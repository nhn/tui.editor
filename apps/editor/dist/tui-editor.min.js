!function t(e,n,i){function o(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(t){var n=e[a][1][t];return o(n?n:t)},d,d.exports,t,e,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";function i(t){o.call(this,{tagName:"button",className:t.className}),this._setOptions(t),this.render(),this.attachEvents({click:"_onClick"})}var o=t("./uicontroller"),r=tui.util;i.prototype=r.extend({},o.prototype),i.prototype._setOptions=function(t){this.command=t.command,this.event=t.event,this.text=t.text,this.style=t.style},i.prototype.render=function(){this.$el.text(this.text),this.$el.attr("type","button"),this.style&&this.$el.attr("style",this.style)},i.prototype._onClick=function(){this.command?this.trigger("command",this.command):this.trigger("event",this.event),this.trigger("clicked")},e.exports=i},{"./uicontroller":45}],2:[function(t,e,n){"use strict";var i=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)/,o=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)$/,r=/[*+-]\s/;CodeMirror.commands.subListIndentTab=function(t){if(t.getOption("disableInput"))return CodeMirror.Pass;for(var e=t.listSelections(),n=0;n<e.length;n++){var i=e[n].head,r=t.getLine(i.line);o.test(r)?t.replaceRange("	"+r,{line:i.line,ch:0},{line:i.line,ch:r.length}):t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")}},CodeMirror.commands.newlineAndIndentContinueMarkdownList=function(t){if(t.getOption("disableInput"))return CodeMirror.Pass;for(var e=t.listSelections(),n=[],a=0;a<e.length;a++){var s=e[a].head,c=t.getStateAfter(s.line),l=c.list!==!1,d=0!==c.quote,u=t.getLine(s.line),h=i.exec(u);if(!e[a].empty()||!l&&!d||!h)return void t.execCommand("newlineAndIndent");if(o.test(u))t.replaceRange("",{line:s.line,ch:0},{line:s.line,ch:s.ch+1}),n[a]="\n";else{var p,m=h[1],f=h[5];p=m.length===s.ch?"":r.test(h[2])||h[2].indexOf(">")>=0?h[2]:parseInt(h[3],10)+1+h[4],n[a]="\n"+m+p+f}}t.replaceSelections(n)}},{}],3:[function(t,e,n){"use strict";CodeMirror.defineMode("gfm",function(t,e){function n(t){return t.code=!1,null}var i=0,o={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(t){return{code:t.code,codeBlock:t.codeBlock,ateSpace:t.ateSpace}},token:function(t,e){if(e.combineTokens=null,e.codeBlock)return t.match(/^```+/)?(e.codeBlock=!1,null):(t.skipToEnd(),null);if(t.sol()&&(e.code=!1),t.sol()&&t.match(/^```+/))return t.skipToEnd(),e.codeBlock=!0,null;if("`"===t.peek()){t.next();var n=t.pos;t.eatWhile("`");var o=1+t.pos-n;return e.code?o===i&&(e.code=!1):(i=o,e.code=!0),null}return e.code?(t.next(),null):t.eatSpace()?(e.ateSpace=!0,null):((t.sol()||e.ateSpace)&&(e.ateSpace=!1),t.next(),null)},blankLine:n},r={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:"```",strikethrough:!0};for(var a in e)r[a]=e[a];return r.name="markdown",CodeMirror.overlayMode(CodeMirror.getMode(t,r),o)},"markdown"),CodeMirror.defineMIME("text/x-gfm","gfm")},{}],4:[function(t,e,n){"use strict";CodeMirror.defineMode("markdown",function(t,e){function n(e){if(CodeMirror.findModeByName){var n=CodeMirror.findModeByName(e);n&&(e=n.mime||n.mimes[0])}var i=CodeMirror.getMode(t,e);return"null"==i.name?null:i}function i(t,e,n){return e.f=e.inline=n,n(t,e)}function o(t){return!t||!/\S/.test(t.string)}function r(t){return t.linkTitle=!1,t.em=!1,t.strong=!1,t.strikethrough=!1,t.quote=0,t.indentedCode=!1,C||t.f!=s||(t.f=h,t.block=a),t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.prevLine=t.thisLine,t.thisLine=null,null}function a(t,r){var a=t.sol(),s=r.list!==!1,l=r.indentedCode;r.indentedCode=!1,s&&(r.indentationDiff>=0?(r.indentationDiff<4&&(r.indentation-=r.indentationDiff),r.list=null):r.indentation>0?(r.list=null,r.listDepth=Math.floor(r.indentation/4)):(r.list=!1,r.listDepth=0));var u=null;if(r.indentationDiff>=4)return t.skipToEnd(),l||o(r.prevLine)?(r.indentation-=4,r.indentedCode=!0,M):null;if(t.eatSpace())return null;if((u=t.match(q))&&u[1].length<=6)return r.header=u[1].length,e.highlightFormatting&&(r.formatting="header"),r.f=r.inline,d(r);if(!(o(r.prevLine)||r.quote||s||l)&&(u=t.match(V)))return r.header="="==u[0].charAt(0)?1:2,e.highlightFormatting&&(r.formatting="header"),r.f=r.inline,d(r);if(t.eat(">"))return r.quote=a?1:r.quote+1,e.highlightFormatting&&(r.formatting="quote"),t.eatSpace(),d(r);if("["===t.peek())return i(t,r,g);if(t.match(F,!0))return r.hr=!0,$;if((o(r.prevLine)||s)&&(t.match(P,!1)||t.match(W,!1))){var h=null;return t.match(P,!0)?h="ul":(t.match(W,!0),h="ol"),r.indentation=t.column()+t.current().length,r.list=!0,r.listDepth++,e.taskLists&&t.match(U,!1)&&(r.taskList=!0),r.f=r.inline,e.highlightFormatting&&(r.formatting=["list","list-"+h]),d(r)}return e.fencedCodeBlocks&&(u=t.match(G,!0))?(r.fencedChars=u[1],r.localMode=n(u[2]),r.localMode&&(r.localState=r.localMode.startState()),r.f=r.block=c,e.highlightFormatting&&(r.formatting="code-block"),r.code=!0,d(r)):i(t,r,r.inline)}function s(t,e){var n=k.token(t,e.htmlState);return(C&&null===e.htmlState.tagStart&&!e.htmlState.context&&e.htmlState.tokenize.isInText||e.md_inside&&t.current().indexOf(">")>-1)&&(e.f=h,e.block=a,e.htmlState=null),n}function c(t,e){return t.sol()&&e.fencedChars&&t.match(e.fencedChars,!1)?(e.localMode=e.localState=null,e.f=e.block=l,null):e.localMode?e.localMode.token(t,e.localState):(t.skipToEnd(),M)}function l(t,n){t.match(n.fencedChars),n.block=a,n.f=h,n.fencedChars=null,e.highlightFormatting&&(n.formatting="code-block"),n.code=!0;var i=d(n);return n.code=!1,i}function d(t){var n=[];if(t.formatting){n.push(N),"string"==typeof t.formatting&&(t.formatting=[t.formatting]);for(var i=0;i<t.formatting.length;i++)n.push(N+"-"+t.formatting[i]),"header"===t.formatting[i]&&n.push(N+"-"+t.formatting[i]+"-"+t.header),"quote"===t.formatting[i]&&(!e.maxBlockquoteDepth||e.maxBlockquoteDepth>=t.quote?n.push(N+"-"+t.formatting[i]+"-"+t.quote):n.push("error"))}if(t.taskOpen)return n.push("meta"),n.length?n.join(" "):null;if(t.taskClosed)return n.push("property"),n.length?n.join(" "):null;if(t.linkHref?n.push(D,"url"):(t.strong&&n.push(A),t.em&&n.push(O),t.strikethrough&&n.push(H),t.linkText&&n.push(R),t.code&&n.push(M)),t.header&&(n.push(_),n.push(_+"-"+t.header)),t.quote&&(n.push(x),!e.maxBlockquoteDepth||e.maxBlockquoteDepth>=t.quote?n.push(x+"-"+t.quote):n.push(x+"-"+e.maxBlockquoteDepth)),t.list!==!1){var o=(t.listDepth-1)%3;o?1===o?n.push(T):n.push(b):n.push(S)}return t.trailingSpaceNewLine?n.push("trailing-space-new-line"):t.trailingSpace&&n.push("trailing-space-"+(t.trailingSpace%2?"a":"b")),n.length?n.join(" "):null}function u(t,e){return t.match(Y,!0)?d(e):void 0}function h(t,n){var i=n.text(t,n);if("undefined"!=typeof i)return i;if(n.list)return n.list=null,d(n);if(n.taskList){var o="x"!==t.match(U,!0)[1];return o?n.taskOpen=!0:n.taskClosed=!0,e.highlightFormatting&&(n.formatting="task"),n.taskList=!1,d(n)}if(n.taskOpen=!1,n.taskClosed=!1,n.header&&t.match(/^#+$/,!0))return e.highlightFormatting&&(n.formatting="header"),d(n);var r=t.sol(),a=t.next();if("\\"===a&&(t.next(),e.highlightFormatting)){var s=d(n);return s?s+" formatting-escape":"formatting-escape"}if(n.linkTitle){n.linkTitle=!1;var c=a;"("===a&&(c=")"),c=(c+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var l="^\\s*(?:[^"+c+"\\\\]+|\\\\\\\\|\\\\.)"+c;if(t.match(new RegExp(l),!0))return D}if("`"===a){var u=n.formatting;e.highlightFormatting&&(n.formatting="code");var h=d(n),f=t.pos;t.eatWhile("`");var g=1+t.pos-f;return n.code?g===E?(n.code=!1,h):(n.formatting=u,d(n)):(E=g,n.code=!0,d(n))}if(n.code)return d(n);if("!"===a&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),I;if("["===a&&t.match(/.*\](\(.*\)| ?\[.*\])/,!1))return n.linkText=!0,e.highlightFormatting&&(n.formatting="link"),d(n);if("]"===a&&n.linkText&&t.match(/\(.*\)| ?\[.*\]/,!1)){e.highlightFormatting&&(n.formatting="link");var s=d(n);return n.linkText=!1,n.inline=n.f=m,s}if("<"===a&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=p,e.highlightFormatting&&(n.formatting="link");var s=d(n);return s?s+=" ":s="",s+L}if("<"===a&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=p,e.highlightFormatting&&(n.formatting="link");var s=d(n);return s?s+=" ":s="",s+B}if("<"===a&&t.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var v=!1;if(!e.underscoresBreakWords&&"_"===a&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var y=t.pos-2;if(y>=0){var w=t.string.charAt(y);"_"!==w&&w.match(/(\w)/,!1)&&(v=!0)}}if("*"===a||"_"===a&&!v)if(r&&" "===t.peek());else{if(n.strong===a&&t.eat(a)){e.highlightFormatting&&(n.formatting="strong");var h=d(n);return n.strong=!1,h}if(!n.strong&&t.eat(a))return n.strong=a,e.highlightFormatting&&(n.formatting="strong"),d(n);if(n.em===a){e.highlightFormatting&&(n.formatting="em");var h=d(n);return n.em=!1,h}if(!n.em)return n.em=a,e.highlightFormatting&&(n.formatting="em"),d(n)}else if(" "===a&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return d(n);t.backUp(1)}if(e.strikethrough)if("~"===a&&t.eatWhile(a)){if(n.strikethrough){e.highlightFormatting&&(n.formatting="strikethrough");var h=d(n);return n.strikethrough=!1,h}if(t.match(/^[^\s]/,!1))return n.strikethrough=!0,e.highlightFormatting&&(n.formatting="strikethrough"),d(n)}else if(" "===a&&t.match(/^~~/,!0)){if(" "===t.peek())return d(n);t.backUp(2)}return" "===a&&(t.match(/ +$/,!1)?n.trailingSpace++:n.trailingSpace&&(n.trailingSpaceNewLine=!0)),d(n)}function p(t,n){var i=t.next();if(">"===i){n.f=n.inline=h,e.highlightFormatting&&(n.formatting="link");var o=d(n);return o?o+=" ":o="",o+L}return t.match(/^[^>]+/,!0),L}function m(t,n){if(t.eatSpace())return null;var i=t.next();return"("===i||"["===i?(n.f=n.inline=f("("===i?")":"]"),e.highlightFormatting&&(n.formatting="link-string"),n.linkHref=!0,d(n)):"error"}function f(t){return function(n,i){var o=n.next();if(o===t){i.f=i.inline=h,e.highlightFormatting&&(i.formatting="link-string");var r=d(i);return i.linkHref=!1,r}return n.match(w(t),!0)&&n.backUp(1),i.linkHref=!0,d(i)}}function g(t,n){return t.match(/^[^\]]*\]:/,!1)?(n.f=v,t.next(),e.highlightFormatting&&(n.formatting="link"),n.linkText=!0,d(n)):i(t,n,h)}function v(t,n){if(t.match(/^\]:/,!0)){n.f=n.inline=y,e.highlightFormatting&&(n.formatting="link");var i=d(n);return n.linkText=!1,i}return t.match(/^[^\]]+/,!0),R}function y(t,e){return t.eatSpace()?null:(t.match(/^[^\s]+/,!0),void 0===t.peek()?e.linkTitle=!0:t.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),e.f=e.inline=h,D+" url")}function w(t){return Q[t]||(t=(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),Q[t]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+t+")")),Q[t]}var C=CodeMirror.modes.hasOwnProperty("xml"),k=CodeMirror.getMode(t,C?{name:"xml",htmlMode:!0}:"text/plain");void 0===e.highlightFormatting&&(e.highlightFormatting=!1),void 0===e.maxBlockquoteDepth&&(e.maxBlockquoteDepth=0),void 0===e.underscoresBreakWords&&(e.underscoresBreakWords=!0),void 0===e.taskLists&&(e.taskLists=!1),void 0===e.strikethrough&&(e.strikethrough=!1);var E=0,_="header",M="comment",x="quote",S="variable-2",T="variable-3",b="keyword",$="hr",I="tag",N="formatting",L="link",B="link",R="link",D="string",O="em",A="strong",H="strikethrough",F=/^([*\-_])(?:\s*\1){2,}\s*$/,P=/^[*\-+]\s+/,W=/^[0-9]+([.)])\s+/,U=/^\[(x| )\](?=\s)/,q=e.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,V=/^ *(?:\={1,}|-{1,})\s*$/,Y=/^[^#!\[\]*_\\<>` "'(~]+/,G=new RegExp("^("+(e.fencedCodeBlocks===!0?"~~~+|```+":e.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),Q=[],z={startState:function(){return{f:a,prevLine:null,thisLine:null,block:a,htmlState:null,indentation:0,inline:h,text:u,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t["this"],block:t.block,htmlState:t.htmlState&&CodeMirror.copyState(k,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?CodeMirror.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(t,e){if(e.formatting=!1,t!=e.thisLine){var n=e.header||e.hr;if(e.header=0,e.hr=!1,t.match(/^\s*$/,!0)||n){if(r(e),!n)return null;e.prevLine=null}e.prevLine=e.thisLine,e.thisLine=t,e.taskList=!1,e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.f=e.block;var i=t.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,o=4*Math.floor((i-e.indentation)/4);o>4&&(o=4);var a=e.indentation+o;if(e.indentationDiff=a-e.indentation,e.indentation=a,i>0)return null}return e.f(t,e)},innerMode:function(t){return t.block==s?{state:t.htmlState,mode:k}:t.localState?{state:t.localState,mode:t.localMode}:{state:t,mode:z}},blankLine:r,getType:d,fold:"markdown"};return z},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown")},{}],5:[function(t,e,n){"use strict";CodeMirror.overlayMode=function(t,e,n){return{startState:function(){return{base:CodeMirror.startState(t),overlay:CodeMirror.startState(e),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(n){return{base:CodeMirror.copyState(t,n.base),overlay:CodeMirror.copyState(e,n.overlay),basePos:n.basePos,baseCur:null,overlayPos:n.overlayPos,overlayCur:null}},token:function(i,o){return(i!=o.streamSeen||Math.min(o.basePos,o.overlayPos)<i.start)&&(o.streamSeen=i,o.basePos=o.overlayPos=i.start),i.start==o.basePos&&(o.baseCur=t.token(i,o.base),o.basePos=i.pos),i.start==o.overlayPos&&(i.pos=i.start,o.overlayCur=e.token(i,o.overlay),o.overlayPos=i.pos),i.pos=Math.min(o.basePos,o.overlayPos),null==o.overlayCur?o.baseCur:null!=o.baseCur&&o.overlay.combineTokens||n&&null==o.overlay.combineTokens?o.baseCur+" "+o.overlayCur:o.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(n){t.blankLine&&t.blankLine(n.base),e.blankLine&&e.blankLine(n.overlay)}}}},{}],6:[function(t,e,n){"use strict";function i(t,e){this.name=t,this.type=e}var o=tui.util;i.prototype.getName=function(){return this.name},i.prototype.getType=function(){return this.type},i.prototype.isMDType=function(){return this.type===i.TYPE.MD},i.prototype.isWWType=function(){return this.type===i.TYPE.WW},i.prototype.isGlobalType=function(){return this.type===i.TYPE.GB},i.prototype.setKeyMap=function(t,e){this.keyMap=[t,e]},i.factory=function(t,e){var n,r;return"markdown"===t?r=i.TYPE.MD:"wysiwyg"===t?r=i.TYPE.WW:"global"===t&&(r=i.TYPE.GB),n=new i(e.name,r),o.extend(n,e),n},i.TYPE={MD:0,WW:1,GB:2},e.exports=i},{}],7:[function(t,e,n){"use strict";function i(t){this._command=new o.Map,this._mdCommand=new o.Map,this._wwCommand=new o.Map,this.base=t,this._initEvent()}var o=tui.util,r=t("./command");i.prototype.addCommand=function(t){var e,n;return 2===arguments.length&&(t=i.command(arguments[0],arguments[1])),e=t.getName(),t.isMDType()?n=this._mdCommand:t.isWWType()?n=this._wwCommand:t.isGlobalType()&&(n=this._command),n.set(e,t),t},i.prototype._initEvent=function(){var t=this;this.base.eventManager.listen("command",function(){t.exec.apply(t,arguments)})},i.prototype.exec=function(t){var e,n=this.base,i=o.toArray(arguments);return i.shift(),e=this._command.get(t),e||(this.base.isMarkdownMode()?(e=this._mdCommand.get(t),n=this.base.mdEditor):(e=this._wwCommand.get(t),n=this.base.wwEditor)),e?(i.unshift(n),e.exec.apply(e,i)):void 0},i.command=function(t,e){var n;return n=r.factory(t,e.name),o.extend(n,e),n},e.exports=i},{"./command":6}],8:[function(t,e,n){"use strict";function i(t){this.eventManager=t}var o=t("./markedCustomRenderer"),r=window.marked,a=window.toMark,s=window.hljs;i.prototype._markdownToHtmlWithCodeHighlight=function(t){return r(t,{renderer:o,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(t,e){return s.getLanguage(e)?s.highlight(e,t).value:t}})},i.prototype._markdownToHtml=function(t){return r(t,{renderer:o,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1})},i.prototype.toHTMLWithCodeHightlight=function(t){var e=this._markdownToHtmlWithCodeHighlight(t);return e=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",e)},i.prototype.toHTML=function(t){var e=this._markdownToHtml(t);return e=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",e)},i.prototype.toMarkdown=function(t){var e=a(t);return e=this.eventManager.emitReduce("convertorAfterHtmlToMarkdownConverted",e)},i.factory=function(t){return new i(t)},e.exports=i},{"./markedCustomRenderer":35}],9:[function(t,e,n){"use strict";var i=function(t){return t&&t.nodeType===Node.TEXT_NODE},o=function(t){return t&&t.nodeType===Node.ELEMENT_NODE},r=function(t,e){return t.childNodes.length&&e>=0?t.childNodes[e]:void 0},a=function(t){return o(t)?t.tagName:i(t)?"TEXT":void 0},s=function(t){var e;return o(t)?e=t.textContent.length:i(t)&&(e=t.nodeValue.length),e},c=function(t){var e;return o(t)?e=t.childNodes.length:i(t)&&(e=t.nodeValue.length),e};e.exports={getChildNodeAt:r,getNodeName:a,isTextNode:i,isElemNode:o,getTextLength:s,getOffsetLength:c}},{}],10:[function(t,e,n){"use strict";function i(t){var e=this;this.options=$.extend({previewStyle:"tab",initialEditType:"markdown",height:300},t),this.eventManager=new c,this.importManager=new u(this.eventManager),this.commandManager=new l(this),this.convertor=new h(this.eventManager),this.layout=new s(t,this.eventManager),this.layout.modeSwitch.on("modeSwitched",function(t,n){e.changeMode(n.text)}),this.mdEditor=new o(this.layout.getMdEditorContainerEl(),this.eventManager),this.preview=new r(this.layout.getPreviewEl(),this.eventManager,this.convertor),this.wwEditor=new a(this.layout.getWwEditorContainerEl(),this.options.contentCSSStyles,this.eventManager),this.options.hooks&&D.forEach(this.options.hooks,function(t,n){e.addHook(n,t)}),this.options.events&&D.forEach(this.options.events,function(t,n){e.on(n,t)}),this.contentHeight(this.options.height),this.changePreviewStyle(this.options.previewStyle),this.mdEditor.init(),this.wwEditor.init(function(){d.applyExtension(e,e.options.exts),e._initDefaultCommands(),e.changeMode(e.options.initialEditType),e.setValue(e.options.initialValue),e.eventManager.emit("load",e)}),O.push(this)}var o=t("./markdownEditor"),r=t("./preview"),a=t("./wysiwygEditor"),s=t("./layout"),c=t("./eventManager"),l=t("./commandManager"),d=t("./extManager"),u=t("./importManager"),h=t("./convertor"),p=t("./markdownCommands/bold"),m=t("./markdownCommands/italic"),f=t("./markdownCommands/blockquote"),g=t("./markdownCommands/heading"),v=t("./markdownCommands/hr"),y=t("./markdownCommands/addLink"),w=t("./markdownCommands/addImage"),C=t("./markdownCommands/ul"),k=t("./markdownCommands/ol"),E=t("./markdownCommands/task"),_=t("./wysiwygCommands/bold"),M=t("./wysiwygCommands/italic"),x=t("./wysiwygCommands/blockquote"),S=t("./wysiwygCommands/addImage"),T=t("./wysiwygCommands/addLink"),b=t("./wysiwygCommands/hr"),I=t("./wysiwygCommands/heading"),N=t("./wysiwygCommands/ul"),L=t("./wysiwygCommands/ol"),B=t("./wysiwygCommands/increaseTask"),R=t("./wysiwygCommands/task"),D=tui.util,O=[];t("./extensions/taskCounter"),t("./extensions/textPalette"),t("./extensions/scrollFollow"),t("./extensions/colorSyntax"),i.prototype._initDefaultCommands=function(){this.commandManager.addCommand(p),this.commandManager.addCommand(m),this.commandManager.addCommand(f),this.commandManager.addCommand(g),this.commandManager.addCommand(v),this.commandManager.addCommand(y),this.commandManager.addCommand(w),this.commandManager.addCommand(C),this.commandManager.addCommand(k),this.commandManager.addCommand(E),this.commandManager.addCommand(_),this.commandManager.addCommand(M),this.commandManager.addCommand(x),this.commandManager.addCommand(N),this.commandManager.addCommand(L),this.commandManager.addCommand(S),this.commandManager.addCommand(T),this.commandManager.addCommand(b),this.commandManager.addCommand(I),this.commandManager.addCommand(B),this.commandManager.addCommand(R)},i.prototype.changePreviewStyle=function(t){this.layout.changePreviewStyle(t),this.mdPreviewStyle=t},i.prototype.exec=function(){this.commandManager.exec.apply(this.commandManager,arguments)},i.prototype.addCommand=function(t,e){e?this.commandManager.addCommand(l.command(t,e)):this.commandManager.addCommand(t)},i.prototype.on=function(t,e){this.eventManager.listen(t,e)},i.prototype.off=function(t){this.eventManager.removeEventHandler(t)},i.prototype.addHook=function(t,e){this.eventManager.removeEventHandler(t),this.eventManager.listen(t,e)},i.prototype.removeHook=function(t){this.eventManager.removeEventHandler(t)},i.prototype.getCodeMirror=function(){return this.mdEditor.getEditor()},i.prototype.getSquire=function(){return this.wwEditor.getEditor()},i.prototype.focus=function(){this.getCurrentModeEditor().focus()},i.prototype.setValue=function(t){t=t||"",this.isMarkdownMode()?this.mdEditor.setValue(t):this.wwEditor.setValue(this.convertor.toHTML(t))},i.prototype.getValue=function(){var t;return t=this.isMarkdownMode()?this.mdEditor.getValue():this.convertor.toMarkdown(this.wwEditor.getValue())},i.prototype.addWidget=function(t,e,n,i){this.getCurrentModeEditor().addWidget(t,e,n,i)},i.prototype.contentHeight=function(t){return t&&(this._contentHeight=t,this.mdEditor.setHeight(t),this.preview.setHeight(t),this.wwEditor.setHeight(t)),this._contentHeight},i.prototype.getCurrentModeEditor=function(){var t;return t=this.isMarkdownMode()?this.mdEditor:this.wwEditor},i.prototype.isMarkdownMode=function(){return"markdown"===this.currentMode},i.prototype.isWysiwygMode=function(){return"wysiwyg"===this.currentMode},i.prototype.changeMode=function(t){this.currentMode!==t&&(this.currentMode=t,this.isWysiwygMode()?(this.wwEditor.setValue(this.convertor.toHTML(this.mdEditor.getValue())),this.layout.switchToWYSIWYG(),this.eventManager.emit("changeModeToWysiwyg")):(this.mdEditor.setValue(this.convertor.toMarkdown(this.wwEditor.getValue())),this.layout.switchToMarkdown(),this.eventManager.emit("changeModeToMarkdown")),this.eventManager.emit("changeMode",t))},i.prototype.remove=function(){this.wwEditor.remove(),this.mdEditor.remove(),this.layout.remove()},i.prototype.hide=function(){this.eventManager.emit("hide",this)},i.prototype.show=function(){this.eventManager.emit("show",this)},i.prototype.reset=function(){this.wwEditor.reset(),this.mdEditor.reset()},i.getInstances=function(){return O},i.defineExtension=function(t,e){d.defineExtension(t,e)},e.exports=i},{"./commandManager":7,"./convertor":8,"./eventManager":11,"./extManager":12,"./extensions/colorSyntax":13,"./extensions/scrollFollow":14,"./extensions/taskCounter":17,"./extensions/textPalette":18,"./importManager":19,"./layout":22,"./markdownCommands/addImage":24,"./markdownCommands/addLink":25,"./markdownCommands/blockquote":26,"./markdownCommands/bold":27,"./markdownCommands/heading":28,"./markdownCommands/hr":29,"./markdownCommands/italic":30,"./markdownCommands/ol":31,"./markdownCommands/task":32,"./markdownCommands/ul":33,"./markdownEditor":34,"./preview":39,"./wysiwygCommands/addImage":46,"./wysiwygCommands/addLink":47,"./wysiwygCommands/blockquote":48,"./wysiwygCommands/bold":49,"./wysiwygCommands/heading":50,"./wysiwygCommands/hr":51,"./wysiwygCommands/increaseTask":52,"./wysiwygCommands/italic":53,"./wysiwygCommands/ol":54,"./wysiwygCommands/task":55,"./wysiwygCommands/ul":56,"./wysiwygEditor":57}],11:[function(t,e,n){"use strict";function i(){this.events=new o.Map,this.TYPE=new o.Enum(r)}var o=tui.util,r=["previewBeforeHook","previewRenderAfter","addImageFileHook","addImageBlobHook","contentChangedFromWysiwyg","changeFromWysiwyg","contentChangedFromMarkdown","changeFromMarkdown","change","changeModeToWysiwyg","changeModeToMarkdown","changeMode","openPopupAddLink","openPopupAddImage","closeAllPopup","command","htmlUpdate","markdownUpdate","renderedHtmlUpdated","convertorAfterMarkdownToHtmlConverted","convertorAfterHtmlToMarkdownConverted","stateChange","load","focus","blur","paste","drop","show","hide"];i.prototype.listen=function(t,e){var n,i=this._getTypeInfo(t);if(!this._hasEventType(i.type))throw new Error("There is no event type "+i.type);n=this.events.get(i.type)||[],i.namespace&&(e.namespace=i.namespace),n.push(e),this.events.set(i.type,n)},i.prototype.emit=function(){var t,e,n=o.toArray(arguments),i=n.shift(),r=this._getTypeInfo(i),a=this.events.get(r.type);return a&&(e=[],o.forEach(a,function(i){t=i.apply(null,n),o.isUndefined(t)||e.push(t)})),e&&e.length?e:void 0},i.prototype.emitReduce=function(){var t=o.toArray(arguments),e=t.shift(),n=this.events.get(e);return n&&o.forEach(n,function(e){var n=e.apply(null,t);o.isFalsy(n)||(t[0]=n)}),t[0]},i.prototype._getTypeInfo=function(t){var e=t.split(".");return{type:e[0],namespace:e[1]}},i.prototype._hasEventType=function(t){return!o.isUndefined(this.TYPE[t.split(".")[0]])},i.prototype.addEventType=function(t){if(this._hasEventType(t))throw new Error("There is already have event type "+t);this.TYPE.set(t)},i.prototype.removeEventHandler=function(t){var e=this,n=this._getTypeInfo(t),t=n.type,i=n.namespace;t&&!i?this.events["delete"](t):!t&&i?this.events.forEach(function(t,n){e._removeEventHandlerWithTypeInfo(n,i)}):t&&i&&e._removeEventHandlerWithTypeInfo(t,i)},i.prototype._removeEventHandlerWithTypeInfo=function(t,e){var n,i=[];n=this.events.get(t),o.forEach(n,function(t){t.namespace!==e&&i.push(t)}),this.events.set(t,i)},e.exports=i},{}],12:[function(t,e,n){"use strict";function i(){this.exts=new o.Map}var o=tui.util;i.prototype.defineExtension=function(t,e){this.exts.set(t,e)},i.prototype.applyExtension=function(t,e){var n=this;e&&e.forEach(function(e){n.exts.has(e)&&n.exts.get(e)(t)})},e.exports=new i},{}],13:[function(t,e,n){"use strict";function i(t,e){return"{color:"+e+"}"+t+"{color}"}function o(t){return t.replace(l,function(t,e,n,i){return e=parseInt(e,10),n=parseInt(n,10),i=parseInt(i,10),"#"+r(e.toString(16))+r(n.toString(16))+r(i.toString(16))})}function r(t){return"0"===t?"00":t}var a=t("../extManager"),s=/{color:(.+?)}(.*?){color}/g,c=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)<\/span>/g,l=/rgb\((\d+)[, ]+(\d+)[, ]+(\d+)\)/g;a.defineExtension("colorSyntax",function(t){var e;t.options.colorSyntax&&(e=!!t.options.colorSyntax.useCustomSyntax),t.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(t){var n;return n=e?t.replace(s,'<span style="color:$1">$2</span>'):t}),t.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(t){return t.replace(c,function(t,n,r){var a;return n.match(l)&&(n=o(n)),a=e?i(r,n):t.replace(/ ?class="colour" ?/g," ").replace(l,n)})}),t.addCommand("markdown",{name:"color",exec:function(t,e){var n=t.getEditor();n.replaceSelection(i(n.getSelection(),e)),t.focus()}}),t.addCommand("wysiwyg",{name:"color",exec:function(t,e){t.getEditor().setTextColour(e),t.focus()}})})},{"../extManager":12}],14:[function(t,e,n){"use strict";var i=t("../extManager"),o=t("./scrollFollow.scrollSync"),r=t("./scrollFollow.sectionManager");i.defineExtension("scrollFollow",function(t){var e,n,i=t.getCodeMirror(),a=!1,s=!0;e=new r(i,t.preview),n=new o(e,i,t.preview.$el),t.addCommand("markdown",{name:"scrollFollow.disable",exec:function(){s=!1}}),t.addCommand("markdown",{name:"scrollFollow.enable",exec:function(){s=!0}}),i.on("change",function(){a=!1,e.makeSectionList()}),t.on("previewRenderAfter",function(){e.sectionMatch(),n.syncToPreview(),a=!0}),i.on("scroll",function(){s&&a&&n.syncToPreview()}),t.layout.toolbar.addButton([{classname:"scrollfollowEnable",command:"scrollFollow.disable",text:"SF",style:"background-color: #fff"},{className:"scrollFollowDisable",command:"scrollFollow.enable",text:"SF",style:"background-color: #ddd"}])})},{"../extManager":12,"./scrollFollow.scrollSync":15,"./scrollFollow.sectionManager":16}],15:[function(t,e,n){"use strict";function i(t,e,n){this.sectionManager=t,this.cm=e,this.$previewContainerEl=n,this._currentTimeoutId=null}var o=20;i.prototype._getEditorSectionHeight=function(t){return this.cm.heightAtLine(t.end,"local")-this.cm.heightAtLine(t.start>0?t.start-1:0,"local")},i.prototype._getEditorLineHeightGapInSection=function(t,e){var n=this.cm.heightAtLine(e,"local")-this.cm.heightAtLine(t.start>0?t.start-1:0,"local");return Math.max(n,0)},i.prototype._getEditorSectionScrollRatio=function(t,e){var n,i=t.end===t.start;return n=i?0:this._getEditorLineHeightGapInSection(t,e)/this._getEditorSectionHeight(t)},i.prototype._getScrollFactorsOfEditor=function(){var t,e,n,i,o,r=this.cm,a=r.getScrollInfo();return i=a.height-a.top<=a.clientHeight,i?o={isEditorBottom:i}:(t=r.coordsChar({left:a.left,top:a.top},"local").line,e=this.sectionManager.sectionByLine(t),n=this._getEditorSectionScrollRatio(e,t),o={section:e,sectionRatio:n}),o},i.prototype._getScrollTopForPreview=function(){var t,e,n,i;return e=this._getScrollFactorsOfEditor(),n=e.section,i=e.sectionRatio,e.isEditorBottom?t=this.$previewContainerEl.find(".previewContent").height():n.$previewSectionEl&&(t=n.$previewSectionEl[0].offsetTop+n.$previewSectionEl.height()*i-o),t=t&&Math.max(t,0)},i.prototype.syncToPreview=function(){var t=this,e=this._getScrollTopForPreview();e&&this._animateRun(this.$previewContainerEl.scrollTop(),e,function(e){t.$previewContainerEl.scrollTop(e)})},i.prototype._animateRun=function(t,e,n){function i(){var s,c=Date.now(),l=(c-r)/200;1>l?(s=t+o*Math.cos((1-l)*Math.PI/2),n(Math.ceil(s)),a._currentTimeoutId=setTimeout(i,1)):(n(e),a._currentTimeoutId=null)}var o=e-t,r=Date.now(),a=this;this._currentTimeoutId&&clearTimeout(this._currentTimeoutId),i()},e.exports=i},{}],16:[function(t,e,n){"use strict";function i(t,e){this.cm=t,this.preview=e,this.$previewContent=e.$el.find(".previewContent"),this._sectionList=null,this._currentSection=null}var o=/^ *(?:\={1,}|-{1,})\s*$/;i.prototype._addNewSection=function(t,e){var n=this._makeSectionData(t,e);this._sectionList.push(n),this._currentSection=n},i.prototype.getSectionList=function(){return this._sectionList},i.prototype._makeSectionData=function(t,e){return{start:t,end:e,$previewSectionEl:null}},i.prototype._updateCurrentSectionEnd=function(t){this._currentSection.end=t},i.prototype._eachLineState=function(t){var e,n,i,r,a=!0,s="";for(r=this.cm.getDoc().lineCount(),i=0;r>i;i+=1){if(n=this.cm.getStateAfter(i),e=!1,!this.cm.getLine(i)||!n.base.header||n.base.quote||n.base.list||n.base.taskList?this.cm.getLine(i+1)&&this.cm.getLine(i+1).match(o)&&(e=!0):e=!0,a){if(s+=this.cm.getLine(i).trim(),!s)continue;a=!1}t(e,i)}},i.prototype.makeSectionList=function(){var t=this;this._sectionList=[],this._eachLineState(function(e,n){e||!t._sectionList.length?t._addNewSection(n,n):t._updateCurrentSectionEnd(n)})},i.prototype.sectionMatch=function(){var t;this._sectionList&&(t=this._getPreviewSections(),this._matchPreviewSectionsWithSectionlist(t))},i.prototype._matchPreviewSectionsWithSectionlist=function(t){var e=this;t.forEach(function(t,n){var i;e._sectionList[n]&&(i=$('<div class="content-id-'+n+'"></div>'),e._sectionList[n].$previewSectionEl=$(t).wrapAll(i).parent())})},i.prototype._getPreviewSections=function(){var t=0,e=[];return e[0]=[],this.$previewContent.contents().filter(function(){return this.nodeType===Node.ELEMENT_NODE}).each(function(n,i){i.tagName.match(/H1|H2|H3|H4|H5|H6/)&&e[t].length&&(e.push([]),t+=1),e[t].push(i)}),e},i.prototype.sectionByLine=function(t){
var e,n=this._sectionList,i=n.length;for(e=0;i>e&&!(t<=n[e].end);e+=1);return e===i&&(e=i-1),n[e]},e.exports=i},{}],17:[function(t,e,n){"use strict";var i=t("../extManager"),o=/^\s*\* \[[xX ]\] [^\n]*/gm,r=/^\s*\* \[[xX]\] [^\n]*/gm;i.defineExtension("taskCounter",function(t){t.getTaskCount=function(){var e,n;return t.isMarkdownMode()?(e=t.mdEditor.getValue().match(o),n=e?e.length:0):n=t.wwEditor.get$Body().find("input").length,n},t.getCheckedTaskCount=function(){var e,n;return t.isMarkdownMode()?(e=t.mdEditor.getValue().match(r),n=e?e.length:0):n=t.wwEditor.get$Body().find("input:checked").length,n}})},{"../extManager":12}],18:[function(t,e,n){"use strict";function i(t){t.show(),t.find("input").focus()}function o(t){t.hide(),t.find("input").val("")}function r(t,e){}var a=t("../extManager");a.defineExtension("textPalette",function(t){var e=$('<div style="z-index:9999"><input type="text" style="background:white" /></div>'),n=t.options.textPalette.triggers,a=t.options.textPalette.querySender;$(t.options.el).append(e),e.find("input").on("keyup",function(n){var i=e.find("input").val();13===n.which?(n.stopPropagation(),t.getCurrentModeEditor().replaceRelativeOffset(i,-1,1),t.focus(),o(e)):a(i,function(t){r(e,t)})}),t.eventManager.listen("change",function(o){-1!==n.indexOf(o.textContent[o.caretOffset-1])&&(t.addWidget(o.selection,e[0],"over"),i(e))})})},{"../extManager":12}],19:[function(t,e,n){"use strict";function i(t){this.eventManager=t,this._initDropEvent(),this._initPasteEvent(),this._initDefaultImporter()}var o=tui.util;i.prototype._initDropEvent=function(){var t=this;this.eventManager.listen("drop",function(e){var n=e.data.dataTransfer&&e.data.dataTransfer.files;t._forEachItems(n)})},i.prototype._initPasteEvent=function(){var t=this;this.eventManager.listen("paste",function(e){var n=e.data.clipboardData&&e.data.clipboardData.items;t._forEachItems(n)})},i.prototype._initDefaultImporter=function(){this.eventManager.listen("addImageBlobHook",function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)})},i.prototype._emitAddImageBlobHook=function(t){var e=this,n=t.name?t:t.getAsFile();this.eventManager.emit("addImageBlobHook",n,function(t){e.eventManager.emit("command","AddImage",{imageUrl:t,altText:n.name||"image"})})},i.prototype._forEachItems=function(t){var e=this;t&&o.forEachArray(t,function(t){-1!==t.type.indexOf("image")&&e._emitAddImageBlobHook(t)})},e.exports=i},{}],20:[function(t,e,n){"use strict";var i;t("./codemirror/overlay"),t("./codemirror/markdown"),t("./codemirror/gfm"),t("./codemirror/continuelist"),i=t("./editor"),$.fn.tuiEditor=function(){var t,e,n,o=$.makeArray(arguments);if(n=this[0])if(t=o[0]||{},e=$.data(n,"tuiEditor")){if("string"==typeof t)return e[t].apply(e,o.slice(1))}else t.el=n,e=new i(t),$.data(n,"tuiEditor",e);return this},window.tui=window.tui||{},window.tui.Editor=i},{"./codemirror/continuelist":2,"./codemirror/gfm":3,"./codemirror/markdown":4,"./codemirror/overlay":5,"./editor":10}],21:[function(t,e,n){"use strict";function i(t){t=r.extend({},t),o.call(this,{tagName:"div",className:s+"wrapper",rootElement:t.$el}),t=r.extend({},t),this._setId(),this._initTarget(t),this._initExternalPopupHtmlIfNeed(t),this._initCloserOpener(t),this._initContent(t),this._initTitle(t),this._initClassName(t)}var o=t("./uicontroller"),r=tui.util,a=0,s="tui-popup-",c=['<div class="'+s+'header">','<span class="'+s+'title"></span>','<button class="'+s+'closeButton">x</button>',"</div>",'<div class="'+s+'body"></div>'].join("");i.prototype=r.extend({},o.prototype),i.prototype._initTarget=function(t){this.$target=t.$target||$("body")},i.prototype._initExternalPopupHtmlIfNeed=function(t){t.$el&&(this.$el=t.$el,this._isExternalHtmlUse=!0)},i.prototype._initCloserOpener=function(t){t.openerCssQuery&&(this.openerCssQuery=t.openerCssQuery),t.closerCssQuery&&(this.closerCssQuery=t.closerCssQuery)},i.prototype._initContent=function(t){t.content?this.$content=$(t.content):t.textContent&&(this.$content=t.textContent)},i.prototype._initTitle=function(t){t.title&&(this.title=t.title)},i.prototype._initClassName=function(t){t.className&&(this.className=t.className)},i.prototype.render=function(){this._renderLayout(),this._renderTitle(),this._renderContent(),this._attachPopupEvent()},i.prototype._renderLayout=function(){this._isExternalHtmlUse?this.hide():(this.$el.html(c),this.$el.addClass(this.className),this.hide(),this.$target.append(this.$el),this.$body=this.$el.find(this._getFullClassName("body")))},i.prototype._renderContent=function(){this._isExternalHtmlUse||this.setContent(this.$content)},i.prototype._renderTitle=function(){this._isExternalHtmlUse||this.setTitle(this.title)},i.prototype._getFullClassName=function(t){return"."+s+t},i.prototype._attachOpenerCloserEvent=function(){var t=this;this.openerCssQuery&&$(this.openerCssQuery).on("click."+this._getId(),function(){t.show()}),this.closerCssQuery&&$(this.closerCssQuery).on("click."+this._getId(),function(){t.hide()})},i.prototype._detachOpenerCloserEvent=function(){this.openerCssQuery&&$(this.openerCssQuery).off("."+this._getId()),this.closerCssQuery&&$(this.closerCssQuery).off("."+this._getId())},i.prototype._attachPopupControlEvent=function(){var t=this;this.on("click "+this._getFullClassName("closeButton"),function(){t.hide()})},i.prototype._detachPopupEvent=function(){this.off(),this._detachOpenerCloserEvent()},i.prototype._attachPopupEvent=function(){this._attachPopupControlEvent(),this._attachOpenerCloserEvent()},i.prototype._setId=function(){this._id=a,a+=1},i.prototype._getId=function(){return this._id},i.prototype.setContent=function(t){this.$body.empty(),this.$body.append(t)},i.prototype.setTitle=function(t){var e=this.$el.find(this._getFullClassName("title"));e.empty(),e.append(t)},i.prototype.hide=function(){this.$el.css("display","none"),this._isShow=!1,this.trigger("hidden",this)},i.prototype.show=function(){this.$el.css("display","block"),this._isShow=!0,this.trigger("shown",this)},i.prototype.isShow=function(){return this._isShow},i.prototype.remove=function(){this.trigger("remove",this),this._detachPopupEvent(),this.$el.empty(),this.$el.remove()},i.factory=function(t){var e=new i(t);return e.render(),e},i.CLASS_PREFIX=s,e.exports=i},{"./uicontroller":45}],22:[function(t,e,n){"use strict";function i(t,e){this.$el=$(t.el),this.height=t.height,this.type=t.initialEditType,this.eventManager=e,this.init(),this._initEvent()}var o=t("./toolbar"),r=t("./tab"),a=t("./modeSwitch"),s=t("./popupAddLink"),c=t("./popupAddImage"),l=['<div class="tui-editor">','<div class="toolbarSection" />','<div class="modeSwitchSection" />','<div class="mdContainer">','<div class="tabSection" />','<div class="editor" />','<div class="preview tui-editor-contents" />',"</div>",'<div class="wysiwygContainer">','<div class="editor" />',"</div>","</div>"].join("");i.prototype.init=function(){this._renderLayout(),this._initToolbar(),this._initModeSwitch(),this._initPopupAddLink(),this._initPopupAddImage(),this._initMarkdownAndPreviewSection(),this._initWysiwygSection()},i.prototype._initEvent=function(){this.eventManager.listen("hide",this.hide.bind(this)),this.eventManager.listen("show",this.show.bind(this))},i.prototype._renderLayout=function(){this.$containerEl=$(l).appendTo(this.$el)},i.prototype._initToolbar=function(){this.toolbar=new o(this.eventManager),this.$containerEl.find(".toolbarSection").append(this.toolbar.$el)},i.prototype._initModeSwitch=function(){this.modeSwitch=new a("markdown"===this.type?a.TYPE.MARKDOWN:a.TYPE.WYSIWYG),this.$containerEl.find(".modeSwitchSection").append(this.modeSwitch.$el)},i.prototype.switchToWYSIWYG=function(){this.$containerEl.removeClass("markdownMode"),this.$containerEl.addClass("wysiwygMode")},i.prototype.switchToMarkdown=function(){this.$containerEl.removeClass("wysiwygMode"),this.$containerEl.addClass("markdownMode"),this.markdownTab.activate("Editor")},i.prototype._initMarkdownAndPreviewSection=function(){this.$mdEditorContainerEl=this.$containerEl.find(".mdContainer .editor"),this.$previewEl=this.$containerEl.find(".mdContainer .preview"),this.markdownTab=new r({items:["Editor","Preview"],sections:[this.$mdEditorContainerEl,this.$previewEl]}),this.$containerEl.find(".mdContainer .tabSection").append(this.markdownTab.$el)},i.prototype._initWysiwygSection=function(){this.$wwEditorContainerEl=this.$containerEl.find(".wysiwygContainer .editor")},i.prototype._initPopupAddLink=function(){this.popupAddLink=new s({$target:this.$el.find(".tui-editor"),eventManager:this.eventManager})},i.prototype._initPopupAddImage=function(){this.popupAddImage=new c({$target:this.$el.find(".tui-editor"),eventManager:this.eventManager})},i.prototype._verticalSplitStyle=function(){this.$containerEl.find(".mdContainer").removeClass("preview-style-tab"),this.$containerEl.find(".mdContainer").addClass("preview-style-vertical")},i.prototype._tabStyle=function(){this.$containerEl.find(".mdContainer").removeClass("preview-style-vertical"),this.$containerEl.find(".mdContainer").addClass("preview-style-tab")},i.prototype.changePreviewStyle=function(t){"tab"===t?this._tabStyle():"vertical"===t&&this._verticalSplitStyle()},i.prototype.hide=function(){this.$el.find(".tui-editor").addClass("hide")},i.prototype.show=function(){this.$el.find(".tui-editor").removeClass("hide")},i.prototype.remove=function(){this.$el.find(".tui-editor").remove()},i.prototype.getEditorEl=function(){return this.$containerEl},i.prototype.getPreviewEl=function(){return this.$previewEl},i.prototype.getStatusbarLeftAreaEl=function(){return this.$statusbarLeftAreaEl},i.prototype.getStatusbarRightAreaEl=function(){return this.$statusbarRightAreaEl},i.prototype.getMdEditorContainerEl=function(){return this.$mdEditorContainerEl},i.prototype.getWwEditorContainerEl=function(){return this.$wwEditorContainerEl},e.exports=i},{"./modeSwitch":36,"./popupAddImage":37,"./popupAddLink":38,"./tab":41,"./toolbar":44}],23:[function(t,e,n){"use strict";function i(){this.globalTOID=null,this.lazyRunFunctions={}}var o=tui.util;i.prototype.run=function(t,e,n,i){var r;return o.isString(t)?r=this._runRegisteredRun(t,e,n,i):(r=this._runSingleRun(t,e,n,i,this.globalTOID),this.globalTOID=r),r},i.prototype.registerLazyRunFunction=function(t,e,n,i){i=i||this,this.lazyRunFunctions[t]={fn:e,delay:n,context:i,TOID:null}},i.prototype._runSingleRun=function(t,e,n,i,o){return this._clearTOIDIfNeed(o),o=setTimeout(function(){t.call(n,e)},i)},i.prototype._runRegisteredRun=function(t,e,n,i){var o,r;return r=this.lazyRunFunctions[t].fn,o=this.lazyRunFunctions[t].TOID,i=i||this.lazyRunFunctions[t].delay,n=n||this.lazyRunFunctions[t].context,o=this._runSingleRun(r,e,n,i,o),this.lazyRunFunctions[t].TOID=o,o},i.prototype._clearTOIDIfNeed=function(t){t&&clearTimeout(t)},e.exports=i},{}],24:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"AddImage",exec:function(t,e){var n,i,o,r,a=t.getEditor(),s=a.getDoc();i=t.getCurrentRange(),o={line:i.from.line,ch:i.from.ch},r={line:i.to.line,ch:i.to.ch},n="!["+e.altText+"]("+e.imageUrl+")",s.replaceRange(n,o,r,"+addImage"),a.focus()}});e.exports=o},{"../commandManager":7}],25:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"AddLink",exec:function(t,e){var n,i,o,r,a=t.getEditor(),s=a.getDoc();i=t.getCurrentRange(),o={line:i.from.line,ch:i.from.ch},r={line:i.to.line,ch:i.to.ch},n="["+e.linkText+"]("+e.url+")",s.replaceRange(n,o,r),a.focus()}});e.exports=o},{"../commandManager":7}],26:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"Blockquote",keyMap:["Ctrl-Q","Ctrl-Q"],exec:function(t){var e,n,i,o,r,a,s,c=t.getEditor(),l=c.getDoc();for(n=t.getCurrentRange(),i={line:n.from.line,ch:0},o={line:n.to.line,ch:l.getLineHandle(n.to.line).text.length},e=l.getRange(i,o),r=e.split("\n"),a=r.length,s=0;a>s;s+=1)r[s]=">"+r[s];l.replaceRange(r.join("\n"),i,o),n.to.ch+=1,l.setCursor(n.to),c.focus()}});e.exports=o},{"../commandManager":7}],27:[function(t,e,n){"use strict";var i=t("../commandManager"),o=/^[\*_]{2,}[^\*_]*[\*_]{2,}$/,r=i.command("markdown",{name:"Bold",keyMap:["Ctrl-B","Ctrl-B"],exec:function(t){var e,n,i,o,r,a,s=t.getEditor(),c=s.getDoc();e=c.getCursor(),n=c.getSelection(),a=!n,a&&e.ch>1&&(i=this.expendSelection(c,e),n=i||n),o=this.isNeedRemove(n),r=o?this.remove(n):this.append(n),c.replaceSelection(r,"around"),a&&!o&&this.setCursorToCenter(c,e),s.focus()},isNeedRemove:function(t){return o.test(t)},append:function(t){return"**"+t+"**"},remove:function(t){return t.substr(2,t.length-4)},expendSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-2},{line:e.line,ch:e.ch+2}),"****"===n||"____"===n?n:void t.setSelection(e)},setCursorToCenter:function(t,e){t.setCursor(e.line,e.ch+2)}});e.exports=r},{"../commandManager":7}],28:[function(t,e,n){"use strict";function i(t){var e,n=t.match(a);return n?(e="#"+n[0],7===e.match(/#/g).length&&(e="# "),t=t.split(n[0])[1]):e="# ",e+t}var o=t("../commandManager"),r=o.command("markdown",{name:"Heading",keyMap:["Ctrl-H","Ctrl-H"],exec:function(t){var e,n,o,r,a,s,c,l,d=t.getEditor(),u=d.getDoc();for(n=t.getCurrentRange(),o={line:n.from.line,ch:0},r={line:n.to.line,ch:u.getLineHandle(n.to.line).text.length},l=u.getLine(r.line).length,e=u.getRange(o,r),a=e.split("\n"),s=a.length,c=0;s>c;c+=1)a[c]=i(a[c]);u.replaceRange(a.join("\n"),o,r),n.to.ch+=u.getLine(r.line).length-l,u.setCursor(n.to),d.focus()}}),a=/^#+\s/g;e.exports=r},{"../commandManager":7}],29:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"HR",exec:function(t){var e,n,i,o=t.getEditor(),r="",a=o.getDoc();e=t.getCurrentRange(),n={line:e.from.line,ch:e.from.ch},i={line:e.to.line,ch:e.to.ch},e.collapsed&&(r=a.getLine(n.line),n.ch=0,i.ch=a.getLineHandle(e.to.line).text.length),r+=a.getLine(n.line).length?"\n\n* * *\n\n":"\n* * *\n",a.replaceRange(r,n,i),o.focus()}});e.exports=o},{"../commandManager":7}],30:[function(t,e,n){"use strict";var i=t("../commandManager"),o=/^[\*_]{3,}[^\*_]*[\*_]{3,}$/,r=/^[\*_][^\*_]*[\*_]$/,a=i.command("markdown",{name:"Italic",keyMap:["Ctrl-I","Ctrl-I"],exec:function(t){var e,n,i,o,r,a,s,c=t.getEditor(),l=c.getDoc();e=l.getCursor(),n=l.getSelection(),a=!n,s=!1,a&&(e.ch>2&&(i=this.expendWithBoldSelection(l,e),i&&(s="with")),"with"!==s&&e.ch>1&&(s=this.expendOnlyBoldSelection(l,e)),!s&&e.ch>0&&(this.expendSelection(l,e),n=i||n)),o=this.isNeedRemove(n),r=o?this.remove(n):this.append(n),l.replaceSelection(r,"around"),a&&this.setCursorToCenter(l,e,o),c.focus()},isNeedRemove:function(t){return r.test(t)||o.test(t)},append:function(t){return"_"+t+"_"},remove:function(t){return t.substr(1,t.length-2)},expendWithBoldSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-3},{line:e.line,ch:e.ch+3}),"******"===n||"______"===n?n:void t.setSelection(e)},expendOnlyBoldSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-2},{line:e.line,ch:e.ch+2}),"****"===n||"____"===n?(t.setSelection(e),"only"):!1},expendSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-1},{line:e.line,ch:e.ch+1}),"**"===n||"__"===n?n:void t.setSelection(e)},setCursorToCenter:function(t,e,n){var i=n?-1:1;t.setCursor(e.line,e.ch+i)}});e.exports=a},{"../commandManager":7}],31:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"OL",exec:function(t){var e,n,i,o,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),i={line:n.from.line,ch:n.from.ch},o={line:n.to.line,ch:n.to.ch},e="1. ",a.replaceRange(e,i,o),r.focus()}});e.exports=o},{"../commandManager":7}],32:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"Task",exec:function(t){var e,n,i,o,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),i={line:n.from.line,ch:n.from.ch},o={line:n.to.line,ch:n.to.ch},e="* [ ] ",a.replaceRange(e,i,o),r.focus()}});e.exports=o},{"../commandManager":7}],33:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("markdown",{name:"UL",exec:function(t){var e,n,i,o,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),i={line:n.from.line,ch:n.from.ch},o={line:n.to.line,ch:n.to.ch},e="* ",a.replaceRange(e,i,o),r.focus()}});e.exports=o},{"../commandManager":7}],34:[function(t,e,n){"use strict";function i(t,e){this.eventManager=e,this.$editorContainerEl=t,this._latestState={bold:!1,italic:!1}}var o=window.CodeMirror;i.prototype.init=function(t){var e=$("<textarea />");t&&(e.text(t),this._emitMarkdownEditorContentChangedEvent(t)),this.$editorContainerEl.append(e),this.cm=o.fromTextArea(e[0],{lineWrapping:!0,mode:"gfm",theme:"default",dragDrop:!0,allowDropFileTypes:["image"],extraKeys:{Enter:"newlineAndIndentContinueMarkdownList",Tab:"subListIndentTab","Shift-Tab":"indentLess"},indentUnit:4}),this._initEvent()},i.prototype._initEvent=function(){var t=this;this.cm.on("change",function(e,n){t._emitMarkdownEditorContentChangedEvent(),t._emitMarkdownEditorChangeEvent(n)}),this.cm.on("focus",function(){t.eventManager.emit("focus",{source:"markdown"})}),this.cm.on("blur",function(){t.eventManager.emit("blur",{source:"markdown"})}),this.cm.getWrapperElement().addEventListener("paste",function(e){t.eventManager.emit("paste",{source:"markdown",data:e})}),this.cm.on("drop",function(e,n){n.preventDefault(),t.eventManager.emit("drop",{source:"markdown",data:n})}),this.cm.on("cursorActivity",function(){var e,n;e=t.cm.getTokenAt(t.cm.getCursor()),n={bold:!!e.state.base.strong,italic:!!e.state.base.em},(t._latestState.bold!==n.bold||t._latestState.italic!==n.italic)&&(t.eventManager.emit("stateChange",n),t._latestState=n)})},i.prototype.getCurrentRange=function(){var t=this.cm.getCursor("from"),e=this.cm.getCursor("to");return{from:t,to:e,collapsed:t===e}},i.prototype.focus=function(){this.cm.focus()},i.prototype.remove=function(){this.cm.toTextArea()},i.prototype.setValue=function(t){this.getEditor().setValue(t),this._emitMarkdownEditorContentChangedEvent(),this.getEditor().refresh()},i.prototype.getValue=function(){return this.cm.getValue("\n")},i.prototype.getEditor=function(){return this.cm},i.prototype.reset=function(){this.setValue("")},i.prototype._emitMarkdownEditorContentChangedEvent=function(){this.eventManager.emit("contentChangedFromMarkdown",this)},i.prototype._cloneCMEventObject=function(t){return{from:{line:t.from.line,ch:t.from.ch},to:{line:t.to.line,ch:t.to.ch}}},i.prototype._emitMarkdownEditorChangeEvent=function(t){var e,n;"setValue"!==t.origin&&(n=this.getEditor().getCursor(),e={source:"markdown",selection:n,textContent:this.cm.getDoc().getLine(n.line)||"",caretOffset:n.ch},this.eventManager.emit("changeFromMarkdown",e),this.eventManager.emit("change",e))},i.prototype.getCaretPosition=function(){return this.cm.cursorCoords()},i.prototype.addWidget=function(t,e,n,i){i&&(t.ch+=i),this.cm.addWidget(t,e,!0,n)},i.prototype.replaceSelection=function(t,e){e&&this.cm.setSelection(e.from,e.to),this.cm.replaceSelection(t),this.focus()},i.prototype.replaceRelativeOffset=function(t,e,n){var i=this.cm.getCursor(),o={from:{line:i.line,ch:i.ch+e},to:{line:i.line,ch:i.ch+e+n}};this.replaceSelection(t,o)},i.prototype.setHeight=function(t){this.$editorContainerEl.height(t)},e.exports=i},{}],35:[function(t,e,n){"use strict";function i(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var o=new window.marked.Renderer,r=/^((?:<p>|))\[(?:x| )\] /;o.listitem=function(t){var e,n,i="",o="";return e=r.exec(t),e&&(t=t.substring(e[0].length),i=' class="task-list-item"',n="[x] "===e[0]?" checked":"",o+=e[1]+'<input type="checkbox" class="task-list-item-checkbox"'+n+"> "),"<li"+i+">"+o+t+"</li>\n"},o.code=function(t,e,n){var o;return this.options.highlight&&(o=this.options.highlight(t,e),null!==o&&o!==t&&(n=!0,t=o)),e?'<pre><code class="'+this.options.langPrefix+i(e,!0)+'" data-language="'+i(e,!0)+'">'+(n?t:i(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:i(t,!0))+"\n</code></pre>"},e.exports=o},{}],36:[function(t,e,n){"use strict";function i(t){o.call(this,{tagName:"div",className:"modeSwitch"}),this.type=r.isExisty(t)?t:s.MARKDOWN,this._render()}var o=t("./uicontroller"),r=tui.util,a=["WYSIWYG","Markdown"],s={MARKDOWN:0,WYSIWYG:1};i.prototype=r.extend({},o.prototype),i.prototype._render=function(){this.$button=$('<button class="switchButton" type="button" />'),this._setButtonTitle(),this.$el.append(this.$button),this.attachEvents({"click button":"_buttonClicked"})},i.prototype._setButtonTitle=function(){this.$button.text("to"+this._getNextTypeString())},i.prototype._buttonClicked=function(){this._switchType()},i.prototype._switchType=function(){var t=this._getNextTypeString();this._toggleType(),this._setButtonTitle(),this.trigger("modeSwitched",{type:this.type,text:t.toLowerCase()})},i.prototype._getNextTypeString=function(){return a[this.type]},i.prototype._toggleType=function(){this.type=this.type===s.MARKDOWN?s.WYSIWYG:s.MARKDOWN},i.TYPE=s,e.exports=i},{"./uicontroller":45}],37:[function(t,e,n){"use strict";function i(t){t=a.extend({title:"Add Image",className:"popupAddImage tui-editor-popup",content:s},t),o.call(this,t),this.eventManager=t.eventManager,this.render(),this._bindContentEvent(),this._linkWithEventManager(),this._initApplyImageBindContext()}var o=t("./layerpopup"),r=t("./tab"),a=tui.util,s=['<div class="tabSection"></div>','<div class="urlType">','<label for="">Image URL</label>','<input type="text" class="imageUrlInput" />',"</div>",'<form enctype="multipart/form-data" class="fileType">','<label for="">Image File</label>','<input type="file" class="imageFileInput" accept="image/*" />',"</form>",'<label for="url">Alt Text</label>','<input type="text" class="altTextInput" />','<div class="buttonSection">','<button type="button" class="okButton">OK</button>','<button type="button" class="closeButton">Cancel</button>',"</div>"].join("");i.prototype=a.extend({},o.prototype),i.prototype._bindContentEvent=function(){var t=this;this.on("click .okButton",function(){t.trigger("okButtonClicked",this),t.hide()}),this.on("click .closeButton",function(){t.trigger("closeButtonClicked",this),t.hide()}),this.on("shown",function(){t.$el.find(".imageUrlInput").focus()}),this.on("hidden",function(){t.resetInputs()}),this.tab.on("itemClick",function(){t.resetInputs()}),this.on("change .imageFileInput",function(){var e=t.$el.find(".imageFileInput").val().split("\\").pop();t.$el.find(".altTextInput").val(e)})},i.prototype._linkWithEventManager=function(){var t=this;this.eventManager.listen("openPopupAddImage",function(){t.eventManager.emit("closeAllPopup"),t.show()}),this.eventManager.listen("closeAllPopup",function(){t.hide()}),this.on("okButtonClicked",function(){t._isUrlType()?t.applyImage():(t._preAltValue=t.$el.find(".altTextInput").val(),t.eventManager.emit("addImageFileHook",t._getImageFileForm(),t.applyImage))})},i.prototype._initApplyImageBindContext=function(){var t=this;this.applyImage=function(e){var n;n=e?t._getImageInfoWithGivenUrl(e):t._getImageInfo(),t.eventManager.emit("command","AddImage",n),t.hide()}},i.prototype._isUrlType=function(){return!!this.$el.find(".imageUrlInput").val()},i.prototype._renderContent=function(){var t=this.$el;o.prototype._renderContent.call(this),this.tab=new r({initName:"File",items:["File","URL"],sections:[t.find(".fileType"),t.find(".urlType")]}),this.$body.find(".tabSection").append(this.tab.$el)},i.prototype._getImageInfoWithGivenUrl=function(t){var e=this._preAltValue;return this._preAltValue="",this._makeImageInfo(t,e)},i.prototype._getImageInfo=function(){var t=this.$el.find(".imageUrlInput").val(),e=this.$el.find(".altTextInput").val();return this._makeImageInfo(t,e)},i.prototype._makeImageInfo=function(t,e){return{imageUrl:t,altText:e}},i.prototype._getImageFileForm=function(){return this.$el.find("form")},i.prototype.resetInputs=function(){this.$el.find("input").val("")},e.exports=i},{"./layerpopup":21,"./tab":41}],38:[function(t,e,n){"use strict";function i(t){t=r.extend({title:"Add Link",className:"popupAddLink tui-editor-popup",content:a},t),o.call(this,t),this.render(),this._bindContentEvent(),this._linkWithEventManager(t.eventManager)}var o=t("./layerpopup"),r=tui.util,a=['<label for="linkText">Link Text</label>','<input type="text" class="linkTextInput" />','<label for="url">URL</label>','<input type="text" class="urlInput" />','<div class="buttonSection">','<button type="button" class="okButton">OK</button>','<button type="button" class="closeButton">Cancel</button>',"</div>"].join("");i.prototype=r.extend({},o.prototype),i.prototype._bindContentEvent=function(){var t=this;this.on("click .okButton",function(){t.trigger("okButtonClicked",this),t.hide()}),this.on("click .closeButton",function(){t.trigger("closeButtonClicked",this),t.hide()}),this.on("shown",function(){t.$el.find(".linkTextInput").focus()}),this.on("hidden",function(){t.resetInputs()})},i.prototype._linkWithEventManager=function(t){var e=this;t.listen("openPopupAddLink",function(){t.emit("closeAllPopup"),e.show()}),t.listen("closeAllPopup",function(){e.hide()}),this.on("okButtonClicked",function(){t.emit("command","AddLink",e.getValue())})},i.prototype.getValue=function(){return{linkText:this.$el.find(".linkTextInput").val(),url:this.$el.find(".urlInput").val()}},i.prototype.resetInputs=function(){this.$el.find("input").val("")},e.exports=i},{"./layerpopup":21}],39:[function(t,e,n){"use strict";function i(t,e,n){this.eventManager=e,this.converter=n,this.$el=t,this._initContentSection(),this.lazyRunner=new o,this.lazyRunner.registerLazyRunFunction("refresh",this.refresh,800,this),this._initEvent()}var o=t("./lazyRunner");i.prototype._initEvent=function(){var t=this;this.eventManager.listen("contentChangedFromMarkdown",function(e){t.lazyRunner.run("refresh",e.getValue())})},i.prototype._initContentSection=function(){this.$previewContent=$('<div class="previewContent tui-editor--contents" />'),this.$el.append(this.$previewContent)},i.prototype.refresh=function(t){this.render(this.converter.toHTMLWithCodeHightlight(t))},i.prototype.render=function(t){var e,n=t;e=this.eventManager.emit("previewBeforeHook",t),e&&(n=e[0]),this.$previewContent.empty(),this.$previewContent.html(n),this.eventManager.emit("previewRenderAfter",this)},i.prototype.setHeight=function(t){this.$el.height(t)},e.exports=i},{"./lazyRunner":23}],40:[function(t,e,n){"use strict";function i(){r.apply(this,arguments)}var o=t("./domUtils"),r=window.Squire,a=tui.util,s=/\b(H[\d]|LI|P|BLOCKQUOTE|TD)\b/;i.prototype=a.extend({},r.prototype),i.prototype.get$Body=function(){return this.$body=this.$body||$(this.getDocument().body),this.$body},i.prototype.changeBlockFormat=function(t,e){var n=this;this.modifyBlocks(function(i){var r,s,c,l,d,u;if(i.childNodes.length?r=i.childNodes[0]:(r=n.createDefaultBlock(),i.appendChild(r)),t){for(;r.firstChild;)r=r.firstChild;for(;r!==i;){if(d=r.tagName,a.isFunction(t)?t(d):d===t){l=r.childNodes[0],(!o.isElemNode(l)||r.childNodes.length>1)&&(l=n.createDefaultBlock(),a.forEachArray(a.toArray(r.childNodes),function(t){l.appendChild(t)}),u=l.lastChild,u&&"BR"===o.getNodeName(u)&&l.removeChild(u)),c=e?n.createElement(e,[l]):l,s=n.getDocument().createDocumentFragment(),s.appendChild(c),i=s;break}r=r.parentNode}}return s&&t||!e||"DIV"!==o.getNodeName(i.childNodes[0])||(i=n.createElement(e,[i.childNodes[0]])),i})},i.prototype.changeBlockFormatTo=function(t){this.changeBlockFormat(function(t){return s.test(t)},t)},i.prototype.getCaretPosition=function(){var t,e,n,i,o,r=0,a=0,s=this.getDocument().body,c=s.offsetLeft,l=s.offsetTop,d={left:0,top:0};return e=this.getSelection(),t=e.cloneRange(),t.setStart(t.startContainer,t.startOffset-1),n=t.getBoundingClientRect(),0===t.endOffset||""===t.toString()?t.startContainer===s?0===t.endOffset?(d.top="0",d.left="0"):(i=t.cloneRange(),i.setStart(i.startContainer,0),o=i.getBoundingClientRect(),d.left=o.left+r-c,d.top=o.top+o.height+a-l):(d.top=t.startContainer.offsetTop,d.left=t.startContainer.offsetLeft):(d.left=n.left+n.width+r-c,d.top=n.top+a-l),d},i.prototype.replaceSelection=function(t,e){e&&this.setSelection(e),this._ignoreChange=!0,this.insertPlainText(t)},i.prototype.replaceRelativeOffset=function(t,e,n){var i;i=this.getSelection().cloneRange(),this._replaceRelativeOffsetOfSelection(t,e,n,i)},i.prototype._replaceRelativeOffsetOfSelection=function(t,e,n,i){var o;i.setStart(i.endContainer,i.endOffset+e),o=this.getSelectionInfoByOffset(i.endContainer,i.endOffset+(e+n)),i.setEnd(o.element,o.offset),this.replaceSelection(t,i)},i.prototype.getSelectionInfoByOffset=function(t,e){var n,i,r,a,s;for(n=t,r=e,a=0;n&&(i=o.getTextLength(n),a+=i,!(a>=e));)r-=i,o.getTextLength(n)>0&&(s=n),n=n.nextSibling;return n||(n=s,r=o.getTextLength(n)),{element:n,offset:r}},i.prototype.getSelectionPosition=function(t,e,n){var i,o,r,a=this.createElement("INPUT");return o=t.cloneRange(),o.setStart(o.startContainer,o.startOffset),r=this.getSelectionInfoByOffset(t.endContainer,t.endOffset+(n||0)),o.setEnd(r.element,r.offset),this._ignoreChange=!0,this.insertElement(a,o),i=$(a).offset(),"over"!==e&&(i.top+=$(a).outerHeight()),a.parentNode.removeChild(a),this.setSelection(t),i.top-=this.get$Body().scrollTop(),i},e.exports=i},{"./domUtils":9}],41:[function(t,e,n){"use strict";function i(t){o.call(this,{tagName:"div",className:"tab"}),t=a.extend({},t),this.items=t.items,this.sections=t.sections,this._$activeButton=null,this.render(),this._initItemClickEvent(t.onItemClick),this._applyInitName(t.initName)}var o=t("./uicontroller"),r=t("./templater"),a=tui.util,s='<button type="button" data-index="${index}">${name}</button>';i.prototype=a.extend({},o.prototype),i.prototype.render=function(){var t;t=r(s,this._getButtonData()),this.$el.html(t),this.attachEvents({"click button":"_onButtonClick"})},i.prototype._applyInitName=function(t){t&&this.activate(t)},i.prototype._getButtonData=function(){var t,e,n=[];for(t=0,e=this.items.length;e>t;t+=1)n.push({name:this.items[t],index:t});return n},i.prototype._onButtonClick=function(t){var e=$(t.target);this._activateTabByButton(e)},i.prototype._deactivate=function(){this._$activeButton&&(this._$activeButton.removeClass("active"),this.sections&&this.sections[this._$activeButton.attr("data-index")].removeClass("active"))},i.prototype._activateButton=function(t){this._$activeButton=t,this._$activeButton.addClass("active")},i.prototype._activateSection=function(t){this.sections&&this.sections[t].addClass("active")},i.prototype.activate=function(t){var e=this.$el.find('button:contains("'+t+'")');this._activateTabByButton(e)},i.prototype._activateTabByButton=function(t){this._isActivatedButton(t)||(this._deactivate(),this._activateButton(t),this._activateSection(t.attr("data-index")),this.trigger("itemClick",t.text()))},i.prototype._isActivatedButton=function(t){return this._$activeButton&&this._$activeButton.text()===t.text()},i.prototype._initItemClickEvent=function(t){t&&this.on("itemClick",t)},e.exports=i},{"./templater":42,"./uicontroller":45}],42:[function(t,e,n){"use strict";function i(t,e){var n,i=[];return o.isArray(e)||(e=[e]),o.forEach(e,function(e){n=t.replace(/\${([\w]+)}/g,function(t,n){return o.isExisty(e,n)?e[n].toString():""}),i.push(n)}),i}var o=tui.util;e.exports=i},{}],43:[function(t,e,n){"use strict";function i(t){this.options=t,this.current=this.options[0],o.call(this,this.current),this._initEvent()}var o=t("./button"),r=tui.util;i.prototype=r.extend({},o.prototype),i.prototype._initEvent=function(){var t=this;this.on("clicked",function(){t._toggle()})},i.prototype._toggle=function(){this.current===this.options[0]?this.current=this.options[1]:this.current=this.options[0],this._setOptions(this.current),this.render()},e.exports=i},{"./button":1}],44:[function(t,e,n){"use strict";function i(t){o.call(this,{tagName:"div",className:"toolbar"}),this.buttons=[],this.eventManager=t,this.render(),
this._initButton()}var o=t("./uicontroller"),r=t("./button"),a=t("./toggleButton"),s=tui.util;i.prototype=s.extend({},o.prototype),i.prototype.render=function(){this.$buttonContainer=this.$el},i.prototype.addButton=function(t){var e=this.eventManager;t.render||(t=s.isArray(t)?new a(t):new r(t)),t.on("command",function(t,n){e.emit("command",n)}),t.on("event",function(t,n){e.emit(n)}),this.buttons.push(t),this.$buttonContainer.append(t.$el)},i.prototype._initButton=function(){this.addButton(new r({className:"bold",command:"Bold",text:"B"})),this.addButton(new r({className:"italic",command:"Italic",text:"I"})),this.addButton(new r({className:"quote",command:"Blockquote",text:"Q"})),this.addButton(new r({className:"heading",command:"Heading",text:"HH"})),this.addButton(new r({className:"hrline",command:"HR",text:"HR"})),this.addButton(new r({className:"link",event:"openPopupAddLink",text:"A"})),this.addButton(new r({className:"image",event:"openPopupAddImage",text:"IMG"})),this.addButton(new r({className:"ul",command:"UL",text:"UL"})),this.addButton(new r({className:"ol",command:"OL",text:"OL"})),this.addButton(new r({className:"task",command:"Task",text:"TASK"}))},e.exports=i},{"./button":1,"./toggleButton":43,"./uicontroller":45}],45:[function(t,e,n){"use strict";function i(t){t=o.extend({tagName:"div"},t||{}),this.tagName=t.tagName,this.className=t.className,this.$el=null,this._initID(),this.setRootElement(t.rootElement)}var o=tui.util,r=0;i.prototype.on=function(t,e){var n=this;o.isObject(t)?o.forEach(t,function(t,e){n._addEvent(e,t)}):this._addEvent(t,e)},i.prototype._addEvent=function(t,e){var n=this._parseEventType(t),i=n[0],o=n[1];o?this.$el.on(i,o,e):this.$el.on(i,e)},i.prototype.off=function(t,e){var n,i,o;t?(n=this._parseEventType(t),i=n[0],o=n[1],o?this.$el.off(i,o,e):this.$el.off(i,e)):this.$el.off()},i.prototype._parseEventType=function(t){var e=t.split(" "),n=e.shift(),i=e.join(" ");return[n,i]},i.prototype.attachEvents=function(t){var e,n=this,i=t||this.events;i&&o.forEach(i,function(t,i){if(!n[t])throw new Error("UIController#attachEvents: "+t+"  .");i=n.getEventNameWithNamespace(i),e=o.bind(n[t],n),n.on(i,e)})},i.prototype.detachEvents=function(){this.$el.off(".uicEvent"+this.id)},i.prototype.setRootElement=function(t){var e=this.className,n=this.tagName;t||(e=e||"uic"+this.id,n=n,t=$("<"+n+' class="'+e+'"/>')),this.$el=t},i.prototype.trigger=function(){this.$el.trigger.apply(this.$el,arguments)},i.prototype._initID=function(){this.id=r,r+=1},i.prototype.getEventNameWithNamespace=function(t){var e=t.split(" ");return e[0]+=".uicEvent"+this.id,e.join(" ")},i.prototype.addUIC=function(t,e){e?this.$el.find(e).append(t.$el):this.$el.append(t.$el)},i.prototype.remove=function(){this.detachEvents(),this.$el.remove()},i.prototype.destroy=function(){this.remove(),this.detachEvents(),o.forEachOwnProperties(this,function(t,e){this[e]=null},this)},i.extend=function(t){var e=o.defineClass(this,t);return e.extend=i.extend,e},e.exports=i},{}],46:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"AddImage",exec:function(t,e){var n=t.getEditor();n.insertImage(e.imageUrl),n.focus()}});e.exports=o},{"../commandManager":7}],47:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"AddLink",exec:function(t,e){var n=t.getEditor();n.removeAllFormatting(),n.makeLink(e.url),n.focus()}});e.exports=o},{"../commandManager":7}],48:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"Blockquote",exec:function(t){var e=t.getEditor();t.unwrapBlockTag(),e.increaseQuoteLevel(),e.focus()}});e.exports=o},{"../commandManager":7}],49:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"Bold",keyMap:["Ctrl-B","Ctrl-B"],exec:function(t){var e=t.getEditor();e.removeItalic(),e.hasFormat("b")||e.hasFormat("strong")?e.changeFormat(null,{tag:"b"}):e.hasFormat("a")||e.bold(),e.focus()}});e.exports=o},{"../commandManager":7}],50:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"Heading",exec:function(t){var e,n=t.getEditor(),i=t.hasFormatWithRx(/h[\d]/i),o=1;i&&(e=parseInt(i[0].replace(/h/i,""),10)),e&&6>e&&(o=e+1),t.changeBlockFormatTo("H"+o),n.focus()}});e.exports=o},{"../commandManager":7}],51:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"HR",exec:function(t){var e=t.getEditor();e.modifyBlocks(function(t){return t.appendChild(e.createElement("HR")),t}),e.focus()}});e.exports=o},{"../commandManager":7}],52:[function(t,e,n){"use strict";function i(t){var e=t.nodeType;return!(e!==Node.ELEMENT_NODE&&e!==Node.DOCUMENT_FRAGMENT_NODE||o(t)||r(t))}function o(t){return d.test(t.nodeName)}function r(t){var e=t.nodeType;return(e===Node.ELEMENT_NODE||e===Node.DOCUMENT_FRAGMENT_NODE)&&!o(t)&&a(t.childNodes,o)}function a(t,e){for(var n=t.length-1;n>=0;){if(!e(t[n]))return!1;n-=1}return!0}function s(t,e){var n=t.parentNode;n&&n.replaceChild(e,t)}function c(t){var e,n,o,r,a,c=t.querySelectorAll("LI"),l={"class":"task-list-item"};for(e=0,n=c.length;n>e;e+=1)o=c[e],i(o.firstChild)||(r=o.parentNode.nodeName,a=o.previousSibling,a&&(a=a.lastChild)&&a.nodeName===r||s(o,this.createElement("LI",l,[a=this.createElement(r)])),a.appendChild(o));return t}var l=t("../commandManager"),d=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|U|VAR|WBR)$/,u=l.command("wysiwyg",{name:"IncreaseTask",exec:function(t){var e,n,i;if(i=t.getEditor().getSelection(),n=i.startContainer,i.collapsed&&""===i.startContainer.textContent.replace(/^[\s]+/g,""))for(;e=n.parentNode;){if("UL"===e.nodeName||"OL"===e.nodeName){n.previousSibling&&t.getEditor().modifyBlocks(c);break}n=e}}});e.exports=u},{"../commandManager":7}],53:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"Italic",keyMap:["Ctrl-I","Ctrl-I"],exec:function(t){var e=t.getEditor();e.removeBold(),e.hasFormat("i")||e.hasFormat("em")?e.changeFormat(null,{tag:"i"}):e.hasFormat("a")||e.italic(),e.focus()}});e.exports=o},{"../commandManager":7}],54:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"OL",keyMap:["Ctrl-O","Ctrl-O"],exec:function(t){var e=t.getEditor();t.unwrapBlockTag(),e.makeOrderedList(),e.focus()}});e.exports=o},{"../commandManager":7}],55:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"Task",exec:function(t){var e,n,i,o=t.getEditor();o.hasFormat("li")||(t.unwrapBlockTag(),o.makeUnorderedList()),e=o.getSelection().cloneRange(),n=$(e.startContainer),i=n.closest("li"),0===i.find("input").length&&(t.saveSelection(e),e.setStart(e.startContainer,0),e.collapse(!0),o.insertElement(o.createElement("INPUT",{type:"checkbox"}),e),e.setStart(e.startContainer,1),o.insertElement(o.getDocument().createTextNode(" "),e),i.addClass("task-list-item"),t.restoreSavedSelection()),o.focus()}});e.exports=o},{"../commandManager":7}],56:[function(t,e,n){"use strict";var i=t("../commandManager"),o=i.command("wysiwyg",{name:"UL",keyMap:["Ctrl-U","Ctrl-U"],exec:function(t){var e=t.getEditor();t.unwrapBlockTag(),e.makeUnorderedList(),e.focus()}});e.exports=o},{"../commandManager":7}],57:[function(t,e,n){"use strict";function i(t,e,n){this.eventManager=n,this.$editorContainerEl=t,this.contentStyles=e}var o=t("./domUtils"),r=t("./squireExt"),a=tui.util,s=/h[\d]/i,c=/<(.+)>(<br>|<br \/>|<BR>|<BR \/>)<\/\1>/g,l=/(?:<br>|<br \/>|<BR>|<BR \/>)<\/(.+?)>/g,d=/\b(H[\d]|LI|P|BLOCKQUOTE|TD)\b/,u=/^\s+/g,h="tui-editor-contents";i.prototype.init=function(t){var e=this;this.$iframe=$('<iframe height="100%" />'),this.$iframe.load(function(){e._initSquire(),setTimeout(function(){t&&(t(),t=null)},0)}),this.$editorContainerEl.css("position","relative"),this.$editorContainerEl.append(this.$iframe)},i.prototype._initSquire=function(){var t=this,e=t.$iframe[0].contentDocument;t._makeSureStandardMode(e),t.editor&&t._isIframeReady()||(t._initStyleSheet(e),t._initEditorContainerStyles(e),t.editor=new r(e,{blockTag:"DIV"}),t._initSquireEvent(),$(e).on("click",function(){t.focus()}))},i.prototype._isIframeReady=function(){var t=this.$iframe[0].contentWindow;return null!==t&&$(t.document.body).hasClass(h)},i.prototype._makeSureStandardMode=function(t){"CSS1Compat"!==t.compatMode&&(t.open(),t.write("<!DOCTYPE html><title></title>"),t.close())},i.prototype._initStyleSheet=function(t){var e;a.forEach(this.contentStyles,function(n){e=t.createElement("link"),e.rel="stylesheet",e.href=n,t.querySelector("head").appendChild(e)})},i.prototype._initEditorContainerStyles=function(t){var e,n;t.querySelector("html").style.height="100%",n=t.querySelector("body"),n.className=h,e=n.style,e.height="100%",e.padding="0 5px"},i.prototype._initEvent=function(){var t=this;this.eventManager.listen("show",function(){t.prepareToDetach()})},i.prototype._initSquireEvent=function(){var t=this;this.getEditor().addEventListener("input",function(){t.eventManager.emit("contentChangedFromWysiwyg",t)}),this.getEditor().addEventListener("paste",function(e){t.eventManager.emit("paste",{source:"wysiwyg",data:e})}),this.getEditor().addEventListener("dragover",function(t){return t.preventDefault(),!1}),this.getEditor().addEventListener("drop",function(e){return e.preventDefault(),t.eventManager.emit("drop",{source:"wysiwyg",data:e}),!1}),this.getEditor().addEventListener("input",function(){var e,n=t.editor.getSelection();e={source:"wysiwyg",selection:n,textContent:n.endContainer.textContent,caretOffset:n.endOffset},t.eventManager.emit("changeFromWysiwyg",e),t.eventManager.emit("change",e)}),this.getEditor().addEventListener("keydown",function(e){t._keyEventHandler(e)}),a.browser.firefox&&this.getEditor().addEventListener("keypress",function(e){e.keyCode&&t._keyEventHandler(e)}),this.getEditor().addEventListener("focus",function(){t.eventManager.emit("focus",{source:"wysiwyg"})}),this.getEditor().addEventListener("blur",function(){t.eventManager.emit("blur",{source:"wysiwyg"})}),this.getEditor().addEventListener("pathChange",function(e){var n={bold:/(>B$)|(>B>)|(>STRONG$)|(>STRONG>)/.test(e.path),italic:/(>I$)|(>I>)|(>EM$)|(>EM>)/.test(e.path)};t.eventManager.emit("stateChange",n)})},i.prototype._keyEventHandler=function(t){var e=this,n=this.getEditor().getSelection().cloneRange();13===t.keyCode?this._isInTaskList(n)?(this._unformatTaskIfNeedOnEnter(n),setTimeout(function(){e._isInTaskList()&&e.eventManager.emit("command","Task")},0)):this.hasFormatWithRx(s)?setTimeout(function(){e._unwrapHeading()},0):this._isInHr(n)||this._isNearHr(n)?this._removeHrIfNeed(n,t):this._isInOrphanText(n)&&this._wrapDefaultBlockTo(n):8===t.keyCode?n.collapsed&&(this._isInTaskList(n)?this._unformatTaskIfNeedOnBackspace(n):this.hasFormatWithRx(s)&&0===n.startOffset?this._unwrapHeading():this._removeHrIfNeed(n,t)):9===t.keyCode&&this._isInTaskList(n)&&(t.preventDefault(),e.eventManager.emit("command","IncreaseTask"))},i.prototype._isInOrphanText=function(t){return t.startContainer.nodeType===Node.TEXT_NODE&&"BODY"===t.startContainer.parentNode.tagName},i.prototype._wrapDefaultBlockTo=function(t){var e,n,i,r;this.saveSelection(t),this._joinSplitedTextNodes(),this.restoreSavedSelection(),t=this.getEditor().getSelection().cloneRange(),n=t.startContainer,i=t.startOffset,e=this.getEditor().createDefaultBlock([t.startContainer]),r=o.getChildNodeAt(t.startContainer,t.startOffset),r?t.setStartBefore(r):t.selectNodeContents(t.startContainer),t.collapse(!0),t.insertNode(e),t.setStart(n,i),t.collapse(!0),this.getEditor().setSelection(t)},i.prototype._joinSplitedTextNodes=function(){var t,e,n,i,o=[];t=function(){return 3===this.nodeType},e=this.get$Body().contents().filter(t),e.each(function(t,e){n===e.previousSibling?(i.nodeValue+=e.nodeValue,o.push(e)):i=e,n=e}),$(o).remove()},i.prototype._wrapDefaultBlockToOrphanTexts=function(){var t,e,t=function(){return 3===this.nodeType};e=this.get$Body().contents().filter(t),e.each(function(t,e){$(e).wrap("<div />")})},i.prototype._isValueKeyCode=function(t){var e=t>=48&&90>=t,n=t>=96&&111>=t,i=t>=186&&222>=t,o=229===t;return e||n||i||o},i.prototype.saveSelection=function(t){var e=this.getEditor();t||(t=e.getSelection().cloneRange()),this.getEditor()._saveRangeToBookmark(t)},i.prototype.restoreSavedSelection=function(){var t=this.getEditor();t.setSelection(t._getRangeAndRemoveBookmark())},i.prototype.reset=function(){this._isIframeReady()||(this.remove(),this._initSquire()),this.setValue("")},i.prototype.changeBlockFormatTo=function(t){this.getEditor().changeBlockFormatTo(t),this._removeTaskInputInWrongPlace()},i.prototype.makeEmptyBlockCurrentSelection=function(){var t=this;this.getEditor().modifyBlocks(function(e){return e.textContent||(e=t.getEditor().createDefaultBlock()),e})},i.prototype.focus=function(){this.editor.focus()},i.prototype.remove=function(){this.editor.removeEventListener("focus"),this.editor.removeEventListener("blur"),this.editor.removeEventListener("keydown"),this.editor.removeEventListener("keypress"),this.editor.removeEventListener("paste"),this.editor=null,this.$body=null},i.prototype.setHeight=function(t){this.$editorContainerEl.height(t)},i.prototype.setValue=function(t){this.editor.setHTML(t),this._ensurePtagContentWrappedWithDiv(),this._unwrapPtags(),this._ensureSpaceNextToTaskInput(),this._unwrapDivOnHr(),this._removeTaskListClass(),this.eventManager.emit("contentChangedFromWysiwyg",this)},i.prototype._ensurePtagContentWrappedWithDiv=function(){this.get$Body().find("p").each(function(t,e){$(e).find("div").length<=0&&$(e).wrapInner("<div />"),$(e).next().is("p")&&$(e).append("<div><br></div>")})},i.prototype._unwrapPtags=function(){this.get$Body().find("div").each(function(t,e){$(e).parent().is("p")&&$(e).unwrap()})},i.prototype._unwrapDivOnHr=function(){this.get$Body().find("hr").each(function(t,e){$(e).parent().is("div")&&($(e).parent().find("br").remove(),$(e).unwrap())})},i.prototype._ensureSpaceNextToTaskInput=function(){var t,e,n;t=function(){return 3===this.nodeType},this.get$Body().find(".task-list-item").each(function(i,o){n=$(o).find("div"),n.length||(n=$(o)),e=n.contents().filter(t)[0],e&&!u.test(e.nodeValue)&&(e.nodeValue=" "+e.nodeValue)})},i.prototype._removeTaskListClass=function(){this.get$Body().find(".task-list").each(function(t,e){$(e).removeClass("task-list")})},i.prototype.getValue=function(){var t;return this._prepareGetHTML(),t=this.editor.getHTML(),t=t.replace(/<input type="checkbox">(\s|&nbsp;)/g,'<input type="checkbox">'),t=t.replace(c,function(t,e){return"li"===e?t:"<br />"}),t=t.replace(l,"</$1>"),t=t.replace(/<div>/g,""),t=t.replace(/<\/div>/g,"<br />")},i.prototype._prepareGetHTML=function(){this.editor._ignoreChange=!0,this.get$Body().attr("lastGetValue",Date.now()),this._addCheckedAttrToCheckedInput(),this._joinSplitedTextNodes(),this._wrapDefaultBlockToOrphanTexts()},i.prototype._addCheckedAttrToCheckedInput=function(){var t=this.getEditor().getDocument();$(t.body).find("input").each(function(t,e){e.checked?$(e).attr("checked","checked"):$(e).removeAttr("checked")})},i.prototype.getEditor=function(){return this.editor},i.prototype.replaceSelection=function(t,e){return this.getEditor().replaceSelection(t,e)},i.prototype.replaceRelativeOffset=function(t,e,n){return this.getEditor().replaceRelativeOffset(t,e,n)},i.prototype.addWidget=function(t,e,n,i){var o=this.getEditor().getSelectionPosition(t,n,i);e.parentNode!==this.$editorContainerEl[0]&&this.$editorContainerEl.append(e),$(e).css({position:"absolute",top:o.top,left:o.left})},i.prototype.get$Body=function(){return this.getEditor().get$Body()},i.prototype.hasFormatWithRx=function(t){return this.getEditor().getPath().match(t)},i.prototype._unformatTaskIfNeedOnBackspace=function(t){var e,n,i,r;e=t.startContainer,n=t.startOffset,o.isElemNode(e)?(i=0===n?o.getChildNodeAt(e,n):o.getChildNodeAt(e,n-1),r="INPUT"===o.getNodeName(i)):o.isTextNode(e)&&(i=e.previousSibling?e.previousSibling:e.parentNode.previousSibling,"INPUT"===i.tagName&&1===n&&u.test(e.nodeValue)&&(e.nodeValue=e.nodeValue.replace(u,""),r=!0)),r&&(this.saveSelection(t),$(i).closest("li").removeClass("task-list-item"),$(i).remove(),this.restoreSavedSelection())},i.prototype._unformatTaskIfNeedOnEnter=function(t){var e,n,i,o;e=$(t.startContainer),n=e.closest("li"),i=n.find("input:checkbox"),o=""===n.text().replace(u,""),n.length&&i.length&&o&&(this.saveSelection(t),i.remove(),n.removeClass("task-list-item"),n.text(""),this.restoreSavedSelection())},i.prototype.breakToNewDefaultBlock=function(t,e){var n,i,r,a;a=o.getChildNodeAt(t.startContainer,t.startOffset)||t.startContainer,i=$(a).parentsUntil("body"),r=i.length?i[i.length-1]:a,n=this.editor.createDefaultBlock(),"before"===e?$(r).before(n):$(r).after(n),t.setStart(n,0),t.collapse(!0),this.editor.setSelection(t)},i.prototype._isInHr=function(t){return"HR"===o.getNodeName(t.startContainer.childNodes[t.startOffset])},i.prototype._isNearHr=function(t){var e=o.getChildNodeAt(t.startContainer,t.startOffset-1);return"HR"===o.getNodeName(e)},i.prototype._removeHrIfNeed=function(t,e){var n,i;this._isInHr(t)?n=o.getChildNodeAt(t.startContainer,t.startOffset):0===t.startOffset?(n=t.startContainer.previousSibling||t.startContainer.parentNode.previousSibling,"HR"!==o.getNodeName(n)&&(n=null)):this._isNearHr(t)&&(n=o.getChildNodeAt(t.startContainer,t.startOffset-1)),n&&(e.preventDefault(),i=n.nextSibling,$(n).remove(),t.setStartBefore(i),t.collapse(!0),this.getEditor().setSelection(t))},i.prototype._removeTaskInputInWrongPlace=function(){var t=this;this.get$Body().find("input:checkbox").each(function(e,n){var i,o,r;i=$(n).parents("li").length>1||$(n).parents("li").hasClass("task-list-item"),o=!n.previousSibling,i&&o||(r=$(n).parent(),$(n).remove(),t.replaceContentText(r,u,""))})},i.prototype.replaceContentText=function(t,e,n){var i;this._addCheckedAttrToCheckedInput(),i=$(t).html(),$(t).html(i.replace(e,n))},i.prototype._isInTaskList=function(t){var e;return t||(t=this.getEditor().getSelection().cloneRange()),e=t.startContainer.nodeType===Node.ELEMENT_NODE&&"LI"===t.startContainer.tagName?t.startContainer:$(t.startContainer).parents("li")[0],$(e).hasClass("task-list-item")},i.prototype._unwrapHeading=function(){this.unwrapBlockTag(function(t){return s.test(t)})},i.prototype.unwrapBlockTag=function(t){t||(t=function(t){return d.test(t)}),this.getEditor().changeBlockFormat(t),this._removeTaskInputInWrongPlace()},e.exports=i},{"./domUtils":9,"./squireExt":40}]},{},[20]);