!function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(t){var n=e[a][1][t];return i(n?n:t)},d,d.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,e,n){"use strict";tui.util.defineNamespace("tui.component.colorpicker",{domutil:t("./src/js/core/domutil"),domevent:t("./src/js/core/domevent"),Collection:t("./src/js/core/collection"),View:t("./src/js/core/view"),Drag:t("./src/js/core/drag"),create:t("./src/js/factory"),Palette:t("./src/js/palette"),Slider:t("./src/js/slider"),colorutil:t("./src/js/colorutil"),svgvml:t("./src/js/svgvml")})},{"./src/js/colorutil":2,"./src/js/core/collection":3,"./src/js/core/domevent":4,"./src/js/core/domutil":5,"./src/js/core/drag":6,"./src/js/core/view":7,"./src/js/factory":8,"./src/js/palette":10,"./src/js/slider":11,"./src/js/svgvml":12}],2:[function(t,e,n){"use strict";var o=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,i={leadingZero:function(t,e){var n="",o=0;if((t+"").length>e)return t+"";for(;e-1>o;o+=1)n+="0";return(n+t).slice(-1*e)},isValidRGB:function(t){return o.test(t)},hexToRGB:function(t){var e,n,o;return i.isValidRGB(t)?(t=t.substring(1),e=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16),[e,n,o]):!1},rgbToHEX:function(t,e,n){var o="#"+i.leadingZero(t.toString(16),2)+i.leadingZero(e.toString(16),2)+i.leadingZero(n.toString(16),2);return i.isValidRGB(o)?o:!1},rgbToHSV:function(t,e,n){var o,i,r,a,s,l;if(t/=255,e/=255,n/=255,o=Math.max(t,e,n),i=Math.min(t,e,n),s=o,l=o-i,a=0===o?0:l/o,o===i)r=0;else{switch(o){case t:r=(e-n)/l+(n>e?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return[Math.round(360*r),Math.round(100*a),Math.round(100*s)]},hsvToRGB:function(t,e,n){var o,i,r,a,s,l,c,d;if(t=Math.max(0,Math.min(360,t)),e=Math.max(0,Math.min(100,e)),n=Math.max(0,Math.min(100,n)),e/=100,n/=100,0===e)return o=i=r=n,[Math.round(255*o),Math.round(255*i),Math.round(255*r)];switch(t/=60,a=Math.floor(t),s=t-a,l=n*(1-e),c=n*(1-e*s),d=n*(1-e*(1-s)),a){case 0:o=n,i=d,r=l;break;case 1:o=c,i=n,r=l;break;case 2:o=l,i=n,r=d;break;case 3:o=l,i=c,r=n;break;case 4:o=d,i=l,r=n;break;default:o=n,i=l,r=c}return[Math.round(255*o),Math.round(255*i),Math.round(255*r)]}};e.exports=i},{}],3:[function(t,e,n){(function(t){"use strict";function n(t){this.items={},this.length=0,a(t)&&(this.getItemID=t)}var o=t.tui.util,i=o.forEachOwnProperties,r=o.forEachArray,a=o.isFunction,s=o.isObject,l=Array.prototype.slice;n.and=function(t){var e;return t=l.call(arguments),e=t.length,function(n){for(var o=0;e>o;o+=1)if(!t[o].call(null,n))return!1;return!0}},n.or=function(t){var e;return t=l.call(arguments),e=t.length,function(n){for(var o=1,i=t[0].call(null,n);e>o;o+=1)i=i||t[o].call(null,n);return i}},n.merge=function(t){var e=l.call(arguments),i={},a=new n(e[0].getItemID),s=o.extend;return r(e,function(t){s(i,t.items)}),a.items=i,a.length=o.keys(a.items).length,a},n.prototype.getItemID=function(t){return t._id+""},n.prototype.add=function(t){var e,n;return arguments.length>1?void r(l.call(arguments),function(t){this.add(t)},this):(e=this.getItemID(t),n=this.items,n[e]||(this.length+=1),void(n[e]=t))},n.prototype.remove=function(t){var e,n,i=[];return this.length?arguments.length>1?i=o.map(l.call(arguments),function(t){return this.remove(t)},this):(e=this.items,s(t)&&(t=this.getItemID(t)),e[t]?(this.length-=1,n=e[t],delete e[t],n):i):i},n.prototype.clear=function(){this.items={},this.length=0},n.prototype.has=function(t){var e,n;return this.length?(e=a(t),n=!1,e?this.each(function(e){return t(e)===!0?(n=!0,!1):void 0}):(t=s(t)?this.getItemID(t):t,n=o.isExisty(this.items[t])),n):!1},n.prototype.doWhenHas=function(t,e,n){var i=this.items[t];o.isExisty(i)&&e.call(n||this,i)},n.prototype.find=function(t){var e=new n;return this.hasOwnProperty("getItemID")&&(e.getItemID=this.getItemID),this.each(function(n){t(n)===!0&&e.add(n)}),e},n.prototype.groupBy=function(t,e){var i,r,a={},s=o.isFunction,l=s(t),c=this.getItemID;if(o.isArray(t)){if(o.forEachArray(t,function(t){a[t+""]=new n(c)}),!e)return a;t=e,l=!0}return this.each(function(e){l?r=t(e):(r=e[t],s(r)&&(r=r.apply(e))),i=a[r],i||(i=a[r]=new n(c)),i.add(e)}),a},n.prototype.single=function(){var t;return this.each(function(e){return t=e,!1},this),t},n.prototype.sort=function(t){var e=[];return this.each(function(t){e.push(t)}),a(t)&&(e=e.sort(t)),e},n.prototype.each=function(t,e){i(this.items,t,e||this)},n.prototype.toArray=function(){return this.length?o.map(this.items,function(t){return t}):[]},e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(t,e,n){(function(t){"use strict";var n=t.tui.util,o=n.browser,i="_evt",r={START:["touchstart","mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},a={on:function(t,e,o,i){return n.isString(e)?void n.forEach(e.split(" "),function(e){a._on(t,e,o,i)}):void n.forEachOwnProperties(e,function(e,n){a._on(t,n,e,o)})},_on:function(t,e,o,r){var s,l,c;s=e+n.stamp(o)+(r?"_"+n.stamp(r):""),t[i]&&t[i][s]||(l=function(e){o.call(r||t,e||window.event)},c=l,"addEventListener"in t?"mouseenter"===e||"mouseleave"===e?(l=function(e){e=e||window.event,a._checkMouse(t,e)&&c(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",l,!1)):("mousewheel"===e&&t.addEventListener("DOMMouseScroll",l,!1),t.addEventListener(e,l,!1)):"attachEvent"in t&&t.attachEvent("on"+e,l),t[i]=t[i]||{},t[i][s]=l)},off:function(t,e,o,i){return n.isString(e)?void n.forEach(e.split(" "),function(e){a._off(t,e,o,i)}):void n.forEachOwnProperties(e,function(e,n){a._off(t,n,e,o)})},_off:function(t,e,o,r){var a=e+n.stamp(o)+(r?"_"+n.stamp(r):""),s=t[i]&&t[i][a];if(s){if("removeEventListener"in t)"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):("mousewheel"===e&&t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1));else if("detachEvent"in t)try{t.detachEvent("on"+e,s)}catch(l){}if(delete t[i][a],!n.keys(t[i]).length)return n.browser.msie&&n.browser.version<9?void(t[i]=null):void delete t[i]}},once:function(t,e,o,i){function r(){o.apply(i||t,arguments),s._off(t,e,r,i)}var s=this;return n.isObject(e)?void n.forEachOwnProperties(e,function(e,n){a.once(t,n,e,o)}):void a.on(t,e,r,i)},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stop:function(t){a.preventDefault(t),a.stopPropagation(t)},disableScrollPropagation:function(t){a.on(t,"mousewheel MozMousePixelScroll",a.stopPropagation)},disableClickPropagation:function(t){a.on(t,r.START.join(" ")+" click dblclick",a.stopPropagation)},getMousePosition:function(t,e){var n;return e?(n=e.getBoundingClientRect(),[t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop]):[t.clientX,t.clientY]},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(o){return!1}return n!==t},trigger:function(t,e,o){var i=/(mouse|click)/;n.isUndefined(o)&&i.exec(e)&&(o=a.mouseEvent(e)),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent&&t.fireEvent("on"+e,o)},mouseEvent:function(t,e){var i,r;return r=n.extend({bubbles:!0,cancelable:"mousemove"!==t,view:window,wheelDelta:0,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},e),o.msie&&o.version<9&&delete r.wheelDelta,"function"==typeof document.createEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,document.body.parentNode)):document.createEventObject&&(i=document.createEventObject(),n.forEach(r,function(t,e){i[e]=t},this),i.button={0:1,1:4,2:2}[i.button]||i.button),i},getMouseButton:function(t){var e,n="0,1,3,5,7",o="2,6",i="4";return document.implementation.hasFeature("MouseEvents","2.0")?t.button:(e=t.button+"",~n.indexOf(e)?0:~o.indexOf(e)?2:~i.indexOf(e)?1:void 0)}};e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,n){(function(n){"use strict";function o(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var i,r=t("./domevent"),a=t("./collection"),s=n.tui.util,l="_pos",c=/^auto$|^$|%/;i={appendHTMLElement:function(t,e,n){var o;return n=n||"",o=document.createElement(t),o.className=n,e?e.appendChild(o):document.body.appendChild(o),o},remove:function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},get:function(t){return document.getElementById(t)},_matcher:function(t,e){var n=/^\./,o=/^#/;return n.test(e)?i.hasClass(t,e.replace(".","")):o.test(e)?t.id===e.replace("#",""):t.nodeName.toLowerCase()===e.toLowerCase()},find:function(t,e,n){function o(t,e){for(var s,d=t.childNodes,u=0,h=d.length;h>u;u+=1)if(s=d[u],"#text"!==s.nodeName)if(i._matcher(s,e)){if((c&&n(s)||!c)&&r.push(s),l){a=!0;break}}else if(s.childNodes.length>0&&(o(s,e),a))break}var r=[],a=!1,l=s.isUndefined(n)||n===!1,c=s.isFunction(n);return s.isString(e)&&(e=i.get(e)),e=e||window.document.body,o(e,t),l?r[0]||null:r},closest:function(t,e){var n=t.parentNode;if(i._matcher(t,e))return t;for(;n&&n!==window.document.body;){if(i._matcher(n,e))return n;n=n.parentNode}},text:function(t){var e="",n=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)e+=i.text(t)}else if(3===o||4===o)return t.nodeValue}else for(;t[n];n+=1)e+=i.text(t[n]);return e},setData:function(t,e,n){return"dataset"in t?void(t.dataset[e]=n):void t.setAttribute("data-"+e,n)},getData:function(t,e){return"dataset"in t?t.dataset[e]:t.getAttribute("data-"+e)},hasClass:function(t,e){var n;return s.isUndefined(t.classList)?(n=i.getClass(t),n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)):t.classList.contains(e)},addClass:function(t,e){var n;s.isUndefined(t.classList)?i.hasClass(t,e)||(n=i.getClass(t),i.setClass(t,(n?n+" ":"")+e)):s.forEachArray(e.split(" "),function(e){t.classList.add(e)})},setClass:function(t,e){s.isUndefined(t.className.baseVal)?t.className=e:t.className.baseVal=e},removeClass:function(t,e){var n="";s.isUndefined(t.classList)?(n=(" "+i.getClass(t)+" ").replace(" "+e+" "," "),i.setClass(t,o(n))):t.classList.remove(e)},getClass:function(t){return t&&t.className?s.isUndefined(t.className.baseVal)?t.className:t.className.baseVal:""},getStyle:function(t,e){var n,o=t.style[e]||t.currentStyle&&t.currentStyle[e];return o&&"auto"!==o||!document.defaultView||(n=document.defaultView.getComputedStyle(t,null),o=n?n[e]:null),"auto"===o?null:o},getComputedStyle:function(t){var e=document.defaultView;return e&&e.getComputedStyle?document.defaultView.getComputedStyle(t):{getPropertyValue:function(e){var n=/(\-([a-z]){1})/g;return"float"===e&&(e="styleFloat"),n.test(e)&&(e=e.replace(n,function(){return arguments[2].toUpperCase()})),t.currentStyle[e]?t.currentStyle[e]:null}}},setPosition:function(t,e,n){e=s.isUndefined(e)?0:e,n=s.isUndefined(n)?0:n,t[l]=[e,n],t.style.left=e+"px",t.style.top=n+"px"},getPosition:function(t,e){var n,o,i;return e&&(t[l]=null),t[l]?t[l]:(n=0,o=0,(c.test(t.style.left)||c.test(t.style.top))&&"getBoundingClientRect"in t?(i=t.getBoundingClientRect(),n=i.left,o=i.top):(n=parseFloat(t.style.left||0),o=parseFloat(t.style.top||0)),[n,o])},getSize:function(t){var e,n=i.getStyle(t,"width"),o=i.getStyle(t,"height");return(c.test(n)||c.test(o))&&"getBoundingClientRect"in t?(e=t.getBoundingClientRect(),n=e.width,o=e.height):(n=parseFloat(n||0),o=parseFloat(o||0)),[n,o]},testProp:function(t){for(var e=document.documentElement.style,n=0,o=t.length;o>n;n+=1)if(t[n]in e)return t[n];return!1},getFormData:function(t){var e=new a(function(){return this.length}),n=function(t){return!t.disabled},o={};return e.add.apply(e,i.find("input",t,n).concat(i.find("select",t,n)).concat(i.find("textarea",t,n))),e=e.groupBy(function(t){return t&&t.getAttribute("name")||"_other"}),s.forEach(e,function(t,e){"_other"!==e&&t.each(function(n){var r=n.nodeName.toLowerCase(),a=n.type,l=[];"radio"===a?l=[t.find(function(t){return t.checked}).toArray().pop()]:"checkbox"===a?l=t.find(function(t){return t.checked}).toArray():"select"===r?t.find(function(t){return!!t.childNodes.length}).each(function(t){l=l.concat(i.find("option",t,function(t){return t.selected}))}):l=t.find(function(t){return""!==t.value}).toArray(),l=s.map(l,function(t){return t.value}),l.length?1===l.length&&(l=l[0]):l="",o[e]=l})}),o}};var d=i.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),u="onselectstart"in document,h="";i.disableTextSelection=function(){return u?function(){r.on(window,"selectstart",r.preventDefault)}:function(){var t=document.documentElement.style;h=t[d],t[d]="none"}}(),i.enableTextSelection=function(){return u?function(){r.off(window,"selectstart",r.preventDefault)}:function(){document.documentElement.style[d]=h}}(),i.disableImageDrag=function(){r.on(window,"dragstart",r.preventDefault)},i.enableImageDrag=function(){r.off(window,"dragstart",r.preventDefault)},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./collection":3,"./domevent":4}],6:[function(t,e,n){(function(n){"use strict";function o(t,e){a.on(e,"mousedown",this._onMouseDown,this),this.options=i.extend({distance:10},t),this.container=e,this._isMoved=!1,this._distance=0,this._dragStartFired=!1,this._dragStartEventData=null}var i=n.tui.util,r=t("./domutil"),a=t("./domevent");o.prototype.destroy=function(){a.off(this.container,"mousedown",this._onMouseDown,this),this.options=this.container=this._isMoved=this._distance=this._dragStartFired=this._dragStartEventData=null},o.prototype._toggleDragEvent=function(t){var e,o,i=this.container;t?(e="on",o="disable"):(e="off",o="enable"),r[o+"TextSelection"](i),r[o+"ImageDrag"](i),a[e](n.document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp},this)},o.prototype._getEventData=function(t){return{target:t.target||t.srcElement,originEvent:t}},o.prototype._onMouseDown=function(t){0===a.getMouseButton(t)&&(this._distance=0,this._dragStartFired=!1,this._dragStartEventData=this._getEventData(t),this._toggleDragEvent(!0))},o.prototype._onMouseMove=function(t){var e=this.options.distance;return a.preventDefault(t),this._isMoved=!0,this._distance<e?void(this._distance+=1):this._dragStartFired||(this._dragStartFired=!0,this.invoke("dragStart",this._dragStartEventData))?void this.fire("drag",this._getEventData(t)):void this._toggleDragEvent(!1)},o.prototype._onMouseUp=function(t){return this._toggleDragEvent(!1),this._isMoved?(this._isMoved=!1,void this.fire("dragEnd",this._getEventData(t))):void this.fire("click",this._getEventData(t))},i.CustomEvents.mixin(o),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./domevent":4,"./domutil":5}],7:[function(t,e,n){(function(n){"use strict";function o(t,e){var n=i.stamp(this);t=t||{},i.isUndefined(e)&&(e=r.appendHTMLElement("div")),r.addClass(e,"tui-view-"+n),this.id=n,this.container=e,this.childs=new a(function(t){return i.stamp(t)}),this.parent=null}var i=n.tui.util,r=t("./domutil"),a=t("./collection");o.prototype.addChild=function(t,e){e&&e.call(t,this),t.parent=this,this.childs.add(t)},o.prototype.removeChild=function(t,e){var n=i.isNumber(t)?this.childs.items[t]:t;t=i.stamp(n),e&&e.call(n,this),this.childs.remove(t)},o.prototype.render=function(){this.childs.each(function(t){t.render()})},o.prototype.recursive=function(t,e){i.isFunction(t)&&(e||t(this),this.childs.each(function(e){e.recursive(t)}))},o.prototype.resize=function(){for(var t=Array.prototype.slice.call(arguments),e=this.parent;e;)i.isFunction(e._onResize)&&e._onResize.apply(e,t),e=e.parent},o.prototype._beforeDestroy=function(){},o.prototype._destroy=function(){this._beforeDestroy(),this.childs.clear(),this.container.innerHTML="",this.id=this.parent=this.childs=this.container=null},o.prototype.destroy=function(t){this.childs.each(function(t){t.destroy(!0),t._destroy()}),t||this._destroy()},o.prototype.getViewBound=function(){var t=this.container,e=r.getPosition(t),n=r.getSize(t);return{x:e[0],y:e[1],width:n[0],height:n[1]}},e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./collection":3,"./domutil":5}],8:[function(t,e,n){(function(n){"use strict";function o(t){alert(t)}function i(t){var e;return this instanceof i?(t=this.options=r.extend({container:null,color:"#f8f8f8",preset:["#181818","#282828","#383838","#585858","#b8b8b8","#d8d8d8","#e8e8e8","#f8f8f8","#ab4642","#dc9656","#f7ca88","#a1b56c","#86c1b9","#7cafc2","#ba8baf","#a16946"],cssPrefix:"tui-colorpicker-",detailTxt:"Detail"},t),t.container?(e=this.layout=new s(t,t.container),this.palette=new l(t,e.container),this.palette.on({_selectColor:this._onSelectColorInPalette,_toggleSlider:this._onToggleSlider},this),this.slider=new c(t,e.container),this.slider.on("_selectColor",this._onSelectColorInSlider,this),e.addChild(this.palette),e.addChild(this.slider),void this.render(t.color)):void o("Colorpicker(): need container option.")):new i(t)}var r=n.tui.util,a=t("./colorutil"),s=t("./layout"),l=t("./palette"),c=t("./slider");i.prototype._onSelectColorInPalette=function(t){var e=t.color,n=this.options;return a.isValidRGB(e)?void(n.color!==e&&(n.color=e,this.render(e),this.fire("selectColor",{color:e,origin:"palette"}))):void this.render()},i.prototype._onToggleSlider=function(){this.slider.toggle(!this.slider.isVisible())},i.prototype._onSelectColorInSlider=function(t){var e=t.color,n=this.options;n.color!==e&&(n.color=e,this.palette.render(e),this.fire("selectColor",{color:e,origin:"slider"}))},i.prototype.setColor=function(t){a.isValidRGB(t)||o("Colorpicker#setColor(): need valid hex string color value"),this.options.color=t,this.render(t)},i.prototype.getColor=function(){return this.options.color},i.prototype.toggle=function(t){this.layout.container.style.display=t?"block":"none"},i.prototype.render=function(t){this.layout.render(t||this.options.color)},i.prototype.destroy=function(){this.layout.destroy(),this.options.container.innerHTML="",this.layout=this.slider=this.palette=this.options=null},r.CustomEvents.mixin(i),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./colorutil":2,"./layout":9,"./palette":10,"./slider":11}],9:[function(t,e,n){(function(n){"use strict";function o(t,e){this.options=i.extend({cssPrefix:"tui-colorpicker-"},t),e=r.appendHTMLElement("div",e,this.options.cssPrefix+"container"),a.call(this,t,e),this.render()}var i=n.tui.util,r=t("./core/domutil"),a=t("./core/view");i.inherit(o,a),o.prototype.render=function(t){this.recursive(function(e){e.render(t)},!0)},e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core/domutil":5,"./core/view":7}],10:[function(t,e,n){(function(n){"use strict";function o(t,e){this.options=i.extend({cssPrefix:"tui-colorpicker-",preset:["#181818","#282828","#383838","#585858","#B8B8B8","#D8D8D8","#E8E8E8","#F8F8F8","#AB4642","#DC9656","#F7CA88","#A1B56C","#86C1B9","#7CAFC2","#BA8BAF","#A16946"],detailTxt:"Detail"},t),e=r.appendHTMLElement("div",e,this.options.cssPrefix+"palette-container"),s.call(this,t,e)}var i=n.tui.util,r=t("./core/domutil"),a=t("./core/domevent"),s=t("./core/view"),l=t("../template/palette");i.inherit(o,s),o.prototype._onClick=function(t){var e=this.options,n=t.srcElement||t.target,o={};return r.hasClass(n,e.cssPrefix+"palette-button")?(o.color=n.value,void this.fire("_selectColor",o)):void(r.hasClass(n,e.cssPrefix+"palette-toggle-slider")&&this.fire("_toggleSlider"))},o.prototype._onChange=function(t){var e=this.options,n=t.srcElement||t.target,o={};return r.hasClass(n,e.cssPrefix+"palette-hex")?(o.color=n.value,void this.fire("_selectColor",o)):void 0},o.prototype._beforeDestroy=function(){this._toggleEvent(!1)},o.prototype._toggleEvent=function(t){var e,n=this.options,o=this.container,i=a[t?"on":"off"];i(o,"click",this._onClick,this),e=r.find("."+n.cssPrefix+"palette-hex",o),e&&i(e,"change",this._onChange,this)},o.prototype.render=function(t){var e=this.options,n="";this._toggleEvent(!1),n=l.layout.replace("{{colorList}}",i.map(e.preset,function(n){var o=l.item.replace(/{{color}}/g,n);return o=o.replace("{{selected}}",n===t?" "+e.cssPrefix+"selected":"")}).join("")),n=n.replace(/{{cssPrefix}}/g,e.cssPrefix).replace("{{detailTxt}}",e.detailTxt).replace(/{{color}}/g,t),this.container.innerHTML=n,this._toggleEvent(!0)},i.CustomEvents.mixin(o),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../template/palette":13,"./core/domevent":4,"./core/domutil":5,"./core/view":7}],11:[function(t,e,n){(function(n){"use strict";function o(t,e){e=r.appendHTMLElement("div",e,t.cssPrefix+"slider-container"),e.style.display="none",c.call(this,t,e),this.options=i.extend({color:"#f8f8f8",cssPrefix:"tui-colorpicker-"},t),this._dragDataCache={},this.sliderHandleElement=null,this.huebarHandleElement=null,this.baseColorElement=null,this.drag=new d({distance:0},e),this.drag.on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd,click:this._onClick},this)}var i=n.tui.util,r=t("./core/domutil"),a=t("./core/domevent"),s=t("./svgvml"),l=t("./colorutil"),c=t("./core/view"),d=t("./core/drag"),u=t("../template/slider"),h=[-7,112],p=[-3,115],f=359.99;i.inherit(o,c),o.prototype._beforeDestroy=function(){this.drag.off(),this.drag=this.options=this._dragDataCache=this.sliderHandleElement=this.huebarHandleElement=this.baseColorElement=null},o.prototype.toggle=function(t){this.container.style.display=t?"block":"none"},o.prototype.isVisible=function(){return"block"===this.container.style.display},o.prototype.render=function(t){var e,n,o=this,i=o.container,a=o.options,s=u.layout;s=s.replace(/{{slider}}/,u.slider),s=s.replace(/{{huebar}}/,u.huebar),s=s.replace(/{{cssPrefix}}/g,a.cssPrefix),o.container.innerHTML=s,o.sliderHandleElement=r.find("."+a.cssPrefix+"slider-handle",i),o.huebarHandleElement=r.find("."+a.cssPrefix+"huebar-handle",i),o.baseColorElement=r.find("."+a.cssPrefix+"slider-basecolor",i),e=l.hexToRGB(t),n=l.rgbToHSV.apply(null,e),this.moveHue(n[0],!0),this.moveSaturationAndValue(n[1],n[2],!0)},o.prototype._moveColorSliderHandle=function(t,e,n){var o,i=this.sliderHandleElement;e=Math.max(h[0],e),e=Math.min(h[1],e),t=Math.max(h[0],t),t=Math.min(h[1],t),s.setTranslateXY(i,t,e),o=e>50?"white":"black",s.setStrokeColor(i,o),n||this.fire("_selectColor",{color:l.rgbToHEX.apply(null,this.getRGB())})},o.prototype.moveSaturationAndValue=function(t,e,n){var o,i,r,a;t=t||0,e=e||0,o=Math.abs(h[0]),i=h[1],r=t*i/100-o,a=i-e*i/100-o,this._moveColorSliderHandle(r,a,n)},o.prototype._moveColorSliderByPosition=function(t,e){var n=h[0];this._moveColorSliderHandle(t+n,e+n)},o.prototype.getSaturationAndValue=function(){var t,e,n=Math.abs(h[0]),o=n+h[1],i=s.getTranslateXY(this.sliderHandleElement);return t=(i[1]+n)/o*100,e=100-(i[0]+n)/o*100,[t,e]},o.prototype._moveHueHandle=function(t,e){var n,o,i=this.huebarHandleElement,r=this.baseColorElement;t=Math.max(p[0],t),t=Math.min(p[1],t),s.setTranslateY(i,t),n=l.hsvToRGB(this.getHue(),100,100),o=l.rgbToHEX.apply(null,n),s.setGradientColorStop(r,o),e||this.fire("_selectColor",{color:l.rgbToHEX.apply(null,this.getRGB())})},o.prototype.moveHue=function(t,e){var n,o,i=0;n=Math.abs(p[0]),o=n+p[1],t=t||0,i=o*t/f-n,this._moveHueHandle(i,e)},o.prototype._moveHueByPosition=function(t){var e=p[0];this._moveHueHandle(t+e)},o.prototype.getHue=function(){var t,e,n=this.huebarHandleElement,o=s.getTranslateXY(n);return t=Math.abs(p[0]),e=t+p[1],(o[0]+t)*f/e},o.prototype.getHSV=function(){var t=this.getSaturationAndValue(),e=this.getHue();return[e].concat(t)},o.prototype.getRGB=function(){return l.hsvToRGB.apply(null,this.getHSV())},o.prototype._prepareColorSliderForMouseEvent=function(t){var e,n=this.options,o=r.closest(t.target,"."+n.cssPrefix+"slider-part");return e=this._dragDataCache={isColorSlider:r.hasClass(o,n.cssPrefix+"slider-left"),parentElement:o}},o.prototype._onClick=function(t){var e=this._prepareColorSliderForMouseEvent(t),n=a.getMousePosition(t.originEvent,e.parentElement);e.isColorSlider?this._moveColorSliderByPosition(n[0],n[1]):this._moveHueByPosition(n[1]),this._dragDataCache=null},o.prototype._onDragStart=function(t){this._prepareColorSliderForMouseEvent(t)},o.prototype._onDrag=function(t){var e=this._dragDataCache,n=a.getMousePosition(t.originEvent,e.parentElement);e.isColorSlider?this._moveColorSliderByPosition(n[0],n[1]):this._moveHueByPosition(n[1])},o.prototype._onDragEnd=function(){this._dragDataCache=null},i.CustomEvents.mixin(o),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../template/slider":14,"./colorutil":2,"./core/domevent":4,"./core/domutil":5,"./core/drag":6,"./core/view":7,"./svgvml":12}],12:[function(t,e,n){(function(t){"use strict";var n=t.tui.util,o=/[\.\-0-9]+/g,i=-6,r={isOldBrowser:function(){var t=r._isOldBrowser;return n.isExisty(t)||(r._isOldBrowser=t=n.browser.msie&&n.browser.version<9),t},getTranslateXY:function(t){var e;return r.isOldBrowser()?(e=t.style,[parseFloat(e.top),parseFloat(e.left)]):(e=t.getAttribute("transform"))?(e=e.match(o),[parseFloat(e[1]),parseFloat(e[0])]):[0,0]},setTranslateXY:function(t,e,n){r.isOldBrowser()?(t.style.left=e+"px",t.style.top=n+"px"):t.setAttribute("transform","translate("+e+","+n+")")},setTranslateY:function(t,e){r.isOldBrowser()?t.style.top=e+"px":t.setAttribute("transform","translate("+i+","+e+")")},setStrokeColor:function(t,e){r.isOldBrowser()?t.strokecolor=e:t.setAttribute("stroke",e)},setGradientColorStop:function(t,e){r.isOldBrowser()?t.color=e:t.setAttribute("stop-color",e)}};e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(t,e,n){"use strict";var o=['<ul class="{{cssPrefix}}clearfix">{{colorList}}</ul>','<div class="{{cssPrefix}}clearfix" style="overflow:hidden">','<input type="button" class="{{cssPrefix}}palette-toggle-slider" value="{{detailTxt}}" />','<input type="text" class="{{cssPrefix}}palette-hex" value="{{color}}" maxlength="7" />','<span class="{{cssPrefix}}palette-preview" style="background-color:{{color}};color:{{color}}">{{color}}</span>',"</div>"].join("\n"),i='<li><input class="{{cssPrefix}}palette-button{{selected}}" type="button" style="background-color:{{color}};color:{{color}}" title="{{color}}" value="{{color}}" /></li>';e.exports={layout:o,item:i}},{}],14:[function(t,e,n){(function(t){"use strict";var n=t.tui.util,o=['<div class="{{cssPrefix}}slider-left {{cssPrefix}}slider-part">{{slider}}</div>','<div class="{{cssPrefix}}slider-right {{cssPrefix}}slider-part">{{huebar}}</div>'].join("\n"),i=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-slider">',"<defs>",'<linearGradient id="{{cssPrefix}}svg-fill-color" x1="0%" y1="0%" x2="100%" y2="0%">','<stop offset="0%" stop-color="rgb(255,255,255)" />','<stop class="{{cssPrefix}}slider-basecolor" offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>",'<linearGradient id="{{cssPrefix}}svn-fill-black" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:0" />','<stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />',"</linearGradient>","</defs>",'<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svg-fill-color)"></rect>','<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svn-fill-black)"></rect>','<path transform="translate(0,0)" class="{{cssPrefix}}slider-handle" d="M0 7.5 L15 7.5 M7.5 15 L7.5 0 M2 7 a5.5 5.5 0 1 1 0 1 Z" stroke="black" stroke-width="0.75" fill="none" />',"</svg>"].join("\n"),r=['<div class="{{cssPrefix}}vml-slider">','<v:rect strokecolor="none" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill class="{{cssPrefix}}vml {{cssPrefix}}slider-basecolor" type="gradient" method="none" color="#ff0000" color2="#fff" angle="90" />',"</v:rect>",'<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill type="gradient" method="none" color="black" color2="white" o:opacity2="0%" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}slider-handle" coordsize="1 1" style="width:1px;height:1px;"path="m 0,7 l 14,7 m 7,14 l 7,0 ar 12,12 2,2 z" filled="false" stroked="true" />',"</div>"].join("\n"),a=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-huebar">',"<defs>",'<linearGradient id="g" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" stop-color="rgb(255,0,0)" />','<stop offset="16.666%" stop-color="rgb(255,255,0)" />','<stop offset="33.333%" stop-color="rgb(0,255,0)" />','<stop offset="50%" stop-color="rgb(0,255,255)" />','<stop offset="66.666%" stop-color="rgb(0,0,255)" />','<stop offset="83.333%" stop-color="rgb(255,0,255)" />','<stop offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>","</defs>",'<rect width="18px" height="100%" fill="url(#g)"></rect>','<path transform="translate(-6,-3)" class="{{cssPrefix}}huebar-handle" d="M0 0 L4 4 L0 8 L0 0 Z" fill="black" stroke="none" />',"</svg>"].join("\n"),s=['<div class="{{cssPrefix}}vml-huebar">','<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-huebar-bg">','<v:fill type="gradient" method="none" colors="0% rgb(255,0,0), 16.666% rgb(255,255,0), 33.333% rgb(0,255,0), 50% rgb(0,255,255), 66.666% rgb(0,0,255), 83.333% rgb(255,0,255), 100% rgb(255,0,0)" angle="180" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}huebar-handle" coordsize="1 1" style="width:1px;height:1px;position:absolute;z-index:1;right:22px;top:-3px;"path="m 0,0 l 4,4 l 0,8 l 0,0 z" filled="true" fillcolor="black" stroked="false" />',"</div>"].join("\n"),l=n.browser.msie&&n.browser.version<9;l&&t.document.namespaces.add("v","urn:schemas-microsoft-com:vml"),e.exports={layout:o,slider:l?r:i,huebar:l?s:a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return i(n?n:e)},d,d.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,e,n){"use strict";var o=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)/,i=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)$/,r=/[*+-]\s/;CodeMirror.commands.subListIndentTab=function(t){if(t.getOption("disableInput"))return CodeMirror.Pass;for(var e=t.listSelections(),n=0;n<e.length;n++){var o=e[n].head,r=t.getLine(o.line),a=r.substr(0,o.ch);i.test(a)?t.replaceRange("	"+r,{line:o.line,ch:0},{line:o.line,ch:r.length}):t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")}},CodeMirror.commands.newlineAndIndentContinueMarkdownList=function(t){
if(t.getOption("disableInput"))return CodeMirror.Pass;for(var e=t.listSelections(),n=[],a=0;a<e.length;a++){var s=e[a].head,l=t.getStateAfter(s.line),c=l.list!==!1,d=0!==l.quote,u=t.getLine(s.line),h=o.exec(u);if(!e[a].empty()||!c&&!d||!h)return void t.execCommand("newlineAndIndent");if(i.test(u))t.replaceRange("",{line:s.line,ch:0},{line:s.line,ch:s.ch+1}),n[a]="\n";else{var p,f=h[1],m=h[5];p=f.length===s.ch?"":r.test(h[2])||h[2].indexOf(">")>=0?h[2]:parseInt(h[3],10)+1+h[4],n[a]="\n"+f+p+m}}t.replaceSelections(n)}},{}],2:[function(t,e,n){"use strict";CodeMirror.defineMode("gfm",function(t,e){function n(t){return t.code=!1,null}var o=0,i={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(t){return{code:t.code,codeBlock:t.codeBlock,ateSpace:t.ateSpace}},token:function(t,e){if(e.combineTokens=null,e.codeBlock)return t.match(/^```+/)?(e.codeBlock=!1,null):(t.skipToEnd(),null);if(t.sol()&&(e.code=!1),t.sol()&&t.match(/^```+/))return t.skipToEnd(),e.codeBlock=!0,null;if("`"===t.peek()){t.next();var n=t.pos;t.eatWhile("`");var i=1+t.pos-n;return e.code?i===o&&(e.code=!1):(o=i,e.code=!0),null}return e.code?(t.next(),null):t.eatSpace()?(e.ateSpace=!0,null):((t.sol()||e.ateSpace)&&(e.ateSpace=!1),t.next(),null)},blankLine:n},r={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:"```",strikethrough:!0};for(var a in e)r[a]=e[a];return r.name="markdown",CodeMirror.overlayMode(CodeMirror.getMode(t,r),i)},"markdown"),CodeMirror.defineMIME("text/x-gfm","gfm")},{}],3:[function(t,e,n){"use strict";CodeMirror.defineMode("markdown",function(t,e){function n(e){if(CodeMirror.findModeByName){var n=CodeMirror.findModeByName(e);n&&(e=n.mime||n.mimes[0])}var o=CodeMirror.getMode(t,e);return"null"==o.name?null:o}function o(t,e,n){return e.f=e.inline=n,n(t,e)}function i(t){return!t||!/\S/.test(t.string)}function r(t){return t.linkTitle=!1,t.em=!1,t.strong=!1,t.strikethrough=!1,t.quote=0,t.indentedCode=!1,C||t.f!=s||(t.f=h,t.block=a),t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.prevLine=t.thisLine,t.thisLine=null,null}function a(t,r){var a=t.sol(),s=r.list!==!1,c=r.indentedCode;r.indentedCode=!1,s&&(r.indentationDiff>=0&&(r.indentationDiff<4&&(r.indentation-=r.indentationDiff),r.list=null),r.indentation>0?(r.list=null,r.listDepth=Math.floor(r.indentation/4)+1):(r.list=!1,r.listDepth=0));var u=null;if(r.indentationDiff>=4)return t.skipToEnd(),c||i(r.prevLine)?(r.indentation-=4,r.indentedCode=!0,b):null;if(t.eatSpace())return null;if((u=t.match(V))&&u[1].length<=6)return r.header=u[1].length,e.highlightFormatting&&(r.formatting="header"),r.f=r.inline,d(r);if(!(i(r.prevLine)||r.quote||s||c)&&(u=t.match(q)))return r.header="="==u[0].charAt(0)?1:2,e.highlightFormatting&&(r.formatting="header"),r.f=r.inline,d(r);if(t.eat(">"))return r.quote=a?1:r.quote+1,e.highlightFormatting&&(r.formatting="quote"),t.eatSpace(),d(r);if("["===t.peek())return o(t,r,g);if(t.match(H,!0))return r.hr=!0,N;if((i(r.prevLine)||s)&&(t.match(F,!1)||t.match(W,!1))){var h=null;return t.match(F,!0)?h="ul":(t.match(W,!0),h="ol"),r.indentation=t.column()+t.current().length,r.list=!0,r.listDepth++,e.taskLists&&t.match(U,!1)&&(r.taskList=!0),r.f=r.inline,e.highlightFormatting&&(r.formatting=["list","list-"+h]),d(r)}return e.fencedCodeBlocks&&(u=t.match(z,!0))?(r.fencedChars=u[1],r.localMode=n(u[2]),r.localMode&&(r.localState=r.localMode.startState()),r.f=r.block=l,e.highlightFormatting&&(r.formatting="code-block"),r.code=!0,d(r)):o(t,r,r.inline)}function s(t,e){var n=_.token(t,e.htmlState);return(C&&null===e.htmlState.tagStart&&!e.htmlState.context&&e.htmlState.tokenize.isInText||e.md_inside&&t.current().indexOf(">")>-1)&&(e.f=h,e.block=a,e.htmlState=null),n}function l(t,e){return t.sol()&&e.fencedChars&&t.match(e.fencedChars,!1)?(e.localMode=e.localState=null,e.f=e.block=c,null):e.localMode?e.localMode.token(t,e.localState):(t.skipToEnd(),b)}function c(t,n){t.match(n.fencedChars),n.block=a,n.f=h,n.fencedChars=null,e.highlightFormatting&&(n.formatting="code-block"),n.code=!0;var o=d(n);return n.code=!1,o}function d(t){var n=[];if(t.formatting){n.push(B),"string"==typeof t.formatting&&(t.formatting=[t.formatting]);for(var o=0;o<t.formatting.length;o++)n.push(B+"-"+t.formatting[o]),"header"===t.formatting[o]&&n.push(B+"-"+t.formatting[o]+"-"+t.header),"quote"===t.formatting[o]&&(!e.maxBlockquoteDepth||e.maxBlockquoteDepth>=t.quote?n.push(B+"-"+t.formatting[o]+"-"+t.quote):n.push("error"))}if(t.taskOpen)return n.push("meta"),n.length?n.join(" "):null;if(t.taskClosed)return n.push("property"),n.length?n.join(" "):null;if(t.linkHref?n.push(D,"url"):(t.strong&&n.push(O),t.em&&n.push(A),t.strikethrough&&n.push(R),t.linkText&&n.push(P),t.code&&n.push(b)),t.header&&(n.push(k),n.push(k+"-"+t.header)),t.quote&&(n.push(x),!e.maxBlockquoteDepth||e.maxBlockquoteDepth>=t.quote?n.push(x+"-"+t.quote):n.push(x+"-"+e.maxBlockquoteDepth)),t.list!==!1){var i=(t.listDepth-1)%3;i?1===i?n.push(S):n.push(T):n.push(M)}return t.trailingSpaceNewLine?n.push("trailing-space-new-line"):t.trailingSpace&&n.push("trailing-space-"+(t.trailingSpace%2?"a":"b")),n.length?n.join(" "):null}function u(t,e){return t.match(j,!0)?d(e):void 0}function h(t,n){var o=n.text(t,n);if("undefined"!=typeof o)return o;if(n.list)return n.list=null,d(n);if(n.taskList){var i="x"!==t.match(U,!0)[1];return i?n.taskOpen=!0:n.taskClosed=!0,e.highlightFormatting&&(n.formatting="task"),n.taskList=!1,d(n)}if(n.taskOpen=!1,n.taskClosed=!1,n.header&&t.match(/^#+$/,!0))return e.highlightFormatting&&(n.formatting="header"),d(n);var r=t.sol(),a=t.next();if("\\"===a&&(t.next(),e.highlightFormatting)){var s=d(n);return s?s+" formatting-escape":"formatting-escape"}if(n.linkTitle){n.linkTitle=!1;var l=a;"("===a&&(l=")"),l=(l+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var c="^\\s*(?:[^"+l+"\\\\]+|\\\\\\\\|\\\\.)"+l;if(t.match(new RegExp(c),!0))return D}if("`"===a){var u=n.formatting;e.highlightFormatting&&(n.formatting="code");var h=d(n),m=t.pos;t.eatWhile("`");var g=1+t.pos-m;return n.code?g===E?(n.code=!1,h):(n.formatting=u,d(n)):(E=g,n.code=!0,d(n))}if(n.code)return d(n);if("!"===a&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),$;if("["===a&&t.match(/.*\](\(.*\)| ?\[.*\])/,!1))return n.linkText=!0,e.highlightFormatting&&(n.formatting="link"),d(n);if("]"===a&&n.linkText&&t.match(/\(.*\)| ?\[.*\]/,!1)){e.highlightFormatting&&(n.formatting="link");var s=d(n);return n.linkText=!1,n.inline=n.f=f,s}if("<"===a&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=p,e.highlightFormatting&&(n.formatting="link");var s=d(n);return s?s+=" ":s="",s+I}if("<"===a&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){n.f=n.inline=p,e.highlightFormatting&&(n.formatting="link");var s=d(n);return s?s+=" ":s="",s+L}if("<"===a&&t.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var v=!1;if(!e.underscoresBreakWords&&"_"===a&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var y=t.pos-2;if(y>=0){var w=t.string.charAt(y);"_"!==w&&w.match(/(\w)/,!1)&&(v=!0)}}if("*"===a||"_"===a&&!v)if(r&&" "===t.peek());else{if(n.strong===a&&t.eat(a)){e.highlightFormatting&&(n.formatting="strong");var h=d(n);return n.strong=!1,h}if(!n.strong&&t.eat(a))return n.strong=a,e.highlightFormatting&&(n.formatting="strong"),d(n);if(n.em===a){e.highlightFormatting&&(n.formatting="em");var h=d(n);return n.em=!1,h}if(!n.em)return n.em=a,e.highlightFormatting&&(n.formatting="em"),d(n)}else if(" "===a&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return d(n);t.backUp(1)}if(e.strikethrough)if("~"===a&&t.eatWhile(a)){if(n.strikethrough){e.highlightFormatting&&(n.formatting="strikethrough");var h=d(n);return n.strikethrough=!1,h}if(t.match(/^[^\s]/,!1))return n.strikethrough=!0,e.highlightFormatting&&(n.formatting="strikethrough"),d(n)}else if(" "===a&&t.match(/^~~/,!0)){if(" "===t.peek())return d(n);t.backUp(2)}return" "===a&&(t.match(/ +$/,!1)?n.trailingSpace++:n.trailingSpace&&(n.trailingSpaceNewLine=!0)),d(n)}function p(t,n){var o=t.next();if(">"===o){n.f=n.inline=h,e.highlightFormatting&&(n.formatting="link");var i=d(n);return i?i+=" ":i="",i+I}return t.match(/^[^>]+/,!0),I}function f(t,n){if(t.eatSpace())return null;var o=t.next();return"("===o||"["===o?(n.f=n.inline=m("("===o?")":"]"),e.highlightFormatting&&(n.formatting="link-string"),n.linkHref=!0,d(n)):"error"}function m(t){return function(n,o){var i=n.next();if(i===t){o.f=o.inline=h,e.highlightFormatting&&(o.formatting="link-string");var r=d(o);return o.linkHref=!1,r}return n.match(w(t),!0)&&n.backUp(1),o.linkHref=!0,d(o)}}function g(t,n){return t.match(/^[^\]]*\]:/,!1)?(n.f=v,t.next(),e.highlightFormatting&&(n.formatting="link"),n.linkText=!0,d(n)):o(t,n,h)}function v(t,n){if(t.match(/^\]:/,!0)){n.f=n.inline=y,e.highlightFormatting&&(n.formatting="link");var o=d(n);return n.linkText=!1,o}return t.match(/^[^\]]+/,!0),P}function y(t,e){return t.eatSpace()?null:(t.match(/^[^\s]+/,!0),void 0===t.peek()?e.linkTitle=!0:t.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),e.f=e.inline=h,D+" url")}function w(t){return G[t]||(t=(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),G[t]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+t+")")),G[t]}var C=CodeMirror.modes.hasOwnProperty("xml"),_=CodeMirror.getMode(t,C?{name:"xml",htmlMode:!0}:"text/plain");void 0===e.highlightFormatting&&(e.highlightFormatting=!1),void 0===e.maxBlockquoteDepth&&(e.maxBlockquoteDepth=0),void 0===e.underscoresBreakWords&&(e.underscoresBreakWords=!0),void 0===e.taskLists&&(e.taskLists=!1),void 0===e.strikethrough&&(e.strikethrough=!1);var E=0,k="header",b="comment",x="quote",M="variable-2",S="variable-3",T="keyword",N="hr",$="tag",B="formatting",I="link",L="link",P="link",D="string",A="em",O="strong",R="strikethrough",H=/^([*\-_])(?:\s*\1){2,}\s*$/,F=/^[*\-+]\s+/,W=/^[0-9]+([.)])\s+/,U=/^\[(x| )\](?=\s)/,V=e.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,q=/^ *(?:\={1,}|-{1,})\s*$/,j=/^[^#!\[\]*_\\<>` "'(~]+/,z=new RegExp("^("+(e.fencedCodeBlocks===!0?"~~~+|```+":e.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),G=[],Y={startState:function(){return{f:a,prevLine:null,thisLine:null,block:a,htmlState:null,indentation:0,inline:h,text:u,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t["this"],block:t.block,htmlState:t.htmlState&&CodeMirror.copyState(_,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?CodeMirror.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(t,e){if(e.formatting=!1,t!=e.thisLine){var n=e.header||e.hr;if(e.header=0,e.hr=!1,t.match(/^\s*$/,!0)||n){if(r(e),!n)return null;e.prevLine=null}e.prevLine=e.thisLine,e.thisLine=t,e.taskList=!1,e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.f=e.block;var o=t.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,i=4*Math.floor((o-e.indentation)/4);i>4&&(i=4);var a=e.indentation+i;if(e.indentationDiff=a-e.indentation,e.indentation=a,o>0)return null}return e.f(t,e)},innerMode:function(t){return t.block==s?{state:t.htmlState,mode:_}:t.localState?{state:t.localState,mode:t.localMode}:{state:t,mode:Y}},blankLine:r,getType:d,fold:"markdown"};return Y},"xml"),CodeMirror.defineMIME("text/x-markdown","markdown")},{}],4:[function(t,e,n){"use strict";CodeMirror.overlayMode=function(t,e,n){return{startState:function(){return{base:CodeMirror.startState(t),overlay:CodeMirror.startState(e),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(n){return{base:CodeMirror.copyState(t,n.base),overlay:CodeMirror.copyState(e,n.overlay),basePos:n.basePos,baseCur:null,overlayPos:n.overlayPos,overlayCur:null}},token:function(o,i){return(o!=i.streamSeen||Math.min(i.basePos,i.overlayPos)<o.start)&&(i.streamSeen=o,i.basePos=i.overlayPos=o.start),o.start==i.basePos&&(i.baseCur=t.token(o,i.base),i.basePos=o.pos),o.start==i.overlayPos&&(o.pos=o.start,i.overlayCur=e.token(o,i.overlay),i.overlayPos=o.pos),o.pos=Math.min(i.basePos,i.overlayPos),null==i.overlayCur?i.baseCur:null!=i.baseCur&&i.overlay.combineTokens||n&&null==i.overlay.combineTokens?i.baseCur+" "+i.overlayCur:i.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(n){t.blankLine&&t.blankLine(n.base),e.blankLine&&e.blankLine(n.overlay)}}}},{}],5:[function(t,e,n){"use strict";function o(t,e){this.name=t,this.type=e}var i=tui.util;o.prototype.getName=function(){return this.name},o.prototype.getType=function(){return this.type},o.prototype.isMDType=function(){return this.type===o.TYPE.MD},o.prototype.isWWType=function(){return this.type===o.TYPE.WW},o.prototype.isGlobalType=function(){return this.type===o.TYPE.GB},o.prototype.setKeyMap=function(t,e){this.keyMap=[t,e]},o.factory=function(t,e){var n,r;return"markdown"===t?r=o.TYPE.MD:"wysiwyg"===t?r=o.TYPE.WW:"global"===t&&(r=o.TYPE.GB),n=new o(e.name,r),i.extend(n,e),n},o.TYPE={MD:0,WW:1,GB:2},e.exports=o},{}],6:[function(t,e,n){"use strict";function o(t){this._command=new i.Map,this._mdCommand=new i.Map,this._wwCommand=new i.Map,this.base=t,this._initEvent()}var i=tui.util,r=t("./command");o.prototype.addCommand=function(t){var e,n;return 2===arguments.length&&(t=o.command(arguments[0],arguments[1])),e=t.getName(),t.isMDType()?n=this._mdCommand:t.isWWType()?n=this._wwCommand:t.isGlobalType()&&(n=this._command),n.set(e,t),t},o.prototype._initEvent=function(){var t=this;this.base.eventManager.listen("command",function(){t.exec.apply(t,arguments)})},o.prototype.exec=function(t){var e,n=this.base,o=i.toArray(arguments);return o.shift(),e=this._command.get(t),e||(this.base.isMarkdownMode()?(e=this._mdCommand.get(t),n=this.base.mdEditor):(e=this._wwCommand.get(t),n=this.base.wwEditor)),e?(o.unshift(n),e.exec.apply(e,o)):void 0},o.command=function(t,e){var n;return n=r.factory(t,e.name),i.extend(n,e),n},e.exports=o},{"./command":5}],7:[function(t,e,n){"use strict";function o(t){this.eventManager=t}var i=t("./markedCustomRenderer"),r=window.marked,a=window.toMark,s=window.hljs;o.prototype._markdownToHtmlWithCodeHighlight=function(t){return r(t,{renderer:i,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(t,e){return s.getLanguage(e)?s.highlight(e,t).value:t}})},o.prototype._markdownToHtml=function(t){return r(t,{renderer:i,gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1})},o.prototype.toHTMLWithCodeHightlight=function(t){var e=this._markdownToHtmlWithCodeHighlight(t);return e=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",e),this._sanitizeScript(e)},o.prototype.toHTML=function(t){var e=this._markdownToHtml(t);return e=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",e),this._sanitizeScript(e)},o.prototype.toMarkdown=function(t){var e=a(t);return e=this.eventManager.emitReduce("convertorAfterHtmlToMarkdownConverted",e)},o.prototype._sanitizeScript=function(t){return t=t.replace(/\<script.*?\>/g,"&lt;script&gt;"),t=t.replace(/\<\/script\>/g,"&lt;/script&gt;")},o.factory=function(t){return new o(t)},e.exports=o},{"./markedCustomRenderer":34}],8:[function(t,e,n){"use strict";var o=function(t){return t&&t.nodeType===Node.TEXT_NODE},i=function(t){return t&&t.nodeType===Node.ELEMENT_NODE},r=function(t,e){return t.childNodes.length&&e>=0?t.childNodes[e]:void 0},a=function(t){return i(t)?t.tagName:o(t)?"TEXT":void 0},s=function(t){var e;return i(t)?e=t.textContent.length:o(t)&&(e=t.nodeValue.length),e},l=function(t){var e;return i(t)?e=t.childNodes.length:o(t)&&(e=t.nodeValue.length),e},c=function(t){var e,n,o=t.parentNode.childNodes;for(e=0,n=o.length;n>e;e+=1)if(o[e]===t)return e},d=function(t,e,n){for(var o,i,r=t+"Sibling";e&&!e[r]&&(o=a(e.parentNode),o!==n&&"BODY"!==o);)e=e.parentNode;return e[r]&&(i=e[r]),i},u=function(t,e,n){var i;return i=e>0?o(t)?t:t.childNodes[e-1]:d("previous",t,n)},h=function(t,e){var n;return n=o(t)?t:t.childNodes[e]};e.exports={getChildNodeAt:r,getNodeName:a,isTextNode:o,isElemNode:i,getTextLength:s,getOffsetLength:l,getPrevOffsetNodeUntil:u,getNodeOffsetOfParent:c,getNodeByOffset:h}},{}],9:[function(t,e,n){"use strict";function o(t){var e=this;this.options=$.extend({previewStyle:"tab",initialEditType:"markdown",height:300},t),this.eventManager=new l,this.importManager=new u(this.eventManager),this.commandManager=new c(this),this.convertor=new h(this.eventManager),this.layout=new s(t,this.eventManager),this.setUI(this.options.UI||new p(this)),this.mdEditor=new i(this.layout.getMdEditorContainerEl(),this.eventManager),this.preview=new r(this.layout.getPreviewEl(),this.eventManager,this.convertor),this.wwEditor=new a(this.layout.getWwEditorContainerEl(),this.options.contentCSSStyles,this.eventManager),this.options.hooks&&R.forEach(this.options.hooks,function(t,n){e.addHook(n,t)}),this.options.events&&R.forEach(this.options.events,function(t,n){e.on(n,t)}),this.changePreviewStyle(this.options.previewStyle),this.mdEditor.init(),this.wwEditor.init(function(){d.applyExtension(e,e.options.exts),e._initDefaultCommands(),e.changeMode(e.options.initialEditType),e.contentHeight(e.options.height),e.setValue(e.options.initialValue),e.eventManager.emit("load",e)}),H.push(this)}var i=t("./markdownEditor"),r=t("./preview"),a=t("./wysiwygEditor"),s=t("./layout"),l=t("./eventManager"),c=t("./commandManager"),d=t("./extManager"),u=t("./importManager"),h=t("./convertor"),p=t("./ui/defaultUI.js"),f=t("./markdownCommands/bold"),m=t("./markdownCommands/italic"),g=t("./markdownCommands/blockquote"),v=t("./markdownCommands/heading"),y=t("./markdownCommands/hr"),w=t("./markdownCommands/addLink"),C=t("./markdownCommands/addImage"),_=t("./markdownCommands/ul"),E=t("./markdownCommands/ol"),k=t("./markdownCommands/table"),b=t("./markdownCommands/task"),x=t("./wysiwygCommands/bold"),M=t("./wysiwygCommands/italic"),S=t("./wysiwygCommands/blockquote"),T=t("./wysiwygCommands/addImage"),N=t("./wysiwygCommands/addLink"),B=t("./wysiwygCommands/hr"),I=t("./wysiwygCommands/heading"),L=t("./wysiwygCommands/ul"),P=t("./wysiwygCommands/ol"),D=t("./wysiwygCommands/table"),A=t("./wysiwygCommands/increaseTask"),O=t("./wysiwygCommands/task"),R=tui.util,H=[];t("./extensions/taskCounter"),t("./extensions/textPalette"),t("./extensions/scrollFollow"),t("./extensions/colorSyntax"),o.prototype._initDefaultCommands=function(){this.commandManager.addCommand(f),this.commandManager.addCommand(m),this.commandManager.addCommand(g),this.commandManager.addCommand(v),this.commandManager.addCommand(y),this.commandManager.addCommand(w),this.commandManager.addCommand(C),this.commandManager.addCommand(_),this.commandManager.addCommand(E),this.commandManager.addCommand(k),this.commandManager.addCommand(b),this.commandManager.addCommand(x),this.commandManager.addCommand(M),this.commandManager.addCommand(S),this.commandManager.addCommand(L),this.commandManager.addCommand(P),this.commandManager.addCommand(T),this.commandManager.addCommand(N),this.commandManager.addCommand(B),this.commandManager.addCommand(I),this.commandManager.addCommand(A),this.commandManager.addCommand(O),this.commandManager.addCommand(D)},o.prototype.changePreviewStyle=function(t){this.layout.changePreviewStyle(t),this.mdPreviewStyle=t,this.eventManager.emit("changePreviewStyle",t)},o.prototype.exec=function(){this.commandManager.exec.apply(this.commandManager,arguments)},o.prototype.addCommand=function(t,e){e?this.commandManager.addCommand(c.command(t,e)):this.commandManager.addCommand(t)},o.prototype.on=function(t,e){this.eventManager.listen(t,e)},o.prototype.off=function(t){this.eventManager.removeEventHandler(t)},o.prototype.addHook=function(t,e){this.eventManager.removeEventHandler(t),this.eventManager.listen(t,e)},o.prototype.removeHook=function(t){this.eventManager.removeEventHandler(t)},o.prototype.getCodeMirror=function(){return this.mdEditor.getEditor()},o.prototype.getSquire=function(){return this.wwEditor.getEditor()},o.prototype.focus=function(){this.getCurrentModeEditor().focus()},o.prototype.setValue=function(t){t=t||"",this.isMarkdownMode()?this.mdEditor.setValue(t):this.wwEditor.setValue(this.convertor.toHTML(t))},o.prototype.getValue=function(){var t;return t=this.isMarkdownMode()?this.mdEditor.getValue():this.convertor.toMarkdown(this.wwEditor.getValue())},o.prototype.addWidget=function(t,e,n,o){this.getCurrentModeEditor().addWidget(t,e,n,o)},o.prototype.contentHeight=function(t){return t&&(this._contentHeight=t,this.mdEditor.setHeight(t),this.preview.setHeight(t),this.wwEditor.setHeight(t)),this._contentHeight},o.prototype.getCurrentModeEditor=function(){var t;return t=this.isMarkdownMode()?this.mdEditor:this.wwEditor},o.prototype.isMarkdownMode=function(){return"markdown"===this.currentMode},o.prototype.isWysiwygMode=function(){return"wysiwyg"===this.currentMode},o.prototype.getCurrentPreviewStyle=function(){return this.mdPreviewStyle},o.prototype.changeMode=function(t){this.currentMode!==t&&(this.currentMode=t,this.isWysiwygMode()?(this.wwEditor.setValue(this.convertor.toHTML(this.mdEditor.getValue())),this.layout.switchToWYSIWYG(),this.eventManager.emit("changeModeToWysiwyg")):(this.mdEditor.setValue(this.convertor.toMarkdown(this.wwEditor.getValue())),this.layout.switchToMarkdown(),this.getCodeMirror().refresh(),this.eventManager.emit("changeModeToMarkdown")),this.eventManager.emit("changeMode",t))},o.prototype.remove=function(){this.wwEditor.remove(),this.mdEditor.remove(),this.layout.remove(),this.getUI()&&this.getUI().remove()},o.prototype.hide=function(){this.eventManager.emit("hide",this)},o.prototype.show=function(){this.eventManager.emit("show",this),this.getCodeMirror().refresh()},o.prototype.setUI=function(t){this._ui=t},o.prototype.getUI=function(){return this._ui},o.prototype.reset=function(){this.wwEditor.reset(),this.mdEditor.reset()},o.getInstances=function(){return H},o.defineExtension=function(t,e){d.defineExtension(t,e)},e.exports=o},{"./commandManager":6,"./convertor":7,"./eventManager":10,"./extManager":11,"./extensions/colorSyntax":12,"./extensions/scrollFollow":13,"./extensions/taskCounter":16,"./extensions/textPalette":17,"./importManager":18,"./layout":20,"./markdownCommands/addImage":22,"./markdownCommands/addLink":23,"./markdownCommands/blockquote":24,"./markdownCommands/bold":25,"./markdownCommands/heading":26,"./markdownCommands/hr":27,"./markdownCommands/italic":28,"./markdownCommands/ol":29,"./markdownCommands/table":30,"./markdownCommands/task":31,"./markdownCommands/ul":32,"./markdownEditor":33,"./preview":35,"./ui/defaultUI.js":38,"./wysiwygCommands/addImage":51,"./wysiwygCommands/addLink":52,"./wysiwygCommands/blockquote":53,"./wysiwygCommands/bold":54,"./wysiwygCommands/heading":55,"./wysiwygCommands/hr":56,"./wysiwygCommands/increaseTask":57,"./wysiwygCommands/italic":58,"./wysiwygCommands/ol":59,"./wysiwygCommands/table":60,"./wysiwygCommands/task":61,"./wysiwygCommands/ul":62,"./wysiwygEditor":63}],10:[function(t,e,n){"use strict";function o(){this.events=new i.Map,this.TYPE=new i.Enum(r)}var i=tui.util,r=["previewBeforeHook","previewRenderAfter","addImageBlobHook","contentChangedFromWysiwyg","changeFromWysiwyg","contentChangedFromMarkdown","changeFromMarkdown","change","changeModeToWysiwyg","changeModeToMarkdown","changeMode","changePreviewStyle","openPopupAddLink","openPopupAddImage","openPopupAddTable","closeAllPopup","command","htmlUpdate","markdownUpdate","renderedHtmlUpdated","convertorAfterMarkdownToHtmlConverted","convertorAfterHtmlToMarkdownConverted","stateChange","load","focus","blur","paste","copy","drop","show","hide"];o.prototype.listen=function(t,e){var n,o=this._getTypeInfo(t);if(!this._hasEventType(o.type))throw new Error("There is no event type "+o.type);n=this.events.get(o.type)||[],o.namespace&&(e.namespace=o.namespace),n.push(e),this.events.set(o.type,n)},o.prototype.emit=function(){var t,e,n=i.toArray(arguments),o=n.shift(),r=this._getTypeInfo(o),a=this.events.get(r.type);return a&&(e=[],i.forEach(a,function(o){t=o.apply(null,n),i.isUndefined(t)||e.push(t)})),e&&e.length?e:void 0},o.prototype.emitReduce=function(){var t=i.toArray(arguments),e=t.shift(),n=this.events.get(e);return n&&i.forEach(n,function(e){var n=e.apply(null,t);i.isFalsy(n)||(t[0]=n)}),t[0]},o.prototype._getTypeInfo=function(t){var e=t.split(".");return{type:e[0],namespace:e[1]}},o.prototype._hasEventType=function(t){return!i.isUndefined(this.TYPE[t.split(".")[0]])},o.prototype.addEventType=function(t){if(this._hasEventType(t))throw new Error("There is already have event type "+t);this.TYPE.set(t)},o.prototype.removeEventHandler=function(t){var e=this,n=this._getTypeInfo(t),t=n.type,o=n.namespace;t&&!o?this.events["delete"](t):!t&&o?this.events.forEach(function(t,n){e._removeEventHandlerWithTypeInfo(n,o)}):t&&o&&e._removeEventHandlerWithTypeInfo(t,o)},o.prototype._removeEventHandlerWithTypeInfo=function(t,e){var n,o=[];n=this.events.get(t),i.forEach(n,function(t){t.namespace!==e&&o.push(t)}),this.events.set(t,o)},e.exports=o},{}],11:[function(t,e,n){"use strict";function o(){this.exts=new i.Map}var i=tui.util;o.prototype.defineExtension=function(t,e){this.exts.set(t,e)},o.prototype.applyExtension=function(t,e){var n=this;e&&e.forEach(function(e){n.exts.has(e)&&n.exts.get(e)(t)})},e.exports=new o},{}],12:[function(t,e,n){"use strict";function o(t){var e,n,o,i,r;t.eventManager.addEventType("colorButtonClicked"),t.getUI().toolbar.addButton({className:"color",event:"colorButtonClicked",text:""}),e=$("<div />"),i=$('<div><button type="button" class="applyButton"></button></div>'),i.css("margin-top",10),n=tui.component.colorpicker.create({container:e[0]}),e.append(i),o=t.getUI().createPopup({title:!1,content:e,$target:t.getUI().$el,css:{width:178,position:"absolute",top:$("button.color").offset().top+$("button.color").height()+5,left:$("button.color").offset().left}}),t.eventManager.listen("focus",function(){o.hide()}),t.eventManager.listen("colorButtonClicked",function(){o.isShow()?o.hide():o.show()}),t.eventManager.listen("closeAllPopup",function(){o.hide()}),n.on("selectColor",function(e){r=e.color,"palette"===e.origin&&(t.exec("color",r),o.hide())}),o.$el.find(".applyButton").on("click",function(){t.exec("color",r)})}function i(t,e){return"{color:"+e+"}"+t+"{color}"}function r(t,e){return'<span style="color:'+e+'">'+t+"</span>"}function a(t){return t.replace(h,function(t,e,n,o){return e=parseInt(e,10),n=parseInt(n,10),o=parseInt(o,10),"#"+s(e.toString(16))+s(n.toString(16))+s(o.toString(16))})}function s(t){return"0"===t?"00":t}var l=t("../extManager"),c=/{color:(.+?)}(.*?){color}/g,d=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)/g,u=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)<\/span>/g,h=/rgb\((\d+)[, ]+(\d+)[, ]+(\d+)\)/g,p="#181818";l.defineExtension("colorSyntax",function(t){var e=!1;t.options.colorSyntax&&(e=!!t.options.colorSyntax.useCustomSyntax),t.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(t){var n;return n=e?t.replace(c,function(t,e,n){return r(n,e)}):t}),t.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(t){var n=e?u:d;return t.replace(n,function(t,n,o){var r;return n.match(h)&&(n=a(n)),r=e?i(o,n):t.replace(/ ?class="colour" ?/g," ").replace(h,n)})}),t.addCommand("markdown",{name:"color",exec:function(t,n){var o=t.getEditor();e?o.replaceSelection(i(o.getSelection(),n)):o.replaceSelection(r(o.getSelection(),n)),t.focus()}}),t.addCommand("wysiwyg",{name:"color",exec:function(t,e){e===p?t.getEditor().changeFormat(null,{"class":"colour",tag:"span"}):t.getEditor().setTextColour(e),t.focus()}}),"default"===t.getUI().name&&o(t)})},{"../extManager":11}],13:[function(t,e,n){"use strict";var o=t("../extManager"),i=t("./scrollFollow.scrollSync"),r=t("./scrollFollow.sectionManager");o.defineExtension("scrollFollow",function(t){var e,n,o=t.getCodeMirror(),a=!1,s=!0;e=new r(o,t.preview),n=new i(e,o,t.preview.$el),t.addCommand("markdown",{name:"scrollFollowDisable",exec:function(){s=!1}}),t.addCommand("markdown",{name:"scrollFollowEnable",exec:function(){s=!0}}),o.on("change",function(){a=!1,e.makeSectionList()}),t.on("previewRenderAfter",function(){e.sectionMatch(),n.syncToPreview(),a=!0}),o.on("scroll",function(){s&&a&&n.syncToPreview()}),"default"===t.getUI().name&&t.getUI().toolbar.addButton([{classname:"te-scrollfollow-enable",command:"scrollFollowDisable",text:"",style:"background-color: #f5f5f7"},{className:"te-scrollfollow-disable",command:"scrollFollowEnable",text:"",style:"background-color: #ddd"}])})},{"../extManager":11,"./scrollFollow.scrollSync":14,"./scrollFollow.sectionManager":15}],14:[function(t,e,n){"use strict";function o(t,e,n){this.sectionManager=t,this.cm=e,this.$previewContainerEl=n,this.$contents=this.$previewContainerEl.find(".tui-editor-contents"),this._currentTimeoutId=null}var i=20;o.prototype._getEditorSectionHeight=function(t){return this.cm.heightAtLine(t.end,"local")-this.cm.heightAtLine(t.start>0?t.start-1:0,"local")},o.prototype._getEditorLineHeightGapInSection=function(t,e){var n=this.cm.heightAtLine(e,"local")-this.cm.heightAtLine(t.start>0?t.start-1:0,"local");return Math.max(n,0)},o.prototype._getEditorSectionScrollRatio=function(t,e){var n,o=t.end===t.start;return n=o?0:this._getEditorLineHeightGapInSection(t,e)/this._getEditorSectionHeight(t)},o.prototype._getScrollFactorsOfEditor=function(){var t,e,n,o,i,r=this.cm,a=r.getScrollInfo();return o=a.height-a.top<=a.clientHeight,o?i={isEditorBottom:o}:(t=r.coordsChar({left:a.left,top:a.top},"local").line,e=this.sectionManager.sectionByLine(t),n=this._getEditorSectionScrollRatio(e,t),i={section:e,sectionRatio:n}),i},o.prototype._getScrollTopForPreview=function(){var t,e,n,o;return e=this._getScrollFactorsOfEditor(),n=e.section,o=e.sectionRatio,e.isEditorBottom?t=this.$contents.height():n.$previewSectionEl&&(t=n.$previewSectionEl[0].offsetTop+n.$previewSectionEl.height()*o-i),t=t&&Math.max(t,0)},o.prototype.syncToPreview=function(){var t=this,e=this._getScrollTopForPreview();this._animateRun(this.$previewContainerEl.scrollTop(),e,function(e){t.$previewContainerEl.scrollTop(e)})},o.prototype._animateRun=function(t,e,n){function o(){var s,l=Date.now(),c=(l-r)/200;1>c?(s=t+i*Math.cos((1-c)*Math.PI/2),n(Math.ceil(s)),a._currentTimeoutId=setTimeout(o,1)):(n(e),a._currentTimeoutId=null)}var i=e-t,r=Date.now(),a=this;this._currentTimeoutId&&clearTimeout(this._currentTimeoutId),o()},e.exports=o},{}],15:[function(t,e,n){"use strict";function o(t,e){this.cm=t,this.preview=e,this.$previewContent=e.$el.find(".tui-editor-contents"),this._sectionList=null,this._currentSection=null}var i=/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/,r=/^ *(?:\={1,}|-{1,})\s*$/,a=/^ *(`{3,}|~{3,})[ ]*$/,s=/^ *(`{3,}|~{3,})[ \.]*(\S+)? */,l=/\s/g;o.prototype._addNewSection=function(t,e){var n=this._makeSectionData(t,e);this._sectionList.push(n),this._currentSection=n},o.prototype.getSectionList=function(){return this._sectionList},o.prototype._makeSectionData=function(t,e){return{start:t,end:e,$previewSectionEl:null}},o.prototype._updateCurrentSectionEnd=function(t){this._currentSection.end=t},o.prototype._eachLineState=function(t){var e,n,o,i,r,a,s=!0,l=!1,c=!1,d="";for(o=this.cm.getDoc().lineCount(),n=0;o>n;n+=1){if(e=!1,i=this.cm.getLine(n),r=this.cm.getLine(n+1)||"",a=this.cm.getLine(n-1)||"",!l||i&&(this._isTableCode(i)||this._isTableAligner(i))?!l&&this._isTable(i,r)&&(l=!0):l=!1,c&&this._isCodeBlockEnd(a)?c=!1:!c&&this._isCodeBlockStart(i)&&(c=this._doFollowedLinesHaveCodeBlockEnd(n,o)),
this._isAtxHeader(i)?e=!0:c||l||!this._isSeTextHeader(i,r)||(e=!0),s){if(d+=i.trim(),!d)continue;s=!1}t(e,n)}},o.prototype._doFollowedLinesHaveCodeBlockEnd=function(t,e){var n,o=!1;for(n=t+1;e>n;n+=1)if(this._isCodeBlockEnd(this.cm.getLine(n))){o=!0;break}return o},o.prototype._isCodeBlockStart=function(t){return s.test(t)},o.prototype._isCodeBlockEnd=function(t){return a.test(t)},o.prototype._isTable=function(t,e){return this._isTableCode(t)&&this._isTableAligner(e)},o.prototype._isTableCode=function(t){return!(!t.match(/ *(\S.*\|.*)/)||!t.match(/ *\|(.+)/))},o.prototype._isTableAligner=function(t){return!(!t.match(/ *([-:]+ *\|[-| :]*)/)||!t.match(/ *\|( *[-:]+[-| :]*)/))},o.prototype._isAtxHeader=function(t){return i.test(t)},o.prototype._isSeTextHeader=function(t,e){return""!==t.replace(l,"")&&e&&r.test(e)},o.prototype.makeSectionList=function(){var t=this;this._sectionList=[],this._eachLineState(function(e,n){e||!t._sectionList.length?t._addNewSection(n,n):t._updateCurrentSectionEnd(n)})},o.prototype.sectionMatch=function(){var t;this._sectionList&&(t=this._getPreviewSections(),this._matchPreviewSectionsWithSectionlist(t))},o.prototype._matchPreviewSectionsWithSectionlist=function(t){var e=this;t.forEach(function(t,n){var o;e._sectionList[n]&&(o=$('<div class="content-id-'+n+'"></div>'),e._sectionList[n].$previewSectionEl=$(t).wrapAll(o).parent())})},o.prototype._getPreviewSections=function(){var t=0,e=[];return e[0]=[],this.$previewContent.contents().filter(function(){return this.nodeType===Node.ELEMENT_NODE}).each(function(n,o){o.tagName.match(/H1|H2|H3|H4|H5|H6/)&&e[t].length&&(e.push([]),t+=1),e[t].push(o)}),e},o.prototype.sectionByLine=function(t){var e,n=this._sectionList,o=n.length;for(e=0;o>e&&!(t<=n[e].end);e+=1);return e===o&&(e=o-1),n[e]},e.exports=o},{}],16:[function(t,e,n){"use strict";var o=t("../extManager"),i=/^\s*\* \[[xX ]\] [^\n]*/gm,r=/^\s*\* \[[xX]\] [^\n]*/gm;o.defineExtension("taskCounter",function(t){t.getTaskCount=function(){var e,n;return t.isMarkdownMode()?(e=t.mdEditor.getValue().match(i),n=e?e.length:0):n=t.wwEditor.get$Body().find("input").length,n},t.getCheckedTaskCount=function(){var e,n;return t.isMarkdownMode()?(e=t.mdEditor.getValue().match(r),n=e?e.length:0):n=t.wwEditor.get$Body().find("input:checked").length,n}})},{"../extManager":11}],17:[function(t,e,n){"use strict";function o(t){t.show(),t.find("input").focus()}function i(t){t.hide(),t.find("input").val("")}function r(t,e){}var a=t("../extManager");a.defineExtension("textPalette",function(t){var e=$('<div style="z-index:9999"><input type="text" style="background:white" /></div>'),n=t.options.textPalette.triggers,a=t.options.textPalette.querySender;$(t.options.el).append(e),e.find("input").on("keyup",function(n){var o=e.find("input").val();13===n.which?(n.stopPropagation(),t.getCurrentModeEditor().replaceRelativeOffset(o,-1,1),t.focus(),i(e)):a(o,function(t){r(e,t)})}),t.eventManager.listen("change",function(i){-1!==n.indexOf(i.textContent[i.caretOffset-1])&&(t.addWidget(i.selection,e[0],"over"),o(e))})})},{"../extManager":11}],18:[function(t,e,n){"use strict";function o(t){this.eventManager=t,this._initDropEvent(),this._initPasteEvent(),this._initDefaultImageImporter()}var i=tui.util;o.prototype._initDropEvent=function(){var t=this;this.eventManager.listen("drop",function(e){var n=e.data.dataTransfer&&e.data.dataTransfer.files;t._processEachItems(n)})},o.prototype._initPasteEvent=function(){var t=this;this.eventManager.listen("paste",function(e){var n=e.data.clipboardData&&e.data.clipboardData.items;t._processEachItems(n)})},o.prototype._initDefaultImageImporter=function(){this.eventManager.listen("addImageBlobHook",function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)})},o.prototype._emitAddImageBlobHook=function(t){var e=this,n=t.name?t:t.getAsFile();this.eventManager.emit("addImageBlobHook",n,function(t){e.eventManager.emit("command","AddImage",{imageUrl:t,altText:n.name||"image"})})},o.prototype._processEachItems=function(t){var e=this;t&&i.forEachArray(t,function(t){return-1!==t.type.indexOf("image")?(e._emitAddImageBlobHook(t),!1):void 0})},e.exports=o},{}],19:[function(t,e,n){"use strict";var o;t("./codemirror/overlay"),t("./codemirror/markdown"),t("./codemirror/gfm"),t("./codemirror/continuelist"),o=t("./editor"),$.fn.tuiEditor=function(){var t,e,n,i=$.makeArray(arguments);if(n=this[0])if(t=i[0]||{},e=$.data(n,"tuiEditor")){if("string"==typeof t)return e[t].apply(e,i.slice(1))}else t.el=n,e=new o(t),$.data(n,"tuiEditor",e);return this},window.tui=window.tui||{},window.tui.Editor=o},{"./codemirror/continuelist":1,"./codemirror/gfm":2,"./codemirror/markdown":3,"./codemirror/overlay":4,"./editor":9}],20:[function(t,e,n){"use strict";function o(t,e){this.$el=$(t.el),this.height=t.height,this.type=t.initialEditType,this.eventManager=e,this.init(),this._initEvent()}var i=['<div class="tui-editor">','<div class="te-md-container">','<div class="te-editor" />','<div class="te-md-splitter" />','<div class="te-preview" />',"</div>",'<div class="te-ww-container">','<div class="te-editor" />',"</div>","</div>"].join("");o.prototype.init=function(){this._renderLayout(),this._initMarkdownAndPreviewSection(),this._initWysiwygSection()},o.prototype._initEvent=function(){this.eventManager.listen("hide",this.hide.bind(this)),this.eventManager.listen("show",this.show.bind(this))},o.prototype._renderLayout=function(){this.$containerEl=$(i).appendTo(this.$el)},o.prototype.switchToWYSIWYG=function(){this.$containerEl.removeClass("te-md-mode"),this.$containerEl.addClass("te-ww-mode")},o.prototype.switchToMarkdown=function(){this.$containerEl.removeClass("te-ww-mode"),this.$containerEl.addClass("te-md-mode")},o.prototype._initMarkdownAndPreviewSection=function(){this.$mdEditorContainerEl=this.$containerEl.find(".te-md-container .te-editor"),this.$previewEl=this.$containerEl.find(".te-md-container .te-preview")},o.prototype._initWysiwygSection=function(){this.$wwEditorContainerEl=this.$containerEl.find(".te-ww-container .te-editor")},o.prototype._verticalSplitStyle=function(){this.$containerEl.find(".te-md-container").removeClass("te-preview-style-tab"),this.$containerEl.find(".te-md-container").addClass("te-preview-style-vertical")},o.prototype._tabStyle=function(){this.$containerEl.find(".te-md-container").removeClass("te-preview-style-vertical"),this.$containerEl.find(".te-md-container").addClass("te-preview-style-tab")},o.prototype.changePreviewStyle=function(t){"tab"===t?this._tabStyle():"vertical"===t&&this._verticalSplitStyle()},o.prototype.hide=function(){this.$el.find(".tui-editor").addClass("te-hide")},o.prototype.show=function(){this.$el.find(".tui-editor").removeClass("te-hide")},o.prototype.remove=function(){this.$el.find(".tui-editor").remove()},o.prototype.getEditorEl=function(){return this.$containerEl},o.prototype.getPreviewEl=function(){return this.$previewEl},o.prototype.getMdEditorContainerEl=function(){return this.$mdEditorContainerEl},o.prototype.getWwEditorContainerEl=function(){return this.$wwEditorContainerEl},e.exports=o},{}],21:[function(t,e,n){"use strict";function o(){this.globalTOID=null,this.lazyRunFunctions={}}var i=tui.util;o.prototype.run=function(t,e,n,o){var r;return i.isString(t)?r=this._runRegisteredRun(t,e,n,o):(r=this._runSingleRun(t,e,n,o,this.globalTOID),this.globalTOID=r),r},o.prototype.registerLazyRunFunction=function(t,e,n,o){o=o||this,this.lazyRunFunctions[t]={fn:e,delay:n,context:o,TOID:null}},o.prototype._runSingleRun=function(t,e,n,o,i){return this._clearTOIDIfNeed(i),i=setTimeout(function(){t.call(n,e)},o)},o.prototype._runRegisteredRun=function(t,e,n,o){var i,r;return r=this.lazyRunFunctions[t].fn,i=this.lazyRunFunctions[t].TOID,o=o||this.lazyRunFunctions[t].delay,n=n||this.lazyRunFunctions[t].context,i=this._runSingleRun(r,e,n,o,i),this.lazyRunFunctions[t].TOID=i,i},o.prototype._clearTOIDIfNeed=function(t){t&&clearTimeout(t)},e.exports=o},{}],22:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"AddImage",exec:function(t,e){var n,o,i,r,a=t.getEditor(),s=a.getDoc();o=t.getCurrentRange(),i={line:o.from.line,ch:o.from.ch},r={line:o.to.line,ch:o.to.ch},n="!["+e.altText+"]("+e.imageUrl+")",s.replaceRange(n,i,r,"+addImage"),a.focus()}});e.exports=i},{"../commandManager":6}],23:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"AddLink",exec:function(t,e){var n,o,i,r,a=t.getEditor(),s=a.getDoc();o=t.getCurrentRange(),i={line:o.from.line,ch:o.from.ch},r={line:o.to.line,ch:o.to.ch},n="["+e.linkText+"]("+e.url+")",s.replaceRange(n,i,r),a.focus()}});e.exports=i},{"../commandManager":6}],24:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"Blockquote",keyMap:["Ctrl-Q","Ctrl-Q"],exec:function(t){var e,n,o,i,r,a,s,l=t.getEditor(),c=l.getDoc();for(n=t.getCurrentRange(),o={line:n.from.line,ch:0},i={line:n.to.line,ch:c.getLineHandle(n.to.line).text.length},e=c.getRange(o,i),r=e.split("\n"),a=r.length,s=0;a>s;s+=1)r[s]=">"+r[s];c.replaceRange(r.join("\n"),o,i),n.to.ch+=1,c.setCursor(n.to),l.focus()}});e.exports=i},{"../commandManager":6}],25:[function(t,e,n){"use strict";var o=t("../commandManager"),i=/^[\*_]{2,}[^\*_]*[\*_]{2,}$/,r=o.command("markdown",{name:"Bold",keyMap:["Ctrl-B","Ctrl-B"],exec:function(t){var e,n,o,i,r,a,s=t.getEditor(),l=s.getDoc();e=l.getCursor(),n=l.getSelection(),a=!n,a&&e.ch>1&&(o=this.expendSelection(l,e),n=o||n),i=this.isNeedRemove(n),r=i?this.remove(n):this.append(n),l.replaceSelection(r,"around"),a&&!i&&this.setCursorToCenter(l,e),s.focus()},isNeedRemove:function(t){return i.test(t)},append:function(t){return"**"+t+"**"},remove:function(t){return t.substr(2,t.length-4)},expendSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-2},{line:e.line,ch:e.ch+2}),"****"===n||"____"===n?n:void t.setSelection(e)},setCursorToCenter:function(t,e){t.setCursor(e.line,e.ch+2)}});e.exports=r},{"../commandManager":6}],26:[function(t,e,n){"use strict";function o(t){var e,n=t.match(a);return n?(e="#"+n[0],7===e.match(/#/g).length&&(e="# "),t=t.split(n[0])[1]):e="# ",e+t}var i=t("../commandManager"),r=i.command("markdown",{name:"Heading",keyMap:["Ctrl-H","Ctrl-H"],exec:function(t){var e,n,i,r,a,s,l,c,d=t.getEditor(),u=d.getDoc();for(n=t.getCurrentRange(),i={line:n.from.line,ch:0},r={line:n.to.line,ch:u.getLineHandle(n.to.line).text.length},c=u.getLine(r.line).length,e=u.getRange(i,r),a=e.split("\n"),s=a.length,l=0;s>l;l+=1)a[l]=o(a[l]);u.replaceRange(a.join("\n"),i,r),n.to.ch+=u.getLine(r.line).length-c,u.setCursor(n.to),d.focus()}}),a=/^#+\s/g;e.exports=r},{"../commandManager":6}],27:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"HR",exec:function(t){var e,n,o,i=t.getEditor(),r="",a=i.getDoc();e=t.getCurrentRange(),n={line:e.from.line,ch:e.from.ch},o={line:e.to.line,ch:e.to.ch},e.collapsed&&(r=a.getLine(n.line),n.ch=0,o.ch=a.getLineHandle(e.to.line).text.length),r+=a.getLine(n.line).length?"\n\n* * *\n\n":"\n* * *\n",a.replaceRange(r,n,o),i.focus()}});e.exports=i},{"../commandManager":6}],28:[function(t,e,n){"use strict";var o=t("../commandManager"),i=/^[\*_]{3,}[^\*_]*[\*_]{3,}$/,r=/^[\*_][^\*_]*[\*_]$/,a=o.command("markdown",{name:"Italic",keyMap:["Ctrl-I","Ctrl-I"],exec:function(t){var e,n,o,i,r,a,s,l=t.getEditor(),c=l.getDoc();e=c.getCursor(),n=c.getSelection(),a=!n,s=!1,a&&(e.ch>2&&(o=this.expendWithBoldSelection(c,e),o&&(s="with")),"with"!==s&&e.ch>1&&(s=this.expendOnlyBoldSelection(c,e)),!s&&e.ch>0&&(this.expendSelection(c,e),n=o||n)),i=this.isNeedRemove(n),r=i?this.remove(n):this.append(n),c.replaceSelection(r,"around"),a&&this.setCursorToCenter(c,e,i),l.focus()},isNeedRemove:function(t){return r.test(t)||i.test(t)},append:function(t){return"_"+t+"_"},remove:function(t){return t.substr(1,t.length-2)},expendWithBoldSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-3},{line:e.line,ch:e.ch+3}),"******"===n||"______"===n?n:void t.setSelection(e)},expendOnlyBoldSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-2},{line:e.line,ch:e.ch+2}),"****"===n||"____"===n?(t.setSelection(e),"only"):!1},expendSelection:function(t,e){var n=t.getSelection();return t.setSelection({line:e.line,ch:e.ch-1},{line:e.line,ch:e.ch+1}),"**"===n||"__"===n?n:void t.setSelection(e)},setCursorToCenter:function(t,e,n){var o=n?-1:1;t.setCursor(e.line,e.ch+o)}});e.exports=a},{"../commandManager":6}],29:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"OL",exec:function(t){var e,n,o,i,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),o={line:n.from.line,ch:n.from.ch},i={line:n.to.line,ch:n.to.ch},e="1. ",a.replaceRange(e,o,i),r.focus()}});e.exports=i},{"../commandManager":6}],30:[function(t,e,n){"use strict";function o(t){for(var e="|",n="|";t;)e+="  |",n+=" --- |",t-=1;return e+"\n"+n+"\n"}function i(t,e){var n,o,i="";for(n=0;e>n;n+=1){for(i+="|",o=0;t>o;o+=1)i+="  |";i+="\n"}return i=i.replace(/\n$/g,"")}var r=t("../commandManager"),a=r.command("markdown",{name:"Table",exec:function(t,e,n){var r=t.getEditor(),a=r.getDoc(),s="\n";r.getCursor().ch>0&&(s+="\n"),s+=o(e),s+=i(e,n-1),a.replaceSelection(s),r.setCursor(r.getCursor().line-n,2),t.focus()}});e.exports=a},{"../commandManager":6}],31:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"Task",exec:function(t){var e,n,o,i,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),o={line:n.from.line,ch:n.from.ch},i={line:n.to.line,ch:n.to.ch},e="* [ ] ",a.replaceRange(e,o,i),r.focus()}});e.exports=i},{"../commandManager":6}],32:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("markdown",{name:"UL",exec:function(t){var e,n,o,i,r=t.getEditor(),a=r.getDoc();n=t.getCurrentRange(),o={line:n.from.line,ch:n.from.ch},i={line:n.to.line,ch:n.to.ch},e="* ",a.replaceRange(e,o,i),r.focus()}});e.exports=i},{"../commandManager":6}],33:[function(t,e,n){"use strict";function o(t,e){this.eventManager=e,this.$editorContainerEl=t,this._latestState={bold:!1,italic:!1}}var i=window.CodeMirror;o.prototype.init=function(t){var e=$("<textarea />");t&&(e.text(t),this._emitMarkdownEditorContentChangedEvent(t)),this.$editorContainerEl.append(e),this.cm=i.fromTextArea(e[0],{lineWrapping:!0,mode:"gfm",theme:"default",dragDrop:!0,allowDropFileTypes:["image"],extraKeys:{Enter:"newlineAndIndentContinueMarkdownList",Tab:"subListIndentTab","Shift-Tab":"indentLess"},indentUnit:4}),this._initEvent()},o.prototype._initEvent=function(){var t=this;this.cm.on("change",function(e,n){t._emitMarkdownEditorContentChangedEvent(),t._emitMarkdownEditorChangeEvent(n)}),this.cm.on("focus",function(){t.eventManager.emit("focus",{source:"markdown"})}),this.cm.on("blur",function(){t.eventManager.emit("blur",{source:"markdown"})}),this.cm.getWrapperElement().addEventListener("paste",function(e){t.eventManager.emit("paste",{source:"markdown",data:e})}),this.cm.on("drop",function(e,n){n.preventDefault(),t.eventManager.emit("drop",{source:"markdown",data:n})}),this.cm.on("cursorActivity",function(){var e,n;e=t.cm.getTokenAt(t.cm.getCursor()),n={bold:!!e.state.base.strong,italic:!!e.state.base.em},(t._latestState.bold!==n.bold||t._latestState.italic!==n.italic)&&(t.eventManager.emit("stateChange",n),t._latestState=n)})},o.prototype.getCurrentRange=function(){var t=this.cm.getCursor("from"),e=this.cm.getCursor("to");return{from:t,to:e,collapsed:t===e}},o.prototype.focus=function(){this.cm.focus()},o.prototype.remove=function(){this.cm.toTextArea()},o.prototype.setValue=function(t){this.getEditor().setValue(t),this._emitMarkdownEditorContentChangedEvent(),this.getEditor().refresh()},o.prototype.getValue=function(){return this.cm.getValue("\n")},o.prototype.getEditor=function(){return this.cm},o.prototype.reset=function(){this.setValue("")},o.prototype._emitMarkdownEditorContentChangedEvent=function(){this.eventManager.emit("contentChangedFromMarkdown",this)},o.prototype._cloneCMEventObject=function(t){return{from:{line:t.from.line,ch:t.from.ch},to:{line:t.to.line,ch:t.to.ch}}},o.prototype._emitMarkdownEditorChangeEvent=function(t){var e,n;"setValue"!==t.origin&&(n=this.getEditor().getCursor(),e={source:"markdown",selection:n,textContent:this.cm.getDoc().getLine(n.line)||"",caretOffset:n.ch},this.eventManager.emit("changeFromMarkdown",e),this.eventManager.emit("change",e))},o.prototype.getCaretPosition=function(){return this.cm.cursorCoords()},o.prototype.addWidget=function(t,e,n,o){o&&(t.ch+=o),this.cm.addWidget(t,e,!0,n)},o.prototype.replaceSelection=function(t,e){e&&this.cm.setSelection(e.from,e.to),this.cm.replaceSelection(t),this.focus()},o.prototype.replaceRelativeOffset=function(t,e,n){var o=this.cm.getCursor(),i={from:{line:o.line,ch:o.ch+e},to:{line:o.line,ch:o.ch+e+n}};this.replaceSelection(t,i)},o.prototype.setHeight=function(t){this.$editorContainerEl.height(t),"auto"===t&&this.$editorContainerEl.find(".CodeMirror").height("auto")},e.exports=o},{}],34:[function(t,e,n){"use strict";function o(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var i=new window.marked.Renderer,r=/^((?:<p>|))\[(?:x| )\] /;i.listitem=function(t){var e,n,o="",i="";return e=r.exec(t),e&&(t=t.substring(e[0].length),o=' class="task-list-item"',n="[x] "===e[0]?" checked":"",i+=e[1]+'<input type="checkbox" class="task-list-item-checkbox"'+n+"> "),"<li"+o+">"+i+t+"</li>\n"},i.code=function(t,e,n){var i;return this.options.highlight&&(i=this.options.highlight(t,e),null!==i&&i!==t&&(n=!0,t=i)),e?'<pre><code class="'+this.options.langPrefix+o(e,!0)+'" data-language="'+o(e,!0)+'">'+(n?t:o(t,!0))+"\n</code></pre>\n":"<pre><code>"+(n?t:o(t,!0))+"\n</code></pre>"},e.exports=i},{}],35:[function(t,e,n){"use strict";function o(t,e,n){this.eventManager=e,this.converter=n,this.$el=t,this._initContentSection(),this.lazyRunner=new i,this.lazyRunner.registerLazyRunFunction("refresh",this.refresh,800,this),this._initEvent()}var i=t("./lazyRunner");o.prototype._initEvent=function(){var t=this;this.eventManager.listen("contentChangedFromMarkdown",function(e){t.lazyRunner.run("refresh",e.getValue())})},o.prototype._initContentSection=function(){this.$previewContent=$('<div class="tui-editor-contents" />'),this.$el.append(this.$previewContent)},o.prototype.refresh=function(t){this.render(this.converter.toHTMLWithCodeHightlight(t))},o.prototype.render=function(t){var e,n=t;e=this.eventManager.emit("previewBeforeHook",t),e&&(n=e[0]),this.$previewContent.empty(),this.$previewContent.html(n),this.eventManager.emit("previewRenderAfter",this)},o.prototype.setHeight=function(t){this.$el.height(t)},e.exports=o},{"./lazyRunner":21}],36:[function(t,e,n){"use strict";function o(){r.apply(this,arguments)}var i=t("./domUtils"),r=window.Squire,a=tui.util,s=/\b(H[\d]|LI|P|BLOCKQUOTE|TD)\b/;o.prototype=a.extend({},r.prototype),o.prototype.get$Body=function(){return this.$body=this.$body||$(this.getDocument().body),this.$body},o.prototype.changeBlockFormat=function(t,e){var n=this;this.modifyBlocks(function(o){var r,s,l,c,d,u;if(o.childNodes.length?r=o.childNodes[0]:(r=n.createDefaultBlock(),o.appendChild(r)),t){for(;r.firstChild;)r=r.firstChild;for(;r!==o;){if(d=r.tagName,a.isFunction(t)?t(d):d===t){c=r.childNodes[0],(!i.isElemNode(c)||r.childNodes.length>1)&&(c=n.createDefaultBlock(),a.forEachArray(a.toArray(r.childNodes),function(t){c.appendChild(t)}),u=c.lastChild,u&&"BR"===i.getNodeName(u)&&c.removeChild(u)),l=e?n.createElement(e,[c]):c,s=n.getDocument().createDocumentFragment(),s.appendChild(l),o=s;break}r=r.parentNode}}return s&&t||!e||"DIV"!==i.getNodeName(o.childNodes[0])||(o=n.createElement(e,[o.childNodes[0]])),o})},o.prototype.changeBlockFormatTo=function(t){this.changeBlockFormat(function(t){return s.test(t)},t)},o.prototype.getCaretPosition=function(){var t,e,n,o,i,r=0,a=0,s=this.getDocument().body,l=s.offsetLeft,c=s.offsetTop,d={left:0,top:0};return e=this.getSelection(),t=e.cloneRange(),t.setStart(t.startContainer,t.startOffset-1),n=t.getBoundingClientRect(),0===t.endOffset||""===t.toString()?t.startContainer===s?0===t.endOffset?(d.top="0",d.left="0"):(o=t.cloneRange(),o.setStart(o.startContainer,0),i=o.getBoundingClientRect(),d.left=i.left+r-l,d.top=i.top+i.height+a-c):(d.top=t.startContainer.offsetTop,d.left=t.startContainer.offsetLeft):(d.left=n.left+n.width+r-l,d.top=n.top+a-c),d},o.prototype.replaceSelection=function(t,e){e&&this.setSelection(e),this._ignoreChange=!0,this.insertPlainText(t)},o.prototype.replaceRelativeOffset=function(t,e,n){var o;o=this.getSelection().cloneRange(),this._replaceRelativeOffsetOfSelection(t,e,n,o)},o.prototype._replaceRelativeOffsetOfSelection=function(t,e,n,o){var i;o.setStart(o.endContainer,o.endOffset+e),i=this.getSelectionInfoByOffset(o.endContainer,o.endOffset+(e+n)),o.setEnd(i.element,i.offset),this.replaceSelection(t,o)},o.prototype.getSelectionInfoByOffset=function(t,e){var n,o,r,a,s;for(n=t,r=e,a=0;n&&(o=i.getTextLength(n),a+=o,!(a>=e));)r-=o,i.getTextLength(n)>0&&(s=n),n=n.nextSibling;return n||(n=s,r=i.getTextLength(n)),{element:n,offset:r}},o.prototype.getSelectionPosition=function(t,e,n){var o,i,r,a=this.createElement("INPUT");return i=t.cloneRange(),i.setStart(i.startContainer,i.startOffset),r=this.getSelectionInfoByOffset(t.endContainer,t.endOffset+(n||0)),i.setEnd(r.element,r.offset),this._ignoreChange=!0,this.insertElement(a,i),o=$(a).offset(),"over"!==e&&(o.top+=$(a).outerHeight()),a.parentNode.removeChild(a),this.setSelection(t),o.top-=this.get$Body().scrollTop(),o},e.exports=o},{"./domUtils":8}],37:[function(t,e,n){"use strict";function o(t){i.call(this,{tagName:"button",className:t.className}),this._setOptions(t),this.render(),this.attachEvents({click:"_onClick"})}var i=t("./uicontroller"),r=tui.util;o.prototype=r.extend({},i.prototype),o.prototype._setOptions=function(t){this.command=t.command,this.event=t.event,this.text=t.text,this.style=t.style},o.prototype.render=function(){this.$el.text(this.text),this.$el.attr("type","button"),this.style&&this.$el.attr("style",this.style)},o.prototype._onClick=function(){this.command?this.trigger("command",this.command):this.trigger("event",this.event),this.trigger("clicked")},e.exports=o},{"./uicontroller":48}],38:[function(t,e,n){"use strict";function o(t){this.name="default",this.$el=$(t.options.el),this.type=t.options.initialEditType,this.editor=t,this.init(),this._initEvent()}var i=t("./toolbar"),r=t("./tab"),a=t("./layerpopup"),s=t("./modeSwitch"),l=t("./popupAddLink"),c=t("./popupAddImage"),d=t("./popupAddTable"),u=['<div class="tui-editor-defaultUI">','<div class="te-toolbar-section" />','<div class="te-mode-switch-section" />','<div class="te-markdown-tab-section" />','<div class="te-editor-section"  />',"</div>"].join("");o.prototype.init=function(){this._renderLayout(),this._initEditorSection(),this._initToolbar(),this._initModeSwitch(),this._initPopupAddLink(),this._initPopupAddImage(),this._initPopupAddTable(),this._initMarkdownTab()},o.prototype._initEditorSection=function(){this.$el.find(".te-editor-section").append(this.editor.layout.getEditorEl())},o.prototype._initEvent=function(){var t=this;this.editor.eventManager.listen("hide",this.hide.bind(this)),this.editor.eventManager.listen("show",this.show.bind(this)),this.editor.eventManager.listen("changeMode",function(){t.markdownTabControl()}),this.editor.eventManager.listen("changePreviewStyle",function(){t.markdownTabControl()})},o.prototype._renderLayout=function(){this.$containerEl=$(u).appendTo(this.$el)},o.prototype._initToolbar=function(){this.toolbar=new i(this.editor.eventManager),this.$containerEl.find(".te-toolbar-section").append(this.toolbar.$el)},o.prototype._initModeSwitch=function(){var t=this;this.modeSwitch=new s("markdown"===this.type?s.TYPE.MARKDOWN:s.TYPE.WYSIWYG),this.$containerEl.find(".te-mode-switch-section").append(this.modeSwitch.$el),this.modeSwitch.on("modeSwitched",function(e,n){t.editor.changeMode(n.text)})},o.prototype.markdownTabControl=function(){this.editor.isMarkdownMode()&&"tab"===this.editor.getCurrentPreviewStyle()?(this.$containerEl.find(".te-markdown-tab-section").show(),this.markdownTab.activate("Editor")):this.$containerEl.find(".te-markdown-tab-section").hide()},o.prototype._initMarkdownTab=function(){this.markdownTab=new r({items:["Editor","Preview"],sections:[this.editor.layout.getMdEditorContainerEl(),this.editor.layout.getPreviewEl()]}),this.$containerEl.find(".te-markdown-tab-section").append(this.markdownTab.$el)},o.prototype._initPopupAddLink=function(){this.popupAddLink=new l({$target:this.$el,eventManager:this.editor.eventManager})},o.prototype._initPopupAddImage=function(){this.popupAddImage=new c({$target:this.$el,eventManager:this.editor.eventManager})},o.prototype._initPopupAddTable=function(){this.popupAddTable=new d({$target:this.$el,eventManager:this.editor.eventManager,css:{position:"absolute",top:$("button.te-table").offset().top+$("button.te-table").height()+5,left:$("button.te-table").offset().left}})},o.prototype.hide=function(){this.$el.find(".tui-editor-defaultUI").addClass("hide")},o.prototype.show=function(){this.$el.find(".tui-editor-defaultUI").removeClass("hide")},o.prototype.remove=function(){this.$el.find(".tui-editor-defaultUI").remove()},o.prototype.createPopup=function(t){return a.factory(t)},e.exports=o},{"./layerpopup":39,"./modeSwitch":40,"./popupAddImage":41,"./popupAddLink":42,"./popupAddTable":43,"./tab":44,"./toolbar":47}],39:[function(t,e,n){"use strict";function o(t){t=r.extend({},t),i.call(this,{tagName:"div",className:s+"wrapper",rootElement:t.$el}),t=r.extend({},t),this._setId(),this._initTarget(t),this._initExternalPopupHtmlIfNeed(t),this._initCloserOpener(t),this._initContent(t),this._initTitle(t),this._initClassName(t),this._initCssStyles(t)}var i=t("./uicontroller"),r=tui.util,a=0,s="tui-popup-",l=['<div class="'+s+'header">','<span class="'+s+'title"></span>','<button class="'+s+'close-button">x</button>',"</div>",'<div class="'+s+'body"></div>'].join("");o.prototype=r.extend({},i.prototype),o.prototype._initTarget=function(t){this.$target=t.$target||$("body")},o.prototype._initExternalPopupHtmlIfNeed=function(t){t.$el&&(this.$el=t.$el,this._isExternalHtmlUse=!0)},o.prototype._initCloserOpener=function(t){this.openerCssQuery=t.openerCssQuery,this.closerCssQuery=t.closerCssQuery},o.prototype._initContent=function(t){t.content?this.$content=$(t.content):t.textContent&&(this.$content=t.textContent)},o.prototype._initTitle=function(t){this.title=t.title},o.prototype._initClassName=function(t){t.className&&(this.className=t.className)},o.prototype.render=function(){this._renderLayout(),this._renderTitle(),this._renderContent(),this._attachPopupEvent()},o.prototype._renderLayout=function(){this._isExternalHtmlUse?(this.hide(),this.$target&&this.$target.append(this.$el)):(this.$el.html(l),this.$el.addClass(this.className),this.hide(),this.$target.append(this.$el),this.$body=this.$el.find(this._getFullClassName("body")),this.title===!1&&this.$el.find(this._getFullClassName("header")).remove())},o.prototype._renderContent=function(){this._isExternalHtmlUse||this.setContent(this.$content)},o.prototype._renderTitle=function(){this._isExternalHtmlUse||this.title===!1||this.setTitle(this.title)},o.prototype._getFullClassName=function(t){return"."+s+t},o.prototype._attachOpenerCloserEvent=function(){var t=this;this.openerCssQuery&&$(this.openerCssQuery).on("click."+this._getId(),function(){t.show()}),this.closerCssQuery&&$(this.closerCssQuery).on("click."+this._getId(),function(){t.hide()})},o.prototype._detachOpenerCloserEvent=function(){this.openerCssQuery&&$(this.openerCssQuery).off("."+this._getId()),this.closerCssQuery&&$(this.closerCssQuery).off("."+this._getId())},o.prototype._attachPopupControlEvent=function(){var t=this;this.on("click "+this._getFullClassName("close-button"),function(){t.hide()})},o.prototype._detachPopupEvent=function(){this.off(),this._detachOpenerCloserEvent()},o.prototype._attachPopupEvent=function(){this._attachPopupControlEvent(),this._attachOpenerCloserEvent()},o.prototype._setId=function(){this._id=a,a+=1},o.prototype._getId=function(){return this._id},o.prototype.setContent=function(t){this.$body.empty(),this.$body.append(t)},o.prototype.setTitle=function(t){var e=this.$el.find(this._getFullClassName("title"));e.empty(),e.append(t)},o.prototype.hide=function(){this.$el.css("display","none"),this._isShow=!1,this.trigger("hidden",this)},o.prototype.show=function(){this.$el.css("display","block"),this._isShow=!0,this.trigger("shown",this)},o.prototype.isShow=function(){return this._isShow},o.prototype.remove=function(){this.trigger("remove",this),this._detachPopupEvent(),this.$el.empty(),this.$el.remove()},o.prototype.css=function(){this.$el.css.apply(this.$el,arguments)},o.prototype._initCssStyles=function(t){t.css&&this.css(t.css)},o.factory=function(t){var e=new o(t);return e.render(),e},o.CLASS_PREFIX=s,e.exports=o},{"./uicontroller":48}],40:[function(t,e,n){"use strict";function o(t){i.call(this,{tagName:"div",className:"te-mode-switch"}),this.type=r.isExisty(t)?t:s.MARKDOWN,this._render()}var i=t("./uicontroller"),r=tui.util,a=["WYSIWYG","Markdown"],s={MARKDOWN:0,WYSIWYG:1};o.prototype=r.extend({},i.prototype),o.prototype._render=function(){this.$button=$('<button class="te-switch-button" type="button" />'),this._setButtonTitle(),this.$el.append(this.$button),this.attachEvents({"click button":"_buttonClicked"})},o.prototype._setButtonTitle=function(){this.$button.text("to"+this._getNextTypeString())},o.prototype._buttonClicked=function(){this._switchType()},o.prototype._switchType=function(){var t=this._getNextTypeString();this._toggleType(),this._setButtonTitle(),this.trigger("modeSwitched",{type:this.type,text:t.toLowerCase()})},o.prototype._getNextTypeString=function(){return a[this.type]},o.prototype._toggleType=function(){this.type=this.type===s.MARKDOWN?s.WYSIWYG:s.MARKDOWN},o.TYPE=s,e.exports=o},{"./uicontroller":48}],41:[function(t,e,n){"use strict";function o(t){t=a.extend({title:"Add Image",className:"te-popup-add-image tui-editor-popup",content:s},t),i.call(this,t),this.eventManager=t.eventManager,this.render(),this._bindContentEvent(),this._linkWithEventManager(),this._initApplyImageBindContext()}var i=t("./layerpopup"),r=t("./tab"),a=tui.util,s=['<div class="te-tab-section"></div>','<div class="te-url-type">','<label for="">Image URL</label>','<input type="text" class="te-image-url-input" />',"</div>",'<form enctype="multipart/form-data" class="te-file-type">','<label for="">Image File</label>','<input type="file" class="te-image-file-input" accept="image/*" />',"</form>",'<label for="url">Alt Text</label>','<input type="text" class="te-alt-text-input" />','<div class="te-button-section">','<button type="button" class="te-ok-button">OK</button>','<button type="button" class="te-close-button">Cancel</button>',"</div>"].join("");o.prototype=a.extend({},i.prototype),o.prototype._bindContentEvent=function(){var t=this;this.on("click .te-ok-button",function(){t.trigger("okButtonClicked",this),t.hide()}),this.on("click .te-close-button",function(){t.trigger("closeButtonClicked",this),t.hide()}),this.on("shown",function(){t.$el.find(".te-image-url-input").focus()}),this.on("hidden",function(){t.resetInputs()}),this.tab.on("itemClick",function(){t.resetInputs()}),this.on("change .te-image-file-input",function(){var e=t.$el.find(".te-image-file-input").val().split("\\").pop();t.$el.find(".te-alt-text-input").val(e)})},o.prototype._linkWithEventManager=function(){var t=this;this.eventManager.listen("focus",function(){t.hide()}),this.eventManager.listen("openPopupAddImage",function(){t.eventManager.emit("closeAllPopup"),t.show()}),this.eventManager.listen("closeAllPopup",function(){t.hide()}),this.on("okButtonClicked",function(){t._isUrlType()?t.applyImage():(t._preAltValue=t.$el.find(".te-alt-text-input").val(),
t.eventManager.emit("addImageBlobHook",t.$el.find(".te-image-file-input")[0].files[0],t.applyImage))})},o.prototype._initApplyImageBindContext=function(){var t=this;this.applyImage=function(e){var n;n=e?t._getImageInfoWithGivenUrl(e):t._getImageInfo(),t.eventManager.emit("command","AddImage",n),t.hide()}},o.prototype._isUrlType=function(){return!!this.$el.find(".te-image-url-input").val()},o.prototype._renderContent=function(){var t=this.$el;i.prototype._renderContent.call(this),this.tab=new r({initName:"File",items:["File","URL"],sections:[t.find(".te-file-type"),t.find(".te-url-type")]}),this.$body.find(".te-tab-section").append(this.tab.$el)},o.prototype._getImageInfoWithGivenUrl=function(t){var e=this._preAltValue;return this._preAltValue="",this._makeImageInfo(t,e)},o.prototype._getImageInfo=function(){var t=this.$el.find(".te-image-url-input").val(),e=this.$el.find(".te-alt-text-input").val();return this._makeImageInfo(t,e)},o.prototype._makeImageInfo=function(t,e){return{imageUrl:t,altText:e}},o.prototype._getImageFileForm=function(){return this.$el.find("form")},o.prototype.resetInputs=function(){this.$el.find("input").val("")},e.exports=o},{"./layerpopup":39,"./tab":44}],42:[function(t,e,n){"use strict";function o(t){t=r.extend({title:"Add Link",className:"te-popup-add-link tui-editor-popup",content:a},t),i.call(this,t),this.render(),this._bindContentEvent(),this._linkWithEventManager(t.eventManager)}var i=t("./layerpopup"),r=tui.util,a=['<label for="linkText">Link Text</label>','<input type="text" class="te-link-text-input" />','<label for="url">URL</label>','<input type="text" class="te-url-input" />','<div class="te-button-section">','<button type="button" class="te-ok-button">OK</button>','<button type="button" class="te-close-button">Cancel</button>',"</div>"].join("");o.prototype=r.extend({},i.prototype),o.prototype._bindContentEvent=function(){var t=this;this.on("click .te-ok-button",function(){t.trigger("okButtonClicked",this),t.hide()}),this.on("click .te-close-button",function(){t.trigger("closeButtonClicked",this),t.hide()}),this.on("shown",function(){t.$el.find(".te-link-text-input").focus()}),this.on("hidden",function(){t.resetInputs()})},o.prototype._linkWithEventManager=function(t){var e=this;t.listen("focus",function(){e.hide()}),t.listen("openPopupAddLink",function(){t.emit("closeAllPopup"),e.show()}),t.listen("closeAllPopup",function(){e.hide()}),this.on("okButtonClicked",function(){t.emit("command","AddLink",e.getValue())})},o.prototype.getValue=function(){return{linkText:this.$el.find(".te-link-text-input").val(),url:this.$el.find(".te-url-input").val()}},o.prototype.resetInputs=function(){this.$el.find("input").val("")},e.exports=o},{"./layerpopup":39}],43:[function(t,e,n){"use strict";function o(t){t=r.extend({title:!1,className:"te-popup-add-table",content:a},t),i.call(this,t),this._selectedBound={},this._tableBound={},this.eventManager=t.eventManager,this.render(),this._cacheElements(),this._bindContentEvent(),this._linkWithEventManager(),this._setTableSizeByBound(u,c)}var i=t("./layerpopup"),r=tui.util,a=['<div class="te-table-selection">','<div class="te-table-header"></div>','<div class="te-table-body"></div>','<div class="te-selection-area"></div>',"</div>",'<p class="te-description"></p>'].join(""),s=25,l=17,c=7,d=14,u=5,h=9,p=1,f=1,m=1,g=1;o.prototype=r.extend({},i.prototype),o.prototype._cacheElements=function(){this.$header=this.$el.find(".te-table-header"),this.$body=this.$el.find(".te-table-body"),this.$selection=this.$el.find(".te-selection-area"),this.$desc=this.$el.find(".te-description")},o.prototype._bindContentEvent=function(){var t=this;this.on("mousemove .te-table-selection",function(e){var n,o=e.pageX-t._selectionOffset.left,i=e.pageY-t._selectionOffset.top;n=t._getSelectionBoundByOffset(o,i),t._resizeTableBySelectionIfNeed(n.col,n.row),t._setSelectionAreaByBound(n.col,n.row),t._setDisplayText(n.col,n.row),t._setSelectedBound(n.col,n.row)}),this.on("click .te-table-selection",function(){var e=t._getSelectedTableSize();t.eventManager.emit("command","Table",e.col,e.row)})},o.prototype._linkWithEventManager=function(){var t=this;this.eventManager.listen("focus",function(){t.hide()}),this.eventManager.listen("openPopupAddTable",function(){t.eventManager.emit("closeAllPopup"),t.show(),t._selectionOffset=t.$el.find(".te-table-selection").offset()}),this.eventManager.listen("closeAllPopup",function(){t.hide()})},o.prototype._resizeTableBySelectionIfNeed=function(t,e){var n=this._getResizedTableBound(t,e);n&&this._setTableSizeByBound(n.col,n.row)},o.prototype._getResizedTableBound=function(t,e){var n,o,i;return t>=u&&h>t?n=t+1:u>t&&(n=u),e>=c&&d>e?o=e+1:c>e&&(o=c),this._isNeedResizeTable(n,o)&&(i={row:o||this._tableBound.row,col:n||this._tableBound.col}),i},o.prototype._isNeedResizeTable=function(t,e){return t&&t!==this._tableBound.col||e&&e!==this._tableBound.row},o.prototype._getBoundByOffset=function(t,e){var n=parseInt(e/l,10),o=parseInt(t/s,10);return{row:n,col:o}},o.prototype._getOffsetByBound=function(t,e){var n=t*s+s,o=e*l+l;return{x:n,y:o}},o.prototype._setTableSizeByBound=function(t,e){var n=this._getOffsetByBound(t,e-m);this._setTableSize(n.x,n.y),this._tableBound.row=e,this._tableBound.col=t},o.prototype._getSelectionBoundByOffset=function(t,e){var n=this._getBoundByOffset(t,e);return n.row<p?n.row=p:n.row>this._tableBound.row&&(n.row=this._tableBound.row),n.col<f?n.col=f:n.col>this._tableBound.col&&(n.col=this._tableBound.col),n},o.prototype._setSelectionAreaByBound=function(t,e){var n,n=this._getOffsetByBound(t,e);this._setSelectionArea(n.x,n.y)},o.prototype._setSelectedBound=function(t,e){this._selectedBound.col=t,this._selectedBound.row=e},o.prototype._getSelectedTableSize=function(){return{row:this._selectedBound.row+1,col:this._selectedBound.col+1}},o.prototype._setDisplayText=function(t,e){this.$desc.html(t+1+" x "+(e+1))},o.prototype._setTableSize=function(t,e){t+=g,e+=g,this.$header.css({height:l,width:t}),this.$body.css({height:e,width:t}),this.$el.css({width:t+30})},o.prototype._setSelectionArea=function(t,e){t+=g,e+=g,this.$selection.css({height:e,width:t})},o.CELL_WIDTH=s,o.CELL_HEIGHT=l,o.MIN_ROW_SELECTION_INDEX=p,o.MIN_COL_SELECTION_INDEX=f,e.exports=o},{"./layerpopup":39}],44:[function(t,e,n){"use strict";function o(t){i.call(this,{tagName:"div",className:"te-tab"}),t=a.extend({},t),this.items=t.items,this.sections=t.sections,this._$activeButton=null,this.render(),this._initItemClickEvent(t.onItemClick),this._applyInitName(t.initName)}var i=t("./uicontroller"),r=t("./templater"),a=tui.util,s='<button type="button" data-index="${index}">${name}</button>';o.prototype=a.extend({},i.prototype),o.prototype.render=function(){var t;t=r(s,this._getButtonData()),this.$el.html(t),this.attachEvents({"click button":"_onButtonClick"})},o.prototype._applyInitName=function(t){t&&this.activate(t)},o.prototype._getButtonData=function(){var t,e,n=[];for(t=0,e=this.items.length;e>t;t+=1)n.push({name:this.items[t],index:t});return n},o.prototype._onButtonClick=function(t){var e=$(t.target);this._activateTabByButton(e)},o.prototype._deactivate=function(){this._$activeButton&&(this._$activeButton.removeClass("te-tab-active"),this.sections&&this.sections[this._$activeButton.attr("data-index")].removeClass("te-tab-active"))},o.prototype._activateButton=function(t){this._$activeButton=t,this._$activeButton.addClass("te-tab-active")},o.prototype._activateSection=function(t){this.sections&&this.sections[t].addClass("te-tab-active")},o.prototype.activate=function(t){var e=this.$el.find('button:contains("'+t+'")');this._activateTabByButton(e)},o.prototype._activateTabByButton=function(t){this._isActivatedButton(t)||(this._deactivate(),this._activateButton(t),this._activateSection(t.attr("data-index")),this.trigger("itemClick",t.text()))},o.prototype._isActivatedButton=function(t){return this._$activeButton&&this._$activeButton.text()===t.text()},o.prototype._initItemClickEvent=function(t){t&&this.on("itemClick",t)},e.exports=o},{"./templater":45,"./uicontroller":48}],45:[function(t,e,n){"use strict";function o(t,e){var n,o=[];return i.isArray(e)||(e=[e]),i.forEach(e,function(e){n=t.replace(/\${([\w]+)}/g,function(t,n){return i.isExisty(e,n)?e[n].toString():""}),o.push(n)}),o}var i=tui.util;e.exports=o},{}],46:[function(t,e,n){"use strict";function o(t){this.options=t,this.current=this.options[0],i.call(this,this.current),this._initEvent()}var i=t("./button"),r=tui.util;o.prototype=r.extend({},i.prototype),o.prototype._initEvent=function(){var t=this;this.on("clicked",function(){t._toggle()})},o.prototype._toggle=function(){this.current===this.options[0]?this.current=this.options[1]:this.current=this.options[0],this._setOptions(this.current),this.render()},e.exports=o},{"./button":37}],47:[function(t,e,n){"use strict";function o(t){i.call(this,{tagName:"div",className:"tui-editor-defaultUI-toolbar"}),this.buttons=[],this.eventManager=t,this.render(),this._initButton()}var i=t("./uicontroller"),r=t("./button"),a=t("./toggleButton"),s=tui.util;o.prototype=s.extend({},i.prototype),o.prototype.render=function(){this.$buttonContainer=this.$el},o.prototype.addButton=function(t){var e=this.eventManager;t.render||(t=s.isArray(t)?new a(t):new r(t)),t.on("command",function(t,n){e.emit("command",n)}),t.on("event",function(t,n){e.emit(n)}),this.buttons.push(t),this.$buttonContainer.append(t.$el)},o.prototype._initButton=function(){this.addButton(new r({className:"te-bold",command:"Bold",text:"B"})),this.addButton(new r({className:"te-italic",command:"Italic",text:"I"})),this.addButton(new r({className:"te-quote",command:"Blockquote",text:"Q"})),this.addButton(new r({className:"te-heading",command:"Heading",text:"HH"})),this.addButton(new r({className:"te-hrline",command:"HR",text:""})),this.addButton(new r({className:"te-link",event:"openPopupAddLink",text:"A"})),this.addButton(new r({className:"te-image",event:"openPopupAddImage",text:"IMG"})),this.addButton(new r({className:"te-ul",command:"UL",text:"UL"})),this.addButton(new r({className:"te-ol",command:"OL",text:"OL"})),this.addButton(new r({className:"te-task",command:"Task",text:""})),this.addButton(new r({className:"te-table",event:"openPopupAddTable",text:"TABLE"}))},e.exports=o},{"./button":37,"./toggleButton":46,"./uicontroller":48}],48:[function(t,e,n){"use strict";function o(t){t=i.extend({tagName:"div"},t||{}),this.tagName=t.tagName,this.className=t.className,this.$el=null,this._initID(),this.setRootElement(t.rootElement)}var i=tui.util,r=0;o.prototype.on=function(t,e){var n=this;i.isObject(t)?i.forEach(t,function(t,e){n._addEvent(e,t)}):this._addEvent(t,e)},o.prototype._addEvent=function(t,e){var n=this._parseEventType(t),o=n[0],i=n[1];i?this.$el.on(o,i,e):this.$el.on(o,e)},o.prototype.off=function(t,e){var n,o,i;t?(n=this._parseEventType(t),o=n[0],i=n[1],i?this.$el.off(o,i,e):this.$el.off(o,e)):this.$el.off()},o.prototype._parseEventType=function(t){var e=t.split(" "),n=e.shift(),o=e.join(" ");return[n,o]},o.prototype.attachEvents=function(t){var e,n=this,o=t||this.events;o&&i.forEach(o,function(t,o){if(!n[t])throw new Error("UIController#attachEvents: "+t+"  .");o=n.getEventNameWithNamespace(o),e=i.bind(n[t],n),n.on(o,e)})},o.prototype.detachEvents=function(){this.$el.off(".uicEvent"+this.id)},o.prototype.setRootElement=function(t){var e=this.className,n=this.tagName;t||(e=e||"uic"+this.id,n=n,t=$("<"+n+' class="'+e+'"/>')),this.$el=t},o.prototype.trigger=function(){this.$el.trigger.apply(this.$el,arguments)},o.prototype._initID=function(){this.id=r,r+=1},o.prototype.getEventNameWithNamespace=function(t){var e=t.split(" ");return e[0]+=".uicEvent"+this.id,e.join(" ")},o.prototype.addUIC=function(t,e){e?this.$el.find(e).append(t.$el):this.$el.append(t.$el)},o.prototype.remove=function(){this.detachEvents(),this.$el.remove()},o.prototype.destroy=function(){this.remove(),this.detachEvents(),i.forEachOwnProperties(this,function(t,e){this[e]=null},this)},o.extend=function(t){var e=i.defineClass(this,t);return e.extend=o.extend,e},e.exports=o},{}],49:[function(t,e,n){"use strict";function o(t){this.wwe=t,r.browser.msie&&(this.$hiddenArea=$('<div style="position:absolute;top:0;left:-9999px;height:1px;width:1px;overflow:hidden;" />'),this.wwe.$editorContainerEl.append(this.$hiddenArea))}var i=t("./domUtils"),r=tui.util;o.prototype.init=function(){this._initSquireEvent()},o.prototype._initSquireEvent=function(){var t=this;r.browser.msie?(this.wwe.getEditor().addEventListener("keydown",function(e){var n;e.ctrlKey&&67===e.keyCode?(n=t.wwe.getEditor().getSelection().cloneRange(),n=t._extendRange(n),t.copyWithTextarea(n)):e.ctrlKey&&88===e.keyCode&&(n=t.wwe.getEditor().getSelection().cloneRange(),n=t._extendRange(n),t.copyWithTextarea(n),n=t.wwe.insertSelectionMarker(n),n.deleteContents(),setTimeout(function(){t.wwe.restoreSelectionMarker(),t.wwe.getEditor()._ensureBottomLine()}))}),this.wwe.getEditor().addEventListener("willPaste",function(e){e.fragment=t._processFragment(e.fragment)})):(this.wwe.getEditor().addEventListener("copy",function(e){var n;e.preventDefault(),n=t.wwe.getEditor().getSelection().cloneRange(),n=t._extendRange(n),t.makeClipboardData(n,e)}),this.wwe.getEditor().addEventListener("cut",function(e){var n;e.preventDefault(),n=t.wwe.getEditor().getSelection().cloneRange(),n=t._extendRange(n),t.makeClipboardData(n,e),n=t.wwe.insertSelectionMarker(n),n.deleteContents(),t.wwe.restoreSelectionMarker(),t.wwe.getEditor()._ensureBottomLine(),t.wwe.postProcessForChange()})),this.wwe.getEditor().addEventListener("paste",function(){t.wwe.postProcessForChange()})},o.prototype._processFragment=function(t){var e,n,o,i;if(this._latestTextareaContent===t.textContent)for(e=$.parseHTML(t.textContent),n=document.createDocumentFragment(),o=0,i=e.length;i>o;o+=1)n.appendChild(e[o]);return n||t},o.prototype._getContentFromRange=function(t){var e,n=this,o=t.cloneContents();return this._isOneTextNodeFullySelected(t)?this._eachCurrentPath(function(t){e=n._makeNodeAndAppend(t,e||o)}):this._isOrphanListItem(t)?e=this._makeNodeAndAppend(t.commonAncestorContainer.tagName,o):this._isStartWithPartialTextNode(t)&&(e=this._makeFirstChildToTextNodeIfNeed(o)),e=this._makeNodeAndAppend("div",e||o),e.html()},o.prototype._makeNodeAndAppend=function(t,e){var n=$("<"+t+"/>");return n.append(e),n},o.prototype._eachCurrentPath=function(t){var e,n=this.wwe.getEditor().getPath().split(">");for(e=n.length-1;e>-1&&!n[e].match(/^body/i);e-=1)t(n[e])},o.prototype._makeFirstChildToTextNodeIfNeed=function(t){var e;return i.isElemNode(t.firstChild)&&"DIV"===t.firstChild.tagName&&(e=this.wwe.getEditor().getDocument().createTextNode(t.firstChild.textContent),$(t).find("*").first().remove(),$(t).prepend(e)),t},o.prototype.copyWithTextarea=function(t){var e=this,n=$("<textarea />");this.$hiddenArea.append(n),this._latestTextareaContent=this._getContentFromRange(t),n.val(this._latestTextareaContent),n.select(),setTimeout(function(){n.remove(),e.wwe.getEditor().focus(),e.wwe.getEditor().setSelection(t)},0)},o.prototype.makeClipboardData=function(t,e){var n=this._getContentFromRange(t);e.clipboardData.setData("text/plain",n)},o.prototype._extendRange=function(t){var e;if(t.startContainer!==t.endContainer){if(0===t.startOffset){for(e=t.startContainer;e.parentNode!==t.commonAncestorContainer&&!e.previousSibling;)e=e.parentNode;t.setStart(e.parentNode,i.getNodeOffsetOfParent(e))}if(t.endOffset===t.endContainer.length){for(e=t.endContainer;e.parentNode!==t.commonAncestorContainer&&(!e.nextSibling||"BR"===e.nextSibling.tagName&&e.parentNode.lastChild===e.nextSibling);)e=e.parentNode;t.setEnd(e.parentNode,i.getNodeOffsetOfParent(e)+1)}}return this._isWholeCommonAncestorContainerSelected(t)&&(e=t.commonAncestorContainer,t.setStart(e.parentNode,i.getNodeOffsetOfParent(e)),t.setEnd(e.parentNode,i.getNodeOffsetOfParent(e)+1)),t},o.prototype._isWholeCommonAncestorContainerSelected=function(t){return t.commonAncestorContainer.nodeType===Node.ELEMENT_NODE&&"BODY"!==t.commonAncestorContainer.tagName&&0===t.startOffset&&t.endOffset===t.commonAncestorContainer.childNodes.length&&t.commonAncestorContainer===t.startContainer&&t.commonAncestorContainer===t.endContainer},o.prototype._isOneTextNodeFullySelected=function(t){return t.commonAncestorContainer.nodeType===Node.TEXT_NODE&&t.startContainer===t.endContainer&&t.startContainer===t.commonAncestorContainer&&0===t.startOffset&&t.endOffset===t.commonAncestorContainer.nodeValue.length},o.prototype._isStartWithPartialTextNode=function(t){return t.startContainer.nodeType===Node.TEXT_NODE&&t.startOffset>0},o.prototype._isOrphanListItem=function(t){return t.commonAncestorContainer.nodeType===Node.ELEMENT_NODE&&("UL"===t.commonAncestorContainer.tagName||"OL"===t.commonAncestorContainer.tagName)},e.exports=o},{"./domUtils":8}],50:[function(t,e,n){"use strict";function o(){this._markerNode=null}var i="tui-editor-selection-marker";o.prototype.insertMarker=function(t,e){return this._markerNode=this._makeMarker(e),t.insertNode(this._markerNode),t.setStartAfter(this._markerNode),t},o.prototype._makeMarker=function(t){return t.createElement("INPUT",{type:"hidden","class":i})},o.prototype.restore=function(t){var e=t.getSelection().cloneRange();return e.setStartAfter(this._markerNode),e.collapse(!0),t.setSelection(e),$(this._markerNode).remove(),e},e.exports=o},{}],51:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"AddImage",exec:function(t,e){var n=t.getEditor();n.insertImage(e.imageUrl),n.focus()}});e.exports=i},{"../commandManager":6}],52:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"AddLink",exec:function(t,e){var n,o=t.getEditor();o.removeAllFormatting(),o.getSelectedText()?o.makeLink(e.url):(n=o.createElement("A",{href:e.url}),$(n).text(e.linkText),o.insertElement(n)),o.focus()}});e.exports=i},{"../commandManager":6}],53:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"Blockquote",exec:function(t){var e=t.getEditor();t.hasFormatWithRx(/TABLE/)||(t.unwrapBlockTag(),e.increaseQuoteLevel()),e.focus()}});e.exports=i},{"../commandManager":6}],54:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"Bold",keyMap:["Ctrl-B","Ctrl-B"],exec:function(t){var e=t.getEditor();e.removeItalic(),e.hasFormat("b")||e.hasFormat("strong")?e.changeFormat(null,{tag:"b"}):e.hasFormat("a")||e.bold(),e.focus()}});e.exports=i},{"../commandManager":6}],55:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"Heading",exec:function(t){var e,n=t.getEditor(),o=t.hasFormatWithRx(/h[\d]/i),i=1;t.hasFormatWithRx(/TABLE/)||(o&&(e=parseInt(o[0].replace(/h/i,""),10)),e&&6>e&&(i=e+1),t.changeBlockFormatTo("H"+i)),n.focus()}});e.exports=i},{"../commandManager":6}],56:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"HR",exec:function(t){var e=t.getEditor();e.modifyBlocks(function(t){return t.appendChild(e.createElement("HR")),t}),e.focus()}});e.exports=i},{"../commandManager":6}],57:[function(t,e,n){"use strict";function o(t){var e=t.nodeType;return!(e!==Node.ELEMENT_NODE&&e!==Node.DOCUMENT_FRAGMENT_NODE||i(t)||r(t))}function i(t){return d.test(t.nodeName)}function r(t){var e=t.nodeType;return(e===Node.ELEMENT_NODE||e===Node.DOCUMENT_FRAGMENT_NODE)&&!i(t)&&a(t.childNodes,i)}function a(t,e){for(var n=t.length-1;n>=0;){if(!e(t[n]))return!1;n-=1}return!0}function s(t,e){var n=t.parentNode;n&&n.replaceChild(e,t)}function l(t){var e,n,i,r,a,l=t.querySelectorAll("LI"),c={"class":"task-list-item"};for(e=0,n=l.length;n>e;e+=1)i=l[e],o(i.firstChild)||(r=i.parentNode.nodeName,a=i.previousSibling,a&&(a=a.lastChild)&&a.nodeName===r||s(i,this.createElement("LI",c,[a=this.createElement(r)])),a.appendChild(i));return t}var c=t("../commandManager"),d=/^(?:#text|A(?:BBR|CRONYM)?|B(?:R|D[IO])?|C(?:ITE|ODE)|D(?:ATA|EL|FN)|EM|FONT|HR|I(?:MG|NPUT|NS)?|KBD|Q|R(?:P|T|UBY)|S(?:AMP|MALL|PAN|TR(?:IKE|ONG)|U[BP])?|U|VAR|WBR)$/,u=c.command("wysiwyg",{name:"IncreaseTask",exec:function(t){var e,n,o;if(o=t.getEditor().getSelection(),n=o.startContainer,o.collapsed&&""===o.startContainer.textContent.replace(/^[\s]+/g,""))for(;e=n.parentNode;){if("UL"===e.nodeName||"OL"===e.nodeName){n.previousSibling&&t.getEditor().modifyBlocks(l);break}n=e}}});e.exports=u},{"../commandManager":6}],58:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"Italic",keyMap:["Ctrl-I","Ctrl-I"],exec:function(t){var e=t.getEditor();e.removeBold(),e.hasFormat("i")||e.hasFormat("em")?e.changeFormat(null,{tag:"i"}):e.hasFormat("a")||e.italic(),e.focus()}});e.exports=i},{"../commandManager":6}],59:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"OL",keyMap:["Ctrl-O","Ctrl-O"],exec:function(t){var e=t.getEditor();(e.getSelection().collapsed||!t.hasFormatWithRx(/TABLE/))&&(t.unwrapBlockTag(),e.makeOrderedList()),e.focus()}});e.exports=i},{"../commandManager":6}],60:[function(t,e,n){"use strict";function o(t,e){var n;n=t.getSelection(),n.selectNodeContents(e.find("th").eq(0)[0]),t.setSelection(n)}function i(t){for(var e="<thead><tr>";t;)e+="<th></th>",t-=1;return e+="</tr></thead>"}function r(t,e){var n,o,i="<tbody>";for(n=0;e>n;n+=1){for(i+="<tr>",o=0;t>o;o+=1)i+="<td></td>";i+="</tr>"}return i+="</tbody>"}var a=t("../commandManager"),s=0,l="te-content-table-",c=a.command("wysiwyg",{name:"Table",exec:function(t,e,n){var a,c=t.getEditor();return!c.getSelection().collapsed||t.hasFormatWithRx(/TABLE/)?void c.focus():(a='<table class="'+l+s+'">',a+=i(e),a+=r(e,n-1),a+="</table>",c.insertHTML(a),c.focus(),o(c,t.get$Body().find("."+l+s)),void(s+=1))}});e.exports=c},{"../commandManager":6}],61:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"Task",exec:function(t){var e,n,o,i,r=t.getEditor();return!r.getSelection().collapsed||t.hasFormatWithRx(/TABLE/)?void r.focus():(r.hasFormat("li")||(t.unwrapBlockTag(),r.makeUnorderedList()),e=r.getSelection().cloneRange(),n=$(e.startContainer),o=n.closest("li"),i=o.children("input").length||o.children("div").eq(0).children("input").length,i||(e=t.insertSelectionMarker(e),e.setStart(e.startContainer,0),e.collapse(!0),r.insertElement(r.createElement("INPUT",{type:"checkbox"}),e),e.setStart(e.startContainer,1),r.insertElement(r.getDocument().createTextNode(" "),e),o.addClass("task-list-item"),t.restoreSelectionMarker()),void r.focus())}});e.exports=i},{"../commandManager":6}],62:[function(t,e,n){"use strict";var o=t("../commandManager"),i=o.command("wysiwyg",{name:"UL",keyMap:["Ctrl-U","Ctrl-U"],exec:function(t){var e=t.getEditor();(e.getSelection().collapsed||!t.hasFormatWithRx(/TABLE/))&&(t.unwrapBlockTag(),e.makeUnorderedList()),e.focus()}});e.exports=i},{"../commandManager":6}],63:[function(t,e,n){"use strict";function o(t,e,n){this.eventManager=n,this.$editorContainerEl=t,this.contentStyles=e,this._height=0,this._silentChange=!1,this._clipboardManager=new r(this),this._selectionMarker=new a,this._initEvent()}var i=t("./domUtils"),r=t("./wwClipboardManager"),a=t("./wwSelectionMarker"),s=t("./squireExt"),l=tui.util,c=/h[\d]/i,d=/<(.+)>(<br>|<br \/>|<BR>|<BR \/>)<\/\1>/g,u=/(?:<br>|<br \/>|<BR>|<BR \/>)<\/(.+?)>/g,h=/\b(H[\d]|LI|P|BLOCKQUOTE|TD)\b/,p=/^\s+/,f="tui-editor-contents";o.prototype.init=function(t){var e=this;this.$iframe=$('<iframe height="100%" />'),this.$iframe.load(function(){e._initSquire(),setTimeout(function(){t&&(t(),t=null)},0)}),this.$editorContainerEl.css("position","relative"),this.$editorContainerEl.append(this.$iframe)},o.prototype._initSquire=function(){var t=this,e=t.$iframe[0].contentDocument;t._makeSureStandardMode(e),t.editor&&t._isIframeReady()||(t._initStyleSheet(e),t._initEditorContainerStyles(e),t.editor=new s(e,{blockTag:"DIV"}),t._initSquireEvent(),t._clipboardManager.init(),$(e).on("click",function(){t.focus()}))},o.prototype._isIframeReady=function(){var t=this.$iframe[0].contentWindow;return null!==t&&$(t.document.body).hasClass(f)},o.prototype._makeSureStandardMode=function(t){"CSS1Compat"!==t.compatMode&&(t.open(),t.write("<!DOCTYPE html><title></title>"),t.close())},o.prototype._initStyleSheet=function(t){var e;l.forEach(this.contentStyles,function(n){e=t.createElement("link"),e.rel="stylesheet",e.href=n,t.querySelector("head").appendChild(e)})},o.prototype._initEditorContainerStyles=function(t){var e,n;t.querySelector("html").style.height="100%",n=t.querySelector("body"),n.className=f,e=n.style,e.padding="0 5px"},o.prototype._initEvent=function(){var t=this;this.eventManager.listen("changeModeToWysiwyg",function(){t._autoResizeHeightIfNeed()})},o.prototype._initSquireEvent=function(){var t=this;this.getEditor().addEventListener("paste",function(e){t.eventManager.emit("paste",{source:"wysiwyg",data:e})}),this.getEditor().getDocument().addEventListener("dragover",function(t){return t.preventDefault(),!1}),this.getEditor().getDocument().addEventListener("drop",function(e){return e.preventDefault(),t.eventManager.emit("drop",{source:"wysiwyg",data:e}),!1}),this.getEditor().addEventListener("input",function(){var e,n=t.editor.getSelection();this._silentChange?this._silentChange=!1:(e={source:"wysiwyg",selection:n,textContent:n.endContainer.textContent,caretOffset:n.endOffset},t.eventManager.emit("changeFromWysiwyg",e),t.eventManager.emit("change",e),t.eventManager.emit("contentChangedFromWysiwyg",t)),t._autoResizeHeightIfNeed()}),this.getEditor().addEventListener("keydown",function(e){t._keyEventHandler(e)}),l.browser.firefox&&this.getEditor().addEventListener("keypress",function(e){e.keyCode&&t._keyEventHandler(e)}),this.getEditor().addEventListener("focus",function(){t.eventManager.emit("focus",{source:"wysiwyg"})}),this.getEditor().addEventListener("blur",function(){t.eventManager.emit("blur",{source:"wysiwyg"})}),this.getEditor().addEventListener("pathChange",function(e){var n={bold:/(>B$)|(>B>)|(>STRONG$)|(>STRONG>)/.test(e.path),italic:/(>I$)|(>I>)|(>EM$)|(>EM>)/.test(e.path)};t.eventManager.emit("stateChange",n)})},o.prototype._keyEventHandler=function(t){var e=this,n=this.getEditor().getSelection().cloneRange();13===t.keyCode?this._isInTaskList(n)?(this._unformatTaskIfNeedOnEnter(n),setTimeout(function(){e._isInTaskList()&&e.eventManager.emit("command","Task")},0)):this.hasFormatWithRx(c)?setTimeout(function(){e._unwrapHeading()},0):this._isInHr(n)||this._isNearHr(n)?this._removeHrIfNeed(n,t):this._isInOrphanText(n)?this._wrapDefaultBlockTo(n):this._isAfterTable(n)?(t.preventDefault(),n.setStart(n.startContainer,n.startOffset-1),this.breakToNewDefaultBlock(n)):this._isBeforeTable(n)?(t.preventDefault(),this.breakToNewDefaultBlock(n,"before")):this._isInTable(n)&&this._appendBrIfTdOrThNotHaveAsLastChild(n):8===t.keyCode?n.collapsed&&(this._isInTaskList(n)?this._unformatTaskIfNeedOnBackspace(n):this.hasFormatWithRx(c)&&0===n.startOffset?this._unwrapHeading():this._isInTable(n)?this._tableHandlerOnBackspace(n,t):this._isAfterTable(n)?t.preventDefault():this._removeHrIfNeed(n,t)):9===t.keyCode&&this._isInTaskList(n)&&(t.preventDefault(),e.eventManager.emit("command","IncreaseTask"))},o.prototype._isBeforeTable=function(t){return"TABLE"===i.getNodeName(i.getChildNodeAt(t.startContainer,t.startOffset))},o.prototype._isAfterTable=function(t){var e=i.getPrevOffsetNodeUntil(t.startContainer,t.startOffset);return"TABLE"===i.getNodeName(e)&&"BODY"===i.getNodeName(t.commonAncestorContainer)},o.prototype._tableHandlerOnBackspace=function(t,e){var n=i.getPrevOffsetNodeUntil(t.startContainer,t.startOffset,"TR"),o=i.getNodeName(n);n&&"TD"!==o&&"TH"!==o?"BR"===o&&1!==n.parentNode.childNodes.length&&(e.preventDefault(),$(n).remove()):e.preventDefault()},o.prototype._appendBrIfTdOrThNotHaveAsLastChild=function(t){var e,n,o;o=i.getNodeName(t.startContainer),"TD"===o||"TH"===o?n=t.startContainer:(e=$(t.startContainer).parentsUntil("tr"),n=e[e.length-1]),"BR"!==i.getNodeName(n.lastChild)&&"DIV"!==i.getNodeName(n.lastChild)&&$(n).append("<br>")},o.prototype._autoResizeHeightIfNeed=function(){"auto"===this._height&&this._heightToFitContents()},o.prototype._heightToFitContents=function(){this.$editorContainerEl.height(this.get$Body().height())},o.prototype._isInOrphanText=function(t){return t.startContainer.nodeType===Node.TEXT_NODE&&"BODY"===t.startContainer.parentNode.tagName},o.prototype._wrapDefaultBlockTo=function(t){var e,n,o,r;this.saveSelection(t),this._joinSplitedTextNodes(),this.restoreSavedSelection(),t=this.getEditor().getSelection().cloneRange(),n=t.startContainer,o=t.startOffset,e=this.getEditor().createDefaultBlock([t.startContainer]),r=i.getChildNodeAt(t.startContainer,t.startOffset),r?t.setStartBefore(r):t.selectNodeContents(t.startContainer),t.collapse(!0),t.insertNode(e),t.setStart(n,o),t.collapse(!0),this.getEditor().setSelection(t)},o.prototype._joinSplitedTextNodes=function(){var t,e,n,o,i=[];t=function(){return 3===this.nodeType},e=this.get$Body().contents().filter(t),e.each(function(t,e){n===e.previousSibling?(o.nodeValue+=e.nodeValue,i.push(e)):o=e,n=e}),$(i).remove()},o.prototype._wrapDefaultBlockToOrphanTexts=function(){var t,e,t=function(){return 3===this.nodeType};e=this.get$Body().contents().filter(t),e.each(function(t,e){$(e).wrap("<div />")})},o.prototype._isValueKeyCode=function(t){var e=t>=48&&90>=t,n=t>=96&&111>=t,o=t>=186&&222>=t,i=229===t;return e||n||o||i},o.prototype.saveSelection=function(t){var e=this.getEditor();t||(t=e.getSelection().cloneRange()),this.getEditor()._saveRangeToBookmark(t)},o.prototype.restoreSavedSelection=function(){var t=this.getEditor();t.setSelection(t._getRangeAndRemoveBookmark())},o.prototype.reset=function(){this._isIframeReady()||(this.remove(),this._initSquire()),this.setValue("")},o.prototype.changeBlockFormatTo=function(t){this.getEditor().changeBlockFormatTo(t),this._removeTaskInputInWrongPlace()},o.prototype.makeEmptyBlockCurrentSelection=function(){var t=this;this.getEditor().modifyBlocks(function(e){return e.textContent||(e=t.getEditor().createDefaultBlock()),e})},o.prototype.focus=function(){this.editor.focus()},o.prototype.remove=function(){this.editor.removeEventListener("focus"),this.editor.removeEventListener("blur"),this.editor.removeEventListener("keydown"),this.editor.removeEventListener("keypress"),this.editor.removeEventListener("paste"),this.editor=null,this.$body=null},o.prototype.setHeight=function(t){this._height=t,"auto"===t?(this.get$Body().css("overflow","hidden"),this.get$Body().css("height","auto"),this._heightToFitContents()):(this.get$Body().css("overflow","visible"),this.get$Body().css("height","100%"),this.$editorContainerEl.height(t))},o.prototype.setValue=function(t){this.editor.setHTML(t),this._ensurePtagContentWrappedWithDiv(),this._unwrapPtags(),this._ensureSpaceNextToTaskInput(),this._unwrapDivOnHr(),this._removeTaskListClass(),this._unwrapBlockInTable(),this._autoResizeHeightIfNeed(),this.eventManager.emit("contentChangedFromWysiwyg",this)},o.prototype._unwrapBlockInTable=function(){this.get$Body().find("td div, th div").each(function(t,e){$(e).children().unwrap()})},o.prototype._ensurePtagContentWrappedWithDiv=function(){this.get$Body().find("p").each(function(t,e){$(e).find("div").length<=0&&$(e).wrapInner("<div />"),$(e).next().is("p")&&$(e).append("<div><br></div>")})},o.prototype._unwrapPtags=function(){this.get$Body().find("div").each(function(t,e){$(e).parent().is("p")&&$(e).unwrap()})},o.prototype._unwrapDivOnHr=function(){this.get$Body().find("hr").each(function(t,e){$(e).parent().is("div")&&($(e).parent().find("br").remove(),$(e).unwrap())})},o.prototype._ensureSpaceNextToTaskInput=function(){var t,e,n;t=function(){return 3===this.nodeType},this.get$Body().find(".task-list-item").each(function(o,i){n=$(i).find("div"),n.length||(n=$(i)),e=n.contents().filter(t)[0],e&&!e.nodeValue.match(p)&&(e.nodeValue=" "+e.nodeValue)})},o.prototype._removeTaskListClass=function(){this.get$Body().find(".task-list").each(function(t,e){
$(e).removeClass("task-list")})},o.prototype.getValue=function(){var t;return this._prepareGetHTML(),t=this.editor.getHTML(),t=t.replace(/<input type="checkbox">(\s|&nbsp;)/g,'<input type="checkbox">'),t=t.replace(d,function(t,e){var n;return n="li"===e?t:"td"===e||"th"===e?"<"+e+"></"+e+">":"<br />"}),t=t.replace(u,"</$1>"),t=t.replace(/<div>/g,""),t=t.replace(/<\/div>/g,"<br />"),t=t.replace(/\<br \/\>(\<\/td\>|\<\/th\>)/g,"$1")},o.prototype._prepareGetHTML=function(){this._silentChange=!0,this.get$Body().attr("lastGetValue",Date.now()),this._addCheckedAttrToCheckedInput(),this._joinSplitedTextNodes(),this._wrapDefaultBlockToOrphanTexts()},o.prototype._addCheckedAttrToCheckedInput=function(){var t=this.getEditor().getDocument();$(t.body).find("input").each(function(t,e){e.checked?$(e).attr("checked","checked"):$(e).removeAttr("checked")})},o.prototype.getEditor=function(){return this.editor},o.prototype.replaceSelection=function(t,e){return this.getEditor().replaceSelection(t,e)},o.prototype.replaceRelativeOffset=function(t,e,n){return this.getEditor().replaceRelativeOffset(t,e,n)},o.prototype.addWidget=function(t,e,n,o){var i=this.getEditor().getSelectionPosition(t,n,o);e.parentNode!==this.$editorContainerEl[0]&&this.$editorContainerEl.append(e),$(e).css({position:"absolute",top:i.top,left:i.left})},o.prototype.get$Body=function(){return this.getEditor().get$Body()},o.prototype.hasFormatWithRx=function(t){return this.getEditor().getPath().match(t)},o.prototype._unformatTaskIfNeedOnBackspace=function(t){var e,n,o,r;e=t.startContainer,n=t.startOffset,i.isElemNode(e)?(0===n?o=i.getChildNodeAt(e,n):(o=i.getChildNodeAt(e,n-1),i.isTextNode(o)&&p.test(o.nodeValue)&&(o=i.getChildNodeAt(e,n-2))),r="INPUT"===i.getNodeName(o)):i.isTextNode(e)&&(o=e.previousSibling?e.previousSibling:e.parentNode.previousSibling,"INPUT"===o.tagName&&1===n&&p.test(e.nodeValue)&&(e.nodeValue=e.nodeValue.replace(p,""),r=!0)),r&&(this.saveSelection(t),$(o).closest("li").removeClass("task-list-item"),$(o).remove(),this.restoreSavedSelection())},o.prototype._unformatTaskIfNeedOnEnter=function(t){var e,n,o,i;e=$(t.startContainer),n=e.closest("li"),o=n.find("input:checkbox"),i=""===n.text().replace(p,""),n.length&&o.length&&i&&(this.saveSelection(t),o.remove(),n.removeClass("task-list-item"),n.text(""),this.restoreSavedSelection())},o.prototype.breakToNewDefaultBlock=function(t,e){var n,o,r,a;a=i.getChildNodeAt(t.startContainer,t.startOffset)||t.startContainer,o=$(a).parentsUntil("body"),r=o.length?o[o.length-1]:a,n=this.editor.createDefaultBlock(),"before"===e?$(r).before(n):$(r).after(n),t.setStart(n,0),t.collapse(!0),this.editor.setSelection(t)},o.prototype._isInHr=function(t){return"HR"===i.getNodeName(t.startContainer.childNodes[t.startOffset])},o.prototype._isNearHr=function(t){var e=i.getChildNodeAt(t.startContainer,t.startOffset-1);return"HR"===i.getNodeName(e)},o.prototype._removeHrIfNeed=function(t,e){var n,o;this._isInHr(t)?n=i.getChildNodeAt(t.startContainer,t.startOffset):0===t.startOffset?(n=t.startContainer.previousSibling||t.startContainer.parentNode.previousSibling,"HR"!==i.getNodeName(n)&&(n=null)):this._isNearHr(t)&&(n=i.getChildNodeAt(t.startContainer,t.startOffset-1)),n&&(e.preventDefault(),o=n.nextSibling,$(n).remove(),t.setStartBefore(o),t.collapse(!0),this.getEditor().setSelection(t))},o.prototype._removeTaskInputInWrongPlace=function(){var t=this;this.get$Body().find("input:checkbox").each(function(e,n){var o,i,r;o=$(n).parents("li").length>1||$(n).parents("li").hasClass("task-list-item"),i=!n.previousSibling,o&&i||(r=$(n).parent(),$(n).remove(),t.replaceContentText(r,p,""))})},o.prototype._unformatIncompleteTask=function(){this.get$Body().find(".task-list-item").each(function(t,e){i.isElemNode(e.firstChild)&&"INPUT"===e.firstChild.tagName||i.isElemNode(e.firstChild.firstChild)&&"INPUT"===e.firstChild.firstChild.tagName||$(e).removeClass("task-list-item")})},o.prototype.replaceContentText=function(t,e,n){var o;this._addCheckedAttrToCheckedInput(),o=$(t).html(),$(t).html(o.replace(e,n))},o.prototype._isInTaskList=function(t){var e;return t||(t=this.getEditor().getSelection().cloneRange()),e=t.startContainer.nodeType===Node.ELEMENT_NODE&&"LI"===t.startContainer.tagName?t.startContainer:$(t.startContainer).parents("li")[0],$(e).hasClass("task-list-item")},o.prototype._unwrapHeading=function(){this.unwrapBlockTag(function(t){return c.test(t)})},o.prototype.unwrapBlockTag=function(t){t||(t=function(t){return h.test(t)}),this.getEditor().changeBlockFormat(t),this._removeTaskInputInWrongPlace()},o.prototype.insertSelectionMarker=function(t){return this._selectionMarker.insertMarker(t,this.getEditor())},o.prototype.restoreSelectionMarker=function(){return this._selectionMarker.restore(this.getEditor())},o.prototype.postProcessForChange=function(){var t=this;setTimeout(function(){t._silentChange=!0,t._unformatIncompleteTask(),t._ensureSpaceNextToTaskInput(),t._unwrapBlockInTable(),t=null},0)},o.prototype._isInTable=function(t){var e;return e=t.collapsed?t.startContainer:t.commonAncestorContainer,!!$(e).closest("table").length},e.exports=o},{"./domUtils":8,"./squireExt":36,"./wwClipboardManager":49,"./wwSelectionMarker":50}]},{},[19]);