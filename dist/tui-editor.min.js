!function e(t,o,n){function i(s,l){if(!o[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){var o=t[s][1][e];return i(o?o:e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,o){"use strict";tui.util.defineNamespace("tui.component.colorpicker",{domutil:e("./src/js/core/domutil"),domevent:e("./src/js/core/domevent"),Collection:e("./src/js/core/collection"),View:e("./src/js/core/view"),Drag:e("./src/js/core/drag"),create:e("./src/js/factory"),Palette:e("./src/js/palette"),Slider:e("./src/js/slider"),colorutil:e("./src/js/colorutil"),svgvml:e("./src/js/svgvml")})},{"./src/js/colorutil":2,"./src/js/core/collection":3,"./src/js/core/domevent":4,"./src/js/core/domutil":5,"./src/js/core/drag":6,"./src/js/core/view":7,"./src/js/factory":8,"./src/js/palette":10,"./src/js/slider":11,"./src/js/svgvml":12}],2:[function(e,t,o){"use strict";var n=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,i={leadingZero:function(e,t){var o="",n=0;if((e+"").length>t)return e+"";for(;n<t-1;n+=1)o+="0";return(o+e).slice(t*-1)},isValidRGB:function(e){return n.test(e)},hexToRGB:function(e){var t,o,n;return!!i.isValidRGB(e)&&(e=e.substring(1),t=parseInt(e.substr(0,2),16),o=parseInt(e.substr(2,2),16),n=parseInt(e.substr(4,2),16),[t,o,n])},rgbToHEX:function(e,t,o){var n="#"+i.leadingZero(e.toString(16),2)+i.leadingZero(t.toString(16),2)+i.leadingZero(o.toString(16),2);return!!i.isValidRGB(n)&&n},rgbToHSV:function(e,t,o){var n,i,r,s,l,a;if(e/=255,t/=255,o/=255,n=Math.max(e,t,o),i=Math.min(e,t,o),l=n,a=n-i,s=0===n?0:a/n,n===i)r=0;else{switch(n){case e:r=(t-o)/a+(t<o?6:0);break;case t:r=(o-e)/a+2;break;case o:r=(e-t)/a+4}r/=6}return[Math.round(360*r),Math.round(100*s),Math.round(100*l)]},hsvToRGB:function(e,t,o){var n,i,r,s,l,a,c,u;if(e=Math.max(0,Math.min(360,e)),t=Math.max(0,Math.min(100,t)),o=Math.max(0,Math.min(100,o)),t/=100,o/=100,0===t)return n=i=r=o,[Math.round(255*n),Math.round(255*i),Math.round(255*r)];switch(e/=60,s=Math.floor(e),l=e-s,a=o*(1-t),c=o*(1-t*l),u=o*(1-t*(1-l)),s){case 0:n=o,i=u,r=a;break;case 1:n=c,i=o,r=a;break;case 2:n=a,i=o,r=u;break;case 3:n=a,i=c,r=o;break;case 4:n=u,i=a,r=o;break;default:n=o,i=a,r=c}return[Math.round(255*n),Math.round(255*i),Math.round(255*r)]}};t.exports=i},{}],3:[function(e,t,o){(function(e){"use strict";function o(e){this.items={},this.length=0,s(e)&&(this.getItemID=e)}var n=e.tui.util,i=n.forEachOwnProperties,r=n.forEachArray,s=n.isFunction,l=n.isObject,a=Array.prototype.slice;o.and=function(e){var t;return e=a.call(arguments),t=e.length,function(o){for(var n=0;n<t;n+=1)if(!e[n].call(null,o))return!1;return!0}},o.or=function(e){var t;return e=a.call(arguments),t=e.length,function(o){for(var n=1,i=e[0].call(null,o);n<t;n+=1)i=i||e[n].call(null,o);return i}},o.merge=function(e){var t=a.call(arguments),i={},s=new o(t[0].getItemID),l=n.extend;return r(t,function(e){l(i,e.items)}),s.items=i,s.length=n.keys(s.items).length,s},o.prototype.getItemID=function(e){return e._id+""},o.prototype.add=function(e){var t,o;return arguments.length>1?void r(a.call(arguments),function(e){this.add(e)},this):(t=this.getItemID(e),o=this.items,o[t]||(this.length+=1),void(o[t]=e))},o.prototype.remove=function(e){var t,o,i=[];return this.length?arguments.length>1?i=n.map(a.call(arguments),function(e){return this.remove(e)},this):(t=this.items,l(e)&&(e=this.getItemID(e)),t[e]?(this.length-=1,o=t[e],delete t[e],o):i):i},o.prototype.clear=function(){this.items={},this.length=0},o.prototype.has=function(e){var t,o;return!!this.length&&(t=s(e),o=!1,t?this.each(function(t){if(e(t)===!0)return o=!0,!1}):(e=l(e)?this.getItemID(e):e,o=n.isExisty(this.items[e])),o)},o.prototype.doWhenHas=function(e,t,o){var i=this.items[e];n.isExisty(i)&&t.call(o||this,i)},o.prototype.find=function(e){var t=new o;return this.hasOwnProperty("getItemID")&&(t.getItemID=this.getItemID),this.each(function(o){e(o)===!0&&t.add(o)}),t},o.prototype.groupBy=function(e,t){var i,r,s={},l=n.isFunction,a=l(e),c=this.getItemID;if(n.isArray(e)){if(n.forEachArray(e,function(e){s[e+""]=new o(c)}),!t)return s;e=t,a=!0}return this.each(function(t){a?r=e(t):(r=t[e],l(r)&&(r=r.apply(t))),i=s[r],i||(i=s[r]=new o(c)),i.add(t)}),s},o.prototype.single=function(){var e;return this.each(function(t){return e=t,!1},this),e},o.prototype.sort=function(e){var t=[];return this.each(function(e){t.push(e)}),s(e)&&(t=t.sort(e)),t},o.prototype.each=function(e,t){i(this.items,e,t||this)},o.prototype.toArray=function(){return this.length?n.map(this.items,function(e){return e}):[]},t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,o){(function(e){"use strict";var o=e.tui.util,n=o.browser,i="_evt",r={START:["touchstart","mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},s={on:function(e,t,n,i){return o.isString(t)?void o.forEach(t.split(" "),function(t){s._on(e,t,n,i)}):void o.forEachOwnProperties(t,function(t,o){s._on(e,o,t,n)})},_on:function(e,t,n,r){var l,a,c;l=t+o.stamp(n)+(r?"_"+o.stamp(r):""),e[i]&&e[i][l]||(a=function(t){n.call(r||e,t||window.event)},c=a,"addEventListener"in e?"mouseenter"===t||"mouseleave"===t?(a=function(t){t=t||window.event,s._checkMouse(e,t)&&c(t)},e.addEventListener("mouseenter"===t?"mouseover":"mouseout",a,!1)):("mousewheel"===t&&e.addEventListener("DOMMouseScroll",a,!1),e.addEventListener(t,a,!1)):"attachEvent"in e&&e.attachEvent("on"+t,a),e[i]=e[i]||{},e[i][l]=a)},off:function(e,t,n,i){return o.isString(t)?void o.forEach(t.split(" "),function(t){s._off(e,t,n,i)}):void o.forEachOwnProperties(t,function(t,o){s._off(e,o,t,n)})},_off:function(e,t,n,r){var s=t+o.stamp(n)+(r?"_"+o.stamp(r):""),l=e[i]&&e[i][s];if(l){if("removeEventListener"in e)"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",l,!1):("mousewheel"===t&&e.removeEventListener("DOMMouseScroll",l,!1),e.removeEventListener(t,l,!1));else if("detachEvent"in e)try{e.detachEvent("on"+t,l)}catch(a){}if(delete e[i][s],!o.keys(e[i]).length)return o.browser.msie&&o.browser.version<9?void(e[i]=null):void delete e[i]}},once:function(e,t,n,i){function r(){n.apply(i||e,arguments),l._off(e,t,r,i)}var l=this;return o.isObject(t)?void o.forEachOwnProperties(t,function(t,o){s.once(e,o,t,n)}):void s.on(e,t,r,i)},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stop:function(e){s.preventDefault(e),s.stopPropagation(e)},disableScrollPropagation:function(e){s.on(e,"mousewheel MozMousePixelScroll",s.stopPropagation)},disableClickPropagation:function(e){s.on(e,r.START.join(" ")+" click dblclick",s.stopPropagation)},getMousePosition:function(e,t){var o;return t?(o=t.getBoundingClientRect(),[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]):[e.clientX,e.clientY]},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_checkMouse:function(e,t){var o=t.relatedTarget;if(!o)return!0;try{for(;o&&o!==e;)o=o.parentNode}catch(n){return!1}return o!==e},trigger:function(e,t,n){var i=/(mouse|click)/;o.isUndefined(n)&&i.exec(t)&&(n=s.mouseEvent(t)),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent&&e.fireEvent("on"+t,n)},mouseEvent:function(e,t){var i,r;return r=o.extend({bubbles:!0,cancelable:"mousemove"!==e,view:window,wheelDelta:0,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},t),n.msie&&n.version<9&&delete r.wheelDelta,"function"==typeof document.createEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(e,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,document.body.parentNode)):document.createEventObject&&(i=document.createEventObject(),o.forEach(r,function(e,t){i[t]=e},this),i.button={0:1,1:4,2:2}[i.button]||i.button),i},getMouseButton:function(e){var t,o="0,1,3,5,7",n="2,6",i="4";return document.implementation.hasFeature("MouseEvents","2.0")?e.button:(t=e.button+"",~o.indexOf(t)?0:~n.indexOf(t)?2:~i.indexOf(t)?1:void 0)}};t.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,o){(function(o){"use strict";function n(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var i,r=e("./domevent"),s=e("./collection"),l=o.tui.util,a="_pos",c=/^auto$|^$|%/;i={appendHTMLElement:function(e,t,o){var n;return o=o||"",n=document.createElement(e),n.className=o,t?t.appendChild(n):document.body.appendChild(n),n},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},get:function(e){return document.getElementById(e)},_matcher:function(e,t){var o=/^\./,n=/^#/;return o.test(t)?i.hasClass(e,t.replace(".","")):n.test(t)?e.id===t.replace("#",""):e.nodeName.toLowerCase()===t.toLowerCase()},find:function(e,t,o){function n(e,t){for(var l,u=e.childNodes,d=0,f=u.length;d<f;d+=1)if(l=u[d],"#text"!==l.nodeName)if(i._matcher(l,t)){if((c&&o(l)||!c)&&r.push(l),a){s=!0;break}}else if(l.childNodes.length>0&&(n(l,t),s))break}var r=[],s=!1,a=l.isUndefined(o)||o===!1,c=l.isFunction(o);return l.isString(t)&&(t=i.get(t)),t=t||window.document.body,n(t,e),a?r[0]||null:r},closest:function(e,t){var o=e.parentNode;if(i._matcher(e,t))return e;for(;o&&o!==window.document.body;){if(i._matcher(o,t))return o;o=o.parentNode}},text:function(e){var t="",o=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)t+=i.text(e)}else if(3===n||4===n)return e.nodeValue}else for(;e[o];o+=1)t+=i.text(e[o]);return t},setData:function(e,t,o){return"dataset"in e?void(e.dataset[t]=o):void e.setAttribute("data-"+t,o)},getData:function(e,t){return"dataset"in e?e.dataset[t]:e.getAttribute("data-"+t)},hasClass:function(e,t){var o;return l.isUndefined(e.classList)?(o=i.getClass(e),o.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(o)):e.classList.contains(t)},addClass:function(e,t){var o;l.isUndefined(e.classList)?i.hasClass(e,t)||(o=i.getClass(e),i.setClass(e,(o?o+" ":"")+t)):l.forEachArray(t.split(" "),function(t){e.classList.add(t)})},setClass:function(e,t){l.isUndefined(e.className.baseVal)?e.className=t:e.className.baseVal=t},removeClass:function(e,t){var o="";l.isUndefined(e.classList)?(o=(" "+i.getClass(e)+" ").replace(" "+t+" "," "),i.setClass(e,n(o))):e.classList.remove(t)},getClass:function(e){return e&&e.className?l.isUndefined(e.className.baseVal)?e.className:e.className.baseVal:""},getStyle:function(e,t){var o,n=e.style[t]||e.currentStyle&&e.currentStyle[t];return n&&"auto"!==n||!document.defaultView||(o=document.defaultView.getComputedStyle(e,null),n=o?o[t]:null),"auto"===n?null:n},getComputedStyle:function(e){var t=document.defaultView;return t&&t.getComputedStyle?document.defaultView.getComputedStyle(e):{getPropertyValue:function(t){var o=/(\-([a-z]){1})/g;return"float"===t&&(t="styleFloat"),o.test(t)&&(t=t.replace(o,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null}}},setPosition:function(e,t,o){t=l.isUndefined(t)?0:t,o=l.isUndefined(o)?0:o,e[a]=[t,o],e.style.left=t+"px",e.style.top=o+"px"},getPosition:function(e,t){var o,n,i;return t&&(e[a]=null),e[a]?e[a]:(o=0,n=0,(c.test(e.style.left)||c.test(e.style.top))&&"getBoundingClientRect"in e?(i=e.getBoundingClientRect(),o=i.left,n=i.top):(o=parseFloat(e.style.left||0),n=parseFloat(e.style.top||0)),[o,n])},getSize:function(e){var t,o=i.getStyle(e,"width"),n=i.getStyle(e,"height");return(c.test(o)||c.test(n))&&"getBoundingClientRect"in e?(t=e.getBoundingClientRect(),o=t.width,n=t.height):(o=parseFloat(o||0),n=parseFloat(n||0)),[o,n]},testProp:function(e){for(var t=document.documentElement.style,o=0,n=e.length;o<n;o+=1)if(e[o]in t)return e[o];return!1},getFormData:function(e){var t=new s(function(){return this.length}),o=function(e){return!e.disabled},n={};return t.add.apply(t,i.find("input",e,o).concat(i.find("select",e,o)).concat(i.find("textarea",e,o))),t=t.groupBy(function(e){return e&&e.getAttribute("name")||"_other"}),l.forEach(t,function(e,t){"_other"!==t&&e.each(function(o){var r=o.nodeName.toLowerCase(),s=o.type,a=[];"radio"===s?a=[e.find(function(e){return e.checked}).toArray().pop()]:"checkbox"===s?a=e.find(function(e){return e.checked}).toArray():"select"===r?e.find(function(e){return!!e.childNodes.length}).each(function(e){a=a.concat(i.find("option",e,function(e){return e.selected}))}):a=e.find(function(e){return""!==e.value}).toArray(),a=l.map(a,function(e){return e.value}),a.length?1===a.length&&(a=a[0]):a="",n[t]=a})}),n}};var u=i.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]),d="onselectstart"in document,f="";i.disableTextSelection=function(){return d?function(){r.on(window,"selectstart",r.preventDefault)}:function(){var e=document.documentElement.style;f=e[u],e[u]="none"}}(),i.enableTextSelection=function(){return d?function(){r.off(window,"selectstart",r.preventDefault)}:function(){document.documentElement.style[u]=f}}(),i.disableImageDrag=function(){r.on(window,"dragstart",r.preventDefault)},i.enableImageDrag=function(){r.off(window,"dragstart",r.preventDefault)},t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./collection":3,"./domevent":4}],6:[function(e,t,o){(function(o){"use strict";function n(e,t){s.on(t,"mousedown",this._onMouseDown,this),this.options=i.extend({distance:10},e),this.container=t,this._isMoved=!1,this._distance=0,this._dragStartFired=!1,this._dragStartEventData=null}var i=o.tui.util,r=e("./domutil"),s=e("./domevent");n.prototype.destroy=function(){s.off(this.container,"mousedown",this._onMouseDown,this),this.options=this.container=this._isMoved=this._distance=this._dragStartFired=this._dragStartEventData=null},n.prototype._toggleDragEvent=function(e){var t,n,i=this.container;e?(t="on",n="disable"):(t="off",n="enable"),r[n+"TextSelection"](i),r[n+"ImageDrag"](i),s[t](o.document,{mousemove:this._onMouseMove,mouseup:this._onMouseUp},this)},n.prototype._getEventData=function(e){return{target:e.target||e.srcElement,originEvent:e}},n.prototype._onMouseDown=function(e){0===s.getMouseButton(e)&&(this._distance=0,this._dragStartFired=!1,this._dragStartEventData=this._getEventData(e),this._toggleDragEvent(!0))},n.prototype._onMouseMove=function(e){var t=this.options.distance;return s.preventDefault(e),this._isMoved=!0,this._distance<t?void(this._distance+=1):this._dragStartFired||(this._dragStartFired=!0,this.invoke("dragStart",this._dragStartEventData))?void this.fire("drag",this._getEventData(e)):void this._toggleDragEvent(!1)},n.prototype._onMouseUp=function(e){return this._toggleDragEvent(!1),this._isMoved?(this._isMoved=!1,void this.fire("dragEnd",this._getEventData(e))):void this.fire("click",this._getEventData(e))},i.CustomEvents.mixin(n),t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./domevent":4,"./domutil":5}],7:[function(e,t,o){(function(o){"use strict";function n(e,t){var o=i.stamp(this);e=e||{},i.isUndefined(t)&&(t=r.appendHTMLElement("div")),r.addClass(t,"tui-view-"+o),this.id=o,this.container=t,this.childs=new s(function(e){return i.stamp(e)}),this.parent=null}var i=o.tui.util,r=e("./domutil"),s=e("./collection");n.prototype.addChild=function(e,t){t&&t.call(e,this),e.parent=this,this.childs.add(e)},n.prototype.removeChild=function(e,t){var o=i.isNumber(e)?this.childs.items[e]:e;e=i.stamp(o),t&&t.call(o,this),this.childs.remove(e)},n.prototype.render=function(){this.childs.each(function(e){e.render()})},n.prototype.recursive=function(e,t){i.isFunction(e)&&(t||e(this),this.childs.each(function(t){t.recursive(e)}))},n.prototype.resize=function(){for(var e=Array.prototype.slice.call(arguments),t=this.parent;t;)i.isFunction(t._onResize)&&t._onResize.apply(t,e),t=t.parent},n.prototype._beforeDestroy=function(){},n.prototype._destroy=function(){this._beforeDestroy(),this.childs.clear(),this.container.innerHTML="",this.id=this.parent=this.childs=this.container=null},n.prototype.destroy=function(e){this.childs.each(function(e){e.destroy(!0),e._destroy()}),e||this._destroy()},n.prototype.getViewBound=function(){var e=this.container,t=r.getPosition(e),o=r.getSize(e);return{x:t[0],y:t[1],width:o[0],height:o[1]}},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./collection":3,"./domutil":5}],8:[function(e,t,o){(function(o){"use strict";function n(e){alert(e)}function i(e){var t;return this instanceof i?(e=this.options=r.extend({container:null,color:"#f8f8f8",preset:["#181818","#282828","#383838","#585858","#b8b8b8","#d8d8d8","#e8e8e8","#f8f8f8","#ab4642","#dc9656","#f7ca88","#a1b56c","#86c1b9","#7cafc2","#ba8baf","#a16946"],cssPrefix:"tui-colorpicker-",detailTxt:"Detail"},e),e.container?(t=this.layout=new l(e,e.container),this.palette=new a(e,t.container),this.palette.on({_selectColor:this._onSelectColorInPalette,_toggleSlider:this._onToggleSlider},this),this.slider=new c(e,t.container),this.slider.on("_selectColor",this._onSelectColorInSlider,this),t.addChild(this.palette),t.addChild(this.slider),void this.render(e.color)):void n("Colorpicker(): need container option.")):new i(e)}var r=o.tui.util,s=e("./colorutil"),l=e("./layout"),a=e("./palette"),c=e("./slider");i.prototype._onSelectColorInPalette=function(e){var t=e.color,o=this.options;return s.isValidRGB(t)?(this.fire("selectColor",{color:t,origin:"palette"}),void(o.color!==t&&(o.color=t,this.render(t)))):void this.render()},i.prototype._onToggleSlider=function(){this.slider.toggle(!this.slider.isVisible())},i.prototype._onSelectColorInSlider=function(e){var t=e.color,o=this.options;this.fire("selectColor",{color:t,origin:"slider"}),o.color!==t&&(o.color=t,this.palette.render(t))},i.prototype.setColor=function(e){s.isValidRGB(e)||n("Colorpicker#setColor(): need valid hex string color value"),this.options.color=e,this.render(e)},i.prototype.getColor=function(){return this.options.color},i.prototype.toggle=function(e){this.layout.container.style.display=e?"block":"none"},i.prototype.render=function(e){this.layout.render(e||this.options.color)},i.prototype.destroy=function(){this.layout.destroy(),this.options.container.innerHTML="",this.layout=this.slider=this.palette=this.options=null},r.CustomEvents.mixin(i),t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./colorutil":2,"./layout":9,"./palette":10,"./slider":11}],9:[function(e,t,o){(function(o){"use strict";function n(e,t){this.options=i.extend({cssPrefix:"tui-colorpicker-"},e),t=r.appendHTMLElement("div",t,this.options.cssPrefix+"container"),s.call(this,e,t),this.render()}var i=o.tui.util,r=e("./core/domutil"),s=e("./core/view");i.inherit(n,s),n.prototype.render=function(e){this.recursive(function(t){t.render(e)},!0)},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core/domutil":5,"./core/view":7}],10:[function(e,t,o){(function(o){"use strict";function n(e,t){this.options=i.extend({cssPrefix:"tui-colorpicker-",preset:["#181818","#282828","#383838","#585858","#B8B8B8","#D8D8D8","#E8E8E8","#F8F8F8","#AB4642","#DC9656","#F7CA88","#A1B56C","#86C1B9","#7CAFC2","#BA8BAF","#A16946"],detailTxt:"Detail"},e),t=r.appendHTMLElement("div",t,this.options.cssPrefix+"palette-container"),l.call(this,e,t)}var i=o.tui.util,r=e("./core/domutil"),s=e("./core/domevent"),l=e("./core/view"),a=e("../template/palette");i.inherit(n,l),n.prototype._onClick=function(e){var t=this.options,o=e.srcElement||e.target,n={};return r.hasClass(o,t.cssPrefix+"palette-button")?(n.color=o.value,void this.fire("_selectColor",n)):void(r.hasClass(o,t.cssPrefix+"palette-toggle-slider")&&this.fire("_toggleSlider"))},n.prototype._onChange=function(e){var t=this.options,o=e.srcElement||e.target,n={};if(r.hasClass(o,t.cssPrefix+"palette-hex"))return n.color=o.value,void this.fire("_selectColor",n)},n.prototype._beforeDestroy=function(){this._toggleEvent(!1)},n.prototype._toggleEvent=function(e){var t,o=this.options,n=this.container,i=s[e?"on":"off"];i(n,"click",this._onClick,this),t=r.find("."+o.cssPrefix+"palette-hex",n),t&&i(t,"change",this._onChange,this)},n.prototype.render=function(e){var t=this.options,o="";this._toggleEvent(!1),o=a.layout.replace("{{colorList}}",i.map(t.preset,function(o){var n=a.item.replace(/{{color}}/g,o);return n=n.replace("{{selected}}",o===e?" "+t.cssPrefix+"selected":"")}).join("")),o=o.replace(/{{cssPrefix}}/g,t.cssPrefix).replace("{{detailTxt}}",t.detailTxt).replace(/{{color}}/g,e),this.container.innerHTML=o,this._toggleEvent(!0)},i.CustomEvents.mixin(n),t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../template/palette":13,"./core/domevent":4,"./core/domutil":5,"./core/view":7}],11:[function(e,t,o){(function(o){"use strict";function n(e,t){t=r.appendHTMLElement("div",t,e.cssPrefix+"slider-container"),t.style.display="none",c.call(this,e,t),this.options=i.extend({color:"#f8f8f8",cssPrefix:"tui-colorpicker-"},e),this._dragDataCache={},this.sliderHandleElement=null,this.huebarHandleElement=null,this.baseColorElement=null,this.drag=new u({distance:0},t),this.drag.on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd,click:this._onClick},this)}var i=o.tui.util,r=e("./core/domutil"),s=e("./core/domevent"),l=e("./svgvml"),a=e("./colorutil"),c=e("./core/view"),u=e("./core/drag"),d=e("../template/slider"),f=[-7,112],p=[-3,115],h=359.99;i.inherit(n,c),n.prototype._beforeDestroy=function(){this.drag.off(),this.drag=this.options=this._dragDataCache=this.sliderHandleElement=this.huebarHandleElement=this.baseColorElement=null},n.prototype.toggle=function(e){this.container.style.display=e?"block":"none"},n.prototype.isVisible=function(){return"block"===this.container.style.display},n.prototype.render=function(e){var t,o,n=this,i=n.container,s=n.options,l=d.layout;l=l.replace(/{{slider}}/,d.slider),l=l.replace(/{{huebar}}/,d.huebar),l=l.replace(/{{cssPrefix}}/g,s.cssPrefix),n.container.innerHTML=l,n.sliderHandleElement=r.find("."+s.cssPrefix+"slider-handle",i),n.huebarHandleElement=r.find("."+s.cssPrefix+"huebar-handle",i),n.baseColorElement=r.find("."+s.cssPrefix+"slider-basecolor",i),t=a.hexToRGB(e),o=a.rgbToHSV.apply(null,t),this.moveHue(o[0],!0),this.moveSaturationAndValue(o[1],o[2],!0)},n.prototype._moveColorSliderHandle=function(e,t,o){var n,i=this.sliderHandleElement;t=Math.max(f[0],t),t=Math.min(f[1],t),e=Math.max(f[0],e),e=Math.min(f[1],e),l.setTranslateXY(i,e,t),n=t>50?"white":"black",l.setStrokeColor(i,n),o||this.fire("_selectColor",{color:a.rgbToHEX.apply(null,this.getRGB())})},n.prototype.moveSaturationAndValue=function(e,t,o){var n,i,r,s;e=e||0,t=t||0,n=Math.abs(f[0]),i=f[1],r=e*i/100-n,s=i-t*i/100-n,this._moveColorSliderHandle(r,s,o)},n.prototype._moveColorSliderByPosition=function(e,t){var o=f[0];this._moveColorSliderHandle(e+o,t+o)},n.prototype.getSaturationAndValue=function(){var e,t,o=Math.abs(f[0]),n=o+f[1],i=l.getTranslateXY(this.sliderHandleElement);return e=(i[1]+o)/n*100,t=100-(i[0]+o)/n*100,[e,t]},n.prototype._moveHueHandle=function(e,t){var o,n,i=this.huebarHandleElement,r=this.baseColorElement;e=Math.max(p[0],e),e=Math.min(p[1],e),l.setTranslateY(i,e),o=a.hsvToRGB(this.getHue(),100,100),n=a.rgbToHEX.apply(null,o),l.setGradientColorStop(r,n),t||this.fire("_selectColor",{color:a.rgbToHEX.apply(null,this.getRGB())})},n.prototype.moveHue=function(e,t){var o,n,i=0;o=Math.abs(p[0]),n=o+p[1],e=e||0,i=n*e/h-o,this._moveHueHandle(i,t)},n.prototype._moveHueByPosition=function(e){var t=p[0];this._moveHueHandle(e+t)},n.prototype.getHue=function(){var e,t,o=this.huebarHandleElement,n=l.getTranslateXY(o);return e=Math.abs(p[0]),t=e+p[1],(n[0]+e)*h/t},n.prototype.getHSV=function(){var e=this.getSaturationAndValue(),t=this.getHue();return[t].concat(e)},n.prototype.getRGB=function(){return a.hsvToRGB.apply(null,this.getHSV())},n.prototype._prepareColorSliderForMouseEvent=function(e){var t,o=this.options,n=r.closest(e.target,"."+o.cssPrefix+"slider-part");return t=this._dragDataCache={isColorSlider:r.hasClass(n,o.cssPrefix+"slider-left"),parentElement:n}},n.prototype._onClick=function(e){var t=this._prepareColorSliderForMouseEvent(e),o=s.getMousePosition(e.originEvent,t.parentElement);t.isColorSlider?this._moveColorSliderByPosition(o[0],o[1]):this._moveHueByPosition(o[1]),this._dragDataCache=null},n.prototype._onDragStart=function(e){this._prepareColorSliderForMouseEvent(e)},n.prototype._onDrag=function(e){var t=this._dragDataCache,o=s.getMousePosition(e.originEvent,t.parentElement);t.isColorSlider?this._moveColorSliderByPosition(o[0],o[1]):this._moveHueByPosition(o[1])},n.prototype._onDragEnd=function(){this._dragDataCache=null},i.CustomEvents.mixin(n),t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../template/slider":14,"./colorutil":2,"./core/domevent":4,"./core/domutil":5,"./core/drag":6,"./core/view":7,"./svgvml":12}],12:[function(e,t,o){(function(e){"use strict";var o=e.tui.util,n=/[\.\-0-9]+/g,i=-6,r={isOldBrowser:function(){var e=r._isOldBrowser;return o.isExisty(e)||(r._isOldBrowser=e=o.browser.msie&&o.browser.version<9),e},getTranslateXY:function(e){var t;return r.isOldBrowser()?(t=e.style,[parseFloat(t.top),parseFloat(t.left)]):(t=e.getAttribute("transform"))?(t=t.match(n),[parseFloat(t[1]),parseFloat(t[0])]):[0,0]},setTranslateXY:function(e,t,o){r.isOldBrowser()?(e.style.left=t+"px",e.style.top=o+"px"):e.setAttribute("transform","translate("+t+","+o+")")},setTranslateY:function(e,t){r.isOldBrowser()?e.style.top=t+"px":e.setAttribute("transform","translate("+i+","+t+")")},setStrokeColor:function(e,t){r.isOldBrowser()?e.strokecolor=t:e.setAttribute("stroke",t)},setGradientColorStop:function(e,t){r.isOldBrowser()?e.color=t:e.setAttribute("stop-color",t)}};t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t,o){"use strict";var n=['<ul class="{{cssPrefix}}clearfix">{{colorList}}</ul>','<div class="{{cssPrefix}}clearfix" style="overflow:hidden">','<input type="button" class="{{cssPrefix}}palette-toggle-slider" value="{{detailTxt}}" />','<input type="text" class="{{cssPrefix}}palette-hex" value="{{color}}" maxlength="7" />','<span class="{{cssPrefix}}palette-preview" style="background-color:{{color}};color:{{color}}">{{color}}</span>',"</div>"].join("\n"),i='<li><input class="{{cssPrefix}}palette-button{{selected}}" type="button" style="background-color:{{color}};color:{{color}}" title="{{color}}" value="{{color}}" /></li>';t.exports={layout:n,item:i}},{}],14:[function(e,t,o){(function(e){"use strict";var o=e.tui.util,n=['<div class="{{cssPrefix}}slider-left {{cssPrefix}}slider-part">{{slider}}</div>','<div class="{{cssPrefix}}slider-right {{cssPrefix}}slider-part">{{huebar}}</div>'].join("\n"),i=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-slider">',"<defs>",'<linearGradient id="{{cssPrefix}}svg-fill-color" x1="0%" y1="0%" x2="100%" y2="0%">','<stop offset="0%" stop-color="rgb(255,255,255)" />','<stop class="{{cssPrefix}}slider-basecolor" offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>",'<linearGradient id="{{cssPrefix}}svn-fill-black" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:0" />','<stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />',"</linearGradient>","</defs>",'<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svg-fill-color)"></rect>','<rect width="100%" height="100%" fill="url(#{{cssPrefix}}svn-fill-black)"></rect>','<path transform="translate(0,0)" class="{{cssPrefix}}slider-handle" d="M0 7.5 L15 7.5 M7.5 15 L7.5 0 M2 7 a5.5 5.5 0 1 1 0 1 Z" stroke="black" stroke-width="0.75" fill="none" />',"</svg>"].join("\n"),r=['<div class="{{cssPrefix}}vml-slider">','<v:rect strokecolor="none" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill class="{{cssPrefix}}vml {{cssPrefix}}slider-basecolor" type="gradient" method="none" color="#ff0000" color2="#fff" angle="90" />',"</v:rect>",'<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-slider-bg">','<v:fill type="gradient" method="none" color="black" color2="white" o:opacity2="0%" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}slider-handle" coordsize="1 1" style="width:1px;height:1px;"path="m 0,7 l 14,7 m 7,14 l 7,0 ar 12,12 2,2 z" filled="false" stroked="true" />',"</div>"].join("\n"),s=['<svg class="{{cssPrefix}}svg {{cssPrefix}}svg-huebar">',"<defs>",'<linearGradient id="g" x1="0%" y1="0%" x2="0%" y2="100%">','<stop offset="0%" stop-color="rgb(255,0,0)" />','<stop offset="16.666%" stop-color="rgb(255,255,0)" />','<stop offset="33.333%" stop-color="rgb(0,255,0)" />','<stop offset="50%" stop-color="rgb(0,255,255)" />','<stop offset="66.666%" stop-color="rgb(0,0,255)" />','<stop offset="83.333%" stop-color="rgb(255,0,255)" />','<stop offset="100%" stop-color="rgb(255,0,0)" />',"</linearGradient>","</defs>",'<rect width="18px" height="100%" fill="url(#g)"></rect>','<path transform="translate(-6,-3)" class="{{cssPrefix}}huebar-handle" d="M0 0 L4 4 L0 8 L0 0 Z" fill="black" stroke="none" />',"</svg>"].join("\n"),l=['<div class="{{cssPrefix}}vml-huebar">','<v:rect strokecolor="#ccc" class="{{cssPrefix}}vml {{cssPrefix}}vml-huebar-bg">','<v:fill type="gradient" method="none" colors="0% rgb(255,0,0), 16.666% rgb(255,255,0), 33.333% rgb(0,255,0), 50% rgb(0,255,255), 66.666% rgb(0,0,255), 83.333% rgb(255,0,255), 100% rgb(255,0,0)" angle="180" class="{{cssPrefix}}vml" />',"</v:rect>",'<v:shape class="{{cssPrefix}}vml {{cssPrefix}}huebar-handle" coordsize="1 1" style="width:1px;height:1px;position:absolute;z-index:1;right:22px;top:-3px;"path="m 0,0 l 4,4 l 0,8 l 0,0 z" filled="true" fillcolor="black" stroked="false" />',"</div>"].join("\n"),a=o.browser.msie&&o.browser.version<9;a&&e.document.namespaces.add("v","urn:schemas-microsoft-com:vml"),t.exports={layout:n,slider:a?r:i,huebar:a?l:s}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)})([function(module,exports,__webpack_require__){"use strict";var _editor=__webpack_require__(1);var _editor2=_interopRequireDefault(_editor);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}__webpack_require__(92);__webpack_require__(93);__webpack_require__(94);__webpack_require__(95);__webpack_require__(96);__webpack_require__(97);__webpack_require__(98);__webpack_require__(101)
;__webpack_require__(102);__webpack_require__(109);window.tui=window.tui||{};window.tui.Editor=_editor2.default;__webpack_require__(127);__webpack_require__(128);__webpack_require__(129);__webpack_require__(130);__webpack_require__(131);$.fn.tuiEditor=function(){var options=void 0,instance=void 0;var el=this[0];if(el){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}options=args[0]||{};instance=$.data(el,"tuiEditor");if(instance){if(typeof options==="string"){var _instance;return(_instance=instance)[options].apply(_instance,_toConsumableArray(args.slice(1)))}}else{options.el=el;instance=_editor2.default.factory(options);$.data(el,"tuiEditor",instance)}}return this}},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _markdownEditor=__webpack_require__(2);var _markdownEditor2=_interopRequireDefault(_markdownEditor);var _preview=__webpack_require__(7);var _preview2=_interopRequireDefault(_preview);var _wysiwygEditor=__webpack_require__(10);var _wysiwygEditor2=_interopRequireDefault(_wysiwygEditor);var _layout=__webpack_require__(26);var _layout2=_interopRequireDefault(_layout);var _eventManager=__webpack_require__(27);var _eventManager2=_interopRequireDefault(_eventManager);var _commandManager2=__webpack_require__(28);var _commandManager3=_interopRequireDefault(_commandManager2);var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _importManager=__webpack_require__(31);var _importManager2=_interopRequireDefault(_importManager);var _codeBlockManager=__webpack_require__(9);var _codeBlockManager2=_interopRequireDefault(_codeBlockManager);var _convertor=__webpack_require__(32);var _convertor2=_interopRequireDefault(_convertor);var _viewOnly=__webpack_require__(39);var _viewOnly2=_interopRequireDefault(_viewOnly);var _defaultUI=__webpack_require__(40);var _defaultUI2=_interopRequireDefault(_defaultUI);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);var _bold=__webpack_require__(54);var _bold2=_interopRequireDefault(_bold);var _italic=__webpack_require__(55);var _italic2=_interopRequireDefault(_italic);var _strike=__webpack_require__(56);var _strike2=_interopRequireDefault(_strike);var _blockquote=__webpack_require__(57);var _blockquote2=_interopRequireDefault(_blockquote);var _heading=__webpack_require__(58);var _heading2=_interopRequireDefault(_heading);var _paragraph=__webpack_require__(59);var _paragraph2=_interopRequireDefault(_paragraph);var _hr=__webpack_require__(60);var _hr2=_interopRequireDefault(_hr);var _addLink=__webpack_require__(61);var _addLink2=_interopRequireDefault(_addLink);var _addImage=__webpack_require__(62);var _addImage2=_interopRequireDefault(_addImage);var _ul=__webpack_require__(63);var _ul2=_interopRequireDefault(_ul);var _ol=__webpack_require__(64);var _ol2=_interopRequireDefault(_ol);var _table=__webpack_require__(65);var _table2=_interopRequireDefault(_table);var _task=__webpack_require__(66);var _task2=_interopRequireDefault(_task);var _code=__webpack_require__(67);var _code2=_interopRequireDefault(_code);var _codeBlock=__webpack_require__(68);var _codeBlock2=_interopRequireDefault(_codeBlock);var _bold3=__webpack_require__(69);var _bold4=_interopRequireDefault(_bold3);var _italic3=__webpack_require__(70);var _italic4=_interopRequireDefault(_italic3);var _strike3=__webpack_require__(71);var _strike4=_interopRequireDefault(_strike3);var _blockquote3=__webpack_require__(72);var _blockquote4=_interopRequireDefault(_blockquote3);var _addImage3=__webpack_require__(73);var _addImage4=_interopRequireDefault(_addImage3);var _addLink3=__webpack_require__(74);var _addLink4=_interopRequireDefault(_addLink3);var _hr3=__webpack_require__(75);var _hr4=_interopRequireDefault(_hr3);var _heading3=__webpack_require__(76);var _heading4=_interopRequireDefault(_heading3);var _paragraph3=__webpack_require__(77);var _paragraph4=_interopRequireDefault(_paragraph3);var _ul3=__webpack_require__(78);var _ul4=_interopRequireDefault(_ul3);var _ol3=__webpack_require__(79);var _ol4=_interopRequireDefault(_ol3);var _table3=__webpack_require__(80);var _table4=_interopRequireDefault(_table3);var _tableAddRow=__webpack_require__(81);var _tableAddRow2=_interopRequireDefault(_tableAddRow);var _tableAddCol=__webpack_require__(82);var _tableAddCol2=_interopRequireDefault(_tableAddCol);var _tableRemoveRow=__webpack_require__(83);var _tableRemoveRow2=_interopRequireDefault(_tableRemoveRow);var _tableRemoveCol=__webpack_require__(84);var _tableRemoveCol2=_interopRequireDefault(_tableRemoveCol);var _tableAlignCol=__webpack_require__(85);var _tableAlignCol2=_interopRequireDefault(_tableAlignCol);var _tableRemove=__webpack_require__(86);var _tableRemove2=_interopRequireDefault(_tableRemove);var _increaseDepth=__webpack_require__(87);var _increaseDepth2=_interopRequireDefault(_increaseDepth);var _decreaseDepth=__webpack_require__(88);var _decreaseDepth2=_interopRequireDefault(_decreaseDepth);var _task3=__webpack_require__(89);var _task4=_interopRequireDefault(_task3);var _code3=__webpack_require__(90);var _code4=_interopRequireDefault(_code3);var _codeBlock3=__webpack_require__(91);var _codeBlock4=_interopRequireDefault(_codeBlock3);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var __nedInstance=[];var ToastUIEditor=function(){function ToastUIEditor(options){_classCallCheck(this,ToastUIEditor);var self=this;this.options=$.extend({previewStyle:"tab",initialEditType:"markdown",height:300,language:"en_US",useDefaultHTMLSanitizer:true,useCommandShortcut:true},options);this.eventManager=new _eventManager2.default;this.importManager=new _importManager2.default(this.eventManager);this.commandManager=new _commandManager3.default(this,{useCommandShortcut:this.options.useCommandShortcut});this.codeBlockManager=_codeBlockManager2.default;this.convertor=new _convertor2.default(this.eventManager);if(this.options.useDefaultHTMLSanitizer){this.convertor.initHtmlSanitizer()}if(this.options.hooks){util.forEach(this.options.hooks,function(fn,key){self.addHook(key,fn)})}if(this.options.events){util.forEach(this.options.events,function(fn,key){self.on(key,fn)})}this.layout=new _layout2.default(options,this.eventManager);this.i18n=_i18n2.default;this.i18n.setCode(this.options.language);this.setUI(this.options.UI||new _defaultUI2.default(this));this.mdEditor=_markdownEditor2.default.factory(this.layout.getMdEditorContainerEl(),this.eventManager);this.preview=new _preview2.default(this.layout.getPreviewEl(),this.eventManager,this.convertor);this.wwEditor=_wysiwygEditor2.default.factory(this.layout.getWwEditorContainerEl(),this.eventManager,{useCommandShortcut:this.options.useCommandShortcut});this.toMarkOptions=null;this.changePreviewStyle(this.options.previewStyle);this.changeMode(self.options.initialEditType,true);this.contentHeight(self.options.height);this.setValue(self.options.initialValue);_extManager2.default.applyExtension(self,self.options.exts);this.eventManager.emit("load",self);__nedInstance.push(this)}_createClass(ToastUIEditor,[{key:"changePreviewStyle",value:function changePreviewStyle(style){this.layout.changePreviewStyle(style);this.mdPreviewStyle=style;this.eventManager.emit("changePreviewStyle",style);this.eventManager.emit("previewNeedsRefresh")}},{key:"exec",value:function exec(){var _commandManager;(_commandManager=this.commandManager).exec.apply(_commandManager,arguments)}},{key:"addCommand",value:function addCommand(type,props){if(!props){this.commandManager.addCommand(type)}else{this.commandManager.addCommand(_commandManager3.default.command(type,props))}}},{key:"afterAddedCommand",value:function afterAddedCommand(){this.eventManager.emit("afterAddedCommand",this)}},{key:"on",value:function on(type,handler){this.eventManager.listen(type,handler)}},{key:"off",value:function off(type){this.eventManager.removeEventHandler(type)}},{key:"addHook",value:function addHook(type,handler){this.eventManager.removeEventHandler(type);this.eventManager.listen(type,handler)}},{key:"removeHook",value:function removeHook(type){this.eventManager.removeEventHandler(type)}},{key:"getCodeMirror",value:function getCodeMirror(){return this.mdEditor.getEditor()}},{key:"getSquire",value:function getSquire(){return this.wwEditor.getEditor()}},{key:"focus",value:function focus(){this.getCurrentModeEditor().focus()}},{key:"blur",value:function blur(){this.getCurrentModeEditor().blur()}},{key:"moveCursorToEnd",value:function moveCursorToEnd(){this.getCurrentModeEditor().moveCursorToEnd()}},{key:"moveCursorToStart",value:function moveCursorToStart(){this.getCurrentModeEditor().moveCursorToStart()}},{key:"setMarkdown",value:function setMarkdown(markdown){markdown=markdown||"";if(this.isMarkdownMode()){this.mdEditor.setValue(markdown)}else{this.wwEditor.setValue(this.convertor.toHTML(markdown))}this.eventManager.emit("setMarkdownAfter",markdown)}},{key:"setHtml",value:function setHtml(html){html=html||"";this.wwEditor.setValue(html);if(this.isMarkdownMode()){var markdown=this.convertor.toMarkdown(this.wwEditor.getValue(),this.toMarkOptions);this.mdEditor.setValue(markdown);this.eventManager.emit("setMarkdownAfter",markdown)}}},{key:"setValue",value:function setValue(value){this.setMarkdown(value)}},{key:"getMarkdown",value:function getMarkdown(){var markdown=void 0;if(this.isMarkdownMode()){markdown=this.mdEditor.getValue()}else{markdown=this.convertor.toMarkdown(this.wwEditor.getValue(),this.toMarkOptions)}return markdown}},{key:"getHtml",value:function getHtml(){if(this.isWysiwygMode()){this.mdEditor.setValue(this.convertor.toMarkdown(this.wwEditor.getValue(),this.toMarkOptions))}return this.convertor.toHTML(this.mdEditor.getValue())}},{key:"getValue",value:function getValue(){return this.getMarkdown()}},{key:"insertText",value:function insertText(text){if(this.isMarkdownMode()){this.mdEditor.replaceSelection(text)}else{this.wwEditor.insertText(text)}}},{key:"addWidget",value:function addWidget(selection,node,style,offset){this.getCurrentModeEditor().addWidget(selection,node,style,offset)}},{key:"contentHeight",value:function contentHeight(height){if(height){this._contentHeight=height;this.mdEditor.setHeight(height);this.preview.setHeight(height);this.wwEditor.setHeight(height)}return this._contentHeight}},{key:"getCurrentModeEditor",value:function getCurrentModeEditor(){var editor=void 0;if(this.isMarkdownMode()){editor=this.mdEditor}else{editor=this.wwEditor}return editor}},{key:"isMarkdownMode",value:function isMarkdownMode(){return this.currentMode==="markdown"}},{key:"isWysiwygMode",value:function isWysiwygMode(){return this.currentMode==="wysiwyg"}},{key:"isViewOnly",value:function isViewOnly(){return false}},{key:"getCurrentPreviewStyle",value:function getCurrentPreviewStyle(){return this.mdPreviewStyle}},{key:"changeMode",value:function changeMode(mode,isWithoutFocus){if(this.currentMode===mode){return}this.eventManager.emit("changeModeBefore",this.currentMode);this.currentMode=mode;if(this.isWysiwygMode()){this.layout.switchToWYSIWYG();this.wwEditor.setValue(this.convertor.toHTML(this.mdEditor.getValue()));this.eventManager.emit("changeModeToWysiwyg")}else{this.layout.switchToMarkdown();this.mdEditor.setValue(this.convertor.toMarkdown(this.wwEditor.getValue(),this.toMarkOptions));this.getCodeMirror().refresh();this.eventManager.emit("changeModeToMarkdown")}this.eventManager.emit("changeMode",mode);if(!isWithoutFocus){this.focus()}}},{key:"remove",value:function remove(){var self=this;var i=__nedInstance.length-1;this.wwEditor.remove();this.mdEditor.remove();this.layout.remove();if(this.getUI()){this.getUI().remove()}this.eventManager.emit("removeEditor");this.eventManager.events.forEach(function(value,key){self.off(key)});this.eventManager=null;for(;i>=0;i-=1){if(__nedInstance[i]===this){__nedInstance.splice(i,1)}}}},{key:"hide",value:function hide(){this.eventManager.emit("hide",this)}},{key:"show",value:function show(){this.eventManager.emit("show",this);this.getCodeMirror().refresh()}},{key:"scrollTop",value:function scrollTop(value){return this.getCurrentModeEditor().scrollTop(value)}},{key:"setUI",value:function setUI(UI){this._ui=UI}},{key:"getUI",value:function getUI(){return this._ui}},{key:"reset",value:function reset(){this.wwEditor.reset();this.mdEditor.reset()}},{key:"getRange",value:function getRange(){return this.getCurrentModeEditor().getRange()}},{key:"getTextObject",value:function getTextObject(range){return this.getCurrentModeEditor().getTextObject(range)}},{key:"getSelectedText",value:function getSelectedText(){var range=this.getRange();var textObject=this.getTextObject(range);return textObject.getTextContent()||""}}],[{key:"getInstances",value:function getInstances(){return __nedInstance}},{key:"defineExtension",value:function defineExtension(name,ext){_extManager2.default.defineExtension(name,ext)}},{key:"factory",value:function factory(options){var tuiEditor=void 0;if(options.viewOnly){tuiEditor=new _viewOnly2.default(options)}else{tuiEditor=new ToastUIEditor(options);tuiEditor.addCommand(_bold2.default);tuiEditor.addCommand(_italic2.default);tuiEditor.addCommand(_blockquote2.default);tuiEditor.addCommand(_heading2.default);tuiEditor.addCommand(_paragraph2.default);tuiEditor.addCommand(_hr2.default);tuiEditor.addCommand(_addLink2.default);tuiEditor.addCommand(_addImage2.default);tuiEditor.addCommand(_ul2.default);tuiEditor.addCommand(_ol2.default);tuiEditor.addCommand(_table2.default);tuiEditor.addCommand(_task2.default);tuiEditor.addCommand(_code2.default);tuiEditor.addCommand(_codeBlock2.default);tuiEditor.addCommand(_strike2.default);tuiEditor.addCommand(_bold4.default);tuiEditor.addCommand(_italic4.default);tuiEditor.addCommand(_blockquote4.default);tuiEditor.addCommand(_ul4.default);tuiEditor.addCommand(_ol4.default);tuiEditor.addCommand(_addImage4.default);tuiEditor.addCommand(_addLink4.default);tuiEditor.addCommand(_hr4.default);tuiEditor.addCommand(_heading4.default);tuiEditor.addCommand(_paragraph4.default);tuiEditor.addCommand(_increaseDepth2.default);tuiEditor.addCommand(_decreaseDepth2.default);tuiEditor.addCommand(_task4.default);tuiEditor.addCommand(_table4.default);tuiEditor.addCommand(_tableAddRow2.default);tuiEditor.addCommand(_tableAddCol2.default);tuiEditor.addCommand(_tableRemoveRow2.default);tuiEditor.addCommand(_tableRemoveCol2.default);tuiEditor.addCommand(_tableAlignCol2.default);tuiEditor.addCommand(_tableRemove2.default);tuiEditor.addCommand(_code4.default);tuiEditor.addCommand(_codeBlock4.default);tuiEditor.addCommand(_strike4.default)}return tuiEditor}}]);return ToastUIEditor}();ToastUIEditor.i18n=_i18n2.default;ToastUIEditor.markdownItRenderer=_convertor2.default.getMarkdownHighlightRenderer();module.exports=ToastUIEditor},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _keyMapper=__webpack_require__(3);var _keyMapper2=_interopRequireDefault(_keyMapper);var _mdTextObject=__webpack_require__(4);var _mdTextObject2=_interopRequireDefault(_mdTextObject);var _mdListManager=__webpack_require__(5);var _mdListManager2=_interopRequireDefault(_mdListManager);var _componentManager=__webpack_require__(6);var _componentManager2=_interopRequireDefault(_componentManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var CodeMirror=window.CodeMirror;var keyMapper=_keyMapper2.default.getSharedInstance();var MarkdownEditor=function(){function MarkdownEditor($el,eventManager){_classCallCheck(this,MarkdownEditor);this.componentManager=new _componentManager2.default(this);this.eventManager=eventManager;this.$editorContainerEl=$el;this._latestState=null}_createClass(MarkdownEditor,[{key:"init",value:function init(initialValue){var cmTextarea=$("<textarea />");if(initialValue){cmTextarea.text(initialValue);this._emitMarkdownEditorContentChangedEvent(initialValue)}this.$editorContainerEl.append(cmTextarea);this.cm=CodeMirror.fromTextArea(cmTextarea[0],{lineWrapping:true,mode:"gfm",theme:"default",dragDrop:true,allowDropFileTypes:["image"],extraKeys:{Enter:"newlineAndIndentContinue",Tab:"subListIndentTab","Shift-Tab":"indentLess","Alt-Up":"replaceLineTextToUpper","Alt-Down":"replaceLineTextToLower"},indentUnit:4});this._initEvent()}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.cm.getWrapperElement().addEventListener("click",function(){_this.eventManager.emit("click",{source:"markdown"})});this.cm.on("beforeChange",function(cm,ev){if(ev.origin==="paste"){_this.eventManager.emit("pasteBefore",{source:"markdown",data:ev})}});this.cm.on("change",function(cm,cmEvent){_this._emitMarkdownEditorContentChangedEvent();_this._emitMarkdownEditorChangeEvent(cmEvent)});this.cm.on("focus",function(){_this.eventManager.emit("focus",{source:"markdown"});_this.getEditor().refresh()});this.cm.on("blur",function(){_this.eventManager.emit("blur",{source:"markdown"})});this.cm.on("scroll",function(cm,eventData){_this.eventManager.emit("scroll",{source:"markdown",data:eventData})});this.cm.on("keydown",function(cm,keyboardEvent){_this.eventManager.emit("keydown",{source:"markdown",data:keyboardEvent});_this.eventManager.emit("keyMap",{source:"markdown",keyMap:keyMapper.convert(keyboardEvent),data:keyboardEvent})});this.cm.on("keyup",function(cm,keyboardEvent){_this.eventManager.emit("keyup",{source:"markdown",data:keyboardEvent})});this.cm.on("copy",function(cm,ev){_this.eventManager.emit("copy",{source:"markdown",data:ev})});this.cm.on("cut",function(cm,ev){_this.eventManager.emit("cut",{source:"markdown",data:ev})});this.cm.on("paste",function(cm,clipboardEvent){_this.eventManager.emit("paste",{source:"markdown",data:clipboardEvent})});this.cm.on("drop",function(cm,eventData){eventData.preventDefault();_this.eventManager.emit("drop",{source:"markdown",data:eventData})});this.cm.on("cursorActivity",function(){var token=_this.cm.getTokenAt(_this.cm.getCursor());var base=token.state.base;var overlay=token.state.overlay;var state={bold:!!base.strong,italic:!!base.em,strike:!!base.strikethrough,code:!!overlay.code,codeBlock:!!overlay.codeBlock,quote:!!base.quote,list:!!base.list,task:!!base.task,source:"markdown"};if(!_this._latestState||_this._isStateChanged(_this._latestState,state)){_this.eventManager.emit("stateChange",state);_this._latestState=state}})}},{key:"getCurrentRange",value:function getCurrentRange(){var from=this.cm.getCursor("from"),to=this.cm.getCursor("to");return{from:from,to:to,collapsed:from===to}}},{key:"focus",value:function focus(){this.cm.focus()}},{key:"blur",value:function blur(){this.cm.getInputField().blur()}},{key:"remove",value:function remove(){this.cm.toTextArea()}},{key:"setValue",value:function setValue(markdown){this.getEditor().setValue(markdown);this._emitMarkdownEditorContentChangedEvent();this.moveCursorToEnd();this.getEditor().refresh()}},{key:"getValue",value:function getValue(){return this.cm.getValue("\n")}},{key:"getEditor",value:function getEditor(){return this.cm}},{key:"reset",value:function reset(){this.setValue("")}},{key:"_emitMarkdownEditorContentChangedEvent",value:function _emitMarkdownEditorContentChangedEvent(){this.eventManager.emit("contentChangedFromMarkdown",this)}},{key:"_cloneCMEventObject",value:function _cloneCMEventObject(e){return{from:{line:e.from.line,ch:e.from.ch},to:{line:e.to.line,ch:e.to.ch}}}},{key:"_emitMarkdownEditorChangeEvent",value:function _emitMarkdownEditorChangeEvent(e){if(e.origin!=="setValue"){var eventObj={source:"markdown"};this.eventManager.emit("changeFromMarkdown",eventObj);this.eventManager.emit("change",eventObj)}}},{key:"getCaretPosition",value:function getCaretPosition(){return this.cm.cursorCoords()}},{key:"addWidget",value:function addWidget(selection,node,style,offset){if(offset){selection.ch+=offset}this.cm.addWidget(selection.end,node,true,style)}},{key:"replaceSelection",value:function replaceSelection(content,selection){if(selection){this.cm.setSelection(selection.from,selection.to)}this.cm.replaceSelection(content);this.focus()}},{key:"replaceRelativeOffset",value:function replaceRelativeOffset(content,offset,overwriteLength){var cursor=this.cm.getCursor(),selection={from:{line:cursor.line,ch:cursor.ch+offset},to:{line:cursor.line,ch:cursor.ch+offset+overwriteLength}};this.replaceSelection(content,selection)}},{key:"setHeight",value:function setHeight(height){this.$editorContainerEl.height(height);if(height==="auto"){this.$editorContainerEl.find(".CodeMirror").height("auto")}}},{key:"moveCursorToEnd",value:function moveCursorToEnd(){var doc=this.getEditor().getDoc(),lastLine=doc.lastLine();doc.setCursor(lastLine,doc.getLine(lastLine).length)}},{key:"moveCursorToStart",value:function moveCursorToStart(){var doc=this.getEditor().getDoc(),firstLine=doc.firstLine();doc.setCursor(firstLine,0)}},{key:"scrollTop",value:function scrollTop(value){if(value){this.cm.scrollTo(0,value)}return this.cm.getScrollInfo().top}},{key:"getRange",value:function getRange(){var start=this.getEditor().getCursor("from");var end=this.getEditor().getCursor("to");return{start:{line:start.line,ch:start.ch},end:{line:end.line,ch:end.ch}}}},{key:"getTextObject",value:function getTextObject(range){return new _mdTextObject2.default(this,range)}},{key:"_isStateChanged",value:function _isStateChanged(previousState,currentState){var result=false;tui.util.forEach(currentState,function(currentStateTypeValue,stateType){result=previousState[stateType]!==currentStateTypeValue;return!result});return result}}],[{key:"factory",value:function factory($el,eventManager){var mde=new MarkdownEditor($el,eventManager);mde.init();mde.componentManager.addManager(_mdListManager2.default);return mde}}]);return MarkdownEditor}();module.exports=MarkdownEditor},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var KEYBOARD_MAP=["","","","CANCEL","","","HELP","","BACK_SPACE","TAB","","","CLEAR","ENTER","ENTER_SPECIAL","","","","","PAUSE","CAPS_LOCK","KANA","EISU","JUNJA","FINAL","HANJA","","ESCAPE","CONVERT","NONCONVERT","ACCEPT","MODECHANGE","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN","SELECT","PRINT","EXECUTE","PRINTSCREEN","INSERT","DELETE","","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","AT","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","","","CONTEXT_MENU","","SLEEP","NUMPAD0","NUMPAD1","NUMPAD2","NUMPAD3","NUMPAD4","NUMPAD5","NUMPAD6","NUMPAD7","NUMPAD8","NUMPAD9","MULTIPLY","ADD","SEPARATOR","SUBTRACT","DECIMAL","DIVIDE","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24","","","","","","","","","NUM_LOCK","SCROLL_LOCK","WIN_OEM_FJ_JISHO","WIN_OEM_FJ_MASSHOU","WIN_OEM_FJ_TOUROKU","WIN_OEM_FJ_LOYA","WIN_OEM_FJ_ROYA","","","","","","","","","","@","!",'"',"#","$","%","&","_","(",")","*","+","|","-","{","}","~","","","","","VOLUME_MUTE","VOLUME_DOWN","VOLUME_UP","","",";","=",",","-",".","/","`","","","","","","","","","","","","","","","","","","","","","","","","","","","[","\\","]","'","","META","ALTGR","","WIN_ICO_HELP","WIN_ICO_00","","WIN_ICO_CLEAR","","","WIN_OEM_RESET","WIN_OEM_JUMP","WIN_OEM_PA1","WIN_OEM_PA2","WIN_OEM_PA3","WIN_OEM_WSCTRL","WIN_OEM_CUSEL","WIN_OEM_ATTN","WIN_OEM_FINISH","WIN_OEM_COPY","WIN_OEM_AUTO","WIN_OEM_ENLW","WIN_OEM_BACKTAB","ATTN","CRSEL","EXSEL","EREOF","PLAY","ZOOM","","PA1","WIN_OEM_CLEAR",""];var sharedInstance=void 0;var KeyMapper=function(){function KeyMapper(options){_classCallCheck(this,KeyMapper);this._setSplitter(options)}_createClass(KeyMapper,[{key:"_setSplitter",value:function _setSplitter(options){var splitter=options?options.splitter:"+";this._splitter=splitter}},{key:"convert",value:function convert(event){var keyMap=[];if(event.shiftKey){keyMap.push("SHIFT")}if(event.ctrlKey){keyMap.push("CTRL")}if(event.metaKey){keyMap.push("META")}if(event.altKey){keyMap.push("ALT")}var keyChar=this._getKeyCodeChar(event.keyCode);if(keyChar){keyMap.push(keyChar)}return keyMap.join(this._splitter)}},{key:"_getKeyCodeChar",value:function _getKeyCodeChar(keyCode){var keyCodeCharacter=KEYBOARD_MAP[keyCode];return keyCodeCharacter}}],[{key:"getSharedInstance",value:function getSharedInstance(){if(!sharedInstance){sharedInstance=new KeyMapper}return sharedInstance}}]);return KeyMapper}();module.exports=KeyMapper},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var mdTextObject=function(){function mdTextObject(mde,range){_classCallCheck(this,mdTextObject);this._mde=mde;this.setRange(range||mde.getRange())}_createClass(mdTextObject,[{key:"_setStart",value:function _setStart(rangeStart){this._start=rangeStart}},{key:"_setEnd",value:function _setEnd(rangeEnd){this._end=rangeEnd}},{key:"setRange",value:function setRange(range){this._setStart(range.start);this._setEnd(range.end)}},{key:"setEndBeforeRange",value:function setEndBeforeRange(range){this._setEnd(range.start)}},{key:"expandStartOffset",value:function expandStartOffset(){var start=this._start;if(start.ch!==0){start.ch-=1}}},{key:"expandEndOffset",value:function expandEndOffset(){var end=this._end;if(end.ch<this._mde.getEditor().getDoc().getLine(end.line).length){end.ch+=1}}},{key:"getTextContent",value:function getTextContent(){return this._mde.getEditor().getRange(this._start,this._end)}},{key:"replaceContent",value:function replaceContent(content){this._mde.getEditor().replaceRange(content,this._start,this._end,"+input")}},{key:"deleteContent",value:function deleteContent(){this._mde.getEditor().replaceRange("",this._start,this._end,"+delete")}},{key:"peekStartBeforeOffset",value:function peekStartBeforeOffset(offset){var peekStart={line:this._start.line,ch:Math.max(this._start.ch-offset,0)};return this._mde.getEditor().getRange(peekStart,this._start)}}]);return mdTextObject}();module.exports=mdTextObject},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var FIND_MD_OL_RX=/^[ \t]*[\d]+\. .*/;var FIND_MD_UL_RX=/^[ \t]*[-*] .*/;var FIND_MD_TASK_RX=/^[ \t]*[-*]( \[[ xX]])? .*/;var FIND_TABLE_RX=/^\|([-\s\w\d\t<>?!@#$%^&*()_=+\\\/'";: \r\[\]]*\|+)+/i;var FIND_HEADING_RX=/^#+\s/;var FIND_BLOCK_RX=/^ {0,3}(```|\||>)/;var MdListManager=function(){function MdListManager(mde){_classCallCheck(this,MdListManager);this.mde=mde;this.eventManager=mde.eventManager;this.name="list"}_createClass(MdListManager,[{key:"isListOrParagraph",value:function isListOrParagraph(line){return!FIND_BLOCK_RX.test(line)&&!FIND_TABLE_RX.test(line)&&!FIND_HEADING_RX.test(line)}},{key:"appendBlankLineIfNeed",value:function appendBlankLineIfNeed(cm,index,endLineNumber,startLineNumber){var doc=cm.getDoc();var cursorPositionFactor=0;var isMultiLineSelection=startLineNumber!==endLineNumber;var nextLineOfLastIndex=doc.getLine(this._getEndLineNumberOfList(doc,endLineNumber)+1);var previousLineOfFirstIndex=doc.getLine(this._getStartLineNumberOfList(doc,startLineNumber)-1);var nextLine=doc.getLine(index+1);if(isMultiLineSelection&&this._isNeedAppendBlankLine(nextLineOfLastIndex)||!isMultiLineSelection&&this._isNeedAppendBlankLine(nextLine)){doc.replaceRange("\n",{line:index,ch:doc.getLine(index).length})}var previousLine=doc.getLine(index-1);if(isMultiLineSelection&&this._isNeedAppendBlankLine(previousLineOfFirstIndex)||!isMultiLineSelection&&this._isNeedAppendBlankLine(previousLine)){doc.replaceRange("\n",{line:startLineNumber,ch:0});cursorPositionFactor+=1}if(!isMultiLineSelection){var currentLineNumber=index+cursorPositionFactor;cm.setCursor(currentLineNumber,doc.getLine(currentLineNumber).length)}}},{key:"_isNeedAppendBlankLine",value:function _isNeedAppendBlankLine(line){return line&&line.length!==0&&!this._isAList(line)}},{key:"createSortedLineRange",value:function createSortedLineRange(range){var isReversed=range.from.line>range.to.line;var rangeStart={line:isReversed?range.to.line:range.from.line,ch:0};var rangeEnd={line:isReversed?range.from.line:range.to.line,ch:0};return{start:rangeStart.line,end:rangeEnd.line}}},{key:"expandLineRangeIfNeed",value:function expandLineRangeIfNeed(doc,range,comparator){var lineRange=this.createSortedLineRange(range);var start=lineRange.start;var end=lineRange.end;var isRangeStartInUlOrTask=this._isDifferentListType(comparator,doc.getLine(start));var isRangeEndInUlOrTask=this._isDifferentListType(comparator,doc.getLine(end));if(isRangeStartInUlOrTask){start=this._getStartLineNumberOfList(doc,start)}if(isRangeEndInUlOrTask){end=this._getEndLineNumberOfList(doc,end)}return{start:start,end:end}}},{key:"replaceLineText",value:function replaceLineText(doc,lineNumber,regexp,replacePattern){var line=doc.getLine(lineNumber);var currentLineStart={line:lineNumber,ch:0};var currentLineEnd={line:lineNumber,ch:line.length};line=line.replace(regexp,replacePattern)
;doc.replaceRange(line,currentLineStart,currentLineEnd)}},{key:"_isDifferentListType",value:function _isDifferentListType(comparator,line){return line&&line.length!==0&&comparator.call(this,line)}},{key:"_isAList",value:function _isAList(line){return line&&line.length!==0&&this._isListLine(line)}},{key:"_isListLine",value:function _isListLine(line){return!!(line.match(FIND_MD_TASK_RX)||line.match(FIND_MD_UL_RX)||line.match(FIND_MD_OL_RX))}},{key:"_getStartLineNumberOfList",value:function _getStartLineNumberOfList(doc,startLineNumber){var lineNumber=void 0;for(lineNumber=startLineNumber;lineNumber>0;lineNumber-=1){var previousLine=doc.getLine(lineNumber-1);if(!previousLine||!this._isListLine(previousLine)){break}}return lineNumber}},{key:"_getEndLineNumberOfList",value:function _getEndLineNumberOfList(doc,endLineNumber){var lineCount=doc.lineCount();var lineNumber=void 0;for(lineNumber=endLineNumber;lineNumber<lineCount;lineNumber+=1){var nextLine=doc.getLine(lineNumber+1);if(!nextLine||!this._isListLine(nextLine)){break}}return lineNumber}}]);return MdListManager}();module.exports=MdListManager},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ComponentManager=function(){function ComponentManager(editor){_classCallCheck(this,ComponentManager);this._managers={};this._editor=editor}_createClass(ComponentManager,[{key:"addManager",value:function addManager(nameOrConstructor,ManagerConstructor){if(!ManagerConstructor){ManagerConstructor=nameOrConstructor;nameOrConstructor=null}var instance=new ManagerConstructor(this._editor);this._managers[nameOrConstructor||instance.name]=instance}},{key:"getManager",value:function getManager(name){return this._managers[name]}},{key:"removeManager",value:function removeManager(name){var manager=this.getManager(name);if(!manager){return}if(manager.destroy){manager.destroy()}delete this._managers[name]}}]);return ComponentManager}();module.exports=ComponentManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _lazyRunner=__webpack_require__(8);var _lazyRunner2=_interopRequireDefault(_lazyRunner);var _codeBlockManager=__webpack_require__(9);var _codeBlockManager2=_interopRequireDefault(_codeBlockManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Preview=function(){function Preview($el,eventManager,convertor,isViewOnly){_classCallCheck(this,Preview);this.eventManager=eventManager;this.convertor=convertor;this.$el=$el;this.isViewOnly=!!isViewOnly;this._initContentSection();this.lazyRunner=new _lazyRunner2.default;this.lazyRunner.registerLazyRunFunction("refresh",this.refresh,800,this);this._initEvent()}_createClass(Preview,[{key:"_initEvent",value:function _initEvent(){var _this=this;var latestMarkdownValue="";this.eventManager.listen("contentChangedFromMarkdown",function(markdownEditor){latestMarkdownValue=markdownEditor.getValue();if(_this.isVisible()){_this.lazyRunner.run("refresh",markdownEditor.getValue().replace(/<br>\n/g,"<br>"))}});this.eventManager.listen("previewNeedsRefresh",function(value){_this.refresh(value||latestMarkdownValue)});this.$el.on("scroll",function(event){_this.eventManager.emit("scroll",{source:"preview",data:event})})}},{key:"_initContentSection",value:function _initContentSection(){this.$previewContent=$('<div class="tui-editor-contents" />');this.$el.append(this.$previewContent)}},{key:"refresh",value:function refresh(markdown){this.render(this.convertor.toHTMLWithCodeHightlight(markdown))}},{key:"render",value:function render(html){var finalHtml=html;var processedDataByHook=this.eventManager.emit("previewBeforeHook",html);if(processedDataByHook){finalHtml=processedDataByHook[0]}this.$previewContent.empty();this.$previewContent.html(finalHtml);this.eventManager.emit("replaceCodeBlockElementsBefore");_codeBlockManager2.default.replaceElements(this.$previewContent,this.isViewOnly);this.eventManager.emit("previewRenderAfter",this)}},{key:"setHeight",value:function setHeight(height){this.$el.height(height)}},{key:"isVisible",value:function isVisible(){return this.$el.css("display")!=="none"}}]);return Preview}();module.exports=Preview},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var LazyRunner=function(){function LazyRunner(){_classCallCheck(this,LazyRunner);this.globalTOID=null;this.lazyRunFunctions={}}_createClass(LazyRunner,[{key:"run",value:function run(fn,params,context,delay){var TOID=void 0;if(util.isString(fn)){TOID=this._runRegisteredRun(fn,params,context,delay)}else{TOID=this._runSingleRun(fn,params,context,delay,this.globalTOID);this.globalTOID=TOID}return TOID}},{key:"registerLazyRunFunction",value:function registerLazyRunFunction(name,fn,delay,context){context=context||this;this.lazyRunFunctions[name]={fn:fn,delay:delay,context:context,TOID:null}}},{key:"_runSingleRun",value:function _runSingleRun(fn,params,context,delay,TOID){this._clearTOIDIfNeed(TOID);TOID=setTimeout(function(){fn.call(context,params)},delay);return TOID}},{key:"_runRegisteredRun",value:function _runRegisteredRun(lazyRunName,params,context,delay){var fn=this.lazyRunFunctions[lazyRunName].fn;var TOID=this.lazyRunFunctions[lazyRunName].TOID;delay=delay||this.lazyRunFunctions[lazyRunName].delay;context=context||this.lazyRunFunctions[lazyRunName].context;TOID=this._runSingleRun(fn,params,context,delay,TOID);this.lazyRunFunctions[lazyRunName].TOID=TOID;return TOID}},{key:"_clearTOIDIfNeed",value:function _clearTOIDIfNeed(TOID){if(TOID){clearTimeout(TOID)}}}]);return LazyRunner}();module.exports=LazyRunner},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var hljs=window.hljs;var CUSTOM_CODE_BLOCK_CLASS_NAME="tui-editor-custom-code-block";var sharedInstance=void 0;var CodeBlockManager=function(){function CodeBlockManager(){_classCallCheck(this,CodeBlockManager);this._elementReplacer=new util.Map}_createClass(CodeBlockManager,[{key:"setElementReplacer",value:function setElementReplacer(type,replacer){this._elementReplacer.set(type,replacer)}},{key:"createCodeBlockHtml",value:function createCodeBlockHtml(type,codeText){var replacer=this._elementReplacer.get(type);var className=CUSTOM_CODE_BLOCK_CLASS_NAME;var html=void 0;if(replacer){codeText=encodeURIComponent(codeText).replace(/(%0A)+$/,"");html='<pre class="'+className+'" data-language="'+type+'" data-code-text="'+codeText+'">'+type+"</pre>"}else{html=hljs.getLanguage(type)?hljs.highlight(type,codeText).value:escape(codeText,false)}return html}},{key:"_getViewMode",value:function _getViewMode(isViewOnly,isWysiwygMode){var replaceMode=void 0;if(isViewOnly){replaceMode="viewOnly"}else if(isWysiwygMode){replaceMode="wysiwyg"}else{replaceMode="preview"}return replaceMode}},{key:"_replaceElement",value:function _replaceElement(containerElement,codeBlockElement,replace,id){var $codeBlock=$(codeBlockElement);var type=$codeBlock.data("language");var beforeParentNode=codeBlockElement.parentNode;var codeText=$codeBlock.data("code-text");var $newCodeBlock=$(replace({id:id,containerElement:containerElement,codeBlockElement:codeBlockElement,type:type,codeText:decodeURIComponent(codeText)}));if($newCodeBlock.length){if(codeBlockElement!==$newCodeBlock[0]&&beforeParentNode===codeBlockElement.parentNode){$codeBlock.replaceWith($newCodeBlock)}$newCodeBlock[0].id=id;$newCodeBlock.data("language",type);$newCodeBlock.addClass(CUSTOM_CODE_BLOCK_CLASS_NAME);if(tui.util.isEmpty($newCodeBlock.data("code-text"))){$newCodeBlock.data("code-text",codeText)}}else{codeBlockElement.id=id}}},{key:"replaceElements",value:function replaceElements($container,isViewOnly,isWysiwygMode){var _this=this;var $codeBlocks=$container.find("."+CUSTOM_CODE_BLOCK_CLASS_NAME);var containerElement=$container[0];var viewMode=this._getViewMode(isViewOnly,isWysiwygMode);var replaceElement=$.proxy(this._replaceElement,this);var timestamp=(new Date).getTime();$codeBlocks.each(function(index,codeBlockElement){var id=CUSTOM_CODE_BLOCK_CLASS_NAME+"-"+timestamp+"-"+index;var replacer=_this._elementReplacer.get($(codeBlockElement).data("language"));var replace=replacer?replacer[viewMode]:null;if(replace){replaceElement(containerElement,codeBlockElement,replace,id)}else{codeBlockElement.id=id}})}},{key:"_restoreElement",value:function _restoreElement(codeBlockElement){var $codeBlock=$(codeBlockElement);var type=$codeBlock.data("language");var codeText=decodeURIComponent($codeBlock.data("code-text"));var $pre=$('<pre data-language="'+type+'" class="lang-'+type+'"></pre>');if(codeText){$pre.html("<div>"+escape(codeText,false).replace(/\n/g,"<br>")+"</div>")}$codeBlock.replaceWith($pre)}},{key:"restoreElements",value:function restoreElements($wweContainer){var $codeBlocks=$wweContainer.find("."+CUSTOM_CODE_BLOCK_CLASS_NAME);var restoreElement=$.proxy(this._restoreElement,this);$codeBlocks.each(function(index,codeBlockElement){restoreElement(codeBlockElement)})}},{key:"updateCodeTextById",value:function updateCodeTextById(containerElement,id,codeText){var $codeBlock=$(containerElement).find("#"+id);$codeBlock.data("code-text",encodeURIComponent(codeText))}}],[{key:"getSharedInstance",value:function getSharedInstance(){if(!sharedInstance){sharedInstance=new CodeBlockManager}return sharedInstance}}]);return CodeBlockManager}();function escape(html,encode){return html.replace(!encode?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}exports.CodeBlockManager=CodeBlockManager;exports.default=CodeBlockManager.getSharedInstance()},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);var _wwClipboardManager=__webpack_require__(12);var _wwClipboardManager2=_interopRequireDefault(_wwClipboardManager);var _wwListManager=__webpack_require__(16);var _wwListManager2=_interopRequireDefault(_wwListManager);var _wwTaskManager=__webpack_require__(17);var _wwTaskManager2=_interopRequireDefault(_wwTaskManager);var _wwTableManager=__webpack_require__(18);var _wwTableManager2=_interopRequireDefault(_wwTableManager);var _wwTableSelectionManager=__webpack_require__(19);var _wwTableSelectionManager2=_interopRequireDefault(_wwTableSelectionManager);var _wwHrManager=__webpack_require__(20);var _wwHrManager2=_interopRequireDefault(_wwHrManager);var _wwPManager=__webpack_require__(21);var _wwPManager2=_interopRequireDefault(_wwPManager);var _wwHeadingManager=__webpack_require__(22);var _wwHeadingManager2=_interopRequireDefault(_wwHeadingManager);var _wwCodeBlockManager=__webpack_require__(23);var _wwCodeBlockManager2=_interopRequireDefault(_wwCodeBlockManager);var _squireExt=__webpack_require__(24);var _squireExt2=_interopRequireDefault(_squireExt);var _keyMapper=__webpack_require__(3);var _keyMapper2=_interopRequireDefault(_keyMapper);var _wwTextObject=__webpack_require__(25);var _wwTextObject2=_interopRequireDefault(_wwTextObject);var _componentManager=__webpack_require__(6);var _componentManager2=_interopRequireDefault(_componentManager);var _codeBlockManager=__webpack_require__(9);var _codeBlockManager2=_interopRequireDefault(_codeBlockManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var keyMapper=_keyMapper2.default.getSharedInstance();var util=tui.util;var FIND_EMPTY_LINE=/<(.+)>(<br>|<br \/>|<BR>|<BR \/>)<\/\1>/g,FIND_UNNECESSARY_BR=/(?:<br>|<br \/>|<BR>|<BR \/>)<\/(.+?)>/g,FIND_BLOCK_TAGNAME_RX=/\b(H[\d]|LI|P|BLOCKQUOTE|TD|PRE)\b/;var EDITOR_CONTENT_CSS_CLASSNAME="tui-editor-contents";var canObserveMutations=typeof MutationObserver!=="undefined";var WysiwygEditor=function(){function WysiwygEditor($el,eventManager){var _this=this;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,WysiwygEditor);this.componentManager=new _componentManager2.default(this);this.eventManager=eventManager;this.$editorContainerEl=$el;this._height=0;this._silentChange=false;this._keyEventHandlers={};this._managers={};this._options=$.extend({useCommandShortcut:true},options);this._initEvent();this._initDefaultKeyEventHandler();this.debouncedPostProcessForChange=util.debounce(function(){return _this.postProcessForChange()},0)}_createClass(WysiwygEditor,[{key:"init",value:function init(){var $editorBody=$("<div />");this.$editorContainerEl.append($editorBody);this.editor=new _squireExt2.default($editorBody[0],{blockTag:"DIV",leafNodeNames:{HR:false}});if(!this._options.useCommandShortcut){this.editor.blockCommandShortcuts()}this._clipboardManager=new _wwClipboardManager2.default(this);this._initSquireEvent();this._clipboardManager.init();this.get$Body().addClass(EDITOR_CONTENT_CSS_CLASSNAME);this.$editorContainerEl.css("position","relative")}},{key:"_preprocessForInlineElement",value:function _preprocessForInlineElement(html){return html.replace(/<br>( *)<img/g,"<br><br>$1<img")}},{key:"_initEvent",value:function _initEvent(){var self=this;this.eventManager.listen("wysiwygSetValueBefore",function(html){return self._preprocessForInlineElement(html)});this.eventManager.listen("wysiwygKeyEvent",function(ev){return self._runKeyEventHandlers(ev.data,ev.keyMap)})}},{key:"addKeyEventHandler",value:function addKeyEventHandler(keyMap,handler){if(!handler){handler=keyMap;keyMap="DEFAULT"}if(!this._keyEventHandlers[keyMap]){this._keyEventHandlers[keyMap]=[]}this._keyEventHandlers[keyMap].push(handler)}},{key:"removeKeyEventHandler",value:function removeKeyEventHandler(keyMap,handler){if(!handler){handler=keyMap;keyMap="DEFAULT"}var handlers=this._keyEventHandlers[keyMap];if(handlers){this._keyEventHandlers[keyMap]=handlers.filter(function(_handler){return _handler!==handler})}}},{key:"_runKeyEventHandlers",value:function _runKeyEventHandlers(event,keyMap){var range=this.getRange();var handlers=void 0,isNeedNext=void 0;handlers=this._keyEventHandlers.DEFAULT;if(handlers){util.forEachArray(handlers,function(handler){isNeedNext=handler(event,range,keyMap);return isNeedNext})}handlers=this._keyEventHandlers[keyMap];if(handlers&&isNeedNext!==false){util.forEachArray(handlers,function(handler){return handler(event,range,keyMap)})}}},{key:"_initSquireEvent",value:function _initSquireEvent(){var self=this;var isNeedFirePostProcessForRangeChange=false;this.getEditor().addEventListener("copy",function(clipboardEvent){self.eventManager.emit("copy",{source:"wysiwyg",data:clipboardEvent});util.debounce(function(){self.eventManager.emit("copyAfter",{source:"wysiwyg",data:clipboardEvent})})()});this.getEditor().addEventListener(util.browser.msie?"beforecut":"cut",function(clipboardEvent){self.eventManager.emit("cut",{source:"wysiwyg",data:clipboardEvent});util.debounce(function(){self.eventManager.emit("cutAfter",{source:"wysiwyg",data:clipboardEvent})})()});this.getEditor().addEventListener(util.browser.msie?"beforepaste":"paste",function(clipboardEvent){self.eventManager.emit("paste",{source:"wysiwyg",data:clipboardEvent})});this.getEditor().addEventListener("dragover",function(ev){ev.preventDefault();return false});this.getEditor().addEventListener("drop",function(ev){ev.preventDefault();self.eventManager.emit("drop",{source:"wysiwyg",data:ev});return false});this.getEditor().addEventListener("input",util.debounce(function(){if(!self._silentChange&&self.isEditorValid()){var eventObj={source:"wysiwyg"};self.eventManager.emit("changeFromWysiwyg",eventObj);self.eventManager.emit("change",eventObj);self.eventManager.emit("contentChangedFromWysiwyg",self)}else{self._silentChange=false}self.getEditor().preserveLastLine()},0));this.getEditor().addEventListener("keydown",function(keyboardEvent){var range=self.getEditor().getSelection();if(!range.collapsed){isNeedFirePostProcessForRangeChange=true}self.eventManager.emit("keydown",{source:"wysiwyg",data:keyboardEvent});self._onKeyDown(keyboardEvent)});if(util.browser.firefox){this.getEditor().addEventListener("keypress",function(keyboardEvent){var keyCode=keyboardEvent.keyCode;if(keyCode===13||keyCode===9){var range=self.getEditor().getSelection();if(!range.collapsed){isNeedFirePostProcessForRangeChange=true}self.eventManager.emit("keydown",{source:"wysiwyg",data:keyboardEvent});self._onKeyDown(keyboardEvent)}});self.getEditor().addEventListener("keyup",function(){var range=self.getRange();if(_domUtils2.default.isTextNode(range.commonAncestorContainer)&&_domUtils2.default.isTextNode(range.commonAncestorContainer.previousSibling)){var prevLen=range.commonAncestorContainer.previousSibling.length;var curEl=range.commonAncestorContainer;range.commonAncestorContainer.previousSibling.appendData(range.commonAncestorContainer.data);range.setStart(range.commonAncestorContainer.previousSibling,prevLen+range.startOffset);range.collapse(true);curEl.parentNode.removeChild(curEl);self.getEditor().setSelection(range);range.detach()}})}this.getEditor().addEventListener("keyup",function(keyboardEvent){if(isNeedFirePostProcessForRangeChange){self.debouncedPostProcessForChange();isNeedFirePostProcessForRangeChange=false}self.eventManager.emit("keyup",{source:"wysiwyg",data:keyboardEvent})});this.getEditor().addEventListener("scroll",function(ev){self.eventManager.emit("scroll",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("click",function(ev){self.eventManager.emit("click",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("mousedown",function(ev){self.eventManager.emit("mousedown",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("mouseover",function(ev){self.eventManager.emit("mouseover",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("mouseup",function(ev){self.eventManager.emit("mouseup",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("contextmenu",function(ev){self.eventManager.emit("contextmenu",{source:"wysiwyg",data:ev})});this.getEditor().addEventListener("focus",function(){self.eventManager.emit("focus",{source:"wysiwyg"})});this.getEditor().addEventListener("blur",function(){self.eventManager.emit("blur",{source:"wysiwyg"})});this.getEditor().addEventListener("pathChange",function(data){var state={bold:/(>B|>STRONG|^B$|^STRONG$)/.test(data.path),italic:/(>I|>EM|^I$|^EM$)/.test(data.path),strike:/(^S>|>S$|>S>|^S$)/.test(data.path),code:/CODE/.test(data.path),codeBlock:/PRE/.test(data.path),quote:/BLOCKQUOTE/.test(data.path),list:/LI(?!.task-list-item)/.test(self._getLastLiString(data.path)),task:/LI.task-list-item/.test(self._getLastLiString(data.path)),source:"wysiwyg"};self.eventManager.emit("stateChange",state)})}},{key:"_getLastLiString",value:function _getLastLiString(path){var foundedListItem=/LI[^UO]*$/.exec(path);var result=void 0;if(foundedListItem){result=foundedListItem[0]}else{result=""}return result}},{key:"_onKeyDown",value:function _onKeyDown(keyboardEvent){var keyMap=keyMapper.convert(keyboardEvent);if(keyboardEvent.keyCode){this.eventManager.emit("keyMap",{source:"wysiwyg",keyMap:keyMap,data:keyboardEvent});if(!keyboardEvent.defaultPrevented){this.eventManager.emit("wysiwygKeyEvent",{keyMap:keyMap,data:keyboardEvent})}}}},{key:"_initDefaultKeyEventHandler",value:function _initDefaultKeyEventHandler(){var self=this;this.addKeyEventHandler("ENTER",function(ev,range){if(self._isInOrphanText(range)){self.defer(function(){self._wrapDefaultBlockToOrphanTexts();self.breakToNewDefaultBlock(range,"before")})}self.defer(function(){self._scrollToRangeIfNeed()})});this.addKeyEventHandler("TAB",function(ev){var sq=self.getEditor();var range=sq.getSelection();var isAbleToInput4Spaces=range.collapsed&&self._isCursorNotInRestrictedAreaOfTabAction(sq);var isTextSelection=!range.collapsed&&_domUtils2.default.isTextNode(range.commonAncestorContainer);ev.preventDefault();if(isAbleToInput4Spaces||isTextSelection){sq.insertPlainText("    ");return false}return true})}},{key:"_wrapDefaultBlockToOrphanTexts",value:function _wrapDefaultBlockToOrphanTexts(){var textNodes=this.get$Body().contents().filter(this.findTextNodeFilter);textNodes.each(function(i,node){if(node.nextSibling&&node.nextSibling.tagName==="BR"){$(node.nextSibling).remove()}$(node).wrap("<div />")})}},{key:"_scrollToRangeIfNeed",value:function _scrollToRangeIfNeed(){var range=this.getEditor().getSelection().cloneRange();var cursorTop=this.getEditor().getCursorPosition(range).top-this.$editorContainerEl.offset().top;if(cursorTop>=this.get$Body().height()){range.endContainer.scrollIntoView()}}},{key:"_isInOrphanText",value:function _isInOrphanText(range){return range.startContainer.nodeType===Node.TEXT_NODE&&range.startContainer.parentNode===this.get$Body()[0]}},{key:"_wrapDefaultBlockTo",value:function _wrapDefaultBlockTo(range){this.saveSelection(range);this._joinSplitedTextNodes();this.restoreSavedSelection();range=this.getEditor().getSelection().cloneRange();var textElem=range.startContainer;var cursorOffset=range.startOffset;var block=this.getEditor().createDefaultBlock([range.startContainer]);var insertTargetNode=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset);if(insertTargetNode){range.setStartBefore(insertTargetNode)}else{range.selectNodeContents(range.startContainer)}range.collapse(true);range.insertNode(block);range.setStart(textElem,cursorOffset);range.collapse(true);this.getEditor().setSelection(range)}},{key:"findTextNodeFilter",value:function findTextNodeFilter(){return this.nodeType===Node.TEXT_NODE}},{key:"_joinSplitedTextNodes",value:function _joinSplitedTextNodes(){var prevNode=void 0,lastGroup=void 0;var nodesToRemove=[];var textNodes=this.get$Body().contents().filter(this.findTextNodeFilter);textNodes.each(function(i,node){if(prevNode===node.previousSibling){lastGroup.nodeValue+=node.nodeValue;nodesToRemove.push(node)}else{lastGroup=node}prevNode=node});$(nodesToRemove).remove()}},{key:"saveSelection",value:function saveSelection(range){var sq=this.getEditor();if(!range){range=sq.getSelection().cloneRange()}this.getEditor()._saveRangeToBookmark(range)}},{key:"restoreSavedSelection",value:function restoreSavedSelection(){var sq=this.getEditor();sq.setSelection(sq._getRangeAndRemoveBookmark())}},{key:"reset",value:function reset(){this.setValue("")}},{key:"changeBlockFormatTo",value:function changeBlockFormatTo(targetTagName){this.getEditor().changeBlockFormatTo(targetTagName);this.eventManager.emit("wysiwygRangeChangeAfter",this)}},{key:"makeEmptyBlockCurrentSelection",value:function makeEmptyBlockCurrentSelection(){var self=this;this.getEditor().modifyBlocks(function(frag){if(!frag.textContent){frag=self.getEditor().createDefaultBlock()}return frag})}},{key:"focus",value:function focus(){this.editor.focus()}},{key:"blur",value:function blur(){this.editor.blur()}},{key:"remove",value:function remove(){this.getEditor().destroy();this.editor=null;this.$body=null}},{key:"setHeight",value:function setHeight(height){this._height=height;if(height==="auto"){this.get$Body().css("overflow","visible");this.get$Body().css("height","auto")}else{this.get$Body().css("overflow","auto");this.get$Body().css("height","100%");this.$editorContainerEl.height(height)}}},{key:"setValue",value:function setValue(html){html=this.eventManager.emitReduce("wysiwygSetValueBefore",html);this.editor.setHTML(html);_codeBlockManager2.default.replaceElements(this.$editorContainerEl,false,true);this.eventManager.emit("wysiwygSetValueAfter",this);this.eventManager.emit("contentChangedFromWysiwyg",this);this.moveCursorToEnd();this.getEditor().preserveLastLine();this.getEditor().removeLastUndoStack();this.getEditor().saveUndoState()}},{key:"insertText",value:function insertText(text){this.editor.insertPlainText(text)}},{key:"getValue",value:function getValue(){_codeBlockManager2.default.restoreElements(this.$editorContainerEl,false,true);this._prepareGetHTML();var html=this.editor.getHTML();html=html.replace(FIND_EMPTY_LINE,function(match,tag){var result=void 0;if(tag==="li"){result=match}else if(tag==="td"||tag==="th"){result="<"+tag+"></"+tag+">"}else{result="<br />"}return result});html=html.replace(FIND_UNNECESSARY_BR,"</$1>");html=html.replace(/<div>/g,"");html=html.replace(/<\/div>/g,"<br />");html=this.eventManager.emitReduce("wysiwygProcessHTMLText",html);return html}},{key:"_prepareGetHTML",value:function _prepareGetHTML(){var _this2=this;this.getEditor().modifyDocument(function(){_this2._joinSplitedTextNodes();_this2.eventManager.emit("wysiwygGetValueBefore",self)})}},{key:"postProcessForChange",value:function postProcessForChange(){var self=this;self.getEditor().modifyDocument(function(){self.eventManager.emit("wysiwygRangeChangeAfter",self)})}},{key:"readySilentChange",value:function readySilentChange(){if(canObserveMutations&&!this.getEditor().isIgnoreChange()){this._silentChange=true}}},{key:"getEditor",value:function getEditor(){return this.editor}},{key:"replaceSelection",value:function replaceSelection(content,range){this.getEditor().replaceSelection(content,range)}},{key:"replaceRelativeOffset",value:function replaceRelativeOffset(content,offset,overwriteLength){this.getEditor().replaceRelativeOffset(content,offset,overwriteLength)}},{key:"addWidget",value:function addWidget(range,node,style,offset){var pos=this.getEditor().getSelectionPosition(range,style,offset);var editorContainerPos=this.$editorContainerEl.offset();this.$editorContainerEl.append(node);$(node).css({position:"absolute",top:pos.top-editorContainerPos.top,left:pos.left-editorContainerPos.left})}},{key:"get$Body",value:function get$Body(){return this.getEditor().get$Body()}},{key:"hasFormatWithRx",value:function hasFormatWithRx(rx){return this.getEditor().getPath().match(rx)}},{key:"breakToNewDefaultBlock",value:function breakToNewDefaultBlock(range,where){var div=this.editor.createDefaultBlock();var currentNode=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset)||_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset-1);var appendBefore=_domUtils2.default.getParentUntil(currentNode,this.get$Body()[0]);if(where==="before"){$(appendBefore).before(div)}else{$(appendBefore).after(div)}range.setStart(div,0);range.collapse(true);this.editor.setSelection(range)}},{key:"replaceContentText",value:function replaceContentText(container,from,to){var before=$(container).html();$(container).html(before.replace(from,to))}},{key:"unwrapBlockTag",value:function unwrapBlockTag(condition){if(!condition){condition=function condition(tagName){return FIND_BLOCK_TAGNAME_RX.test(tagName)}}this.getEditor().changeBlockFormat(condition);this.eventManager.emit("wysiwygRangeChangeAfter",this)}},{key:"moveCursorToEnd",value:function moveCursorToEnd(){this.getEditor().moveCursorToEnd();this.getEditor().scrollTop(this.get$Body().height());this._correctRangeAfterMoveCursor("end")}},{key:"moveCursorToStart",value:function moveCursorToStart(){this.getEditor().moveCursorToStart();this.getEditor().scrollTop(0)}},{key:"scrollTop",value:function scrollTop(value){return this.getEditor().scrollTop(value)}},{key:"_correctRangeAfterMoveCursor",value:function _correctRangeAfterMoveCursor(direction){var range=this.getEditor().getSelection().cloneRange();var cursorContainer=this.get$Body()[0];if(direction==="start"){while(cursorContainer.firstChild){cursorContainer=cursorContainer.firstChild}}else{while(cursorContainer.lastChild){cursorContainer=cursorContainer.lastChild}}if(cursorContainer.tagName==="BR"){range.setStartBefore(cursorContainer)}else{range.setStartAfter(cursorContainer)}range.collapse(true);this.getEditor().setSelection(range)}},{key:"getRange",value:function getRange(){return this.getEditor().getSelection().cloneRange()}},{key:"getTextObject",value:function getTextObject(range){return new _wwTextObject2.default(this,range)}},{key:"defer",value:function defer(callback,delayOffset){var self=this;var delay=delayOffset?delayOffset:0;setTimeout(function(){if(self.isEditorValid()){callback(self)}},delay)}},{key:"isEditorValid",value:function isEditorValid(){return this.getEditor()&&$.contains(this.$editorContainerEl[0].ownerDocument,this.$editorContainerEl[0])}},{key:"_isCursorNotInRestrictedAreaOfTabAction",value:function _isCursorNotInRestrictedAreaOfTabAction(editor){return!editor.hasFormat("li")&&!editor.hasFormat("blockquote")&&!editor.hasFormat("table")}}],[{key:"factory",value:function factory($el,eventManager,options){var wwe=new WysiwygEditor($el,eventManager,options);wwe.init();wwe.componentManager.addManager(_wwListManager2.default);wwe.componentManager.addManager(_wwTaskManager2.default);wwe.componentManager.addManager(_wwTableSelectionManager2.default);wwe.componentManager.addManager(_wwTableManager2.default);wwe.componentManager.addManager(_wwHrManager2.default);wwe.componentManager.addManager(_wwPManager2.default);wwe.componentManager.addManager(_wwHeadingManager2.default)
;wwe.componentManager.addManager(_wwCodeBlockManager2.default);return wwe}}]);return WysiwygEditor}();module.exports=WysiwygEditor},function(module,exports){"use strict";var FIND_ZWB=/\u200B/g;var util=tui.util;var isTextNode=function isTextNode(node){return node&&node.nodeType===Node.TEXT_NODE};var isElemNode=function isElemNode(node){return node&&node.nodeType===Node.ELEMENT_NODE};var getNodeName=function getNodeName(node){if(isElemNode(node)){return node.tagName}return"TEXT"};var getTextLength=function getTextLength(node){var len=void 0;if(isElemNode(node)){len=node.textContent.replace(FIND_ZWB,"").length}else if(isTextNode(node)){len=node.nodeValue.replace(FIND_ZWB,"").length}return len};var getOffsetLength=function getOffsetLength(node){var len=void 0;if(isElemNode(node)){len=node.childNodes.length}else if(isTextNode(node)){len=node.nodeValue.replace(FIND_ZWB,"").length}return len};var getNodeOffsetOfParent=function getNodeOffsetOfParent(node){var childNodesOfParent=node.parentNode.childNodes;var i=void 0,t=void 0,found=void 0;for(i=0,t=childNodesOfParent.length;i<t;i+=1){if(childNodesOfParent[i]===node){found=i;break}}return found};var getChildNodeByOffset=function getChildNodeByOffset(node,index){var currentNode=void 0;if(isTextNode(node)){currentNode=node}else if(node.childNodes.length&&index>=0){currentNode=node.childNodes[index]}return currentNode};var getNodeWithDirectionUntil=function getNodeWithDirectionUntil(direction,node,untilNodeName){var directionKey=direction+"Sibling";var nodeName=void 0,foundedNode=void 0;while(node&&!node[directionKey]){nodeName=getNodeName(node.parentNode);if(nodeName===untilNodeName||nodeName==="BODY"){break}node=node.parentNode}if(node[directionKey]){foundedNode=node[directionKey]}return foundedNode};var getPrevOffsetNodeUntil=function getPrevOffsetNodeUntil(node,index,untilNodeName){var prevNode=void 0;if(index>0){prevNode=getChildNodeByOffset(node,index-1)}else{prevNode=getNodeWithDirectionUntil("previous",node,untilNodeName)}return prevNode};var getParentUntilBy=function getParentUntilBy(node,condition){var foundedNode=void 0;while(node.parentNode&&!condition(node.parentNode)){node=node.parentNode}if(condition(node.parentNode)){foundedNode=node}return foundedNode};var getParentUntil=function getParentUntil(node,untilNode){var foundedNode=void 0;if(util.isString(untilNode)){foundedNode=getParentUntilBy(node,function(targetNode){return untilNode===getNodeName(targetNode)})}else{foundedNode=getParentUntilBy(node,function(targetNode){return untilNode===targetNode})}return foundedNode};var getNodeWithDirectionUnderParent=function getNodeWithDirectionUnderParent(direction,node,underNode){var directionKey=direction+"Sibling";var foundedNode=void 0;node=getParentUntil(node,underNode);if(node&&node[directionKey]){foundedNode=node[directionKey]}return foundedNode};var getTopPrevNodeUnder=function getTopPrevNodeUnder(node,underNode){return getNodeWithDirectionUnderParent("previous",node,underNode)};var getTopNextNodeUnder=function getTopNextNodeUnder(node,underNode){return getNodeWithDirectionUnderParent("next",node,underNode)};var getTopBlockNode=function getTopBlockNode(node){return getParentUntil(node,"BODY")};var getPrevTextNode=function getPrevTextNode(node){node=node.previousSibling||node.parentNode;while(!isTextNode(node)&&getNodeName(node)!=="BODY"){if(node.previousSibling){node=node.previousSibling;while(node.lastChild){node=node.lastChild}}else{node=node.parentNode}}if(getNodeName(node)==="BODY"){node=null}return node};var findOffsetNode=function findOffsetNode(root,offsetList,textNodeFilter){var result=[];var text="";var walkerOffset=0;var newWalkerOffset=void 0;if(!offsetList.length){return result}var offset=offsetList.shift();var walker=document.createTreeWalker(root,4,null,false);while(walker.nextNode()){text=walker.currentNode.nodeValue||"";if(textNodeFilter){text=textNodeFilter(text)}newWalkerOffset=walkerOffset+text.length;while(newWalkerOffset>=offset){result.push({container:walker.currentNode,offsetInContainer:offset-walkerOffset,offset:offset});if(!offsetList.length){return result}offset=offsetList.shift()}walkerOffset=newWalkerOffset}do{result.push({container:walker.currentNode,offsetInContainer:text.length,offset:offset});offset=offsetList.shift()}while(!util.isUndefined(offset));return result};var getNodeInfo=function getNodeInfo(node){var path={};path.tagName=node.nodeName;if(node.id){path.id=node.id}var className=node.className.trim();if(className){path.className=className}return path};var getPath=function getPath(node,root){var paths=[];while(node&&node!==root){if(isElemNode(node)){paths.unshift(getNodeInfo(node))}node=node.parentNode}return paths};var getTableCellByDirection=function getTableCellByDirection(node,direction){var isForward=true;var targetElement=null;if(tui.util.isUndefined(direction)||direction!=="next"&&direction!=="previous"){return null}else if(direction==="previous"){isForward=false}if(isForward){targetElement=node.nextElementSibling}else{targetElement=node.previousElementSibling}return targetElement};var getSiblingRowCellByDirection=function getSiblingRowCellByDirection(node,direction,needEdgeCell){var isForward=true;var tableCellElement=null;var $node=void 0,index=void 0,$targetRowElement=void 0,$currentContainer=void 0,$siblingContainer=void 0,isSiblingContainerExists=void 0;if(tui.util.isUndefined(direction)||direction!=="next"&&direction!=="previous"){return null}else if(direction==="previous"){isForward=false}if(node){$node=$(node);if(isForward){$targetRowElement=$node.parent().next();$currentContainer=$node.parents("thead");$siblingContainer=$currentContainer[0]&&$currentContainer.next();isSiblingContainerExists=$siblingContainer&&getNodeName($siblingContainer[0])==="TBODY";index=0}else{$targetRowElement=$node.parent().prev();$currentContainer=$node.parents("tbody");$siblingContainer=$currentContainer[0]&&$currentContainer.prev();isSiblingContainerExists=$siblingContainer&&getNodeName($siblingContainer[0])==="THEAD";index=node.parentNode.childNodes.length-1}if(tui.util.isUndefined(needEdgeCell)||!needEdgeCell){index=getNodeOffsetOfParent(node)}if($targetRowElement[0]){tableCellElement=$targetRowElement.children("td,th")[index]}else if($currentContainer[0]&&isSiblingContainerExists){tableCellElement=$siblingContainer.find("td,th")[index]}return tableCellElement}return null};module.exports={getNodeName:getNodeName,isTextNode:isTextNode,isElemNode:isElemNode,getTextLength:getTextLength,getOffsetLength:getOffsetLength,getPrevOffsetNodeUntil:getPrevOffsetNodeUntil,getNodeOffsetOfParent:getNodeOffsetOfParent,getChildNodeByOffset:getChildNodeByOffset,getTopPrevNodeUnder:getTopPrevNodeUnder,getTopNextNodeUnder:getTopNextNodeUnder,getParentUntil:getParentUntil,getTopBlockNode:getTopBlockNode,getPrevTextNode:getPrevTextNode,findOffsetNode:findOffsetNode,getPath:getPath,getNodeInfo:getNodeInfo,getTableCellByDirection:getTableCellByDirection,getSiblingRowCellByDirection:getSiblingRowCellByDirection}},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);var _wwPasteContentHelper=__webpack_require__(13);var _wwPasteContentHelper2=_interopRequireDefault(_wwPasteContentHelper);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PASTE_TABLE_BOOKMARK="tui-paste-table-bookmark";var PASTE_TABLE_CELL_BOOKMARK="tui-paste-table-cell-bookmark";var WwClipboardManager=function(){function WwClipboardManager(wwe){_classCallCheck(this,WwClipboardManager);this.wwe=wwe;this._pch=new _wwPasteContentHelper2.default(this.wwe);this._selectedSellCount=0;this._$clipboardArea=null}_createClass(WwClipboardManager,[{key:"init",value:function init(){this.wwe.getEditor().addEventListener("willPaste",this._onWillPaste.bind(this));this.wwe.eventManager.listen("copy",this._onCopyCut.bind(this));this.wwe.eventManager.listen("copyAfter",this._onCopyAfter.bind(this));this.wwe.eventManager.listen("cut",this._onCopyCut.bind(this));this.wwe.eventManager.listen("cutAfter",this._onCutAfter.bind(this))}},{key:"_onCopyCut",value:function _onCopyCut(event){var tableManager=this.wwe.componentManager.getManager("tableSelection");var selectedCellCount=tableManager.getSelectedCells().length;if(!selectedCellCount){return}if(!tableManager.mergedTableSelectionManager){tableManager.createRangeBySelectedCells();tableManager.removeClassAttrbuteFromAllCellsIfNeed();return}var editor=this.wwe.getEditor();var clipboardEvent=event.data;var range=editor.getSelection().cloneRange();var $clipboardContainer=$("<div />");this._extendRange(range);$clipboardContainer.append(range.cloneContents());this._updateCopyDataForListTypeIfNeed(range,$clipboardContainer);this.wwe.eventManager.emit("copyBefore",{source:"wysiwyg",$clipboardContainer:$clipboardContainer});this._setClipboardData(clipboardEvent,$clipboardContainer.html(),$clipboardContainer.text())}},{key:"_clearClipboardArea",value:function _clearClipboardArea(){if(this._$clipboardArea){this._$clipboardArea.remove();this._$clipboardArea=null}}},{key:"_onCopyAfter",value:function _onCopyAfter(){this.wwe.getEditor().get$Body().focus();this._clearClipboardArea()}},{key:"_onCutAfter",value:function _onCutAfter(){var range=this.wwe.getEditor().getSelection();range.deleteContents();this.wwe.getEditor().focus();this._clearClipboardArea()}},{key:"_onWillPaste",value:function _onWillPaste(pasteData){var _this=this;var $clipboardContainer=$("<div>").append(pasteData.fragment.cloneNode(true));this._setTableBookmark($clipboardContainer);if(this._pasteToTable($clipboardContainer)){pasteData.preventDefault()}else{this._preparePaste($clipboardContainer);this._setTableBookmark($clipboardContainer);pasteData.fragment=document.createDocumentFragment();$($clipboardContainer[0].childNodes).each(function(index,element){pasteData.fragment.appendChild(element)})}var handler=function handler(){_this.wwe.getEditor().removeEventListener("input",handler);_this.wwe.eventManager.emit("wysiwygRangeChangeAfter",_this);_this._focusTableBookmark()};this.wwe.getEditor().addEventListener("input",handler)}},{key:"_setClipboardData",value:function _setClipboardData(clipboardEvent,htmlContent,textContent){if(tui.util.browser.msie){clipboardEvent.squirePrevented=true;this._$clipboardArea=this._createClipboardArea();this._$clipboardArea.html(htmlContent);this._$clipboardArea.focus();window.getSelection().selectAllChildren(this._$clipboardArea[0])}else{clipboardEvent.preventDefault();clipboardEvent.stopPropagation();clipboardEvent.clipboardData.setData("text/html",htmlContent);clipboardEvent.clipboardData.setData("text/plain",textContent)}}},{key:"_createClipboardArea",value:function _createClipboardArea(){return $("<DIV>").attr({contenteditable:"true",style:"position:fixed; overflow:hidden; top:0; right:100%; width:1px; height:1px;"}).appendTo(document.body)}},{key:"_updateCopyDataForListTypeIfNeed",value:function _updateCopyDataForListTypeIfNeed(range,$clipboardContainer){var commonAncestorNodeName=range.commonAncestorContainer.nodeName;if(commonAncestorNodeName!=="UL"&&commonAncestorNodeName!=="OL"){return}var $newParent=$("<"+commonAncestorNodeName+" />");$newParent.append($clipboardContainer.html());$clipboardContainer.html("");$clipboardContainer.append($newParent)}},{key:"_removeEmptyFontElement",value:function _removeEmptyFontElement($clipboardContainer){$clipboardContainer.children("font").each(function(index,element){var $element=$(element);if(!$element.text().trim()){$element.remove()}})}},{key:"_pasteToTable",value:function _pasteToTable($clipboardContainer){var tableManager=this.wwe.componentManager.getManager("table");var tableSelectionManager=this.wwe.componentManager.getManager("tableSelection");var range=this.wwe.getEditor().getSelection();var pastingToTable=tableManager.isInTable(range);var childNodes=$clipboardContainer[0].childNodes;var containsOneTableOnly=childNodes.length===1&&childNodes[0].nodeName==="TABLE";var processed=false;if(pastingToTable){if(containsOneTableOnly){tableManager.pasteClipboardData($clipboardContainer.first());$clipboardContainer.html("");processed=true}else if(tableSelectionManager.getSelectedCells().length){alert(_i18n2.default.get("Cannot paste values ​​other than a table in the cell selection state"));$clipboardContainer.html("");processed=true}}return processed}},{key:"_preparePaste",value:function _preparePaste($clipboardContainer){this._removeEmptyFontElement($clipboardContainer);this._pch.preparePaste($clipboardContainer);this.wwe.eventManager.emit("pasteBefore",{source:"wysiwyg",$clipboardContainer:$clipboardContainer})}},{key:"_setTableBookmark",value:function _setTableBookmark($clipboardContainer){var $lastNode=$($clipboardContainer[0].childNodes).last();var isLastNodeTable=$lastNode[0]&&$lastNode[0].nodeName==="TABLE";if(isLastNodeTable){$lastNode.addClass(PASTE_TABLE_BOOKMARK)}}},{key:"_focusTableBookmark",value:function _focusTableBookmark(){var sq=this.wwe.getEditor();var range=sq.getSelection().cloneRange();var $bookmarkedTable=sq.get$Body().find("."+PASTE_TABLE_BOOKMARK);var $bookmarkedCell=sq.get$Body().find("."+PASTE_TABLE_CELL_BOOKMARK);if($bookmarkedTable.length){$bookmarkedTable.removeClass(PASTE_TABLE_BOOKMARK);range.setEndAfter($bookmarkedTable[0]);range.collapse(false);sq.setSelection(range)}if($bookmarkedCell.length){$bookmarkedCell.removeClass(PASTE_TABLE_CELL_BOOKMARK);range.selectNodeContents($bookmarkedCell[0]);range.collapse(false);sq.setSelection(range)}}},{key:"_extendRange",value:function _extendRange(range){if(_domUtils2.default.isTextNode(range.commonAncestorContainer)&&(range.startOffset!==0||range.commonAncestorContainer.textContent.length!==range.endOffset)&&range.commonAncestorContainer.nodeName!=="TD"){return}if(range.startOffset===0){range=this._extendStartRange(range)}if(range.endOffset===_domUtils2.default.getOffsetLength(range.endContainer)){range=this._extendEndRange(range)}if(this._isWholeCommonAncestorContainerSelected(range)){range.selectNode(range.commonAncestorContainer)}this.wwe.getEditor().setSelection(range)}},{key:"_extendStartRange",value:function _extendStartRange(range){var newBound=range.startContainer;while(newBound.parentNode!==range.commonAncestorContainer&&newBound.parentNode!==this.wwe.get$Body()[0]&&!newBound.previousSibling){newBound=newBound.parentNode}range.setStart(newBound.parentNode,_domUtils2.default.getNodeOffsetOfParent(newBound));return range}},{key:"_extendEndRange",value:function _extendEndRange(range){var newBound=range.endContainer;var boundNext=newBound.nextSibling;while(newBound.parentNode!==range.commonAncestorContainer&&newBound.parentNode!==this.wwe.get$Body()[0]&&(!boundNext||_domUtils2.default.getNodeName(boundNext)==="BR"&&newBound.parentNode.lastChild===boundNext)){newBound=newBound.parentNode;boundNext=newBound.nextSibling}range.setEnd(newBound.parentNode,_domUtils2.default.getNodeOffsetOfParent(newBound)+1);return range}},{key:"_isWholeCommonAncestorContainerSelected",value:function _isWholeCommonAncestorContainerSelected(range){return range.commonAncestorContainer.nodeType===Node.ELEMENT_NODE&&range.commonAncestorContainer!==this.wwe.get$Body()[0]&&range.startOffset===0&&range.endOffset===range.commonAncestorContainer.childNodes.length&&range.commonAncestorContainer===range.startContainer&&range.commonAncestorContainer===range.endContainer}}]);return WwClipboardManager}();module.exports=WwClipboardManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);var _htmlSanitizer=__webpack_require__(14);var _htmlSanitizer2=_interopRequireDefault(_htmlSanitizer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var WwPasteContentHelper=function(){function WwPasteContentHelper(wwe){_classCallCheck(this,WwPasteContentHelper);this.wwe=wwe}_createClass(WwPasteContentHelper,[{key:"preparePaste",value:function preparePaste($container){var range=this.wwe.getEditor().getSelection().cloneRange();var codeblockManager=this.wwe.componentManager.getManager("codeblock");var firstBlockIsTaken=false;var $tempContainer=$("<div />");var nodeName=void 0,node=void 0,isPastingList=void 0;this._pasteFirstAid($container);var childNodes=util.toArray($container[0].childNodes);if(childNodes.length&&childNodes[0].tagName==="DIV"){$tempContainer.append(this._unwrapFragmentFirstChildForPasteAsInline(childNodes[0]));childNodes.shift()}while(childNodes.length){node=childNodes[0];nodeName=_domUtils2.default.getNodeName(node);isPastingList=nodeName==="LI"||nodeName==="UL"||nodeName==="OL";if(codeblockManager.isInCodeBlock(range)){$tempContainer.append(codeblockManager.prepareToPasteOnCodeblock(childNodes))}else if(isPastingList){$tempContainer.append(this._prepareToPasteList(childNodes,range,firstBlockIsTaken));firstBlockIsTaken=true}else{$tempContainer.append(childNodes.shift())}}$container.html($tempContainer.html())}},{key:"_wrapOrphanNodeWithDiv",value:function _wrapOrphanNodeWithDiv($container){var $tempContainer=$("<div />");var array=util.toArray($container[0].childNodes);var currentDiv=void 0;util.forEachArray(array,function(node){var isTextNode=node.nodeType===3;var isInlineNode=/^(SPAN|A|CODE|EM|I|STRONG|B|S|ABBR|ACRONYM|CITE|DFN|KBD|SAMP|VAR|BDO|Q|SUB|SUP)$/gi.test(node.tagName);if(isTextNode||isInlineNode){if(!currentDiv){currentDiv=document.createElement("div");$tempContainer.append(currentDiv)}currentDiv.appendChild(node)}else{if(currentDiv&&currentDiv.lastChild.tagName!=="BR"){currentDiv.appendChild($("<br/>")[0])}currentDiv=null;$tempContainer.append(node)}});return $tempContainer.html()}},{key:"_pasteFirstAid",value:function _pasteFirstAid($container){var _this=this;var blockTags="div, section, article, aside, nav, menus, p";$container.html((0,_htmlSanitizer2.default)($container.html(),true));$container.find("*").each(function(i,node){_this._removeStyles(node)});this._unwrapIfNonBlockElementHasBr($container);this._unwrapNestedBlocks($container,blockTags);this._removeUnnecessaryBlocks($container,blockTags);$container.html(this._wrapOrphanNodeWithDiv($container));this._preElementAid($container);this._tableElementAid($container);$container.children("br").remove()}},{key:"_preElementAid",value:function _preElementAid($container){var codeblockManager=this.wwe.componentManager.getManager("codeblock");codeblockManager.splitCodeblockToEachLine($container)}},{key:"_unwrapIfNonBlockElementHasBr",value:function _unwrapIfNonBlockElementHasBr($container){var nonBlockElements=$container.find("span, a, b, em, i, s");nonBlockElements.each(function(i,node){var brChildren=$(node).children("br");if(brChildren.length&&node.nodeName!=="LI"&&node.nodeName!=="UL"){brChildren.eq(0).unwrap()}})}},{key:"_unwrapNestedBlocks",value:function _unwrapNestedBlocks($container,blockTags){var $leafElements=$container.find(":not(:has(*))").not("b,s,i,em,code,span");$leafElements.each(function(i,node){var leafElement=node.nodeName==="BR"?$(node.parentNode):$(node);while(leafElement.parents(blockTags).length){var $parent=leafElement.parent(blockTags);if($parent.length&&$parent[0]!==$container[0]){leafElement.unwrap()}else{leafElement=leafElement.parent()}}})}},{key:"_removeUnnecessaryBlocks",value:function _removeUnnecessaryBlocks($container,blockTags){$container.find(blockTags).each(function(index,blockElement){var $blockElement=$(blockElement);var tagName=blockElement.tagName;var isDivElement=tagName==="DIV";var isInListItem=$blockElement.parent("li").length!==0;var isInBlockquote=$blockElement.parent("blockquote").length!==0;var hasBlockChildElement=$blockElement.children(blockTags).length;if(isDivElement&&(isInListItem||isInBlockquote||!hasBlockChildElement)){return}$blockElement.replaceWith($blockElement.html())})}},{key:"_removeStyles",value:function _removeStyles(node){var $node=$(node);var colorValue=void 0;if(_domUtils2.default.getNodeName($node[0])!=="SPAN"){$node.removeAttr("style")}else{if($node.attr("style")){colorValue=$node.css("color")}$node.removeAttr("style");if(colorValue){$node.css("color",colorValue)}else{$node.contents().unwrap()}}}},{key:"_prepareToPasteList",value:function _prepareToPasteList(nodes,rangeInfo,firstBlockIsTaken){var nodeName=_domUtils2.default.getNodeName(nodes[0]);var node=nodes.shift();var newFragment=this.wwe.getEditor().getDocument().createDocumentFragment();if(nodeName!=="LI"&&nodes.length&&nodes[0].tagName==="LI"){nodeName="LI";node=this._makeNodeAndAppend({tagName:nodeName},node)}if(nodeName==="OL"||nodeName==="UL"){if(!firstBlockIsTaken&&this.wwe.getEditor().hasFormat("LI")){$(newFragment).append(this._wrapCurrentFormat(node))}else{$(newFragment).append(node)}}else if(nodeName==="LI"){var listGroup=this.wwe.getEditor().getDocument().createDocumentFragment();listGroup.appendChild(node);while(nodes.length&&nodes[0].tagName==="LI"){listGroup.appendChild(nodes.shift())}if(!firstBlockIsTaken&&this.wwe.getEditor().hasFormat("LI")){$(newFragment).append(this._wrapCurrentFormat(listGroup))}else if(rangeInfo&&(rangeInfo.commonAncestorName==="UL"||rangeInfo.commonAncestorName==="OL")){$(newFragment).append(this._makeNodeAndAppend({tagName:rangeInfo.commonAncestorName},listGroup))}else{$(newFragment).append(this._makeNodeAndAppend({tagName:"UL"},listGroup))}}return newFragment}},{key:"_unwrapFragmentFirstChildForPasteAsInline",value:function _unwrapFragmentFirstChildForPasteAsInline(node){$(node).find("br").remove();return node.childNodes}},{key:"_wrapCurrentFormat",value:function _wrapCurrentFormat(nodes){var _this2=this;var currentTagName=void 0;this._eachCurrentPath(function(path){if(path.tagName!=="DIV"){if(_domUtils2.default.isElemNode(nodes)){currentTagName=nodes.tagName}else{currentTagName=nodes.firstChild.tagName}if(path.tagName!==currentTagName){nodes=_this2._makeNodeAndAppend(path,nodes)}}});return nodes}},{key:"_eachCurrentPath",value:function _eachCurrentPath(iteratee){var paths=_domUtils2.default.getPath(this.wwe.getEditor().getSelection().startContainer,this.wwe.get$Body()[0]);for(var i=paths.length-1;i>-1;i-=1){iteratee(paths[i])}}},{key:"_makeNodeAndAppend",value:function _makeNodeAndAppend(pathInfo,content){var node=$("<"+pathInfo.tagName+"/>");node.append(content);if(pathInfo.id){node.attr("id",pathInfo.id)}if(pathInfo.className){node.addClass(pathInfo.className)}return node[0]}},{key:"_tableElementAid",value:function _tableElementAid($container){this._completeTableIfNeed($container);this._updateTableIDClassName($container)}},{key:"_completeTableIfNeed",value:function _completeTableIfNeed($container){var tableManager=this.wwe.componentManager.getManager("table");var wrapperTr=tableManager.wrapDanglingTableCellsIntoTrIfNeed($container);if(wrapperTr){$container.append(wrapperTr)}var wrapperTbody=tableManager.wrapTrsIntoTbodyIfNeed($container);if(wrapperTbody){$container.append(wrapperTbody)}var wrapperTable=tableManager.wrapTheadAndTbodyIntoTableIfNeed($container);if(wrapperTable){$container.append(wrapperTable)}}},{key:"_updateTableIDClassName",value:function _updateTableIDClassName($container){var tableManager=this.wwe.componentManager.getManager("table");$container.find("table").each(function(index,table){$(table).removeClass(function(idx,className){return className.replace(/.*\s*(te-content-table-\d+)\s*.*/,"$1")})});$container.find("table").each(function(index,table){$(table).addClass(tableManager.getTableIDClassName())})}}]);return WwPasteContentHelper}();module.exports=WwPasteContentHelper},function(module,exports){"use strict";var util=tui.util;var HTML_ATTR_LIST_RX=new RegExp("^(abbr|align|alt|axis|bgcolor|border|cellpadding|cellspacing|class|clear|"+"color|cols|compact|coords|dir|face|headers|height|hreflang|hspace|"+"ismap|lang|language|nohref|nowrap|rel|rev|rows|rules|"+"scope|scrolling|shape|size|span|start|summary|tabindex|target|title|type|"+"valign|value|vspace|width|checked|mathvariant|encoding|id|name|"+"background|cite|href|longdesc|src|usemap|xlink:href|data-+|checked|style)","g");var SVG_ATTR_LIST_RX=new RegExp("^(accent-height|accumulate|additive|alphabetic|arabic-form|ascent|"+"baseProfile|bbox|begin|by|calcMode|cap-height|class|color|color-rendering|content|"+"cx|cy|d|dx|dy|descent|display|dur|end|fill|fill-rule|font-family|font-size|font-stretch|"+"font-style|font-variant|font-weight|from|fx|fy|g1|g2|glyph-name|gradientUnits|hanging|"+"height|horiz-adv-x|horiz-origin-x|ideographic|k|keyPoints|keySplines|keyTimes|lang|"+"marker-end|marker-mid|marker-start|markerHeight|markerUnits|markerWidth|mathematical|"+"max|min|offset|opacity|orient|origin|overline-position|overline-thickness|panose-1|"+"path|pathLength|points|preserveAspectRatio|r|refX|refY|repeatCount|repeatDur|"+"requiredExtensions|requiredFeatures|restart|rotate|rx|ry|slope|stemh|stemv|stop-color|"+"stop-opacity|strikethrough-position|strikethrough-thickness|stroke|stroke-dasharray|"+"stroke-dashoffset|stroke-linecap|stroke-linejoin|stroke-miterlimit|stroke-opacity|"+"stroke-width|systemLanguage|target|text-anchor|to|transform|type|u1|u2|underline-position|"+"underline-thickness|unicode|unicode-range|units-per-em|values|version|viewBox|visibility|"+"width|widths|x|x-height|x1|x2|xlink:actuate|xlink:arcrole|xlink:role|xlink:show|xlink:title|"+"xlink:type|xml:base|xml:lang|xml:space|xmlns|xmlns:xlink|y|y1|y2|zoomAndPan)","g");function htmlSanitizer(html,needHtmlText){var $html=$("<div />");html=html.replace(/<!--[\s\S]*?-->/g,"");$html.append(html);removeUnnecessaryTags($html);leaveOnlyWhitelistAttribute($html);return finalizeHtml($html,needHtmlText)}function removeUnnecessaryTags($html){$html.find("script, iframe, textarea, form, button, select, meta, style, link, title").remove()}function leaveOnlyWhitelistAttribute($html){$html.find("*").each(function(index,node){var blacklist=util.toArray(node.attributes).filter(function(attr){var isHTMLAttr=attr.name.match(HTML_ATTR_LIST_RX);var isSVGAttr=attr.name.match(SVG_ATTR_LIST_RX);return!isHTMLAttr&&!isSVGAttr});util.forEachArray(blacklist,function(attr){node.attributes.removeNamedItem(attr.name)})})}function finalizeHtml($html,needHtmlText){var returnValue=void 0;if(needHtmlText){returnValue=$html[0].innerHTML}else{var frag=document.createDocumentFragment();var childNodes=tui.util.toArray($html[0].childNodes);var length=childNodes.length;for(var i=0;i<length;i+=1){frag.appendChild(childNodes[i])}returnValue=frag}return returnValue}module.exports=htmlSanitizer},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var sharedInstance=void 0;var DEFAULT_CODE="en_US";var I18n=function(){function I18n(){_classCallCheck(this,I18n);this._code=DEFAULT_CODE;this._langs=new util.Map}_createClass(I18n,[{key:"setCode",value:function setCode(code){this._code=code}},{key:"setLang",value:function setLang(codes,data){var _this=this;codes=[].concat(codes);codes.forEach(function(code){if(!_this._langs.has(code)){_this._langs.set(code,data)}else{var langData=_this._langs.get(code);_this._langs.set(code,util.extend(langData,data))}})}},{key:"get",value:function get(key,code){if(!code){code=this._code}var langSet=this._langs.get(code);if(!langSet){langSet=this._langs.get(DEFAULT_CODE)}var text=langSet[key];if(!text){throw new Error('There is no text key "'+key+'" in '+code)}return text}}],[{key:"getSharedInstance",value:function getSharedInstance(){if(!sharedInstance){sharedInstance=new I18n}return sharedInstance}}]);return I18n}();exports.I18n=I18n;exports.default=I18n.getSharedInstance()},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var FIND_LI_ELEMENT=/<li/i;var WwListManager=function(){function WwListManager(wwe){_classCallCheck(this,WwListManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="list";this._init()}_createClass(WwListManager,[{key:"_init",value:function _init(){this._initEvent();this._initKeyHandler()}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygRangeChangeAfter",function(){_this._findAndRemoveEmptyList();_this._removeBranchListAll();_this._wrapDefaultBlockToListInner()});this.eventManager.listen("wysiwygSetValueAfter",function(){_this._removeBranchListAll();_this._wrapDefaultBlockToListInner()});this.eventManager.listen("wysiwygProcessHTMLText",function(html){return _this._prepareInsertBlankToBetweenSameList(html)});this.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(markdown){return markdown.replace(/:BLANK_LINE:\n/g,"")})}},{key:"_initKeyHandler",value:function _initKeyHandler(){var _this2=this;this.wwe.addKeyEventHandler("TAB",function(ev,range){var isNeedNext=void 0;if(range.collapsed){if(_this2.wwe.getEditor().hasFormat("LI")){ev.preventDefault();_this2.eventManager.emit("command","IncreaseDepth");isNeedNext=false}}return isNeedNext});this.wwe.addKeyEventHandler("SHIFT+TAB",function(ev,range){var isNeedNext=void 0;if(range.collapsed){if(_this2.wwe.getEditor().hasFormat("LI")){ev.preventDefault();var $ul=$(range.startContainer).closest("li").children("ul, ol")
;_this2.eventManager.emit("command","DecreaseDepth");if($ul.length&&!$ul.prev().length){_this2._removeBranchList($ul)}isNeedNext=false}}return isNeedNext});this.wwe.addKeyEventHandler("ENTER",function(ev,range){if(range.collapsed){if(_this2.wwe.getEditor().hasFormat("LI")){_this2.wwe.defer(function(){var afterRange=_this2.wwe.getRange();var $li=$(afterRange.startContainer).parents("li").eq(0);_this2._removeBranchListAll($li)})}}});this.wwe.addKeyEventHandler("BACK_SPACE",function(ev,range){if(range.collapsed){if(_this2.wwe.getEditor().hasFormat("LI")){_this2.wwe.defer(function(){_this2._removeBranchListAll()})}}})}},{key:"_findAndRemoveEmptyList",value:function _findAndRemoveEmptyList(){this.wwe.get$Body().find("ul,ol").each(function(index,node){if(!FIND_LI_ELEMENT.test(node.innerHTML)){$(node).remove()}})}},{key:"_removeBranchListAll",value:function _removeBranchListAll($root){var _this3=this;$root=!$root?this.wwe.get$Body():$($root);$root.find("li ul, li ol").each(function(idx,node){if(!node||node.previousSibling){return}_this3._removeBranchList(node)})}},{key:"_removeBranchList",value:function _removeBranchList(list){var $list=$(list);var $branchRoot=$list;while(!$branchRoot[0].previousSibling&&$branchRoot[0].parentElement.tagName.match(/UL|OL|LI/g)){$branchRoot=$branchRoot.parent()}var $firstLi=$branchRoot.children("li").eq(0);$branchRoot.prepend($list.children().unwrap());$firstLi.remove()}},{key:"_wrapDefaultBlockToListInner",value:function _wrapDefaultBlockToListInner(){this.wwe.get$Body().find("li").each(function(index,node){if($(node).children("div, p").length<=0){$(node).wrapInner("<div />");$(node).find("div").children("ul, ol").appendTo(node)}})}},{key:"_prepareInsertBlankToBetweenSameList",value:function _prepareInsertBlankToBetweenSameList(html){return html.replace(/<\/(ul|ol)>(<br \/>|<br>){0,}<\1>/g,"</$1>:BLANK_LINE:<$1>")}},{key:"getLinesOfSelection",value:function getLinesOfSelection(start,end){var lines=[];var isEndPassed=false;var needNext=true;var nextLine=void 0;if(_domUtils2.default.isTextNode(start)){start=$(start).parents("div").first()[0]}if(_domUtils2.default.isTextNode(end)){end=$(end).parents("div").first()[0]}for(var line=start;needNext;line=nextLine){if($(line).is("DIV")){lines.push(line);if(line===end){isEndPassed=true}nextLine=line.nextElementSibling}else{break}needNext=nextLine&&!isEndPassed}return lines}}]);return WwListManager}();module.exports=WwListManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TASK_CLASS_NAME="task-list-item";var TASK_ATTR_NAME="data-te-task";var TASK_CHECKED_CLASS_NAME="checked";var WwTaskManager=function(){function WwTaskManager(wwe){_classCallCheck(this,WwTaskManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="task";this._init()}_createClass(WwTaskManager,[{key:"_init",value:function _init(){this._initKeyHandler();this._initEvent();this.wwe.getEditor().addEventListener("mousedown",function(ev){var isOnTaskBox=ev.offsetX<18&&ev.offsetY<18;if(ev.target.hasAttribute(TASK_ATTR_NAME)&&isOnTaskBox){$(ev.target).toggleClass(TASK_CHECKED_CLASS_NAME)}})}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygSetValueAfter",function(){_this._removeTaskListClass()})}},{key:"_initKeyHandler",value:function _initKeyHandler(){var _this2=this;this.wwe.addKeyEventHandler("ENTER",function(ev,range){if(_this2.isInTaskList(range)){_this2.wwe.defer(function(){var newRange=_this2.wwe.getRange();var $li=$(newRange.startContainer).closest("li");$li.removeClass(TASK_CHECKED_CLASS_NAME)})}})}},{key:"isInTaskList",value:function isInTaskList(range){var li=void 0;if(!range){range=this.wwe.getEditor().getSelection().cloneRange()}if(range.startContainer.nodeType===Node.ELEMENT_NODE&&range.startContainer.tagName==="LI"){li=range.startContainer}else{li=$(range.startContainer).parents("li")[0]}return $(li).hasClass(TASK_CLASS_NAME)}},{key:"unformatTask",value:function unformatTask(node){var $li=$(node).closest("li");$li.removeClass(TASK_CLASS_NAME);$li.removeClass(TASK_CHECKED_CLASS_NAME);$li.removeAttr(TASK_ATTR_NAME);if(!$li.attr("class")){$li.removeAttr("class")}}},{key:"formatTask",value:function formatTask(node){var $selected=$(node);var $li=$selected.closest("li");$li.addClass(TASK_CLASS_NAME);$li.attr(TASK_ATTR_NAME,"")}},{key:"_formatTaskIfNeed",value:function _formatTaskIfNeed(){var range=this.wwe.getEditor().getSelection().cloneRange();if(this.isInTaskList(range)){this.formatTask(range.startContainer)}}},{key:"_removeTaskListClass",value:function _removeTaskListClass(){this.wwe.get$Body().find(".task-list").each(function(index,node){$(node).removeClass("task-list")})}},{key:"getLinesOfSelection",value:function getLinesOfSelection(start,end){var divOrLi="DIV,LI";var lines=[];var isEndPassed=false;var needNext=true;var nextLine=void 0;if(_domUtils2.default.isTextNode(start)){start=$(start).parents("div").first()[0]}if(_domUtils2.default.isTextNode(end)){end=$(end).parents("div").first()[0]}for(var line=start;needNext;line=nextLine){if($(line).is(divOrLi)){lines.push(line);if(line===end||line.parentNode===end){isEndPassed=true}var isStartInList=$(start).is("li")||$(start).parent("li").length!==0;nextLine=this._getNextLine(line,isStartInList,isEndPassed)}else{break}needNext=nextLine&&!isEndPassed}return lines}},{key:"_getNextLine",value:function _getNextLine(line,isStartInList,isEndPassed){var nextLine=void 0;if(isStartInList&&line.parentNode.tagName==="LI"){var $nextLI=$(line).parent().next();nextLine=$nextLI.children("div").first()[0];var hasNextLiHaveDivChild=$nextLI[0]&&!nextLine;var isLastLiInList=!$nextLI[0]&&!nextLine;if(hasNextLiHaveDivChild){nextLine=$nextLI[0]}else if(isLastLiInList&&!isEndPassed){nextLine=$(line).parents("ol,ul").first().next()[0]}}else{nextLine=line.nextElementSibling}return nextLine}}]);return WwTaskManager}();module.exports=WwTaskManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var isIE10=util.browser.msie&&util.browser.version===10;var TABLE_CLASS_PREFIX="te-content-table-";var isIE10And11=util.browser.msie&&(util.browser.version===10||util.browser.version===11);var BASIC_CELL_CONTENT=util.browser.msie?"":"<br>";var TABLE_CELL_SELECTED_CLASS_NAME="te-cell-selected";var WwTableManager=function(){function WwTableManager(wwe){_classCallCheck(this,WwTableManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="table";this._lastCellNode=null;this._init()}_createClass(WwTableManager,[{key:"_init",value:function _init(){this._initKeyHandler();this._initEvent();this.tableID=0}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygRangeChangeAfter.table",function(){var range=_this.wwe.getEditor().getSelection();var isRangeInTable=_this.isInTable(range);_this._unwrapBlockInTable();_this._completeTableIfNeed();if(!isRangeInTable){var selectionManager=_this.wwe.componentManager.getManager("tableSelection");selectionManager.removeClassAttrbuteFromAllCellsIfNeed()}_this._insertDefaultBlockBetweenTable()});this.eventManager.listen("wysiwygSetValueAfter.table",function(){_this._unwrapBlockInTable();_this._insertDefaultBlockBetweenTable()});this.eventManager.listen("wysiwygProcessHTMLText.table",function(html){return html.replace(/<br \/>(<\/td>|<\/th>)/g,"$1")});this.eventManager.listen("cut.table",function(){var selectionManager=_this.wwe.componentManager.getManager("tableSelection");var $selectedCells=selectionManager.getSelectedCells();if($selectedCells.length){$selectedCells.get().forEach(function(cell){return $(cell).html(BASIC_CELL_CONTENT)})}selectionManager.removeClassAttrbuteFromAllCellsIfNeed()});this.eventManager.listen("copyBefore.table",function(_ref){var $clipboardContainer=_ref.$clipboardContainer;return _this.updateTableHtmlOfClipboardIfNeed($clipboardContainer)});this.onBindedPaste=this._onPaste.bind(this);this.wwe.getEditor().addEventListener("paste",this.onBindedPaste)}},{key:"updateTableHtmlOfClipboardIfNeed",value:function updateTableHtmlOfClipboardIfNeed($clipboardContainer){var _this2=this;var selectionManager=this.wwe.componentManager.getManager("tableSelection");var $selectedCells=selectionManager.getSelectedCells();if($selectedCells.length){selectionManager.createRangeBySelectedCells();var fragment=this.wwe.getEditor().getSelection().cloneContents();$(fragment).children().each(function(index,node){var $node=$(node);if(!_this2.isTableOrSubTableElement(node.nodeName)){return}else if(node.nodeName==="TABLE"&&$node.find("thead").length===0&&$node.find("tbody").length===0){$node.remove()}else if(node.previousSibling&&node.previousSibling.nodeName==="TABLE"){node.previousSibling.appendChild(node)}else{_this2._completeIncompleteTable(node);if(node.nodeName!=="TABLE"&&node.nodeName!=="THEAD"){$(node).closest("table").find("thead").remove()}}});$clipboardContainer.append(fragment);$clipboardContainer.find("."+TABLE_CELL_SELECTED_CLASS_NAME).removeClass(TABLE_CELL_SELECTED_CLASS_NAME)}}},{key:"pasteClipboardData",value:function pasteClipboardData($clipboardTable){if(this.wwe.componentManager.getManager("tableSelection").getSelectedCells().length){return}this._expandTableIfNeed($clipboardTable);this._pasteDataIntoTable($clipboardTable)}},{key:"_onPaste",value:function _onPaste(ev){var range=this.wwe.getEditor().getSelection();var isNotPastingIntoTextNode=!_domUtils2.default.isTextNode(range.commonAncestorContainer);if(this.isInTable(range)&&!range.collapsed&&isNotPastingIntoTextNode){ev.preventDefault()}}},{key:"_initKeyHandler",value:function _initKeyHandler(){var _this3=this;this.keyEventHandlers={DEFAULT:function DEFAULT(ev,range,keymap){var isRangeInTable=_this3.isInTable(range);if(isRangeInTable&&!_this3._isSingleModifierKey(keymap)){_this3._recordUndoStateIfNeed(range);_this3._removeBRIfNeed(range);_this3._removeContentsAndChangeSelectionIfNeed(range,keymap,ev)}else if(!isRangeInTable&&_this3._lastCellNode){_this3._recordUndoStateAndResetCellNode(range)}if(isRangeInTable&&!_this3._isModifierKeyPushed(ev)){_this3.wwe.getEditor().modifyDocument(function(){var selectionManager=_this3.wwe.componentManager.getManager("tableSelection");selectionManager.removeClassAttrbuteFromAllCellsIfNeed()})}},ENTER:function ENTER(ev,range){var isNeedNext=void 0;if(_this3._isAfterTable(range)){ev.preventDefault();range.setStart(range.startContainer,range.startOffset-1);_this3.wwe.breakToNewDefaultBlock(range);isNeedNext=false}else if(_this3._isBeforeTable(range)){ev.preventDefault();_this3.wwe.breakToNewDefaultBlock(range,"before");isNeedNext=false}else if(_this3.isInTable(range)){_this3._appendBrIfTdOrThNotHaveAsLastChild(range);isNeedNext=false}return isNeedNext},BACK_SPACE:function BACK_SPACE(ev,range,keymap){return _this3._handleBackspaceAndDeleteKeyEvent(ev,range,keymap)},DELETE:function DELETE(ev,range,keymap){return _this3._handleBackspaceAndDeleteKeyEvent(ev,range,keymap)},TAB:function TAB(){return _this3._moveCursorTo("next","cell")},"SHIFT+TAB":function SHIFTTAB(ev){return _this3._moveCursorTo("previous","cell",ev)},UP:function UP(ev){return _this3._moveCursorTo("previous","row",ev)},DOWN:function DOWN(ev){return _this3._moveCursorTo("next","row",ev)}};util.forEach(this.keyEventHandlers,function(handler,key){return _this3.wwe.addKeyEventHandler(key,handler)})}},{key:"isInTable",value:function isInTable(range){var target=void 0,result=void 0;if(range.collapsed){target=range.startContainer;result=!!$(target).closest("[contenteditable=true] table").length}else{target=range.commonAncestorContainer;result=!!$(target).closest("[contenteditable=true] table").length||!!$(range.cloneContents()).find("table").length}return result}},{key:"_isBeforeTable",value:function _isBeforeTable(range){return _domUtils2.default.getNodeName(_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset))==="TABLE"}},{key:"_isAfterTable",value:function _isAfterTable(range){var prevElem=_domUtils2.default.getPrevOffsetNodeUntil(range.startContainer,range.startOffset);return _domUtils2.default.getNodeName(prevElem)==="TABLE"&&range.commonAncestorContainer===this.wwe.get$Body()[0]}},{key:"_handleBackspaceAndDeleteKeyEvent",value:function _handleBackspaceAndDeleteKeyEvent(ev,range,keymap){var isBackspace=keymap==="BACK_SPACE";var isTextOrElementDelete=range.commonAncestorContainer.nodeType!==3&&range.commonAncestorContainer!==this.wwe.get$Body()[0];var isNeedNext=void 0;if(range.collapsed){if(this.isInTable(range)){if(isBackspace){this._tableHandlerOnBackspace(range,ev)}else{this._tableHandlerOnDelete(range,ev)}this._insertBRIfNeed(range);this._removeContentsAndChangeSelectionIfNeed(range,keymap,ev);isNeedNext=false}else if(!isBackspace&&this._isBeforeTable(range)||isBackspace&&this._isAfterTable(range)){ev.preventDefault();var startOffset=isBackspace?range.startOffset-1:range.startOffset;this._removeTable(range,_domUtils2.default.getChildNodeByOffset(range.startContainer,startOffset));isNeedNext=false}}else if(this.isInTable(range)){if(isTextOrElementDelete){ev.preventDefault();this._removeContentsAndChangeSelectionIfNeed(range,keymap,ev);isNeedNext=false}}return isNeedNext}},{key:"_tableHandlerOnBackspace",value:function _tableHandlerOnBackspace(range,event){var prevNode=_domUtils2.default.getPrevOffsetNodeUntil(range.startContainer,range.startOffset,"TR"),prevNodeName=_domUtils2.default.getNodeName(prevNode);if(!prevNode||prevNodeName==="TD"||prevNodeName==="TH"){event.preventDefault()}else if(prevNodeName==="BR"&&prevNode.parentNode.childNodes.length!==1){event.preventDefault();$(prevNode).remove()}}},{key:"isNonTextDeleting",value:function isNonTextDeleting(range){var currentElement=range.startContainer;var nextNode=currentElement.nextSibling;var nextNodeName=_domUtils2.default.getNodeName(nextNode);var currentNodeName=_domUtils2.default.getNodeName(currentElement);var isCellDeleting=currentNodeName===nextNodeName&&currentNodeName!=="TEXT";var isEndOfText=(!nextNode||nextNodeName==="BR"&&nextNode.parentNode.lastChild===nextNode)&&_domUtils2.default.isTextNode(currentElement)&&range.startOffset===currentElement.nodeValue.length;var isLastCellOfRow=!isEndOfText&&$(currentElement).parents("tr").children().last()[0]===currentElement&&(currentNodeName==="TD"||currentNodeName==="TH");return isCellDeleting||isEndOfText||isLastCellOfRow}},{key:"_tableHandlerOnDelete",value:function _tableHandlerOnDelete(range,event){var needPreventDefault=this.isNonTextDeleting(range);if(needPreventDefault){event.preventDefault();range.startContainer.normalize()}}},{key:"_appendBrIfTdOrThNotHaveAsLastChild",value:function _appendBrIfTdOrThNotHaveAsLastChild(range){var startContainerNodeName=_domUtils2.default.getNodeName(range.startContainer);var tdOrTh=void 0;if(startContainerNodeName==="TD"||startContainerNodeName==="TH"){tdOrTh=range.startContainer}else{var paths=$(range.startContainer).parentsUntil("tr");tdOrTh=paths[paths.length-1]}if(_domUtils2.default.getNodeName(tdOrTh.lastChild)!=="BR"&&_domUtils2.default.getNodeName(tdOrTh.lastChild)!=="DIV"&&!isIE10And11){$(tdOrTh).append($("<br />")[0])}}},{key:"_unwrapBlockInTable",value:function _unwrapBlockInTable(){this.wwe.get$Body().find("td div,th div,tr>br,td>br,th>br").each(function(index,node){if(_domUtils2.default.getNodeName(node)==="BR"){var parentNodeName=_domUtils2.default.getNodeName(node.parentNode);var isInTableCell=/TD|TH/.test(parentNodeName);var isEmptyTableCell=node.parentNode.textContent.length===0;var isLastBR=node.parentNode.lastChild===node;if(parentNodeName==="TR"||isInTableCell&&!isEmptyTableCell&&isLastBR){$(node).remove()}}else{$(node).children().unwrap()}})}},{key:"_insertDefaultBlockBetweenTable",value:function _insertDefaultBlockBetweenTable(){this.wwe.get$Body().find("table").each(function(index,node){if(node.nextElementSibling&&node.nextElementSibling.nodeName==="TABLE"){$("<div><br /></div>").insertAfter(node)}})}},{key:"_removeTable",value:function _removeTable(range,table){if(table.tagName==="TABLE"){this.wwe.getEditor().saveUndoState(range);this.wwe.saveSelection(range);$(table).remove();this.wwe.restoreSavedSelection()}}},{key:"_recordUndoStateIfNeed",value:function _recordUndoStateIfNeed(range){var currentCellNode=_domUtils2.default.getParentUntil(range.startContainer,"TR");if(range.collapsed&&currentCellNode&&this._lastCellNode!==currentCellNode){this.wwe.getEditor().saveUndoState(range);this._lastCellNode=currentCellNode}}},{key:"_recordUndoStateAndResetCellNode",value:function _recordUndoStateAndResetCellNode(range){this.wwe.getEditor().saveUndoState(range);this.resetLastCellNode()}},{key:"_pasteDataIntoTable",value:function _pasteDataIntoTable(fragment){var range=this.wwe.getEditor().getSelection();var tableData=this._getTableDataFromTable(fragment);var startContainer=range.startContainer;var parentNode=startContainer.parentNode;var isTextInTableCell=parentNode.tagName==="TD"||parentNode.tagName==="TH";var isTableCell=startContainer.tagName==="TD"||startContainer.tagName==="TH";var isTextNode=startContainer.nodeType===3;var brString=isIE10?"":"<br />";var anchorElement=void 0,td=void 0,tr=void 0,tdContent=void 0;if(isTextNode&&isTextInTableCell){anchorElement=parentNode}else if(isTableCell){anchorElement=startContainer}else{anchorElement=$(startContainer).find("th,td")[0]}td=anchorElement;while(tableData.length){tr=tableData.shift();while(td&&tr.length){tdContent=tr.shift();if(tdContent.length){td.textContent=tdContent}else{td.innerHTML=brString}td=_domUtils2.default.getTableCellByDirection(td,"next")}td=_domUtils2.default.getSiblingRowCellByDirection(anchorElement,"next",false);anchorElement=td}}},{key:"_getTableDataFromTable",value:function _getTableDataFromTable(fragment){var $fragment=$(fragment);var tableData=[];var trs=$fragment.find("tr");trs.each(function(i,tr){var trData=[];var tds=$(tr).children();tds.each(function(index,cell){trData.push(cell.textContent)});if(trData.length){tableData.push(trData)}});return tableData}},{key:"_removeTableContents",value:function _removeTableContents(selectedCells){this.wwe.getEditor().saveUndoState();selectedCells.each(function(i,cell){var brHTMLString=isIE10?"":"<br />";$(cell).html(brHTMLString)})}},{key:"wrapDanglingTableCellsIntoTrIfNeed",value:function wrapDanglingTableCellsIntoTrIfNeed($container){var danglingTableCells=$container.children("td,th");var tr=void 0;if(danglingTableCells.length){var $wrapperTr=$("<tr></tr>");danglingTableCells.each(function(i,cell){$wrapperTr.append(cell)});tr=$wrapperTr[0]}return tr}},{key:"wrapTrsIntoTbodyIfNeed",value:function wrapTrsIntoTbodyIfNeed($container){var danglingTrs=$container.children("tr");var ths=danglingTrs.find("th");var tbody=void 0;if(ths.length){ths.each(function(i,node){var $node=$(node);var td=$("<td></td>");td.html($node.html());td.insertBefore(node);$node.detach()})}if(danglingTrs.length){var $wrapperTableBody=$("<tbody></tbody>");danglingTrs.each(function(i,tr){$wrapperTableBody.append(tr)});tbody=$wrapperTableBody[0]}return tbody}},{key:"wrapTheadAndTbodyIntoTableIfNeed",value:function wrapTheadAndTbodyIntoTableIfNeed($container){var danglingThead=$container.children("thead");var danglingTbody=$container.children("tbody");var $wrapperTable=$("<table></table>");var table=void 0;if(!danglingTbody.length&&danglingThead.length){$wrapperTable.append(danglingThead[0]);$wrapperTable.append("<tbody><tr></tr></tbody>");table=$wrapperTable[0]}else if(danglingTbody.length&&!danglingThead.length){$wrapperTable.append("<thead><tr></tr></thead>");$wrapperTable.append(danglingTbody[0]);table=$wrapperTable[0]}else if(danglingTbody.length&&danglingThead.length){$wrapperTable.append(danglingThead[0]);$wrapperTable.append(danglingTbody[0]);table=$wrapperTable[0]}return table}},{key:"isTableOrSubTableElement",value:function isTableOrSubTableElement(pastingNodeName){return pastingNodeName==="TABLE"||pastingNodeName==="TBODY"||pastingNodeName==="THEAD"||pastingNodeName==="TR"||pastingNodeName==="TD"}},{key:"_stuffTableCellsIntoIncompleteRow",value:function _stuffTableCellsIntoIncompleteRow($trs,maximumCellLength){$trs.each(function(rowIndex,row){var $row=$(row);var tableCells=$row.find("th,td");var parentNodeName=_domUtils2.default.getNodeName($row.parent()[0]);var cellTagName=parentNodeName==="THEAD"?"th":"td";for(var cellLength=tableCells.length;cellLength<maximumCellLength;cellLength+=1){$row.append($(tableCellGenerator(1,cellTagName))[0])}})}},{key:"prepareToTableCellStuffing",value:function prepareToTableCellStuffing($trs){var maximumCellLength=$trs.eq(0).find("th,td").length;var needTableCellStuffingAid=false;$trs.each(function(i,row){var cellCount=$(row).find("th,td").length;if(maximumCellLength!==cellCount){needTableCellStuffingAid=true;if(maximumCellLength<cellCount){maximumCellLength=cellCount}}});return{maximumCellLength:maximumCellLength,needTableCellStuffingAid:needTableCellStuffingAid}}},{key:"_addTbodyOrTheadIfNeed",value:function _addTbodyOrTheadIfNeed($table){var isTheadNotExists=!$table.find("thead").length;var isTbodyNotExists=!$table.find("tbody").length;var absentNode=void 0;if(isTheadNotExists){absentNode=$("<thead><tr></tr></thead>")[0];$table.prepend(absentNode)}else if(isTbodyNotExists){absentNode=$("<tbody><tr></tr></tbody>")[0];$table.append(absentNode)}}},{key:"tableCellAppendAidForTableElement",value:function tableCellAppendAidForTableElement(node){var $table=$(node);this._addTbodyOrTheadIfNeed($table);this._addTrIntoContainerIfNeed($table);var trs=$table.find("tr");var tableAidInformation=this.prepareToTableCellStuffing(trs);var maximumCellLength=tableAidInformation.maximumCellLength;var needTableCellStuffingAid=tableAidInformation.needTableCellStuffingAid;if(needTableCellStuffingAid){this._stuffTableCellsIntoIncompleteRow(trs,maximumCellLength)}}},{key:"_generateTheadAndTbodyFromTbody",value:function _generateTheadAndTbodyFromTbody(node){var tr=$("<tr></tr>");var thead=$("<thead></thead>");tr.append(tableCellGenerator($(node).find("tr").eq(0).find("td").length,"th"));thead.append(tr);return{thead:thead[0],tbody:node}}},{key:"_generateTheadAndTbodyFromThead",value:function _generateTheadAndTbodyFromThead(node){var tr=$("<tr></tr>");var tbody=$("<tbody></tbody>");tr.append(tableCellGenerator($(node).find("th").length,"td"));tbody.append(tr);return{thead:node,tbody:tbody[0]}}},{key:"_generateTheadAndTbodyFromTr",value:function _generateTheadAndTbodyFromTr(node){var $node=$(node);var thead=$("<thead></thead>");var tbody=$("<tbody></tbody>");var theadRow=void 0,tbodyRow=void 0;if($node.children()[0].tagName==="TH"){theadRow=node;tbodyRow=$("<tr>"+tableCellGenerator($node.find("th").length,"td")+"</tr>")[0]}else{theadRow=$("<tr>"+tableCellGenerator($node.find("td").length,"th")+"</tr>")[0];tbodyRow=node}thead.append(theadRow);tbody.append(tbodyRow);return{thead:thead[0],tbody:tbody[0]}}},{key:"_completeIncompleteTable",value:function _completeIncompleteTable(node,useHeader){var nodeName=node.tagName;var table=void 0,completedTableContents=void 0;useHeader=util.isUndefined(useHeader)?true:useHeader;if(nodeName==="TABLE"){table=node}else{table=$("<table></table>");table.insertAfter(node);if(nodeName==="TBODY"){completedTableContents=this._generateTheadAndTbodyFromTbody(node)}else if(nodeName==="THEAD"){completedTableContents=this._generateTheadAndTbodyFromThead(node)}else if(nodeName==="TR"){completedTableContents=this._generateTheadAndTbodyFromTr(node)}if(useHeader){table.append(completedTableContents.thead)}table.append(completedTableContents.tbody)}this.tableCellAppendAidForTableElement(table)}},{key:"_completeTableIfNeed",value:function _completeTableIfNeed(){var _this4=this;var $body=this.wwe.getEditor().get$Body();$body.children().each(function(index,node){var $node=$(node);if(!_this4.isTableOrSubTableElement(node.nodeName)){return}else if(node.nodeName==="TABLE"&&$node.find("thead").length===0&&$node.find("tbody").length===0){$node.remove()}_this4._completeIncompleteTable(node)})}},{key:"resetLastCellNode",value:function resetLastCellNode(){this._lastCellNode=null}},{key:"setLastCellNode",value:function setLastCellNode(node){this._lastCellNode=node}},{key:"_isSingleModifierKey",value:function _isSingleModifierKey(keymap){return keymap==="META"||keymap==="SHIFT"||keymap==="ALT"||keymap==="CONTROL"}},{key:"_isModifierKeyPushed",value:function _isModifierKeyPushed(ev){return ev.metaKey||ev.ctrlKey||ev.altKey||ev.shiftKey}},{key:"_addTrIntoContainerIfNeed",value:function _addTrIntoContainerIfNeed($table){var $trContainers=$table.children();$trContainers.each(function(i,container){var hasNoRows=$(container).find("tr").length===0;if(hasNoRows){$(container).append($("<tr></tr>")[0])}})}},{key:"_expandTableIfNeed",value:function _expandTableIfNeed(fragment){var range=this.wwe.getEditor().getSelection().cloneRange();var $table=$(range.startContainer).parents("table");var difference=this._getColumnAndRowDifference(fragment,range);if(difference.column<0){this._appendCellForAllRow($table,difference.column)}if(difference.row<0){this._appendRow($table,difference.row)}}},{key:"_getColumnAndRowDifference",value:function _getColumnAndRowDifference(fragment,range){var tableData=this._getTableDataFromTable(fragment);var rowLength=tableData.length;var columnLength=tableData[0].length;var $currentCell=$(range.startContainer).closest("th,td");var $currentRow=$currentCell.parent();var currentColumnIndex=_domUtils2.default.getNodeOffsetOfParent($currentCell[0]);var currentRowIndex=_domUtils2.default.getNodeOffsetOfParent($currentCell[0].parentNode);var $table=$currentRow.parents("table");var tableColumnLength=$table.find("tr").eq(0).children().length;var tableRowLength=$table.find("tr").length;var isInTbody=$currentRow.parents("tbody").length;if(isInTbody){currentRowIndex+=1}return{row:tableRowLength-(currentRowIndex+rowLength),column:tableColumnLength-(currentColumnIndex+columnLength)}}},{key:"_appendCellForAllRow",value:function _appendCellForAllRow($table,columnDifference){var brString=isIE10?"":"<br />";$table.find("tr").each(function(i,row){var tagName=void 0;for(var index=columnDifference;index<0;index+=1){if(i===0){tagName="th"}else{tagName="td"}$(row).append($("<"+tagName+">"+brString+"</"+tagName+">")[0])}})}},{key:"_appendRow",value:function _appendRow($table,rowDifference){var newRow=$table.find("tr").last().clone();var brHTMLSting=isIE10?"":"<br />";newRow.find("td").html(brHTMLSting);for(;rowDifference<0;rowDifference+=1){$table.find("tbody").append(newRow.clone()[0])}}},{key:"_getSiblingTextNodeByDirection",value:function _getSiblingTextNodeByDirection(currentTextNode,isNext){var isPreviousLineExist=currentTextNode.previousSibling&&currentTextNode.previousSibling.nodeName==="BR"&&currentTextNode.previousSibling.previousSibling&&currentTextNode.previousSibling.previousSibling.nodeType===3;var isNextLineExist=currentTextNode.nextSibling&&currentTextNode.nextSibling.nodeName==="BR"&&currentTextNode.nextSibling.nextSibling&&currentTextNode.nextSibling.nextSibling.nodeType===3;var target=void 0;if(isNext&&isNextLineExist){target=currentTextNode.nextSibling.nextSibling}else if(!isNext&&isPreviousLineExist){target=currentTextNode.previousSibling.previousSibling}return target}},{key:"_changeSelectionToTargetCell",value:function _changeSelectionToTargetCell(currentCell,range,direction,scale){var startContainer=range.startContainer;var isNext=direction==="next";var isRow=scale==="row";var target=void 0,textOffset=void 0;if(isRow){if(_domUtils2.default.isTextNode(startContainer)){target=this._getSiblingTextNodeByDirection(startContainer,isNext);if(target){textOffset=target.length<range.startOffset?target.length:range.startOffset;range.setStart(target,textOffset);range.collapse(true);return}}target=_domUtils2.default.getSiblingRowCellByDirection(currentCell,direction,false)}else{target=_domUtils2.default.getTableCellByDirection(currentCell,direction);if(!target){target=_domUtils2.default.getSiblingRowCellByDirection(currentCell,direction,true)}}if(target){range.setStart(target,0);range.collapse(true)}else{target=$(currentCell).parents("table")[0];if(isNext){range.setStart(target.nextElementSibling,0)}else if(target.previousElementSibling&&target.previousElementSibling.nodeName!=="TABLE"){range.setStart(target.previousElementSibling,1)}else{range.setStartBefore(target)}range.collapse(true)}}},{key:"_moveCursorTo",value:function _moveCursorTo(direction,interval,ev){var sq=this.wwe.getEditor();var range=sq.getSelection().cloneRange();var currentCell=$(range.startContainer).closest("td,th")[0];var isNeedNext=void 0;if(range.collapsed){if(this.isInTable(range)&&currentCell){if((direction==="previous"||interval==="row")&&!util.isUndefined(ev)){ev.preventDefault()}this._changeSelectionToTargetCell(currentCell,range,direction,interval);sq.setSelection(range);isNeedNext=false}}return isNeedNext}},{key:"_removeContentsAndChangeSelectionIfNeed",value:function _removeContentsAndChangeSelectionIfNeed(range,keymap,ev){var isTextInput=keymap.length<=1;var isDeleteOperation=keymap==="BACK_SPACE"||keymap==="DELETE";var selectedCells=this.wwe.componentManager.getManager("tableSelection").getSelectedCells();var firstSelectedCell=selectedCells.first()[0];if((isTextInput||isDeleteOperation)&&!this._isModifierKeyPushed(ev)&&selectedCells.length){if(isDeleteOperation){this._recordUndoStateIfNeed(range)}this._removeTableContents(selectedCells);this._lastCellNode=firstSelectedCell;range.setStart(firstSelectedCell,0);range.collapse(true);this.wwe.getEditor().setSelection(range)}}},{key:"getTableIDClassName",value:function getTableIDClassName(){var tableClassName=TABLE_CLASS_PREFIX+this.tableID;this.tableID+=1;return tableClassName}},{key:"_removeBRIfNeed",value:function _removeBRIfNeed(range){var isText=_domUtils2.default.isTextNode(range.startContainer);var startContainer=isText?range.startContainer.parentNode:range.startContainer;var nodeName=_domUtils2.default.getNodeName(startContainer);if(/td|th/i.test(nodeName)&&range.collapsed&&startContainer.textContent.length===1){$(startContainer).find("br").remove()}}},{key:"_insertBRIfNeed",value:function _insertBRIfNeed(range){var isText=_domUtils2.default.isTextNode(range.startContainer);var currentCell=isText?range.startContainer.parentNode:range.startContainer;var nodeName=_domUtils2.default.getNodeName(currentCell);var $currentCell=$(currentCell)
;if(/td|th/i.test(nodeName)&&range.collapsed&&!currentCell.textContent.length&&!$currentCell.children().length&&!isIE10And11){currentCell.normalize();$currentCell.append("<br>")}}},{key:"destroy",value:function destroy(){var _this5=this;this.eventManager.removeEventHandler("wysiwygRangeChangeAfter.table");this.eventManager.removeEventHandler("wysiwygSetValueAfter.table");this.eventManager.removeEventHandler("wysiwygProcessHTMLText.table");this.eventManager.removeEventHandler("cut.table");this.eventManager.removeEventHandler("copyBefore.table");this.wwe.getEditor().removeEventListener("paste",this.onBindedPaste);util.forEach(this.keyEventHandlers,function(handler,key){return _this5.wwe.removeKeyEventHandler(key,handler)})}}]);return WwTableManager}();function tableCellGenerator(amount,tagName){var brHTMLString="<br />";var cellString="<"+tagName+">"+brHTMLString+"</"+tagName+">";var tdString="";for(var i=0;i<amount;i+=1){tdString=tdString+cellString}return tdString}module.exports=WwTableManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var TABLE_CELL_SELECTED_CLASS_NAME="te-cell-selected";var WwTableSelectionManager=function(){function WwTableSelectionManager(wwe){_classCallCheck(this,WwTableSelectionManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="tableSelection";this._init()}_createClass(WwTableSelectionManager,[{key:"_init",value:function _init(){this._initEvent();if(tui.util.browser.firefox){document.execCommand("enableObjectResizing",false,"false");document.execCommand("enableInlineTableEditing",false,"false")}}},{key:"_initEvent",value:function _initEvent(){var _this=this;var selectionStart=void 0,selectionEnd=void 0,validSelectionEnd=void 0;this._tableSelectionTimer=null;this._removeSelectionTimer=null;this._isSelectionStarted=false;var onMouseover=function onMouseover(ev){selectionEnd=$(ev.data.target).closest("[contenteditable=true] td,th")[0];var range=_this.wwe.getEditor().getSelection();var isEndsInTable=$(selectionEnd).parents("[contenteditable=true] table")[0];var isSameCell=selectionStart===selectionEnd;var isTextSelect=_this._isTextSelect(range,isSameCell)&&!$(selectionStart).hasClass(TABLE_CELL_SELECTED_CLASS_NAME);if(_this._isSelectionStarted&&isEndsInTable&&!isTextSelect){window.getSelection().removeAllRanges();if(tui.util.browser.firefox&&!_this._removeSelectionTimer){_this._removeSelectionTimer=setInterval(function(){window.getSelection().removeAllRanges()},10)}_this.highlightTableCellsBy(selectionStart,selectionEnd);validSelectionEnd=selectionEnd}};var finishSelection=function finishSelection(){if(_this._isSelectionStarted){_this._isSelectionStarted=false;_this.eventManager.removeEventHandler("mouseover.tableSelection");_this.eventManager.removeEventHandler("mouseup.tableSelection")}};var onMouseup=function onMouseup(ev){selectionEnd=$(ev.data.target).closest("[contenteditable=true] td,th")[0];var range=_this.wwe.getEditor().getSelection();var isSameCell=selectionStart===selectionEnd;var isTextSelect=_this._isTextSelect(range,isSameCell)&&!$(selectionStart).hasClass(TABLE_CELL_SELECTED_CLASS_NAME);_this._clearTableSelectionTimerIfNeed();if(_this._isSelectionStarted){if(isTextSelect){_this.removeClassAttrbuteFromAllCellsIfNeed()}else{_this.wwe.componentManager.getManager("table").resetLastCellNode();selectionEnd=selectionEnd||validSelectionEnd;range=_this.wwe.getEditor().getSelection();range.setStart(selectionEnd,0);if(tui.util.browser.msie){range.setEnd(selectionEnd,1)}else{range.setEnd(selectionEnd,0);range.collapse(false)}_this.wwe.getEditor().setSelection(range)}if(_this.onDragEnd){_this.onDragEnd()}}finishSelection()};var onMousedown=function onMousedown(ev){var MOUSE_RIGHT_BUTTON=2;selectionStart=$(ev.data.target).closest("[contenteditable=true] td,th")[0];var isSelectedCell=$(selectionStart).hasClass(TABLE_CELL_SELECTED_CLASS_NAME);selectionEnd=null;if(!isSelectedCell||isSelectedCell&&ev.data.button!==MOUSE_RIGHT_BUTTON){_this.removeClassAttrbuteFromAllCellsIfNeed();_this.setTableSelectionTimerIfNeed(selectionStart);_this.eventManager.listen("mouseover.tableSelection",onMouseover);_this.eventManager.listen("mouseup.tableSelection",onMouseup);if(_this.onDragStart&&selectionStart){_this.onDragStart(selectionStart)}}else if(ev.data.button===MOUSE_RIGHT_BUTTON){finishSelection()}};this.eventManager.listen("mousedown.tableSelection",onMousedown);this.eventManager.listen("copyBefore.tableSelection",finishSelection);this.eventManager.listen("pasteBefore.tableSelection",finishSelection)}},{key:"_isTextSelect",value:function _isTextSelect(range,isSameCell){return/TD|TH|TEXT/i.test(range.commonAncestorContainer.nodeName)&&isSameCell}},{key:"setTableSelectionTimerIfNeed",value:function setTableSelectionTimerIfNeed(selectionStart){var isTableSelecting=$(selectionStart).parents("[contenteditable=true] table").length;if(isTableSelecting){this._isSelectionStarted=true}}},{key:"_clearTableSelectionTimerIfNeed",value:function _clearTableSelectionTimerIfNeed(){clearTimeout(this._tableSelectionTimer);if(tui.util.browser.firefox&&this._removeSelectionTimer){clearTimeout(this._removeSelectionTimer);this._removeSelectionTimer=null}}},{key:"_reArrangeSelectionIfneed",value:function _reArrangeSelectionIfneed(selectionStart,selectionEnd){var isRangeStartInTable=$(selectionStart).parents("[contenteditable=true] table").length;var isRangeEndInTable=$(selectionEnd).parents("[contenteditable=true] table").length;var isStartRangeOut=isRangeEndInTable&&!isRangeStartInTable;var isEndRangeOut=!isRangeEndInTable&&isRangeStartInTable;if(isStartRangeOut){selectionStart=$(selectionEnd).parents("[contenteditable=true] table").find("th").first()[0]}else if(isEndRangeOut){selectionEnd=$(selectionStart).parents("[contenteditable=true] table").find("td").last()[0]}return{startContainer:selectionStart,endContainer:selectionEnd}}},{key:"_applySelectionDirection",value:function _applySelectionDirection(selectionInformation,range){var nodeOffsetOfParent=_domUtils2.default.getNodeOffsetOfParent;var selectionStart=selectionInformation.startContainer;var selectionEnd=selectionInformation.endContainer;var rowDirection=nodeOffsetOfParent($(selectionStart).closest("[contenteditable=true] tr")[0])-nodeOffsetOfParent($(selectionEnd).closest("[contenteditable=true] tr")[0]);var cellDirection=nodeOffsetOfParent(selectionStart)-nodeOffsetOfParent(selectionEnd);var isSameRow=rowDirection===0;var isRowIncreases=rowDirection<0;var isColumnIncreases=cellDirection>0;if(isSameRow){if(isColumnIncreases){range.setStart(selectionEnd,0);range.setEnd(selectionStart,1)}else{range.setStart(selectionStart,0);range.setEnd(selectionEnd,1)}}else if(isRowIncreases){range.setStart(selectionStart,0);range.setEnd(selectionEnd,1)}else{range.setStart(selectionEnd,0);range.setEnd(selectionStart,1)}return range}},{key:"getSelectionRangeFromTable",value:function getSelectionRangeFromTable(selectionStart,selectionEnd){var nodeOffsetOfParent=_domUtils2.default.getNodeOffsetOfParent;var startRowOffset=nodeOffsetOfParent(selectionStart.parentNode);var endRowOffset=nodeOffsetOfParent(selectionEnd.parentNode);var startCellOffset=nodeOffsetOfParent(selectionStart);var endCellOffset=nodeOffsetOfParent(selectionEnd);var startCellContainer=_domUtils2.default.getParentUntil(selectionStart,"TABLE");var endCellContainer=_domUtils2.default.getParentUntil(selectionEnd,"TABLE");var isReversedTheadAndTbodySelect=_domUtils2.default.getNodeName(startCellContainer)==="TBODY"&&_domUtils2.default.getNodeName(endCellContainer)==="THEAD";var isTheadAndTbodySelect=startCellContainer!==endCellContainer;var isBothInTbody=!!$(selectionStart).parents("tbody").length&&!!$(selectionEnd).parents("tbody").length;var start={row:startRowOffset,cell:startCellOffset};var end={row:endRowOffset,cell:endCellOffset};var from=void 0,to=void 0;if(isReversedTheadAndTbodySelect){start.row+=1}else if(isTheadAndTbodySelect){end.row+=1}else if(isBothInTbody){start.row+=1;end.row+=1}if(startRowOffset>endRowOffset||startRowOffset===endRowOffset&&startCellOffset>endCellOffset){from=end;to=start}else{from=start;to=end}return{from:from,to:to}}},{key:"highlightTableCellsBy",value:function highlightTableCellsBy(selectionStart,selectionEnd){var trs=$(selectionStart).parents("[contenteditable=true] table").find("tr");var selection=this.getSelectionRangeFromTable(selectionStart,selectionEnd);var rowFrom=selection.from.row;var cellFrom=selection.from.cell;var rowTo=selection.to.row;var cellTo=selection.to.cell;trs.each(function(rowIndex,row){$(row).find("td,th").each(function(cellIndex,cell){var $cell=$(cell);var isFromRow=rowIndex===rowFrom;var isToRow=rowIndex===rowTo;if(isFromRow&&cellIndex<cellFrom||isToRow&&cellIndex>cellTo||rowIndex<rowFrom||rowIndex>rowTo){$cell.removeClass(TABLE_CELL_SELECTED_CLASS_NAME)}else{$cell.addClass(TABLE_CELL_SELECTED_CLASS_NAME)}})})}},{key:"removeClassAttrbuteFromAllCellsIfNeed",value:function removeClassAttrbuteFromAllCellsIfNeed(){this.wwe.get$Body().find("td."+TABLE_CELL_SELECTED_CLASS_NAME+",th."+TABLE_CELL_SELECTED_CLASS_NAME).each(function(i,node){var $node=$(node);$node.removeClass(TABLE_CELL_SELECTED_CLASS_NAME);if(!$node.attr("class").length){$node.removeAttr("class")}})}},{key:"getSelectedCells",value:function getSelectedCells(){return this.wwe.get$Body().find("."+TABLE_CELL_SELECTED_CLASS_NAME)}},{key:"createRangeBySelectedCells",value:function createRangeBySelectedCells(){var sq=this.wwe.getEditor();var range=sq.getSelection().cloneRange();var selectedCells=this.getSelectedCells();var tableManager=this.wwe.componentManager.getManager("table");var firstSelectedCell=selectedCells.first()[0];var lastSelectedCell=selectedCells.last()[0];if(selectedCells.length&&tableManager.isInTable(range)){range.setStart(firstSelectedCell,0);range.setEnd(lastSelectedCell,lastSelectedCell.childNodes.length);sq.setSelection(range)}}},{key:"styleToSelectedCells",value:function styleToSelectedCells(onStyle){this.createRangeBySelectedCells();onStyle(this.wwe.getEditor())}},{key:"destroy",value:function destroy(){this.eventManager.removeEventHandler("mousedown.tableSelection");this.eventManager.removeEventHandler("mouseover.tableSelection");this.eventManager.removeEventHandler("mouseup.tableSelection");this.eventManager.removeEventHandler("copyBefore.tableSelection");this.eventManager.removeEventHandler("pasteBefore.tableSelection")}}]);return WwTableSelectionManager}();module.exports=WwTableSelectionManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var WwHrManager=function(){function WwHrManager(wwe){_classCallCheck(this,WwHrManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="hr";this._init()}_createClass(WwHrManager,[{key:"_init",value:function _init(){this._initKeyHandler();this._initEvent()}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygSetValueAfter",function(){_this._unwrapDivOnHr()});this.eventManager.listen("wysiwygGetValueBefore",function(){_this._wrapDefaultBlockToOrphanTexts()})}},{key:"_initKeyHandler",value:function _initKeyHandler(){var _this2=this;this.wwe.addKeyEventHandler(function(ev,range){return _this2._onTypedInHr(range)});this.wwe.addKeyEventHandler("ENTER",function(ev,range){if(range.collapsed){return _this2._removeHrOnEnter(range,ev)}return true});this.wwe.addKeyEventHandler("BACK_SPACE",function(ev,range){if(range.collapsed){return _this2._removeHrOnBackspace(range,ev)}return true})}},{key:"_isInHr",value:function _isInHr(range){return _domUtils2.default.getNodeName(range.startContainer.childNodes[range.startOffset])==="HR"}},{key:"_isNearHr",value:function _isNearHr(range){var prevNode=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset-1);return _domUtils2.default.getNodeName(prevNode)==="HR"}},{key:"_onTypedInHr",value:function _onTypedInHr(range){var _this3=this;if(this._isInHr(range)||this._isNearHr(range)){this.wwe.defer(function(wwe){wwe.saveSelection();_this3._wrapDefaultBlockToOrphanTexts();wwe.restoreSavedSelection()})}}},{key:"_removeHrOnEnter",value:function _removeHrOnEnter(range,ev){var hrSuspect=void 0,blockPosition=void 0;if(this._isInHr(range)){hrSuspect=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset)}else if(this._isNearHr(range)){hrSuspect=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset-1);blockPosition="before"}return this._changeHrToNewDefaultBlock(hrSuspect,range,ev,blockPosition)}},{key:"_removeHrOnBackspace",value:function _removeHrOnBackspace(range,ev){var hrSuspect=void 0,blockPosition=void 0;if(this._isInHr(range)){hrSuspect=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset)}else if(range.startOffset===0){hrSuspect=_domUtils2.default.getTopPrevNodeUnder(range.startContainer,this.wwe.get$Body()[0]);blockPosition="none"}else if(this._isNearHr(range)){hrSuspect=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset-1);blockPosition="before"}return this._changeHrToNewDefaultBlock(hrSuspect,range,ev,blockPosition)}},{key:"_changeHrToNewDefaultBlock",value:function _changeHrToNewDefaultBlock(hrSuspect,range,ev,newBlockPosition){if(hrSuspect&&_domUtils2.default.getNodeName(hrSuspect)==="HR"){ev.preventDefault();if(newBlockPosition!=="none"){this.wwe.breakToNewDefaultBlock(range,newBlockPosition)}$(hrSuspect).remove();return false}return true}},{key:"_unwrapDivOnHr",value:function _unwrapDivOnHr(){var editorContentBody=this.wwe.get$Body()[0];this.wwe.get$Body().find("hr").each(function(index,node){var parentDiv=$(node).parent("div");if(parentDiv[0]!==editorContentBody){parentDiv.find("br").remove();$(node).unwrap()}})}},{key:"_wrapDefaultBlockToOrphanTexts",value:function _wrapDefaultBlockToOrphanTexts(){var textNodes=this.wwe.get$Body().contents().filter(findTextNodeFilter);textNodes.each(function(i,node){$(node).wrap("<div />")})}}]);return WwHrManager}();function findTextNodeFilter(){return this.nodeType===Node.TEXT_NODE}module.exports=WwHrManager},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var WwPManager=function(){function WwPManager(wwe){_classCallCheck(this,WwPManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="p";this._initEvent()}_createClass(WwPManager,[{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygSetValueBefore",function(html){return _this._splitPtagContentLines(html)});this.eventManager.listen("wysiwygSetValueAfter",function(){_this._ensurePtagContentWrappedWithDiv();_this._unwrapPtags()})}},{key:"_splitPtagContentLines",value:function _splitPtagContentLines(html){if(html){var $wrapper=$("<div />");$wrapper.html(html);$wrapper.find("p").each(function(pIndex,para){var content=para.innerHTML;var lines=content.split(/<br>/gi);var lastIndex=lines.length-1;var nextElement=para.nextElementSibling||para.nextSibling;var splitedContent="";splitedContent=lines.map(function(line,index){var result="";if(index>0&&index<lastIndex){line=line?line:"<br>"}if(line){result="<div>"+line+"</div>"}return result});if(nextElement&&nextElement.nodeName==="P"){splitedContent.push("<div><br></div>")}$(para).replaceWith($(splitedContent.join("")))});html=$wrapper.html()}return html}},{key:"_ensurePtagContentWrappedWithDiv",value:function _ensurePtagContentWrappedWithDiv(){this.wwe.get$Body().find("p").each(function(index,node){if($(node).find("div").length<=0){$(node).wrapInner("<div />")}if($(node).next().is("p")){$(node).append("<div><br></div>")}})}},{key:"_unwrapPtags",value:function _unwrapPtags(){this.wwe.get$Body().find("div").each(function(index,node){if($(node).parent().is("p")){$(node).unwrap()}})}}]);return WwPManager}();module.exports=WwPManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var FIND_HEADING_RX=/h[\d]/i;var WwHeadingManager=function(){function WwHeadingManager(wwe){_classCallCheck(this,WwHeadingManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="heading";this._init()}_createClass(WwHeadingManager,[{key:"_init",value:function _init(){this._initEvent();this._initKeyHandler()}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("wysiwygSetValueAfter",function(){_this._wrapDefaultBlockToHeadingInner()})}},{key:"_initKeyHandler",value:function _initKeyHandler(){var _this2=this;this.wwe.addKeyEventHandler("ENTER",function(ev,range){if(_this2.wwe.hasFormatWithRx(FIND_HEADING_RX)){_this2._onEnter(ev,range);return false}return true});this.wwe.addKeyEventHandler("BACK_SPACE",function(ev,range){if(_this2.wwe.hasFormatWithRx(FIND_HEADING_RX)){_this2._removePrevTopNodeIfNeed(ev,range);return false}return true})}},{key:"_wrapDefaultBlockToHeadingInner",value:function _wrapDefaultBlockToHeadingInner(){this.wwe.get$Body().find("h1, h2, h3, h4, h5, h6").each(function(index,node){if($(node).children("div, p").length<=0){$(node).wrapInner("<div />")}})}},{key:"_unwrapHeading",value:function _unwrapHeading(){this.wwe.unwrapBlockTag(function(node){return FIND_HEADING_RX.test(node)})}},{key:"_onEnter",value:function _onEnter(event,range){var _this3=this;if(range.startOffset>0){this.wwe.defer(function(wwe){_this3._unwrapHeading();wwe.getEditor().removeLastUndoStack()})}else{event.preventDefault();this._insertEmptyBlockToPrevious(range)}}},{key:"_insertEmptyBlockToPrevious",value:function _insertEmptyBlockToPrevious(range){this.wwe.getEditor().saveUndoState(range);$("<div><br></div>").insertBefore(_domUtils2.default.getParentUntil(range.startContainer,this.wwe.get$Body()[0]))}},{key:"_removePrevTopNodeIfNeed",value:function _removePrevTopNodeIfNeed(event,range){var isHandled=false;if(range.collapsed&&range.startOffset===0){var startContainer=range.startContainer;var prevTopNode=_domUtils2.default.getTopPrevNodeUnder(startContainer,this.wwe.get$Body()[0]);var isPrevTopNodeEmpty=prevTopNode&&prevTopNode.textContent.length===0;var sq=this.wwe.getEditor();if(startContainer.textContent.length===0){isHandled=this._removeHedingAndChangeSelection(event,range,prevTopNode)}else if(isPrevTopNodeEmpty){event.preventDefault();sq.saveUndoState(range);$(prevTopNode).remove();isHandled=true}}return isHandled}},{key:"_removeHedingAndChangeSelection",value:function _removeHedingAndChangeSelection(event,range,prevTopNode){var startContainer=range.startContainer;var sq=this.wwe.getEditor();var $Body=this.wwe.get$Body();var isHeading=FIND_HEADING_RX.test(_domUtils2.default.getNodeName(startContainer));var headingElement=isHeading?startContainer:$(startContainer).parents("h1,h2,h3,h4,h5,h6")[0];var targetNode=prevTopNode;var offset=1;if(!event.defaultPrevented){event.preventDefault();sq.saveUndoState(range)}$(headingElement).remove();if(!prevTopNode){targetNode=$Body.children("div").first()[0];offset=0}range.setStart(targetNode,offset);range.collapse(true);sq.setSelection(range);return true}}]);return WwHeadingManager}();module.exports=WwHeadingManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var tagEntities={"&":"&amp;","<":"&lt;",">":"&gt;"};var FIND_ZWS_RX=/\u200B/g;var CODEBLOCK_ATTR_NAME="data-te-codeblock";var WwCodeBlockManager=function(){function WwCodeBlockManager(wwe){_classCallCheck(this,WwCodeBlockManager);this.wwe=wwe;this.eventManager=wwe.eventManager;this.name="codeblock";this._init()}_createClass(WwCodeBlockManager,[{key:"_init",value:function _init(){this._initKeyHandler();this._initEvent()}},{key:"_initKeyHandler",value:function _initKeyHandler(){this.wwe.addKeyEventHandler("BACK_SPACE",this._removeCodeblockIfNeed.bind(this))}},{key:"_initEvent",value:function _initEvent(){var self=this;this.eventManager.listen("wysiwygSetValueAfter",function(){self.splitCodeblockToEachLine()});this.eventManager.listen("wysiwygProcessHTMLText",function(html){return self._mergeCodeblockEachlinesFromHTMLText(html)})}},{key:"prepareToPasteOnCodeblock",value:function prepareToPasteOnCodeblock(nodes){var range=this.wwe.getEditor().getSelection().cloneRange();var frag=this.wwe.getEditor().getDocument().createDocumentFragment();if(nodes.length===1&&this._isCodeBlock(nodes[0])){frag.appendChild(this._copyCodeblockTypeFromRangeCodeblock(nodes.shift(),range))}else{frag.appendChild(this._copyCodeblockTypeFromRangeCodeblock(this.convertToCodeblock(nodes),range))}return frag}},{key:"convertToCodeblock",value:function convertToCodeblock(nodes){var $codeblock=$("<pre />");var self=this;var node=nodes.shift();while(util.isTruthy(node)){$codeblock.append(self._makeCodeBlockLineHtml(util.isString(node)?node:node.textContent));node=nodes.shift()}$codeblock.attr(CODEBLOCK_ATTR_NAME,"");return $codeblock[0]}},{key:"_copyCodeblockTypeFromRangeCodeblock",value:function _copyCodeblockTypeFromRangeCodeblock(element,range){var blockNode=_domUtils2.default.getParentUntil(range.commonAncestorContainer,this.wwe.get$Body()[0]);if(_domUtils2.default.getNodeName(blockNode)==="PRE"){var attrs=$(blockNode).prop("attributes");util.forEach(attrs,function(attr){$(element).attr(attr.name,attr.value)})}return element}},{key:"_mergeCodeblockEachlinesFromHTMLText",value:function _mergeCodeblockEachlinesFromHTMLText(html){html=html.replace(/<pre( .*?)?>(.*?)<\/pre>/g,function(match,codeAttr,code){code=code.replace(/<br \/>/g,"\n");code=code.replace(/<div ?(.*?)>/g,"");code=code.replace(/\n$/,"");return"<pre><code"+(codeAttr||"")+">"+code+"</code></pre>"});return html}},{key:"splitCodeblockToEachLine",value:function splitCodeblockToEachLine(node){var self=this;if(!node){node=this.wwe.get$Body()}$(node).find("pre").each(function(index,pre){var $pre=$(pre);var lang=$pre.find("code").attr("data-language");var textLines=void 0;if($pre.children().length>1){textLines=[];$pre.children().each(function(idx,childNode){if((childNode.nodeName==="DIV"||childNode.nodeName==="P")&&!$(childNode).find("br").length){$(childNode).append("<br>")}})}$pre.find("br").replaceWith("\n");textLines=$pre.text().replace(/\s+$/,"").split(/\n/g);if(lang){$pre.attr("data-language",lang);$pre.addClass("lang-"+lang)}$pre.empty();util.forEach(textLines,function(line){$pre.append(self._makeCodeBlockLineHtml(line))});$pre.attr(CODEBLOCK_ATTR_NAME,"")})}},{key:"_makeCodeBlockLineHtml",value:function _makeCodeBlockLineHtml(lineContent){if(!lineContent){lineContent="<br>"}else{lineContent=sanitizeHtmlCode(lineContent)}return"<div>"+lineContent+"</div>"}},{key:"_removeCodeblockIfNeed",value:function _removeCodeblockIfNeed(ev,range){var self=this;if(!this.isInCodeBlock(range)){return true}var pre=$(range.startContainer).closest("pre");var $div=$(pre).find("div").eq(0);var codeContent=$div.text().replace(FIND_ZWS_RX,"");if((range.startOffset===0||codeContent.length===0)&&$(pre).find("div").length<=1){this.wwe.getEditor().modifyBlocks(function(){var newFrag=self.wwe.getEditor().getDocument().createDocumentFragment();var content=void 0;if(codeContent.length===0){content="<br>"}else{content=$div.html().replace(FIND_ZWS_RX,"")}$(newFrag).append($("<div>"+content+"</div>"));return newFrag});return false}return true}},{key:"isInCodeBlock",value:function isInCodeBlock(range){var target=void 0;if(range.collapsed){target=range.startContainer}else{target=range.commonAncestorContainer}return this._isCodeBlock(target)}},{key:"_isCodeBlock",value:function _isCodeBlock(element){return!!$(element).closest("pre").length}}]);return WwCodeBlockManager}();function sanitizeHtmlCode(code){return code.replace(/[<>&]/g,function(tag){return tagEntities[tag]||tag})}module.exports=WwCodeBlockManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Squire=window.Squire;var util=tui.util;var FIND_BLOCK_TAGNAME_RX=/\b(H[\d]|LI|P|BLOCKQUOTE|TD)\b/;var isIElt11=/Trident\/[456]\./.test(navigator.userAgent);var SquireExt=function(_Squire){_inherits(SquireExt,_Squire);function SquireExt(){var _ref;_classCallCheck(this,SquireExt);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var _this=_possibleConstructorReturn(this,(_ref=SquireExt.__proto__||Object.getPrototypeOf(SquireExt)).call.apply(_ref,[this].concat(args)));_this._decorateHandlerToCancelable("copy");_this._decorateHandlerToCancelable(isIElt11?"beforecut":"cut");_this._decorateHandlerToCancelable(isIElt11?"beforepaste":"paste");_this.get$Body=function(){_this.$body=_this.$body||$(_this.getRoot());return _this.$body};return _this}_createClass(SquireExt,[{key:"_decorateHandlerToCancelable",value:function _decorateHandlerToCancelable(eventName){var handlers=this._events[eventName];if(handlers.length>1){throw new Error("too many"+eventName+"handlers in squire")}var handler=handlers[0].bind(this);handlers[0]=function(event){if(!event.defaultPrevented&&!event.squirePrevented){handler(event)}}}},{key:"changeBlockFormat",value:function changeBlockFormat(srcCondition,targetTagName){var _this2=this;this.modifyBlocks(function(frag){var current=void 0,newFrag=void 0,newBlock=void 0,nextBlock=void 0,tagName=void 0,lastNodeOfNextBlock=void 0,appendChidToNextBlock=void 0;if(frag.childNodes.length){current=frag.childNodes[0]}else{current=_this2.createDefaultBlock();frag.appendChild(current)}if(srcCondition){while(current.firstChild){current=current.firstChild}appendChidToNextBlock=function appendChidToNextBlock(node){nextBlock.appendChild(node)};while(current!==frag){tagName=current.tagName;if(util.isFunction(srcCondition)?srcCondition(tagName):tagName===srcCondition){nextBlock=current.childNodes[0];if(!_domUtils2.default.isElemNode(nextBlock)||current.childNodes.length>1){nextBlock=_this2.createDefaultBlock();util.forEachArray(util.toArray(current.childNodes),appendChidToNextBlock);lastNodeOfNextBlock=nextBlock.lastChild;if(lastNodeOfNextBlock&&_domUtils2.default.getNodeName(lastNodeOfNextBlock)==="BR"){nextBlock.removeChild(lastNodeOfNextBlock)}}if(targetTagName){newBlock=_this2.createElement(targetTagName,[nextBlock])}else{newBlock=nextBlock}newFrag=_this2.getDocument().createDocumentFragment();newFrag.appendChild(newBlock);frag=newFrag;break}current=current.parentNode}}if((!newFrag||!srcCondition)&&targetTagName&&_domUtils2.default.getNodeName(frag.childNodes[0])==="DIV"){frag=_this2.createElement(targetTagName,[frag.childNodes[0]])}return frag})}},{key:"changeBlockFormatTo",value:function changeBlockFormatTo(targetTagName){this.changeBlockFormat(function(tagName){return FIND_BLOCK_TAGNAME_RX.test(tagName)},targetTagName)}},{key:"getCaretPosition",value:function getCaretPosition(){return this.getCursorPosition()}},{key:"replaceSelection",value:function replaceSelection(content,selection){if(selection){this.setSelection(selection)}
this._ignoreChange=true;this.insertHTML(content)}},{key:"replaceRelativeOffset",value:function replaceRelativeOffset(content,offset,overwriteLength){var selection=this.getSelection().cloneRange();this._replaceRelativeOffsetOfSelection(content,offset,overwriteLength,selection)}},{key:"_replaceRelativeOffsetOfSelection",value:function _replaceRelativeOffsetOfSelection(content,offset,overwriteLength,selection){var startSelectionInfo=void 0,endSelectionInfo=void 0,finalOffset=void 0;var endOffsetNode=selection.endContainer;var endTextOffset=selection.endOffset;if(_domUtils2.default.getNodeName(endOffsetNode)!=="TEXT"){endOffsetNode=this._getClosestTextNode(endOffsetNode,endTextOffset);if(endOffsetNode){if(_domUtils2.default.isTextNode(endOffsetNode)){endTextOffset=endOffsetNode.nodeValue.length}else{endTextOffset=endOffsetNode.textContent.length}}}if(endOffsetNode){startSelectionInfo=this.getSelectionInfoByOffset(endOffsetNode,endTextOffset+offset);selection.setStart(startSelectionInfo.element,startSelectionInfo.offset);finalOffset=endTextOffset+(offset+overwriteLength);endSelectionInfo=this.getSelectionInfoByOffset(endOffsetNode,finalOffset);selection.setEnd(endSelectionInfo.element,endSelectionInfo.offset);this.replaceSelection(content,selection)}else{this.replaceSelection(content)}}},{key:"_getClosestTextNode",value:function _getClosestTextNode(node,offset){var foundNode=_domUtils2.default.getChildNodeByOffset(node,offset-1);if(_domUtils2.default.getNodeName(foundNode)!=="TEXT"){foundNode=foundNode.previousSibling}return foundNode}},{key:"getSelectionInfoByOffset",value:function getSelectionInfoByOffset(anchorElement,offset){var traceElement=void 0,traceElementLength=void 0,traceOffset=void 0,stepLength=void 0;var direction=offset>=0?"next":"previous";var offsetAbs=Math.abs(offset);var latestAvailableElement=traceElement;if(direction==="next"){traceElement=anchorElement}else{traceElement=anchorElement.previousSibling}traceOffset=offsetAbs;stepLength=0;while(traceElement){if(_domUtils2.default.isTextNode(traceElement)){traceElementLength=traceElement.nodeValue.length}else{traceElementLength=traceElement.textContent.length}stepLength+=traceElementLength;if(offsetAbs<=stepLength){break}traceOffset-=traceElementLength;if(_domUtils2.default.getTextLength(traceElement)>0){latestAvailableElement=traceElement}traceElement=traceElement[direction+"Sibling"]}if(!traceElement){traceElement=latestAvailableElement;traceOffset=_domUtils2.default.getTextLength(traceElement)}if(direction==="previous"){traceOffset=_domUtils2.default.getTextLength(traceElement)-traceOffset}return{element:traceElement,offset:traceOffset}}},{key:"getSelectionPosition",value:function getSelectionPosition(selection,style,offset){var marker=this.createElement("INPUT");var range=selection.cloneRange();var endSelectionInfo=this.getSelectionInfoByOffset(selection.endContainer,selection.endOffset+(offset||0));range.setStart(range.startContainer,range.startOffset);range.setEnd(endSelectionInfo.element,endSelectionInfo.offset);this._ignoreChange=true;this.insertElement(marker,range);var pos=$(marker).offset();if(style!=="over"){pos.top+=$(marker).outerHeight()}marker.parentNode.removeChild(marker);selection.setStart(selection.endContainer,selection.endOffset);selection.collapse(true);this.setSelection(selection);return pos}},{key:"removeLastUndoStack",value:function removeLastUndoStack(){if(this._undoStack.length){this._undoStackLength-=1;this._undoIndex-=1;this._undoStack.pop();this._isInUndoState=false}}},{key:"replaceParent",value:function replaceParent(node,from,to){var target=$(node).closest(from);if(target.length){target.wrapInner("<"+to+"/>");target.children().unwrap()}}},{key:"preserveLastLine",value:function preserveLastLine(){var lastBlock=this.get$Body().children().last();if(_domUtils2.default.getNodeName(lastBlock[0])!=="DIV"){this._ignoreChange=true;$(this.createDefaultBlock()).insertAfter(lastBlock)}}},{key:"scrollTop",value:function scrollTop(top){if(util.isUndefined(top)){return this.get$Body().scrollTop()}return this.get$Body().scrollTop(top)}},{key:"isIgnoreChange",value:function isIgnoreChange(){return this._ignoreChange}},{key:"focus",value:function focus(){var scrollTop=this.scrollTop();Squire.prototype.focus.call(this);if(scrollTop!==this.scrollTop()){this.scrollTop(scrollTop)}return this}},{key:"blockCommandShortcuts",value:function blockCommandShortcuts(){var _this3=this;var isMac=/Mac/.test(navigator.platform);var meta=isMac?"meta":"ctrl";var keys=["b","i","u","shift-7","shift-5","shift-6","shift-8","shift-9","[","]"];keys.forEach(function(key){_this3.setKeyHandler(meta+"-"+key,function(editor,keyboardEvent){keyboardEvent.preventDefault()})})}}]);return SquireExt}(Squire);module.exports=SquireExt},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var isIE11=tui.util.browser.msie&&tui.util.browser.version===11;var isWindowChrome=navigator.appVersion.indexOf("Win")!==-1&&tui.util.browser.chrome;var isNeedOffsetFix=isIE11||isWindowChrome;var WwTextObject=function(){function WwTextObject(wwe,range){_classCallCheck(this,WwTextObject);this._wwe=wwe;if(isNeedOffsetFix){this.isComposition=false;this._initCompositionEvent()}this.setRange(range||this._wwe.getRange())}_createClass(WwTextObject,[{key:"_initCompositionEvent",value:function _initCompositionEvent(){var _this=this;this._wwe.getEditor().addEventListener("compositionstart",function(){_this.isComposition=true});this._wwe.getEditor().addEventListener("compositionend",function(){_this.isComposition=false})}},{key:"setRange",value:function setRange(range){if(this._range){this._range.detach()}this._range=range}},{key:"expandStartOffset",value:function expandStartOffset(){var range=this._range;if(_domUtils2.default.isTextNode(range.startContainer)&&range.startOffset>0){range.setStart(range.startContainer,range.startOffset-1)}}},{key:"expandEndOffset",value:function expandEndOffset(){var range=this._range;if(_domUtils2.default.isTextNode(range.endContainer)&&range.endOffset<range.endContainer.nodeValue.length){range.setEnd(range.endContainer,range.endOffset+1)}}},{key:"setEndBeforeRange",value:function setEndBeforeRange(range){var offset=range.startOffset;if(this.isComposition){offset+=1}this._range.setEnd(range.startContainer,offset)}},{key:"getTextContent",value:function getTextContent(){return this._range.cloneContents().textContent}},{key:"replaceContent",value:function replaceContent(content){this._wwe.getEditor().setSelection(this._range);this._wwe.getEditor().insertHTML(content);this._range=this._wwe.getRange()}},{key:"deleteContent",value:function deleteContent(){this._wwe.getEditor().setSelection(this._range);this._wwe.getEditor().insertHTML("");this._range=this._wwe.getRange()}},{key:"peekStartBeforeOffset",value:function peekStartBeforeOffset(offset){var range=this._range.cloneRange();range.setStart(range.startContainer,Math.max(range.startOffset-offset,0));range.setEnd(this._range.startContainer,this._range.startOffset);return range.cloneContents().textContent}}]);return WwTextObject}();module.exports=WwTextObject},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var containerTmpl=['<div class="tui-editor">','<div class="te-md-container">','<div class="te-editor" />','<div class="te-md-splitter" />','<div class="te-preview" />',"</div>",'<div class="te-ww-container">','<div class="te-editor" />',"</div>","</div>"].join("");var Layout=function(){function Layout(options,eventManager){_classCallCheck(this,Layout);this.$el=$(options.el);this.height=options.height;this.type=options.initialEditType;this.eventManager=eventManager;this.init();this._initEvent()}_createClass(Layout,[{key:"init",value:function init(){this._renderLayout();this._initMarkdownAndPreviewSection();this._initWysiwygSection()}},{key:"_initEvent",value:function _initEvent(){this.eventManager.listen("hide",this.hide.bind(this));this.eventManager.listen("show",this.show.bind(this))}},{key:"_renderLayout",value:function _renderLayout(){this.$containerEl=$(containerTmpl).appendTo(this.$el)}},{key:"switchToWYSIWYG",value:function switchToWYSIWYG(){this.$containerEl.removeClass("te-md-mode");this.$containerEl.addClass("te-ww-mode")}},{key:"switchToMarkdown",value:function switchToMarkdown(){this.$containerEl.removeClass("te-ww-mode");this.$containerEl.addClass("te-md-mode")}},{key:"_initMarkdownAndPreviewSection",value:function _initMarkdownAndPreviewSection(){this.$mdEditorContainerEl=this.$containerEl.find(".te-md-container .te-editor");this.$previewEl=this.$containerEl.find(".te-md-container .te-preview")}},{key:"_initWysiwygSection",value:function _initWysiwygSection(){this.$wwEditorContainerEl=this.$containerEl.find(".te-ww-container .te-editor")}},{key:"_verticalSplitStyle",value:function _verticalSplitStyle(){this.$containerEl.find(".te-md-container").removeClass("te-preview-style-tab");this.$containerEl.find(".te-md-container").addClass("te-preview-style-vertical")}},{key:"_tabStyle",value:function _tabStyle(){this.$containerEl.find(".te-md-container").removeClass("te-preview-style-vertical");this.$containerEl.find(".te-md-container").addClass("te-preview-style-tab")}},{key:"changePreviewStyle",value:function changePreviewStyle(style){if(style==="tab"){this._tabStyle()}else if(style==="vertical"){this._verticalSplitStyle()}}},{key:"hide",value:function hide(){this.$el.find(".tui-editor").addClass("te-hide")}},{key:"show",value:function show(){this.$el.find(".tui-editor").removeClass("te-hide")}},{key:"remove",value:function remove(){this.$el.find(".tui-editor").remove()}},{key:"getEditorEl",value:function getEditorEl(){return this.$containerEl}},{key:"getPreviewEl",value:function getPreviewEl(){return this.$previewEl}},{key:"getMdEditorContainerEl",value:function getMdEditorContainerEl(){return this.$mdEditorContainerEl}},{key:"getWwEditorContainerEl",value:function getWwEditorContainerEl(){return this.$wwEditorContainerEl}}]);return Layout}();module.exports=Layout},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var eventList=["previewBeforeHook","previewRenderAfter","previewNeedsRefresh","addImageBlobHook","setMarkdownAfter","contentChangedFromWysiwyg","changeFromWysiwyg","contentChangedFromMarkdown","changeFromMarkdown","change","changeModeToWysiwyg","changeModeToMarkdown","changeModeBefore","changeMode","changePreviewStyle","openPopupAddLink","openPopupAddImage","openPopupAddTable","openPopupTableUtils","openHeadingSelect","closeAllPopup","command","addCommandBefore","htmlUpdate","markdownUpdate","renderedHtmlUpdated","removeEditor","convertorAfterMarkdownToHtmlConverted","convertorBeforeHtmlToMarkdownConverted","convertorAfterHtmlToMarkdownConverted","stateChange","wysiwygSetValueAfter","wysiwygSetValueBefore","wysiwygGetValueBefore","wysiwygProcessHTMLText","wysiwygRangeChangeAfter","wysiwygKeyEvent","replaceCodeBlockElementsBefore","pasteBefore","scroll","click","mousedown","mouseover","mouseup","contextmenu","keydown","keyup","keyMap","load","focus","blur","paste","copy","copyBefore","copyAfter","cut","cutAfter","drop","show","hide"];var EventManager=function(){function EventManager(){_classCallCheck(this,EventManager);this.events=new util.Map;this.TYPE=new util.Enum(eventList)}_createClass(EventManager,[{key:"listen",value:function listen(typeStr,handler){var typeInfo=this._getTypeInfo(typeStr);var eventHandlers=this.events.get(typeInfo.type)||[];if(!this._hasEventType(typeInfo.type)){throw new Error("There is no event type "+typeInfo.type)}if(typeInfo.namespace){handler.namespace=typeInfo.namespace}eventHandlers.push(handler);this.events.set(typeInfo.type,eventHandlers)}},{key:"emit",value:function emit(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var typeStr=args.shift();var typeInfo=this._getTypeInfo(typeStr);var eventHandlers=this.events.get(typeInfo.type);var results=void 0;if(eventHandlers){util.forEach(eventHandlers,function(handler){var result=handler.apply(undefined,args);if(!util.isUndefined(result)){results=results||[];results.push(result)}})}return results}},{key:"emitReduce",value:function emitReduce(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}var type=args.shift();var eventHandlers=this.events.get(type);if(eventHandlers){util.forEach(eventHandlers,function(handler){var result=handler.apply(undefined,args);if(!util.isFalsy(result)){args[0]=result}})}return args[0]}},{key:"_getTypeInfo",value:function _getTypeInfo(typeStr){var splited=typeStr.split(".");return{type:splited[0],namespace:splited[1]}}},{key:"_hasEventType",value:function _hasEventType(type){return!util.isUndefined(this.TYPE[this._getTypeInfo(type).type])}},{key:"addEventType",value:function addEventType(type){if(this._hasEventType(type)){throw new Error("There is already have event type "+type)}this.TYPE.set(type)}},{key:"removeEventHandler",value:function removeEventHandler(typeStr){var _this=this;var _getTypeInfo2=this._getTypeInfo(typeStr),type=_getTypeInfo2.type,namespace=_getTypeInfo2.namespace;if(type&&!namespace){this.events["delete"](type)}else if(!type&&namespace){this.events.forEach(function(eventHandlers,eventType){_this._removeEventHandlerWithTypeInfo(eventType,namespace)})}else if(type&&namespace){this._removeEventHandlerWithTypeInfo(type,namespace)}}},{key:"_removeEventHandlerWithTypeInfo",value:function _removeEventHandlerWithTypeInfo(type,namespace){var handlersToSurvive=[];var eventHandlers=this.events.get(type);if(!eventHandlers){return}eventHandlers.map(function(handler){if(handler.namespace!==namespace){handlersToSurvive.push(handler)}});this.events.set(type,handlersToSurvive)}}]);return EventManager}();module.exports=EventManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _command=__webpack_require__(29);var _command2=_interopRequireDefault(_command);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var isMac=/Mac/.test(navigator.platform);var KEYMAP_OS_INDEX=isMac?1:0;var CommandManager=function(){function CommandManager(base){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,CommandManager);this._command=new util.Map;this._mdCommand=new util.Map;this._wwCommand=new util.Map;this._options=$.extend({useCommandShortcut:true},options);this.base=base;this.keyMapCommand={};this._initEvent()}_createClass(CommandManager,[{key:"_addCommandBefore",value:function _addCommandBefore(command){var commandWrapper={command:command};this.base.eventManager.emit("addCommandBefore",commandWrapper);return commandWrapper.command||command}},{key:"addCommand",value:function addCommand(command){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}if(args.length){command=CommandManager.command.apply(CommandManager,[command].concat(args))}command=this._addCommandBefore(command);var name=command.getName();var commandBase=void 0;if(command.isMDType()){commandBase=this._mdCommand}else if(command.isWWType()){commandBase=this._wwCommand}else if(command.isGlobalType()){commandBase=this._command}commandBase.set(name,command);if(command.keyMap){this.keyMapCommand[command.keyMap[KEYMAP_OS_INDEX]]=name}return command}},{key:"_initEvent",value:function _initEvent(){var _this=this;this.base.eventManager.listen("command",function(){_this.exec.apply(_this,arguments)});this.base.eventManager.listen("keyMap",function(ev){if(!_this._options.useCommandShortcut){return}var command=_this.keyMapCommand[ev.keyMap];if(command){ev.data.preventDefault();_this.exec(command)}})}},{key:"exec",value:function exec(name){var commandToRun=void 0,result=void 0;var context=this.base;commandToRun=this._command.get(name);if(!commandToRun){if(this.base.isMarkdownMode()){commandToRun=this._mdCommand.get(name);context=this.base.mdEditor}else{commandToRun=this._wwCommand.get(name);context=this.base.wwEditor}}if(commandToRun){var _commandToRun;for(var _len2=arguments.length,args=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2]}args.unshift(context);result=(_commandToRun=commandToRun).exec.apply(_commandToRun,args)}return result}}]);return CommandManager}();CommandManager.command=function(type,props){var command=_command2.default.factory(type,props.name,props.keyMap);util.extend(command,props);return command};module.exports=CommandManager},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var Command=function(){function Command(name,type,keyMap){_classCallCheck(this,Command);this.name=name;this.type=type;if(keyMap){this.setKeyMap(keyMap)}}_createClass(Command,[{key:"getName",value:function getName(){return this.name}},{key:"getType",value:function getType(){return this.type}},{key:"isMDType",value:function isMDType(){return this.type===Command.TYPE.MD}},{key:"isWWType",value:function isWWType(){return this.type===Command.TYPE.WW}},{key:"isGlobalType",value:function isGlobalType(){return this.type===Command.TYPE.GB}},{key:"setKeyMap",value:function setKeyMap(win,mac){this.keyMap=[win,mac]}}]);return Command}();Command.factory=function(typeStr,props){var type=void 0;if(typeStr==="markdown"){type=Command.TYPE.MD}else if(typeStr==="wysiwyg"){type=Command.TYPE.WW}else if(typeStr==="global"){type=Command.TYPE.GB}var command=new Command(props.name,type);util.extend(command,props);return command};Command.TYPE={MD:0,WW:1,GB:2};module.exports=Command},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var ExtManager=function(){function ExtManager(){_classCallCheck(this,ExtManager);this.exts=new util.Map}_createClass(ExtManager,[{key:"defineExtension",value:function defineExtension(name,ext){this.exts.set(name,ext)}},{key:"applyExtension",value:function applyExtension(context,extNames){var _this=this;if(extNames){extNames.forEach(function(extName){if(_this.exts.has(extName)){_this.exts.get(extName)(context)}})}}}]);return ExtManager}();module.exports=new ExtManager},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var URLRegex=/(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})(\/([^\s]*))?/g;var ImportManager=function(){function ImportManager(eventManager){_classCallCheck(this,ImportManager);this.eventManager=eventManager;this._lastState=null;this._initEvent();this._initDefaultImageImporter()}_createClass(ImportManager,[{key:"_initEvent",value:function _initEvent(){var _this=this;this.eventManager.listen("stateChange",function(ev){_this._lastState=ev});this.eventManager.listen("drop",function(ev){var items=ev.data.dataTransfer&&ev.data.dataTransfer.files;_this._processBlobItems(items,ev.data)});this.eventManager.listen("paste",function(ev){_this._processClipboard(ev.data)});this.eventManager.listen("pasteBefore",function(ev){_this._decodeURL(ev)})}},{key:"_initDefaultImageImporter",value:function _initDefaultImageImporter(){this.eventManager.listen("addImageBlobHook",function(blob,callback){var reader=new FileReader;reader.onload=function(event){callback(event.target.result)};reader.readAsDataURL(blob)})}},{key:"_emitAddImageBlobHook",value:function _emitAddImageBlobHook(item,type){var _this2=this;var blob=item.name?item:item.getAsFile();this.eventManager.emit("addImageBlobHook",blob,function(imageUrl,altText){_this2.eventManager.emit("command","AddImage",{imageUrl:imageUrl,altText:altText||blob.name||"image"})},type)}},{key:"_decodeURL",value:function _decodeURL(ev){if(ev.source==="markdown"&&ev.data.text){var newTexts=[];ev.data.text.forEach(function(text){text=text.replace(URLRegex,function(match){return ImportManager.decodeURIGraceful(match)});newTexts.push(text)});ev.data.update(null,null,newTexts)}else if(ev.source==="wysiwyg"&&ev.$clipboardContainer.find("A")){var $anchor=ev.$clipboardContainer.find("A");$anchor.each(function(index,element){var text=$(element).text();var decodeFunction=text.match(URLRegex)?decodeURI:decodeURIComponent;$(element).text(ImportManager.decodeURIGraceful(text,decodeFunction))})}}},{key:"_processClipboard",value:function _processClipboard(evData){var cbData=evData.clipboardData||window.clipboardData;var blobItems=cbData&&cbData.items;var types=cbData.types;if(blobItems&&types&&types.length===1&&util.inArray("Files",types)!==-1){this._processBlobItems(blobItems,evData)}}},{key:"_processBlobItems",value:function _processBlobItems(items,evData){var _this3=this;if(items){util.forEachArray(items,function(item){if(item.type.indexOf("image")!==-1){evData.preventDefault();evData.codemirrorIgnore=true;_this3._emitAddImageBlobHook(item,evData.type);return false}return true})}}},{key:"_isInBlockFormat",value:function _isInBlockFormat(){var state=this._lastState;return state&&(state.codeBlock||state.list||state.task||state.code)}}],[{key:"decodeURIGraceful",value:function decodeURIGraceful(uri){var decodeFunction=arguments.length>1&&arguments[1]!==undefined?arguments[1]:decodeURI;var decodedURI=void 0;try{decodedURI=decodeFunction(uri);decodedURI=decodedURI.replace(/ /g,"%20").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/</g,"%3C").replace(/>/g,"%3E")}catch(e){decodedURI=uri}return decodedURI}}]);return ImportManager}();module.exports=ImportManager},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _htmlSanitizer=__webpack_require__(14);var _htmlSanitizer2=_interopRequireDefault(_htmlSanitizer);var _markdownitTaskPlugin=__webpack_require__(33);var _markdownitTaskPlugin2=_interopRequireDefault(_markdownitTaskPlugin);var _markdownitCodeBlockPlugin=__webpack_require__(34);var _markdownitCodeBlockPlugin2=_interopRequireDefault(_markdownitCodeBlockPlugin);var _markdownitCodeRenderer=__webpack_require__(35);var _markdownitCodeRenderer2=_interopRequireDefault(_markdownitCodeRenderer);var _markdownitBlockQuoteRenderer=__webpack_require__(36);var _markdownitBlockQuoteRenderer2=_interopRequireDefault(_markdownitBlockQuoteRenderer);var _markdownitTableRenderer=__webpack_require__(37);var _markdownitTableRenderer2=_interopRequireDefault(_markdownitTableRenderer);var _markdownitHtmlBlockRenderer=__webpack_require__(38);var _markdownitHtmlBlockRenderer2=_interopRequireDefault(_markdownitHtmlBlockRenderer);var _codeBlockManager=__webpack_require__(9);var _codeBlockManager2=_interopRequireDefault(_codeBlockManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var markdownIt=window.markdownit,toMark=window.toMark;var markdownitHighlight=markdownIt({html:true,breaks:true,quotes:"“”‘’",langPrefix:"lang-",highlight:function highlight(codeText,type){return _codeBlockManager2.default.createCodeBlockHtml(type,codeText)}});var markdownit=markdownIt({html:true,breaks:true,quotes:"“”‘’",langPrefix:"lang-"});markdownitHighlight.block.ruler.at("table",_markdownitTableRenderer2.default,["paragraph","reference"]);markdownitHighlight.block.ruler.at("code",_markdownitCodeRenderer2.default);markdownitHighlight.block.ruler.at("blockquote",_markdownitBlockQuoteRenderer2.default,["paragraph","reference","list"]);markdownitHighlight.block.ruler.at("html_block",_markdownitHtmlBlockRenderer2.default,["paragraph","reference","blockquote"]);markdownitHighlight.use(_markdownitTaskPlugin2.default);markdownitHighlight.use(_markdownitCodeBlockPlugin2.default);markdownit.block.ruler.at("table",_markdownitTableRenderer2.default,["paragraph","reference"]);markdownit.block.ruler.at("code",_markdownitCodeRenderer2.default);markdownit.block.ruler.at("blockquote",_markdownitBlockQuoteRenderer2.default,["paragraph","reference","list"]);markdownit.block.ruler.at("html_block",_markdownitHtmlBlockRenderer2.default,["paragraph","reference","blockquote"]);markdownit.use(_markdownitTaskPlugin2.default);markdownit.use(_markdownitCodeBlockPlugin2.default);var Convertor=function(){function Convertor(em){_classCallCheck(this,Convertor);this.eventManager=em}_createClass(Convertor,[{key:"_markdownToHtmlWithCodeHighlight",value:function _markdownToHtmlWithCodeHighlight(markdown){markdown=markdown.replace(/<br>/gi,"<br data-tomark-pass>");var onerrorStripeRegex=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;while(onerrorStripeRegex.exec(markdown)){markdown=markdown.replace(onerrorStripeRegex,"$1$3")}var renderedHTML=markdownitHighlight.render(markdown);renderedHTML=this._removeBrToMarkPassAttributeInCode(renderedHTML);return renderedHTML}},{key:"_markdownToHtml",value:function _markdownToHtml(markdown){markdown=markdown.replace(/<br>/gi,"<br data-tomark-pass>");var onerrorStripeRegex=/(<img[^>]*)(onerror\s*=\s*[\"']?[^\"']*[\"']?)(.*)/i;while(onerrorStripeRegex.exec(markdown)){markdown=markdown.replace(onerrorStripeRegex,"$1$3")}var renderedHTML=markdownit.render(markdown);renderedHTML=this._removeBrToMarkPassAttributeInCode(renderedHTML);return renderedHTML}},{key:"_removeBrToMarkPassAttributeInCode",value:function _removeBrToMarkPassAttributeInCode(renderedHTML){var $wrapperDiv=$("<div />");$wrapperDiv.html(renderedHTML);$wrapperDiv.find("code, pre").each(function(i,codeOrPre){var $code=$(codeOrPre);$code.html($code.html().replace(/&lt;br data-tomark-pass&gt;/,"&lt;br&gt;"))});renderedHTML=$wrapperDiv.html();return renderedHTML}},{key:"toHTMLWithCodeHightlight",value:function toHTMLWithCodeHightlight(markdown){var html=this._markdownToHtmlWithCodeHighlight(markdown);html=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",html);return html}},{key:"toHTML",value:function toHTML(markdown){var html=this._markdownToHtml(markdown);html=this.eventManager.emitReduce("convertorAfterMarkdownToHtmlConverted",html);return html}},{key:"initHtmlSanitizer",value:function initHtmlSanitizer(){this.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(html){return(0,_htmlSanitizer2.default)(html,true)})}},{key:"toMarkdown",value:function toMarkdown(html,toMarkOptions){var resultArray=[];html=this.eventManager.emitReduce("convertorBeforeHtmlToMarkdownConverted",html);var markdown=toMark(this._appendAttributeForBrIfNeed(html),toMarkOptions);markdown=this.eventManager.emitReduce("convertorAfterHtmlToMarkdownConverted",markdown);tui.util.forEach(markdown.split("\n"),function(line,index){var FIND_TABLE_RX=/^\|[^|]*\|/gi;var FIND_CODE_RX=/`[^`]*<br>[^`]*`/gi;if(!FIND_CODE_RX.test(line)&&!FIND_TABLE_RX.test(line)){line=line.replace(/<br>/gi,"<br>\n")}resultArray[index]=line});return resultArray.join("\n")}},{key:"_appendAttributeForBrIfNeed",value:function _appendAttributeForBrIfNeed(html){var FIND_BR_RX=/<br>/gi;var FIND_DOUBLE_BR_RX=/<br \/><br \/>/gi;var FIND_PASSING_AND_NORMAL_BR_RX=/<br data-tomark-pass \/><br \/>(.)/gi
;var FIRST_TWO_BRS_BEFORE_RX=/([^>]|<\/b>|<\/i>|<\/s>|<img [^>]*>)/;var TWO_BRS_RX=/<br data-tomark-pass \/><br data-tomark-pass \/>/;var FIND_FIRST_TWO_BRS_RX=new RegExp(FIRST_TWO_BRS_BEFORE_RX.source+TWO_BRS_RX.source,"g");html=html.replace(FIND_BR_RX,"<br />");html=html.replace(FIND_DOUBLE_BR_RX,"<br data-tomark-pass /><br data-tomark-pass />");var div=document.createElement("div");var $div=$(div);$div.html(html);$div.find("pre br,code br").each(function(index,node){if(node.hasAttribute("data-tomark-pass")){node.removeAttribute("data-tomark-pass")}});html=$div.html().replace(/<br data-tomark-pass="">/gi,"<br data-tomark-pass />");html=html.replace(FIND_BR_RX,"<br />");html=html.replace(FIND_PASSING_AND_NORMAL_BR_RX,"<br data-tomark-pass /><br data-tomark-pass />$1");html=html.replace(FIND_FIRST_TWO_BRS_RX,"$1<br /><br />");return html}}],[{key:"factory",value:function factory(eventManager){return new Convertor(eventManager)}},{key:"getMarkdownHighlightRenderer",value:function getMarkdownHighlightRenderer(){return markdownitHighlight}}]);return Convertor}();module.exports=Convertor},function(module,exports){"use strict";var MarkdownitTaskRenderer=function MarkdownitTaskRenderer(markdownit){markdownit.core.ruler.after("inline","tui-task-list",function(state){var TASK_LIST_ITEM_CLASS_NAME="task-list-item";var CHECKED_CLASS_NAME="checked";var tokens=state.tokens;var className;var tokenIndex;for(tokenIndex=2;tokenIndex<tokens.length;tokenIndex+=1){if(isTaskListItemToken(tokens,tokenIndex)){if(isChecked(tokens[tokenIndex])){className=TASK_LIST_ITEM_CLASS_NAME+" "+CHECKED_CLASS_NAME}else{className=TASK_LIST_ITEM_CLASS_NAME}removeMarkdownTaskFormatText(tokens[tokenIndex]);setTokenAttribute(tokens[tokenIndex-2],"class",className);setTokenAttribute(tokens[tokenIndex-2],"data-te-task","")}}})};function removeMarkdownTaskFormatText(token){token.content=token.content.slice(4);token.children[0].content=token.children[0].content.slice(4)}function isChecked(token){var checked=false;if(token.content.indexOf("[x]")===0||token.content.indexOf("[X]")===0){checked=true}return checked}function setTokenAttribute(token,attributeName,attributeValue){var index=token.attrIndex(attributeName);var attr=[attributeName,attributeValue];if(index<0){token.attrPush(attr)}else{token.attrs[index]=attr}}function isTaskListItemToken(tokens,index){return tokens[index].type==="inline"&&tokens[index-1].type==="paragraph_open"&&tokens[index-2].type==="list_item_open"&&(tokens[index].content.indexOf("[ ]")===0||tokens[index].content.indexOf("[x]")===0||tokens[index].content.indexOf("[X]")===0)}module.exports=MarkdownitTaskRenderer},function(module,exports){"use strict";var MarkdownitCodeBlockRenderer=function MarkdownitCodeBlockRenderer(markdownit){markdownit.core.ruler.after("block","tui-code-block",function(state){var tokens=state.tokens;var currentToken,tokenIndex;for(tokenIndex=0;tokenIndex<tokens.length;tokenIndex+=1){currentToken=tokens[tokenIndex];if(isCodeFenceToken(currentToken)&&currentToken.info){setTokenAttribute(currentToken,"data-language",escape(currentToken.info.replace(" ",""),true))}}})};function setTokenAttribute(token,attributeName,attributeValue){var index=token.attrIndex(attributeName);var attr=[attributeName,attributeValue];if(index<0){token.attrPush(attr)}else{token.attrs[index]=attr}}function isCodeFenceToken(token){return token.block===true&&token.tag==="code"&&token.type==="fence"}function escape(html,encode){return html.replace(!encode?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}module.exports=MarkdownitCodeBlockRenderer},function(module,exports){"use strict";module.exports=function code(state,startLine,endLine){var FIND_LIST_RX=/ {0,3}(?:-|\*|\d\.) /;var lines=state.src.split("\n");var currentLine=lines[startLine];var nextLine,last,token,emptyLines=0;if(currentLine.match(FIND_LIST_RX)||state.sCount[startLine]-state.blkIndent<4){return false}last=nextLine=startLine+1;while(nextLine<endLine){if(state.isEmpty(nextLine)){emptyLines++;if(emptyLines>=2&&state.parentType==="list"){break}nextLine++;continue}emptyLines=0;if(state.sCount[nextLine]-state.blkIndent>=4){nextLine++;last=nextLine;continue}break}state.line=last;token=state.push("code_block","code",0);token.content=state.getLines(startLine,last,4+state.blkIndent,true);token.map=[startLine,state.line];return true}},function(module,exports){"use strict";module.exports=function blockquote(state,startLine,endLine,silent){var FIND_LIST_RX=/(?:-|\*|\d+\.) {1,4}(?:> {0,3})[^>]*$/;var sourceLines=state.src.split("\n");var currentLine=sourceLines[startLine];var nextLine,lastLineEmpty,oldTShift,oldSCount,oldBMarks,oldIndent,oldParentType,lines,initial,offset,ch,terminatorRules,token,i,l,terminate,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(currentLine.match(FIND_LIST_RX)||state.src.charCodeAt(pos++)!==62){return false}if(silent){return true}if(state.src.charCodeAt(pos)===32){pos++}oldIndent=state.blkIndent;state.blkIndent=0;initial=offset=state.sCount[startLine]+pos-(state.bMarks[startLine]+state.tShift[startLine]);oldBMarks=[state.bMarks[startLine]];state.bMarks[startLine]=pos;while(pos<max){ch=state.src.charCodeAt(pos);if(isSpace(ch)){if(ch===9){offset+=4-offset%4}else{offset++}}else{break}pos++}lastLineEmpty=pos>=max;oldSCount=[state.sCount[startLine]];state.sCount[startLine]=offset-initial;oldTShift=[state.tShift[startLine]];state.tShift[startLine]=pos-state.bMarks[startLine];terminatorRules=state.md.block.ruler.getRules("blockquote");for(nextLine=startLine+1;nextLine<endLine;nextLine++){if(state.sCount[nextLine]<oldIndent){break}pos=state.bMarks[nextLine]+state.tShift[nextLine];max=state.eMarks[nextLine];if(pos>=max){break}if(state.src.charCodeAt(pos++)===62){if(state.src.charCodeAt(pos)===32){pos++}initial=offset=state.sCount[nextLine]+pos-(state.bMarks[nextLine]+state.tShift[nextLine]);oldBMarks.push(state.bMarks[nextLine]);state.bMarks[nextLine]=pos;while(pos<max){ch=state.src.charCodeAt(pos);if(isSpace(ch)){if(ch===9){offset+=4-offset%4}else{offset++}}else{break}pos++}lastLineEmpty=pos>=max;oldSCount.push(state.sCount[nextLine]);state.sCount[nextLine]=offset-initial;oldTShift.push(state.tShift[nextLine]);state.tShift[nextLine]=pos-state.bMarks[nextLine];continue}if(lastLineEmpty){break}terminate=false;for(i=0,l=terminatorRules.length;i<l;i++){if(terminatorRules[i](state,nextLine,endLine,true)){terminate=true;break}}if(terminate){break}oldBMarks.push(state.bMarks[nextLine]);oldTShift.push(state.tShift[nextLine]);oldSCount.push(state.sCount[nextLine]);state.sCount[nextLine]=-1}oldParentType=state.parentType;state.parentType="blockquote";token=state.push("blockquote_open","blockquote",1);token.markup=">";token.map=lines=[startLine,0];state.md.block.tokenize(state,startLine,nextLine);token=state.push("blockquote_close","blockquote",-1);token.markup=">";state.parentType=oldParentType;lines[1]=state.line;for(i=0;i<oldTShift.length;i++){state.bMarks[i+startLine]=oldBMarks[i];state.tShift[i+startLine]=oldTShift[i];state.sCount[i+startLine]=oldSCount[i]}state.blkIndent=oldIndent;return true};function isSpace(code){switch(code){case 9:case 32:return true}return false}},function(module,exports){"use strict";function getLine(state,line){var pos=state.bMarks[line]+state.blkIndent,max=state.eMarks[line];return state.src.substr(pos,max-pos)}function escapedSplit(str){var result=[],pos=0,max=str.length,ch,escapes=0,lastPos=0,backTicked=false,lastBackTick=0;ch=str.charCodeAt(pos);while(pos<max){if(ch===96&&escapes%2===0){backTicked=!backTicked;lastBackTick=pos}else if(ch===124&&escapes%2===0&&!backTicked){result.push(str.substring(lastPos,pos));lastPos=pos+1}else if(ch===92){escapes+=1}else{escapes=0}pos+=1;if(pos===max&&backTicked){backTicked=false;pos=lastBackTick+1}ch=str.charCodeAt(pos)}result.push(str.substring(lastPos));return result}module.exports=function table(state,startLine,endLine,silent){var ch,lineText,pos,i,nextLine,columns,columnCount,token,aligns,alignCount,t,tableLines,tbodyLines;if(startLine+2>endLine){return false}nextLine=startLine+1;if(state.sCount[nextLine]<state.blkIndent){return false}pos=state.bMarks[nextLine]+state.tShift[nextLine];if(pos>=state.eMarks[nextLine]){return false}ch=state.src.charCodeAt(pos);if(ch!==124&&ch!==45&&ch!==58){return false}lineText=getLine(state,startLine+1);if(!/^[-:| ]+$/.test(lineText)){return false}columns=lineText.split("|");aligns=[];for(i=0;i<columns.length;i+=1){t=columns[i].trim();if(!t){if(i===0||i===columns.length-1){continue}else{return false}}if(!/^:?-+:?$/.test(t)){return false}if(t.charCodeAt(t.length-1)===58){aligns.push(t.charCodeAt(0)===58?"center":"right")}else if(t.charCodeAt(0)===58){aligns.push("left")}else{aligns.push("")}}alignCount=aligns.length;lineText=getLine(state,startLine).trim();if(lineText.indexOf("|")===-1){return false}columns=escapedSplit(lineText.replace(/^\||\|$/g,""));columnCount=columns.length;if(columnCount>alignCount){return false}else if(columnCount<alignCount){for(i=0;i<alignCount-columnCount;i+=1){columns.push("")}columnCount=columns.length}if(silent){return true}token=state.push("table_open","table",1);token.map=tableLines=[startLine,0];token=state.push("thead_open","thead",1);token.map=[startLine,startLine+1];token=state.push("tr_open","tr",1);token.map=[startLine,startLine+1];for(i=0;i<columnCount;i+=1){token=state.push("th_open","th",1);token.map=[startLine,startLine+1];if(aligns[i]){token.attrs=[["align",aligns[i]]]}token=state.push("inline","",0);token.content=columns[i].trim();token.map=[startLine,startLine+1];token.children=[];token=state.push("th_close","th",-1)}token=state.push("tr_close","tr",-1);token=state.push("thead_close","thead",-1);token=state.push("tbody_open","tbody",1);token.map=tbodyLines=[startLine+2,0];for(nextLine=startLine+2;nextLine<endLine;nextLine+=1){if(state.sCount[nextLine]<state.blkIndent){break}lineText=getLine(state,nextLine);if(lineText.indexOf("|")===-1){break}columns=escapedSplit(lineText.replace(/^\||\|\s*$/g,""));token=state.push("tr_open","tr",1);for(i=0;i<columnCount;i+=1){token=state.push("td_open","td",1);if(aligns[i]){token.attrs=[["align",aligns[i]]]}token=state.push("inline","",0);token.content=columns[i]?columns[i].trim():"";token.children=[];token=state.push("td_close","td",-1)}token=state.push("tr_close","tr",-1)}token=state.push("tbody_close","tbody",-1);token=state.push("table_close","table",-1);tableLines[1]=tbodyLines[1]=nextLine;state.line=nextLine;return true}},function(module,exports){"use strict";var voidTagNames=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var HTML_SEQUENCES=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,true],[/^<!--/,/-->/,true],[/^<\?/,/\?>/,true],[/^<![A-Z]/,/>/,true],[/^<!\[CDATA\[/,/\]\]>/,true],[new RegExp("^<("+voidTagNames.join("|")+")","i"),/^\/?>$/,true],[new RegExp("^</?(address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|pre|section|source|title|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?=(\\s|/?>|$))","i"),/^$/,true],[/^(?:<[A-Za-z][A-Za-z0-9\-]*(?:\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\s*=\s*(?:[^"'=<>`\x00-\x20]+|'[^']*'|"[^"]*"))?)*\s*\/?>|<\/[A-Za-z][A-Za-z0-9\-]*\s*>)\s*$/,/^$/,false]];module.exports=function html_block(state,startLine,endLine,silent){var i,nextLine,token,lineText,pos=state.bMarks[startLine]+state.tShift[startLine],max=state.eMarks[startLine];if(!state.md.options.html){return false}if(state.src.charCodeAt(pos)!==60){return false}lineText=state.src.slice(pos,max);for(i=0;i<HTML_SEQUENCES.length;i++){if(HTML_SEQUENCES[i][0].test(lineText)){if(i===5){return false}else{break}}}if(i===HTML_SEQUENCES.length){return false}if(silent){return HTML_SEQUENCES[i][2]}nextLine=startLine+1;if(!HTML_SEQUENCES[i][1].test(lineText)){for(;nextLine<endLine;nextLine++){if(state.sCount[nextLine]<state.blkIndent){break}pos=state.bMarks[nextLine]+state.tShift[nextLine];max=state.eMarks[nextLine];lineText=state.src.slice(pos,max);if(HTML_SEQUENCES[i][1].test(lineText)){if(lineText.length!==0){nextLine++}break}}}state.line=nextLine;token=state.push("html_block","",0);token.map=[startLine,nextLine];token.content=state.getLines(startLine,nextLine,state.blkIndent,true);return true}},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _preview=__webpack_require__(7);var _preview2=_interopRequireDefault(_preview);var _eventManager=__webpack_require__(27);var _eventManager2=_interopRequireDefault(_eventManager);var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _convertor=__webpack_require__(32);var _convertor2=_interopRequireDefault(_convertor);var _codeBlockManager=__webpack_require__(9);var _codeBlockManager2=_interopRequireDefault(_codeBlockManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var TASK_ATTR_NAME="data-te-task";var TASK_CHECKED_CLASS_NAME="checked";var ToastUIEditorViewOnly=function(){function ToastUIEditorViewOnly(options){var _this=this;_classCallCheck(this,ToastUIEditorViewOnly);this.options=options;this.eventManager=new _eventManager2.default;this.commandManager=new _commandManager2.default(this);this.convertor=new _convertor2.default(this.eventManager);this.codeBlockManager=_codeBlockManager2.default;this.toMarkOptions=null;if(this.options.hooks){util.forEach(this.options.hooks,function(fn,key){_this.addHook(key,fn)})}if(this.options.events){util.forEach(this.options.events,function(fn,key){_this.on(key,fn)})}this.preview=new _preview2.default($(this.options.el),this.eventManager,this.convertor,true);this.preview.$el.on("mousedown",$.proxy(this._toggleTask,this));_extManager2.default.applyExtension(this,this.options.exts);this.setValue(this.options.initialValue);this.eventManager.emit("load",this)}_createClass(ToastUIEditorViewOnly,[{key:"_toggleTask",value:function _toggleTask(ev){var isBeneathTaskBox=ev.offsetX<18&&ev.offsetY>18;if(ev.target.hasAttribute(TASK_ATTR_NAME)&&!isBeneathTaskBox){$(ev.target).toggleClass(TASK_CHECKED_CLASS_NAME);this.eventManager.emit("change",{source:"viewOnly",data:ev})}}},{key:"setMarkdown",value:function setMarkdown(markdown){this.markdownValue=markdown=markdown||"";this.preview.refresh(this.markdownValue);this.eventManager.emit("setMarkdownAfter",this.markdownValue)}},{key:"setValue",value:function setValue(markdown){this.setMarkdown(markdown)}},{key:"on",value:function on(type,handler){this.eventManager.listen(type,handler)}},{key:"off",value:function off(type){this.eventManager.removeEventHandler(type)}},{key:"remove",value:function remove(){this.eventManager.emit("removeEditor");this.preview.$el.off("mousedown",$.proxy(this._toggleTask,this));this.options=null;this.eventManager=null;this.commandManager=null;this.convertor=null;this.preview=null}},{key:"addHook",value:function addHook(type,handler){this.eventManager.removeEventHandler(type);this.eventManager.listen(type,handler)}},{key:"isViewOnly",value:function isViewOnly(){return true}},{key:"isMarkdownMode",value:function isMarkdownMode(){return false}},{key:"isWysiwygMode",value:function isWysiwygMode(){return false}}]);return ToastUIEditorViewOnly}();module.exports=ToastUIEditorViewOnly},function(module,exports,__webpack_require__){"use strict";var _toolbar=__webpack_require__(41);var _toolbar2=_interopRequireDefault(_toolbar);var _tab=__webpack_require__(45);var _tab2=_interopRequireDefault(_tab);var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);var _modeSwitch=__webpack_require__(48);var _modeSwitch2=_interopRequireDefault(_modeSwitch);var _popupAddLink=__webpack_require__(49);var _popupAddLink2=_interopRequireDefault(_popupAddLink);var _popupAddImage=__webpack_require__(50);var _popupAddImage2=_interopRequireDefault(_popupAddImage);var _popupTableUtils=__webpack_require__(51);var _popupTableUtils2=_interopRequireDefault(_popupTableUtils);var _popupAddTable=__webpack_require__(52);var _popupAddTable2=_interopRequireDefault(_popupAddTable);var _popupAddHeading=__webpack_require__(53);var _popupAddHeading2=_interopRequireDefault(_popupAddHeading);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var containerTmpl=['<div class="tui-editor-defaultUI">','<div class="te-toolbar-section"></div>','<div class="te-markdown-tab-section"></div>','<div class="te-editor-section"></div>','<div class="te-mode-switch-section"></div>',"</div>"].join("");function DefaultUI(editor){this.name="default";this.type=editor.options.initialEditType;this.editor=editor;this.init(editor.options.el);this._initEvent()}DefaultUI.prototype.init=function($container){this._renderLayout($container);this._initEditorSection();this._initToolbar();this._initModeSwitch();this._initPopupAddLink();this._initPopupAddImage();this._initPopupAddTable();this._initPopupAddHeading();this._initPopupTableUtils();this._initMarkdownTab()};DefaultUI.prototype._initEditorSection=function(){this.$el.find(".te-editor-section").append(this.editor.layout.getEditorEl())};DefaultUI.prototype._initEvent=function(){var self=this;this.editor.eventManager.listen("hide",this.hide.bind(this));this.editor.eventManager.listen("show",this.show.bind(this));this.editor.eventManager.listen("changeMode",function(){self.markdownTabControl()});this.editor.eventManager.listen("changePreviewStyle",function(){self.markdownTabControl()})};DefaultUI.prototype._renderLayout=function($container){this.$el=$(containerTmpl).appendTo($container)};DefaultUI.prototype._initToolbar=function(){this.toolbar=new _toolbar2.default(this.editor.eventManager);this.$el.find(".te-toolbar-section").append(this.toolbar.$el)};DefaultUI.prototype._initModeSwitch=function(){var self=this;this.modeSwitch=new _modeSwitch2.default(this.type==="markdown"?_modeSwitch2.default.TYPE.MARKDOWN:_modeSwitch2.default.TYPE.WYSIWYG);this.$el.find(".te-mode-switch-section").append(this.modeSwitch.$el);this.modeSwitch.on("modeSwitched",function(ev,type){self.editor.changeMode(type)})};DefaultUI.prototype.markdownTabControl=function(){if(this.editor.isMarkdownMode()&&this.editor.getCurrentPreviewStyle()==="tab"){this.$el.find(".te-markdown-tab-section").show();this.markdownTab.activate("Editor")}else{this.$el.find(".te-markdown-tab-section").hide()}};DefaultUI.prototype._initMarkdownTab=function(){var editor=this.editor;this.markdownTab=new _tab2.default({items:["Editor","Preview"],sections:[editor.layout.getMdEditorContainerEl(),editor.layout.getPreviewEl()]});this.$el.find(".te-markdown-tab-section").append(this.markdownTab.$el);this.markdownTab.on("itemClick",function(ev,itemText){if(itemText==="Preview"){editor.eventManager.emit("previewNeedsRefresh")}else{editor.getCodeMirror().focus()}})};DefaultUI.prototype._initPopupAddLink=function(){this.popupAddLink=new _popupAddLink2.default({$target:this.$el,editor:this.editor})};DefaultUI.prototype._initPopupAddImage=function(){this.popupAddImage=new _popupAddImage2.default({$target:this.$el,eventManager:this.editor.eventManager})};DefaultUI.prototype._initPopupAddTable=function(){this.popupAddTable=new _popupAddTable2.default({$target:this.$el,eventManager:this.editor.eventManager,$button:this.$el.find("button.tui-table"),css:{position:"absolute"}})};DefaultUI.prototype._initPopupAddHeading=function(){this.popupAddHeading=new _popupAddHeading2.default({$target:this.$el,eventManager:this.editor.eventManager,$button:this.$el.find("button.tui-heading"),css:{position:"absolute"}})};DefaultUI.prototype._initPopupTableUtils=function(){var self=this;this.editor.eventManager.listen("contextmenu",function(ev){if($(ev.data.target).parents("[contenteditable=true] table").length>0){ev.data.preventDefault();self.editor.eventManager.emit("openPopupTableUtils",ev.data)}});this.popupTableUtils=new _popupTableUtils2.default({$target:this.$el,eventManager:this.editor.eventManager})};DefaultUI.prototype.hide=function(){this.$el.addClass("te-hide")};DefaultUI.prototype.show=function(){this.$el.removeClass("te-hide")};DefaultUI.prototype.remove=function(){this.$el.remove()};DefaultUI.prototype.createPopup=function(options){return _layerpopup2.default.factory(options)};module.exports=DefaultUI},function(module,exports,__webpack_require__){"use strict";var _uicontroller=__webpack_require__(42);var _uicontroller2=_interopRequireDefault(_uicontroller);var _button=__webpack_require__(43);var _button2=_interopRequireDefault(_button);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;function Toolbar(eventManager){_uicontroller2.default.call(this,{tagName:"div",className:"tui-editor-defaultUI-toolbar"});this.buttons=[];this.eventManager=eventManager;this.render();this._initButton()}Toolbar.prototype=util.extend({},_uicontroller2.default.prototype);Toolbar.prototype.render=function(){this.$buttonContainer=this.$el};Toolbar.prototype.addButton=function(buttons,index){var _this=this;var TOOLBAR_GROUP_CLASS_NAME="tui-toolbar-button-group";var $buttonWrap=$('<div class="'+TOOLBAR_GROUP_CLASS_NAME+'"></div>');if(util.isArray(buttons)){util.forEach(buttons,function(button){$buttonWrap.append(_this._setButton(button).$el)})}else{$buttonWrap.append(this._setButton(buttons).$el)}if(index){this.$buttonContainer.find("."+TOOLBAR_GROUP_CLASS_NAME).eq(index-1).after($buttonWrap)}else{this.$buttonContainer.append($buttonWrap)}};Toolbar.prototype._setButton=function(button){var ev=this.eventManager;if(!button.render){button=new _button2.default(button)}button.on("command",function emitCommandEvent($,commandName){ev.emit("command",commandName)});button.on("event",function emitEventByCommand($,eventName){ev.emit(eventName)});this.buttons.push(button);return button};Toolbar.prototype._initButton=function(){var _this2=this;this.addButton(new _button2.default({className:"tui-heading",event:"openHeadingSelect",tooltip:_i18n2.default.get("Headings")}));this.addButton([new _button2.default({className:"tui-bold",command:"Bold",tooltip:_i18n2.default.get("Bold"),state:"bold"}),new _button2.default({className:"tui-italic",command:"Italic",tooltip:_i18n2.default.get("Italic"),state:"italic"}),new _button2.default({className:"tui-strike",command:"Strike",text:"~",tooltip:_i18n2.default.get("Strike"),state:"strike"})]);this.addButton([new _button2.default({className:"tui-ul",command:"UL",tooltip:_i18n2.default.get("Unordered list")}),new _button2.default({className:"tui-ol",command:"OL",tooltip:_i18n2.default.get("Ordered list")}),new _button2.default({className:"tui-task",command:"Task",tooltip:_i18n2.default.get("Task")})]);this.addButton([new _button2.default({className:"tui-hrline",command:"HR",tooltip:_i18n2.default.get("Line")}),new _button2.default({className:"tui-table",event:"openPopupAddTable",tooltip:_i18n2.default.get("Insert table")})]);this.addButton([new _button2.default({className:"tui-image",event:"openPopupAddImage",tooltip:_i18n2.default.get("Insert image")}),new _button2.default({className:"tui-link",event:"openPopupAddLink",tooltip:_i18n2.default.get("Insert link")})]);this.addButton(new _button2.default({className:"tui-quote",command:"Blockquote",tooltip:_i18n2.default.get("Blockquote"),state:"quote"}));this.addButton([new _button2.default({className:"tui-codeblock",command:"CodeBlock",text:"CB",tooltip:_i18n2.default.get("Insert codeblock"),state:"codeBlock"}),new _button2.default({className:"tui-code",command:"Code",tooltip:_i18n2.default.get("Code"),state:"code"})]);this.eventManager.listen("stateChange",function(ev){util.forEach(_this2.buttons,function(button){if(button.state){if(ev[button.state]){button.$el.addClass("active")}else{button.$el.removeClass("active")}}})})};module.exports=Toolbar},function(module,exports){"use strict";var util=tui.util;var _id=0;function UIController(options){options=util.extend({tagName:"div"},options||{});this.tagName=options.tagName;this.className=options.className;this.$el=null;this._initID();this.setRootElement(options.rootElement)}UIController.prototype.on=function(aType,aFn){var self=this;if(util.isObject(aType)){util.forEach(aType,function(fn,type){self._addEvent(type,fn)})}else{this._addEvent(aType,aFn)}};UIController.prototype._addEvent=function(type,fn){var parsedType=this._parseEventType(type),event=parsedType[0],selector=parsedType[1];if(selector){this.$el.on(event,selector,fn)}else{this.$el.on(event,fn)}};UIController.prototype.off=function(type,fn){if(type){var parsedType=this._parseEventType(type);var event=parsedType[0];var selector=parsedType[1];if(selector){this.$el.off(event,selector,fn)}else{this.$el.off(event,fn)}}else{this.$el.off()}};UIController.prototype._parseEventType=function(type){var splitType=type.split(" "),event=splitType.shift(),selector=splitType.join(" ");return[event,selector]};UIController.prototype.attachEvents=function(events){var self=this;var eventlist=events||this.events;var handler=void 0;if(eventlist){util.forEach(eventlist,function(handlerName,type){if(self[handlerName]){type=self.getEventNameWithNamespace(type);handler=util.bind(self[handlerName],self);self.on(type,handler)}else{throw new Error("UIController#attachEvents: "+handlerName+"란 메서드가 없습니다.")}})}};UIController.prototype.detachEvents=function(){this.$el.off(".uicEvent"+this.id)};UIController.prototype.setRootElement=function($el){var className=this.className;var tagName=this.tagName;if(!$el){className=className||"uic"+this.id;$el=$("<"+tagName+' class="'+className+'"/>')}this.$el=$el};UIController.prototype.trigger=function(){var _$el;(_$el=this.$el).trigger.apply(_$el,arguments)};UIController.prototype._initID=function(){this.id=_id;_id+=1};UIController.prototype.getEventNameWithNamespace=function(event){var eventSplited=event.split(" ");eventSplited[0]+=".uicEvent"+this.id;return eventSplited.join(" ")};UIController.prototype.addUIC=function(uic,targetSEL){if(targetSEL){this.$el.find(targetSEL).append(uic.$el)}else{this.$el.append(uic.$el)}};UIController.prototype.remove=function(){this.detachEvents();this.$el.remove()};UIController.prototype.destroy=function(){var self=this;this.remove();this.detachEvents();util.forEachOwnProperties(this,function(value,key){self[key]=null})};UIController.extend=function(props){var newUIC=util.defineClass(this,props);newUIC.extend=UIController.extend;return newUIC};module.exports=UIController},function(module,exports,__webpack_require__){"use strict";var UIController=__webpack_require__(42);var Tooltip=__webpack_require__(44);var util=tui.util;var tooltip=new Tooltip;function Button(options){UIController.call(this,{tagName:"button",className:options.className+" tui-toolbar-icons",rootElement:options.$el});this._setOptions(options);this.render();this.attachEvents({click:"_onClick"});if(options.tooltip){this.attachEvents({mouseover:"_onOver",mouseout:"_onOut"})}}Button.prototype=util.extend({},UIController.prototype);Button.prototype._setOptions=function(options){this.command=options.command;this.event=options.event;this.text=options.text;this.tooltip=options.tooltip;this.style=options.style;this.state=options.state};Button.prototype.render=function(){this.$el.text(this.text);this.$el.attr("type","button");if(this.style){this.$el.attr("style",this.style)}};Button.prototype._onClick=function(){if(this.command){this.trigger("command",this.command)}else{this.trigger("event",this.event)}this.trigger("clicked")};Button.prototype._onOver=function(){tooltip.show(this.$el,this.tooltip)};Button.prototype._onOut=function(){tooltip.hide()};module.exports=Button},function(module,exports){"use strict";var TOOLTIP_CONTENT='<div class="tui-tooltip"><div class="arrow"></div><span class="text"></span></span></div>';function Tooltip(){this.$el=$(TOOLTIP_CONTENT);this.$el.appendTo("body");this.$el.hide()}Tooltip.prototype.show=function(target,text){this.$el.css({top:target.offset().top+target.height()+13,left:target.offset().left+3}).find(".text").html(text).end().show()};Tooltip.prototype.hide=function(){this.$el.hide()};module.exports=Tooltip},function(module,exports,__webpack_require__){"use strict";var _uicontroller=__webpack_require__(42);var _uicontroller2=_interopRequireDefault(_uicontroller);var _templater=__webpack_require__(46);var _templater2=_interopRequireDefault(_templater);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var buttonTmpl='<button type="button" data-index="${index}">${name}</button>';function Tab(options){_uicontroller2.default.call(this,{tagName:"div",className:"te-tab"});options=util.extend({},options);this.items=options.items;this.sections=options.sections;this._$activeButton=null;this.render();this._initItemClickEvent(options.onItemClick);this._applyInitName(options.initName)}Tab.prototype=util.extend({},_uicontroller2.default.prototype);Tab.prototype.render=function(){var buttonHtml=(0,_templater2.default)(buttonTmpl,this._getButtonData());this.$el.html(buttonHtml);this.attachEvents({"click button":"_onButtonClick"})};Tab.prototype._applyInitName=function(initName){if(initName){this.activate(initName)}};Tab.prototype._getButtonData=function(){var buttonData=[];for(var i=0,len=this.items.length;i<len;i+=1){buttonData.push({name:this.items[i],index:i})}return buttonData};Tab.prototype._onButtonClick=function(ev){var $button=$(ev.target);this._activateTabByButton($button);this.trigger("itemClick",$button.text())};Tab.prototype._deactivate=function(){if(this._$activeButton){this._$activeButton.removeClass("te-tab-active");if(this.sections){this.sections[this._$activeButton.attr("data-index")].removeClass("te-tab-active")}}};Tab.prototype._activateButton=function($button){this._$activeButton=$button;this._$activeButton.addClass("te-tab-active")};Tab.prototype._activateSection=function(index){if(this.sections){this.sections[index].addClass("te-tab-active")}};Tab.prototype.activate=function(name){var $button=this.$el.find('button:contains("'+name+'")');this._activateTabByButton($button)};Tab.prototype._activateTabByButton=function($button){if(this._isActivatedButton($button)){return}this._deactivate();this._activateButton($button);this._activateSection($button.attr("data-index"))};Tab.prototype._isActivatedButton=function($button){return this._$activeButton&&this._$activeButton.text()===$button.text()};Tab.prototype._initItemClickEvent=function(handler){if(handler){this.on("itemClick",handler)}};module.exports=Tab},function(module,exports){"use strict";var util=tui.util;function templater(template,mapper){var totalReplaced=[];var replaced=void 0;if(!util.isArray(mapper)){mapper=[mapper]}util.forEach(mapper,function(mapdata){replaced=template.replace(/\${([\w]+)}/g,function(matchedString,name){return util.isExisty(mapdata,name)?mapdata[name].toString():""});totalReplaced.push(replaced)});return totalReplaced}module.exports=templater},function(module,exports,__webpack_require__){
"use strict";var _uicontroller=__webpack_require__(42);var _uicontroller2=_interopRequireDefault(_uicontroller);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var CLASS_PREFIX="tui-popup-";var _id=0;var LAYOUT_TEMPLATE=['<div class="'+CLASS_PREFIX+'header">','<span class="'+CLASS_PREFIX+'title"></span>','<button type="button" class="'+CLASS_PREFIX+'close-button">x</button>',"</div>",'<div class="'+CLASS_PREFIX+'body"></div>'].join("");function LayerPopup(options){options=util.extend({},options);_uicontroller2.default.call(this,{tagName:"div",className:CLASS_PREFIX+"wrapper",rootElement:options.$el});options=util.extend({},options);this._setId();this._initTarget(options);this._initExternalPopupHtmlIfNeed(options);this._initCloserOpener(options);this._initContent(options);this._initTitle(options);this._initClassName(options);this._initCssStyles(options)}LayerPopup.prototype=util.extend({},_uicontroller2.default.prototype);LayerPopup.prototype._initTarget=function(options){this.$target=options.$target||$("body")};LayerPopup.prototype._initExternalPopupHtmlIfNeed=function(options){if(options.$el){this.$el=options.$el;this._isExternalHtmlUse=true}};LayerPopup.prototype._initCloserOpener=function(options){this.openerCssQuery=options.openerCssQuery;this.closerCssQuery=options.closerCssQuery};LayerPopup.prototype._initContent=function(options){if(options.content){this.$content=$(options.content)}else if(options.textContent){this.$content=options.textContent}};LayerPopup.prototype._initTitle=function(options){this.title=options.title};LayerPopup.prototype._initClassName=function(options){if(options.className){this.className=options.className}};LayerPopup.prototype.render=function(){this._renderLayout();this._renderTitle();this._renderContent();this._attachPopupEvent()};LayerPopup.prototype._renderLayout=function(){if(!this._isExternalHtmlUse){this.$el.html(LAYOUT_TEMPLATE);this.$el.addClass(this.className);this.hide();this.$target.append(this.$el);this.$body=this.$el.find(this._getFullClassName("body"));if(this.title===false){this.$el.find(this._getFullClassName("header")).remove()}}else{this.hide();if(this.$target){this.$target.append(this.$el)}}};LayerPopup.prototype._renderContent=function(){if(!this._isExternalHtmlUse){this.setContent(this.$content)}};LayerPopup.prototype._renderTitle=function(){if(!this._isExternalHtmlUse&&this.title!==false){this.setTitle(this.title)}};LayerPopup.prototype._getFullClassName=function(lastName){return"."+CLASS_PREFIX+lastName};LayerPopup.prototype._attachOpenerCloserEvent=function(){var self=this;if(this.openerCssQuery){$(this.openerCssQuery).on("click."+this._getId(),function(){self.show()})}if(this.closerCssQuery){$(this.closerCssQuery).on("click."+this._getId(),function(){self.hide()})}};LayerPopup.prototype._detachOpenerCloserEvent=function(){if(this.openerCssQuery){$(this.openerCssQuery).off("."+this._getId())}if(this.closerCssQuery){$(this.closerCssQuery).off("."+this._getId())}};LayerPopup.prototype._attachPopupControlEvent=function(){var self=this;this.on("click "+this._getFullClassName("close-button"),function(){self.hide()})};LayerPopup.prototype._detachPopupEvent=function(){this.off();this._detachOpenerCloserEvent()};LayerPopup.prototype._attachPopupEvent=function(){this._attachPopupControlEvent();this._attachOpenerCloserEvent()};LayerPopup.prototype._setId=function(){this._id=_id;_id+=1};LayerPopup.prototype._getId=function(){return this._id};LayerPopup.prototype.setContent=function($content){this.$body.empty();this.$body.append($content)};LayerPopup.prototype.setTitle=function(title){var $title=this.$el.find(this._getFullClassName("title"));$title.empty();$title.append(title)};LayerPopup.prototype.hide=function(){this.$el.css("display","none");this._isShow=false;this.trigger("hidden",this)};LayerPopup.prototype.show=function(){this.$el.css("display","block");this._isShow=true;this.trigger("shown",this)};LayerPopup.prototype.isShow=function(){return this._isShow};LayerPopup.prototype.remove=function(){this.trigger("remove",this);this._detachPopupEvent();this.$el.empty();this.$el.remove()};LayerPopup.prototype.css=function(){var _$el;(_$el=this.$el).css.apply(_$el,arguments)};LayerPopup.prototype._initCssStyles=function(options){if(options.css){this.css(options.css)}};LayerPopup.factory=function(options){var popup=new LayerPopup(options);popup.render();return popup};LayerPopup.CLASS_PREFIX=CLASS_PREFIX;module.exports=LayerPopup},function(module,exports,__webpack_require__){"use strict";var _uicontroller=__webpack_require__(42);var _uicontroller2=_interopRequireDefault(_uicontroller);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var TYPE={MARKDOWN:"markdown",WYSIWYG:"wysiwyg"};function ModeSwitch(initialType){_uicontroller2.default.call(this,{tagName:"div",className:"te-mode-switch"});this._render();this._switchType(util.isExisty(initialType)?initialType:TYPE.MARKDOWN)}ModeSwitch.prototype=util.extend({},_uicontroller2.default.prototype);ModeSwitch.prototype._render=function(){this.$buttons={};this.$buttons.markdown=$('<button class="te-switch-button markdown" type="button">'+_i18n2.default.get("Markdown")+"</button>");this.$buttons.wysiwyg=$('<button class="te-switch-button wysiwyg" type="button">'+_i18n2.default.get("WYSIWYG")+"</button>");this.$el.append(this.$buttons.markdown);this.$el.append(this.$buttons.wysiwyg);this.attachEvents({"click .markdown":"_changeMarkdown","click .wysiwyg":"_changeWysiwyg"})};ModeSwitch.prototype._changeMarkdown=function(){this._switchType(TYPE.MARKDOWN)};ModeSwitch.prototype._changeWysiwyg=function(){this._switchType(TYPE.WYSIWYG)};ModeSwitch.prototype._setActiveButton=function(type){util.forEach(this.$buttons,function($button){$button.removeClass("active")});this.$buttons[type].addClass("active")};ModeSwitch.prototype._switchType=function(type){if(this.type===type){return}this.type=type;this._setActiveButton(type);this.trigger("modeSwitched",this.type)};ModeSwitch.TYPE=TYPE;module.exports=ModeSwitch},function(module,exports,__webpack_require__){"use strict";var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);var _importManager=__webpack_require__(31);var _importManager2=_interopRequireDefault(_importManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var URL_REGEX=/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})(\/([^\s]*))?$/;function PopupAddLink(options){var POPUP_CONTENT='<label for="linkText">'+_i18n2.default.get("Link text")+'</label>\n        <input type="text" class="te-link-text-input" />\n        <label for="url">'+_i18n2.default.get("URL")+'</label>\n        <input type="text" class="te-url-input" />\n        <div class="te-button-section">\n            <button type="button" class="te-ok-button">'+_i18n2.default.get("OK")+'</button>\n            <button type="button" class="te-close-button">'+_i18n2.default.get("Cancel")+"</button>\n        </div>";options=util.extend({title:_i18n2.default.get("Insert link"),className:"te-popup-add-link tui-editor-popup",content:POPUP_CONTENT},options);_layerpopup2.default.call(this,options);this._editor=options.editor;this.render();this._initDOM();this._bindContentEvent();this._linkWithEventManager(options.editor.eventManager)}PopupAddLink.prototype=util.extend({},_layerpopup2.default.prototype);PopupAddLink.prototype._initDOM=function(){var el=this.$el.get(0);this._inputText=el.querySelector(".te-link-text-input");this._inputURL=el.querySelector(".te-url-input")};PopupAddLink.prototype._bindContentEvent=function(){var _this=this;this.on("click .te-ok-button",function(){_this.trigger("okButtonClicked",_this);_this.hide()});this.on("click .te-close-button",function(){_this.trigger("closeButtonClicked",_this);_this.hide()});this.on("shown",function(){var inputText=_this._inputText;var inputURL=_this._inputURL;var selectedText=_this._editor.getSelectedText().trim();inputText.value=selectedText;if(URL_REGEX.exec(selectedText)){inputURL.value=selectedText}if(selectedText.length>0&&inputURL.value.length<1){inputURL.focus()}else{inputText.focus();inputText.setSelectionRange(0,selectedText.length)}});this.on("hidden",function(){_this.resetInputs()})};PopupAddLink.prototype._linkWithEventManager=function(eventManager){var _this2=this;eventManager.listen("focus",function(){_this2.hide()});eventManager.listen("openPopupAddLink",function(){eventManager.emit("closeAllPopup");_this2.show()});eventManager.listen("closeAllPopup",function(){_this2.hide()});this.on("okButtonClicked",function(){eventManager.emit("command","AddLink",_this2.getValue())})};PopupAddLink.prototype.getValue=function(){var linkText=_importManager2.default.decodeURIGraceful(this._inputText.value,decodeURIComponent);var url=_importManager2.default.decodeURIGraceful(this._inputURL.value,decodeURI);return{linkText:linkText,url:url}};PopupAddLink.prototype.resetInputs=function(){this._inputText.value="";this._inputURL.value=""};module.exports=PopupAddLink},function(module,exports,__webpack_require__){"use strict";var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);var _tab=__webpack_require__(45);var _tab2=_interopRequireDefault(_tab);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;function PopupAddImage(options){var POPUP_CONTENT=['<div class="te-tab-section"></div>','<div class="te-url-type">','<label for="">'+_i18n2.default.get("Image URL")+"</label>",'<input type="text" class="te-image-url-input" />',"</div>",'<form enctype="multipart/form-data" class="te-file-type">','<label for="">'+_i18n2.default.get("Select image file")+"</label>",'<input type="file" class="te-image-file-input" accept="image/*" />',"</form>",'<label for="url">'+_i18n2.default.get("Description")+"</label>",'<input type="text" class="te-alt-text-input" />','<div class="te-button-section">','<button type="button" class="te-ok-button">'+_i18n2.default.get("OK")+"</button>",'<button type="button" class="te-close-button">'+_i18n2.default.get("Cancel")+"</button>","</div>"].join("");options=util.extend({title:_i18n2.default.get("Insert image"),className:"te-popup-add-image tui-editor-popup",content:POPUP_CONTENT},options);_layerpopup2.default.call(this,options);this.eventManager=options.eventManager;this.render();this._bindContentEvent();this._linkWithEventManager()}PopupAddImage.prototype=util.extend({},_layerpopup2.default.prototype);PopupAddImage.prototype._bindContentEvent=function(){var self=this;this.on("click .te-ok-button",function(){self.trigger("okButtonClicked",self);self.hide()});this.on("click .te-close-button",function(){self.trigger("closeButtonClicked",self);self.hide()});this.on("shown",function(){self.$el.find(".te-image-url-input").focus()});this.on("hidden",function(){self.resetInputs()});this.tab.on("itemClick",function(){self.resetInputs()});this.on("change .te-image-file-input",function(){var filename=self.$el.find(".te-image-file-input").val().split("\\").pop();self.$el.find(".te-alt-text-input").val(filename)})};PopupAddImage.prototype._linkWithEventManager=function(){var _this=this;this.eventManager.listen("focus",function(){_this.hide()});this.eventManager.listen("openPopupAddImage",function(){_this.eventManager.emit("closeAllPopup");_this.show()});this.eventManager.listen("closeAllPopup",function(){_this.hide()});this.on("okButtonClicked",function(){var imageUrl=_this.$el.find(".te-image-url-input").val();var altText=_this.$el.find(".te-alt-text-input").val();if(imageUrl){_this.applyImage(imageUrl,altText)}else{_this.eventManager.emit("addImageBlobHook",_this.$el.find(".te-image-file-input")[0].files[0],function(url,text){return _this.applyImage(url,altText||text)},"ui")}})};PopupAddImage.prototype.applyImage=function(imageUrl,altText){this.eventManager.emit("command","AddImage",{imageUrl:imageUrl,altText:altText||"image"});this.hide()};PopupAddImage.prototype._renderContent=function(){var $popup=this.$el;_layerpopup2.default.prototype._renderContent.call(this);this.tab=new _tab2.default({initName:_i18n2.default.get("File"),items:[_i18n2.default.get("File"),_i18n2.default.get("URL")],sections:[$popup.find(".te-file-type"),$popup.find(".te-url-type")]});this.$body.find(".te-tab-section").append(this.tab.$el)};PopupAddImage.prototype._getImageFileForm=function(){return this.$el.find("form")};PopupAddImage.prototype.resetInputs=function(){this.$el.find("input").val("")};module.exports=PopupAddImage},function(module,exports,__webpack_require__){"use strict";var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;function PopupTableUtils(options){var POPUP_CONTENT=['<button type="button" class="te-table-add-row">'+_i18n2.default.get("Add row")+"</button>",'<button type="button" class="te-table-add-col">'+_i18n2.default.get("Add col")+"</button>",'<button type="button" class="te-table-remove-row">'+_i18n2.default.get("Remove row")+"</button>",'<button type="button" class="te-table-remove-col">'+_i18n2.default.get("Remove col")+"</button>",'<button type="button" class="te-table-col-align-left">'+_i18n2.default.get("Align left")+"</button>",'<button type="button" class="te-table-col-align-center">'+_i18n2.default.get("Align center")+"</button>",'<button type="button" class="te-table-col-align-right">'+_i18n2.default.get("Align right")+"</button>",'<button type="button" class="te-table-remove">'+_i18n2.default.get("Remove table")+"</button>"].join("");options=util.extend({title:false,className:"te-popup-table-utils",content:POPUP_CONTENT},options);_layerpopup2.default.call(this,options);this.eventManager=options.eventManager;this.render();this._bindContentEvent();this._linkWithEventManager()}PopupTableUtils.prototype=util.extend({},_layerpopup2.default.prototype);PopupTableUtils.prototype._bindContentEvent=function(){var self=this;this.on("click .te-table-add-row",function(){self.eventManager.emit("command","AddRow")});this.on("click .te-table-add-col",function(){self.eventManager.emit("command","AddCol")});this.on("click .te-table-remove-row",function(){self.eventManager.emit("command","RemoveRow")});this.on("click .te-table-col-align-left",function(){self.eventManager.emit("command","AlignCol","left")});this.on("click .te-table-col-align-center",function(){self.eventManager.emit("command","AlignCol","center")});this.on("click .te-table-col-align-right",function(){self.eventManager.emit("command","AlignCol","right")});this.on("click .te-table-remove-col",function(){self.eventManager.emit("command","RemoveCol")});this.on("click .te-table-remove",function(){self.eventManager.emit("command","RemoveTable")})};PopupTableUtils.prototype._linkWithEventManager=function(){var self=this;this.eventManager.listen("focus",function(){self.hide()});this.eventManager.listen("mousedown",function(){self.hide()});this.eventManager.listen("openPopupTableUtils",function(event){var offset=self.$el.parent().offset();var x=event.clientX-offset.left;var y=event.clientY-offset.top+$(window).scrollTop();self.eventManager.emit("closeAllPopup");self.$el.css({position:"absolute",top:y+5,left:x+10});self.show()});this.eventManager.listen("closeAllPopup",function(){self.hide()})};module.exports=PopupTableUtils},function(module,exports,__webpack_require__){"use strict";var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var POPUP_CONTENT=['<div class="te-table-selection">','<div class="te-table-header"></div>','<div class="te-table-body"></div>','<div class="te-selection-area"></div>',"</div>",'<p class="te-description"></p>'].join("");var CELL_WIDTH=25,CELL_HEIGHT=17,MIN_ROW_INDEX=7,MAX_ROW_INDEX=14,MIN_COL_INDEX=5,MAX_COL_INDEX=9,MIN_ROW_SELECTION_INDEX=1,MIN_COL_SELECTION_INDEX=1,HEADER_ROW_COUNT=1,LAST_BORDER=1;function PopupAddTable(options){options=util.extend({title:false,className:"te-popup-add-table",content:POPUP_CONTENT},options);_layerpopup2.default.call(this,options);this._selectedBound={};this._tableBound={};this.eventManager=options.eventManager;this.$button=options.$button;this.render();this._cacheElements();this._bindContentEvent();this._linkWithEventManager();this._setTableSizeByBound(MIN_COL_INDEX,MIN_ROW_INDEX)}PopupAddTable.prototype=util.extend({},_layerpopup2.default.prototype);PopupAddTable.prototype._cacheElements=function(){this.$header=this.$el.find(".te-table-header");this.$body=this.$el.find(".te-table-body");this.$selection=this.$el.find(".te-selection-area");this.$desc=this.$el.find(".te-description")};PopupAddTable.prototype._bindContentEvent=function(){var self=this;this.on("mousemove .te-table-selection",function(ev){var x=ev.pageX-self._selectionOffset.left;var y=ev.pageY-self._selectionOffset.top;var bound=self._getSelectionBoundByOffset(x,y);self._resizeTableBySelectionIfNeed(bound.col,bound.row);self._setSelectionAreaByBound(bound.col,bound.row);self._setDisplayText(bound.col,bound.row);self._setSelectedBound(bound.col,bound.row)});this.on("click .te-table-selection",function(){var tableSize=self._getSelectedTableSize();self.eventManager.emit("command","Table",tableSize.col,tableSize.row)})};PopupAddTable.prototype._linkWithEventManager=function(){var self=this;this.eventManager.listen("focus",function(){self.hide()});this.eventManager.listen("openPopupAddTable",function(){self.eventManager.emit("closeAllPopup");self.$el.css({top:self.$button.position().top+self.$button.height()+5,left:self.$button.position().left});self.show();self._selectionOffset=self.$el.find(".te-table-selection").offset()});this.eventManager.listen("closeAllPopup",function(){self.hide()})};PopupAddTable.prototype._resizeTableBySelectionIfNeed=function(col,row){var resizedBound=this._getResizedTableBound(col,row);if(resizedBound){this._setTableSizeByBound(resizedBound.col,resizedBound.row)}};PopupAddTable.prototype._getResizedTableBound=function(col,row){var resizedCol=void 0,resizedRow=void 0,resizedBound=void 0;if(col>=MIN_COL_INDEX&&col<MAX_COL_INDEX){resizedCol=col+1}else if(col<MIN_COL_INDEX){resizedCol=MIN_COL_INDEX}if(row>=MIN_ROW_INDEX&&row<MAX_ROW_INDEX){resizedRow=row+1}else if(row<MIN_ROW_INDEX){resizedRow=MIN_ROW_INDEX}if(this._isNeedResizeTable(resizedCol,resizedRow)){resizedBound={row:resizedRow||this._tableBound.row,col:resizedCol||this._tableBound.col}}return resizedBound};PopupAddTable.prototype._isNeedResizeTable=function(col,row){return col&&col!==this._tableBound.col||row&&row!==this._tableBound.row};PopupAddTable.prototype._getBoundByOffset=function(x,y){var rowBound=parseInt(y/CELL_HEIGHT,10),colBound=parseInt(x/CELL_WIDTH,10);return{row:rowBound,col:colBound}};PopupAddTable.prototype._getOffsetByBound=function(col,row){var x=col*CELL_WIDTH+CELL_WIDTH,y=row*CELL_HEIGHT+CELL_HEIGHT;return{x:x,y:y}};PopupAddTable.prototype._setTableSizeByBound=function(col,row){var boundOffset=this._getOffsetByBound(col,row-HEADER_ROW_COUNT);this._setTableSize(boundOffset.x,boundOffset.y);this._tableBound.row=row;this._tableBound.col=col};PopupAddTable.prototype._getSelectionBoundByOffset=function(x,y){var bound=this._getBoundByOffset(x,y);if(bound.row<MIN_ROW_SELECTION_INDEX){bound.row=MIN_ROW_SELECTION_INDEX}else if(bound.row>this._tableBound.row){bound.row=this._tableBound.row}if(bound.col<MIN_COL_SELECTION_INDEX){bound.col=MIN_COL_SELECTION_INDEX}else if(bound.col>this._tableBound.col){bound.col=this._tableBound.col}return bound};PopupAddTable.prototype._setSelectionAreaByBound=function(col,row){var boundOffset=this._getOffsetByBound(col,row);this._setSelectionArea(boundOffset.x,boundOffset.y)};PopupAddTable.prototype._setSelectedBound=function(col,row){this._selectedBound.col=col;this._selectedBound.row=row};PopupAddTable.prototype._getSelectedTableSize=function(){return{row:this._selectedBound.row+1,col:this._selectedBound.col+1}};PopupAddTable.prototype._setDisplayText=function(col,row){this.$desc.html(col+1+" x "+(row+1))};PopupAddTable.prototype._setTableSize=function(x,y){x+=LAST_BORDER;y+=LAST_BORDER;this.$header.css({height:CELL_HEIGHT,width:x});this.$body.css({height:y,width:x});this.$el.css({width:x+30})};PopupAddTable.prototype._setSelectionArea=function(x,y){x+=LAST_BORDER;y+=LAST_BORDER;this.$selection.css({height:y,width:x})};PopupAddTable.CELL_WIDTH=CELL_WIDTH;PopupAddTable.CELL_HEIGHT=CELL_HEIGHT;PopupAddTable.MIN_ROW_SELECTION_INDEX=MIN_ROW_SELECTION_INDEX;PopupAddTable.MIN_COL_SELECTION_INDEX=MIN_COL_SELECTION_INDEX;module.exports=PopupAddTable},function(module,exports,__webpack_require__){"use strict";var _layerpopup=__webpack_require__(47);var _layerpopup2=_interopRequireDefault(_layerpopup);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;function PopupAddHeading(options){var POPUP_CONTENT=["<ul>",'<li data-value="1" data-type="Heading"><h1>'+_i18n2.default.get("Heading")+" 1</h1></li>",'<li data-value="2" data-type="Heading"><h2>'+_i18n2.default.get("Heading")+" 2</h2></li>",'<li data-value="3" data-type="Heading"><h3>'+_i18n2.default.get("Heading")+" 3</h3></li>",'<li data-value="4" data-type="Heading"><h4>'+_i18n2.default.get("Heading")+" 4</h4></li>",'<li data-value="5" data-type="Heading"><h5>'+_i18n2.default.get("Heading")+" 5</h5></li>",'<li data-value="6" data-type="Heading"><h6>'+_i18n2.default.get("Heading")+" 6</h6></li>",'<li data-type="Paragraph"><div>'+_i18n2.default.get("Paragraph")+"</div></li>","</ul>"].join("");options=util.extend({title:false,className:"te-heading-add",content:POPUP_CONTENT},options);_layerpopup2.default.call(this,options);this.eventManager=options.eventManager;this.$button=options.$button;this.render();this._linkWithEventManager();this._bindEvent()}PopupAddHeading.prototype=util.extend({},_layerpopup2.default.prototype);PopupAddHeading.prototype._linkWithEventManager=function(){var self=this;this.eventManager.listen("focus",function(){self.hide()});this.eventManager.listen("openHeadingSelect",function(){self.eventManager.emit("closeAllPopup");self.$el.css({top:self.$button.position().top+self.$button.height()+5,left:self.$button.position().left});self.show()});this.eventManager.listen("closeAllPopup",function(){self.hide()})};PopupAddHeading.prototype._bindEvent=function(){var self=this;this.on("click li",function(){self.eventManager.emit("command",$(this).data("type"),$(this).data("value"))})};module.exports=PopupAddHeading},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var boldRegex=/^[\*_]{2,}[^\*_]*[\*_]{2,}$/;var Bold=_commandManager2.default.command("markdown",{name:"Bold",keyMap:["CTRL+B","META+B"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var cursor=doc.getCursor();var selection=doc.getSelection();var isEmpty=!selection;if(isEmpty&&cursor.ch>1){var tmpSelection=this.expendSelection(doc,cursor);selection=tmpSelection||selection}var isRemoved=this.isNeedRemove(selection);var result=isRemoved?this.remove(selection):this.append(selection);doc.replaceSelection(result,"around");if(isEmpty&&!isRemoved){this.setCursorToCenter(doc,cursor)}cm.focus()},isNeedRemove:function isNeedRemove(text){return boldRegex.test(text)},append:function append(text){return"**"+text+"**"},remove:function remove(text){return text.substr(2,text.length-4)},expendSelection:function expendSelection(doc,cursor){var tmpSelection=doc.getSelection();var result=void 0;var start={line:cursor.line,ch:cursor.ch-2};var end={line:cursor.line,ch:cursor.ch+2};doc.setSelection(start,end);if(tmpSelection==="****"||tmpSelection==="____"){result=tmpSelection}else{doc.setSelection(cursor)}return result},setCursorToCenter:function setCursorToCenter(doc,cursor){doc.setCursor(cursor.line,cursor.ch+2)}});module.exports=Bold},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var boldItalicRegex=/^[\*_]{3,}[^\*_]*[\*_]{3,}$/;var italicRegex=/^[\*_][^\*_]*[\*_]$/;var Italic=_commandManager2.default.command("markdown",{name:"Italic",keyMap:["CTRL+I","META+I"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var cursor=doc.getCursor();var selection=doc.getSelection();var isEmpty=!selection;var isWithBold=false;var tmpSelection=void 0;if(isEmpty){if(cursor.ch>2){tmpSelection=this.expendWithBoldSelection(doc,cursor);if(tmpSelection){isWithBold="with"}}if(isWithBold!=="with"&&cursor.ch>1){isWithBold=this.expendOnlyBoldSelection(doc,cursor)}if(!isWithBold&&cursor.ch>0){this.expendSelection(doc,cursor);selection=tmpSelection||selection}}var isRemoved=this.isNeedRemove(selection);var result=isRemoved?this.remove(selection):this.append(selection);doc.replaceSelection(result,"around");if(isEmpty){this.setCursorToCenter(doc,cursor,isRemoved)}cm.focus()},isNeedRemove:function isNeedRemove(text){return italicRegex.test(text)||boldItalicRegex.test(text)},append:function append(text){return"_"+text+"_"},remove:function remove(text){return text.substr(1,text.length-2)},expendWithBoldSelection:function expendWithBoldSelection(doc,cursor){var tmpSelection=doc.getSelection();var result=void 0;var start={line:cursor.line,ch:cursor.ch-3};var end={line:cursor.line,ch:cursor.ch+3};doc.setSelection(start,end);if(tmpSelection==="******"||tmpSelection==="______"){result=tmpSelection}else{doc.setSelection(cursor)}return result},expendOnlyBoldSelection:function expendOnlyBoldSelection(doc,cursor){var tmpSelection=doc.getSelection();var result=false;var start={line:cursor.line,ch:cursor.ch-2};var end={line:cursor.line,ch:cursor.ch+2};doc.setSelection(start,end);if(tmpSelection==="****"||tmpSelection==="____"){doc.setSelection(cursor);result="only"}return result},expendSelection:function expendSelection(doc,cursor){var tmpSelection=doc.getSelection();var result=void 0;var start={line:cursor.line,ch:cursor.ch-2};var end={line:cursor.line,ch:cursor.ch+2};doc.setSelection(start,end);if(tmpSelection==="****"||tmpSelection==="____"){result=tmpSelection}else{doc.setSelection(cursor)}return result},setCursorToCenter:function setCursorToCenter(doc,cursor,isRemoved){var pos=isRemoved?-1:1;doc.setCursor(cursor.line,cursor.ch+pos)}});module.exports=Italic},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var strikeRegex=/^[~~](.*[\s\n]*.*)*[~~]$/;var Strike=_commandManager2.default.command("markdown",{name:"Strike",keyMap:["CTRL+S","META+S"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var cursor=doc.getCursor();var selection=doc.getSelection();var isNeedToRemove=this.hasStrikeSyntax(selection);var result=void 0;if(isNeedToRemove){result=this.remove(selection)}else{result=this.append(selection)}doc.replaceSelection(result,"around");var isEmptySelection=!selection;if(isEmptySelection&&!isNeedToRemove){this.setCursorToCenter(doc,cursor,isNeedToRemove)}cm.focus()},hasStrikeSyntax:function hasStrikeSyntax(text){return strikeRegex.test(text)},append:function append(text){return"~~"+text+"~~"},remove:function remove(text){return text.substr(2,text.length-4)},setCursorToCenter:function setCursorToCenter(doc,cursor,isRemoved){var pos=isRemoved?-2:2;doc.setCursor(cursor.line,cursor.ch+pos)}});module.exports=Strike},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Blockquote=_commandManager2.default.command("markdown",{name:"Blockquote",keyMap:["CTRL+Q","META+Q"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var from={line:range.from.line,ch:0};var to={line:range.to.line,ch:doc.getLineHandle(range.to.line).text.length};var textToModify=doc.getRange(from,to);var textLinesToModify=textToModify.split("\n");var lineLength=textLinesToModify.length;for(var i=0;i<lineLength;i+=1){textLinesToModify[i]=">"+textLinesToModify[i]}doc.replaceRange(textLinesToModify.join("\n"),from,to);range.to.ch+=1;doc.setCursor(range.to);cm.focus()}});module.exports=Blockquote},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var FIND_HEADING_RX=/^#+\s/g;var Heading=_commandManager2.default.command("markdown",{name:"Heading",exec:function exec(mde,size){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var from={line:range.from.line,ch:0};var to={line:range.to.line,ch:doc.getLineHandle(range.to.line).text.length};var lengthOfCurrentLineBefore=doc.getLine(to.line).length;var textToModify=doc.getRange(from,to);var textLinesToModify=textToModify.split("\n");util.forEachArray(textLinesToModify,function(line,index){textLinesToModify[index]=getHeadingMarkdown(line,size)});doc.replaceRange(textLinesToModify.join("\n"),from,to);range.to.ch+=doc.getLine(to.line).length-lengthOfCurrentLineBefore;doc.setSelection(from,range.to);cm.focus()}});function getHeadingMarkdown(text,size){var foundedHeading=text.match(FIND_HEADING_RX);var heading="";do{heading+="#";size-=1}while(size>0);if(foundedHeading){text=text.split(foundedHeading[0])[1]}return heading+" "+text}module.exports=Heading},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var Paragraph=_commandManager2.default.command("markdown",{name:"Paragraph",exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var from={line:range.from.line,ch:0};var to={line:range.to.line,ch:doc.getLineHandle(range.to.line).text.length};var lengthOfCurrentLineBefore=doc.getLine(to.line).length;var textToModify=doc.getRange(from,to);var textLines=textToModify.split("\n");util.forEachArray(textLines,function(line,index){textLines[index]=getParagraphMarkdown(line)});doc.replaceRange(textLines.join("\n"),from,to);range.to.ch+=doc.getLine(to.line).length-lengthOfCurrentLineBefore;doc.setSelection(from,to);cm.focus()}});function getParagraphMarkdown(lineText){var headingRx=/^(#{1,6}| *((?:\*|-|\d\.)(?: \[[ xX]])?)) /;return lineText.replace(headingRx,"")}module.exports=Paragraph},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HR=_commandManager2.default.command("markdown",{name:"HR",keyMap:["CTRL+L","META+L"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var replaceText="";var range=mde.getCurrentRange();var from={
line:range.from.line,ch:range.from.ch};var to={line:range.to.line,ch:range.to.ch};if(range.collapsed){replaceText=doc.getLine(from.line);from.ch=0;to.ch=doc.getLineHandle(range.to.line).text.length}if(doc.getLine(from.line).length){replaceText+="\n\n* * *\n\n"}else{replaceText+="\n* * *\n"}doc.replaceRange(replaceText,from,to);cm.focus()}});module.exports=HR},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AddLink=_commandManager2.default.command("markdown",{name:"AddLink",exec:function exec(mde,data){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var from={line:range.from.line,ch:range.from.ch};var to={line:range.to.line,ch:range.to.ch};var replaceText="["+data.linkText+"]("+data.url+")";doc.replaceRange(replaceText,from,to);cm.focus()}});module.exports=AddLink},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AddImage=_commandManager2.default.command("markdown",{name:"AddImage",exec:function exec(mde,data){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var from={line:range.from.line,ch:range.from.ch};var to={line:range.to.line,ch:range.to.ch};var replaceText="!["+data.altText+"]("+data.imageUrl+")";doc.replaceRange(replaceText,from,to,"+addImage");cm.focus()}});module.exports=AddImage},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FIND_MD_OL_RX=/^[ \t]*[\d]+\. .*/;var FIND_MD_UL_RX=/^[ \t]*[-*] .*/;var FIND_MD_TASK_RX=/^[ \t]*[-*]( \[[ xX]])? .*/;var UL=_commandManager2.default.command("markdown",{name:"UL",keyMap:["CTRL+U","META+U"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var listManager=mde.componentManager.getManager("list");var lineRange=listManager.expandLineRangeIfNeed(doc,range,isOlOrTask);var startLineNumber=lineRange.start;var endLineNumber=lineRange.end;var line=void 0,currentLineStart=void 0;for(var i=startLineNumber;i<=endLineNumber;i+=1){currentLineStart={line:i,ch:0};line=doc.getLine(i);if(listManager.isListOrParagraph(line)){if(isOlOrTask(line)){listManager.replaceLineText(doc,i,/[\d]+\. /,"* ")}else if(!line.match(FIND_MD_UL_RX)){doc.replaceRange("* ",currentLineStart)}if(i===endLineNumber){listManager.appendBlankLineIfNeed(cm,i,endLineNumber,startLineNumber)}}else{break}}cm.focus()}});function isOlOrTask(line){return!!(line&&(line.match(FIND_MD_TASK_RX)||line.match(FIND_MD_OL_RX)))}module.exports=UL},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FIND_MD_OL_RX=/^[ \t]*[\d]+\. .*/;var FIND_MD_UL_RX=/^[ \t]*[-*] .*/;var FIND_MD_TASK_RX=/^[ \t]*[-*]( \[[ xX]])? .*/;var OL=_commandManager2.default.command("markdown",{name:"OL",keyMap:["CTRL+O","META+O"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var listManager=mde.componentManager.getManager("list");var lineRange=listManager.expandLineRangeIfNeed(doc,range,isUlOrTask);var startLineNumber=lineRange.start;var endLineNumber=lineRange.end;var ordinalNumber=1;var line=void 0,currentLineStart=void 0;for(var i=startLineNumber;i<=endLineNumber;i+=1){currentLineStart={line:i,ch:0};line=doc.getLine(i);if(listManager.isListOrParagraph(line)){if(isUlOrTask(line)){listManager.replaceLineText(doc,i,/[*-] /,ordinalNumber+". ")}else if(!line.match(FIND_MD_OL_RX)){doc.replaceRange(ordinalNumber+". ",currentLineStart)}ordinalNumber+=1;if(i===endLineNumber){listManager.appendBlankLineIfNeed(cm,i,endLineNumber,startLineNumber)}}else{break}}cm.focus()}});function isUlOrTask(line){return!!(line&&(line.match(FIND_MD_TASK_RX)||line.match(FIND_MD_UL_RX)))}module.exports=OL},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Table=_commandManager2.default.command("markdown",{name:"Table",exec:function exec(mde,col,row,data){var cm=mde.getEditor();var doc=cm.getDoc();var table="\n";if(cm.getCursor().ch>0){table+="\n"}table+=makeHeader(col,data);table+=makeBody(col,row-1,data);doc.replaceSelection(table);if(!data){cm.setCursor(cm.getCursor().line-row,2)}mde.focus()}});function makeHeader(col,data){var header="|";var border="|";var index=0;while(col){if(data){header+=" "+data[index]+" |";index+=1}else{header+="  |"}border+=" --- |";col-=1}return header+"\n"+border+"\n"}function makeBody(col,row,data){var body="";var index=col;for(var irow=0;irow<row;irow+=1){body+="|";for(var icol=0;icol<col;icol+=1){if(data){body+=" "+data[index]+" |";index+=1}else{body+="  |"}}body+="\n"}body=body.replace(/\n$/g,"");return body}module.exports=Table},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FIND_MD_OL_RX=/^[ \t]*[\d]+\. .*/;var FIND_MD_UL_RX=/^[ \t]*[-*] .*/;var FIND_MD_TASK_RX=/^[ \t]*[-*]( \[[ xX]])? .*/;var FIND_TASK_SYNTAX_RX=/([*-] |[\d]+\. )(\[[ xX]] )/;var Task=_commandManager2.default.command("markdown",{name:"Task",keyMap:["CTRL+T","META+T"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var listManager=mde.componentManager.getManager("list");var lineRange=listManager.createSortedLineRange(range);var startLineNumber=lineRange.start;var endLineNumber=lineRange.end;var line=void 0,currentLineStart=void 0;for(var i=startLineNumber;i<=endLineNumber;i+=1){currentLineStart={line:i,ch:0};line=doc.getLine(i);var hasTaskSyntax=!!line.match(FIND_TASK_SYNTAX_RX);if(listManager.isListOrParagraph(line)){if(isOlOrUl(line)&&hasTaskSyntax){listManager.replaceLineText(doc,i,FIND_TASK_SYNTAX_RX,"$1")}else if(isOlOrUl(line)&&!hasTaskSyntax){listManager.replaceLineText(doc,i,/([*-] |[\d]+\. )/,"$1[ ] ")}else if(!line.match(FIND_MD_TASK_RX)){doc.replaceRange("* [ ] ",currentLineStart)}if(i===endLineNumber){listManager.appendBlankLineIfNeed(cm,i,endLineNumber,startLineNumber)}}else{break}}cm.focus()}});function isOlOrUl(line){return!!(line&&(line.match(FIND_MD_UL_RX)||line.match(FIND_MD_OL_RX)))}module.exports=Task},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Code=_commandManager2.default.command("markdown",{name:"Code",keyMap:["SHIFT+CTRL+C","SHIFT+META+C"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var selection=doc.getSelection();var range=cm.getCursor();doc.replaceSelection(this.append(selection),"around");if(!selection){doc.setCursor(range.line,range.ch+1)}cm.focus()},append:function append(text){return"`"+text+"`"}});module.exports=Code},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CodeBlock=_commandManager2.default.command("markdown",{name:"CodeBlock",keyMap:["SHIFT+CTRL+P","SHIFT+META+P"],exec:function exec(mde){var cm=mde.getEditor();var doc=cm.getDoc();var range=mde.getCurrentRange();var replaceText=["```",doc.getSelection(),"```"];var cursorOffset=1;if(range.from.ch!==0){replaceText.unshift("");cursorOffset+=1}if(range.to.ch!==doc.getLine(range.to.line).length){replaceText.push("")}doc.replaceSelection(replaceText.join("\n"));cm.setCursor(range.from.line+cursorOffset,0);cm.focus()}});module.exports=CodeBlock},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Bold=_commandManager2.default.command("wysiwyg",{name:"Bold",keyMap:["CTRL+B","META+B"],exec:function exec(wwe){var sq=wwe.getEditor();var tableSelectionManager=wwe.componentManager.getManager("tableSelection");sq.focus();if(sq.hasFormat("table")&&tableSelectionManager.getSelectedCells().length){tableSelectionManager.styleToSelectedCells(styleBold)}else{styleBold(sq)}var range=sq.getSelection();if(sq.hasFormat("table")&&!_domUtils2.default.isTextNode(range.commonAncestorContainer)){range.collapse(true);sq.setSelection(range)}}});function styleBold(sq){if(sq.hasFormat("b")||sq.hasFormat("strong")){sq.changeFormat(null,{tag:"b"})}else if(!sq.hasFormat("a")&&!sq.hasFormat("PRE")){if(sq.hasFormat("code")){sq.changeFormat(null,{tag:"code"})}sq.bold()}}module.exports=Bold},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Italic=_commandManager2.default.command("wysiwyg",{name:"Italic",keyMap:["CTRL+I","META+I"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var tableSelectionManager=wwe.componentManager.getManager("tableSelection");sq.focus();if(sq.hasFormat("table")&&tableSelectionManager.getSelectedCells().length){tableSelectionManager.styleToSelectedCells(styleItalic)}else{styleItalic(sq)}if(sq.hasFormat("table")&&!_domUtils2.default.isTextNode(range.commonAncestorContainer)){range.collapse(true);sq.setSelection(range)}}});function styleItalic(sq){if(sq.hasFormat("i")||sq.hasFormat("em")){sq.changeFormat(null,{tag:"i"})}else if(!sq.hasFormat("a")&&!sq.hasFormat("PRE")){if(sq.hasFormat("code")){sq.changeFormat(null,{tag:"code"})}sq.italic()}}module.exports=Italic},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Strike=_commandManager2.default.command("wysiwyg",{name:"Strike",keyMap:["CTRL+S","META+S"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var tableSelectionManager=wwe.componentManager.getManager("tableSelection");sq.focus();if(sq.hasFormat("table")&&tableSelectionManager.getSelectedCells().length){tableSelectionManager.styleToSelectedCells(styleStrike)}else{styleStrike(sq)}if(sq.hasFormat("table")&&!_domUtils2.default.isTextNode(range.commonAncestorContainer)){range.collapse(true);sq.setSelection(range)}}});function styleStrike(sq){if(sq.hasFormat("S")){sq.changeFormat(null,{tag:"S"})}else if(!sq.hasFormat("a")&&!sq.hasFormat("PRE")){if(sq.hasFormat("code")){sq.changeFormat(null,{tag:"code"})}sq.strikethrough()}}module.exports=Strike},function(module,exports,__webpack_require__){"use strict";var CommandManager=__webpack_require__(28);var Blockquote=CommandManager.command("wysiwyg",{name:"Blockquote",keyMap:["CTRL+Q","META+Q"],exec:function exec(wwe){var sq=wwe.getEditor();sq.focus();if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){wwe.unwrapBlockTag();sq.increaseQuoteLevel()}}});module.exports=Blockquote},function(module,exports,__webpack_require__){"use strict";var CommandManager=__webpack_require__(28);var AddImage=CommandManager.command("wysiwyg",{name:"AddImage",exec:function exec(wwe,data){var sq=wwe.getEditor();sq.focus();if(!sq.hasFormat("PRE")){sq.insertImage(data.imageUrl,{alt:data.altText})}}});module.exports=AddImage},function(module,exports,__webpack_require__){"use strict";var CommandManager=__webpack_require__(28);var AddLink=CommandManager.command("wysiwyg",{name:"AddLink",exec:function exec(wwe,data){var sq=wwe.getEditor();sq.focus();if(!sq.hasFormat("PRE")){sq.removeAllFormatting();if(sq.getSelectedText()){sq.makeLink(data.url)}else{var link=sq.createElement("A",{href:data.url});$(link).text(data.linkText);sq.insertElement(link)}}}});module.exports=AddLink},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HR=_commandManager2.default.command("wysiwyg",{name:"HR",keyMap:["CTRL+L","META+L"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var currentNode=void 0,nextBlockNode=void 0,previousSibling=void 0;if(range.collapsed&&!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){currentNode=_domUtils2.default.getChildNodeByOffset(range.startContainer,range.startOffset);nextBlockNode=_domUtils2.default.getTopNextNodeUnder(currentNode,wwe.get$Body()[0]);if(!nextBlockNode){nextBlockNode=sq.createDefaultBlock();wwe.get$Body().append(nextBlockNode)}var hr=sq.createElement("HR");sq.modifyBlocks(function(frag){frag.appendChild(hr);return frag});previousSibling=hr.previousSibling;if(previousSibling&&_domUtils2.default.isTextNode(previousSibling)&&_domUtils2.default.getTextLength(previousSibling)===0){hr.parentNode.removeChild(previousSibling)}range.selectNodeContents(nextBlockNode);range.collapse(true);sq.setSelection(range)}sq.focus()}});module.exports=HR},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Heading=_commandManager2.default.command("wysiwyg",{name:"Heading",exec:function exec(wwe,size){var sq=wwe.getEditor();var blockTagName="h1, h2, h3, h4, h5, h6, div";sq.focus();if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){sq.modifyBlocks(function(fragment){$(fragment).children(blockTagName).each(function(index,block){var headingHTML="<H"+size+" />";var $block=$(block);if($block.is("DIV")){$block.wrap(headingHTML)}else{var $wrapperHeading=$(headingHTML);$wrapperHeading.insertBefore(block);$wrapperHeading.html($block.html());$block.remove()}});return fragment})}}});module.exports=Heading},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Paragraph=_commandManager2.default.command("wysiwyg",{name:"Paragraph",exec:function exec(wwe){var sq=wwe.getEditor();sq.focus();if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){sq.modifyBlocks(function(fragment){var $newFragment=$(document.createDocumentFragment());$(fragment).children().each(function(index,block){if(block.nodeName.match(/h\d/i)){$newFragment.append($(block).children())}else if(block.nodeName.match(/ul|ol/i)){$(block).find("li").each(function(i,listItem){$newFragment.append($(listItem).children())})}else{$newFragment.append(block)}});return $newFragment[0]})}}});module.exports=Paragraph},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var UL=_commandManager2.default.command("wysiwyg",{name:"UL",keyMap:["CTRL+U","META+U"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var listManager=wwe.componentManager.getManager("list");var start=range.startContainer;var startOffset=range.startOffset;var end=range.endContainer;var endOffset=range.endOffset;sq.focus();sq.saveUndoState(range);var lines=listManager.getLinesOfSelection(start,end);for(var i=0;i<lines.length;i+=1){this._changeFormatToUnorderedListIfNeed(wwe,lines[i])}range=sq.getSelection();range.setStart(start,startOffset);range.setEnd(end,endOffset);sq.setSelection(range);sq.saveUndoState(range)},_changeFormatToUnorderedListIfNeed:function _changeFormatToUnorderedListIfNeed(wwe,target){var sq=wwe.getEditor();var range=sq.getSelection();if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){range.setStart(target,0);range.collapse(true);sq.setSelection(range);if(sq.hasFormat("LI")){wwe.saveSelection(range);sq.replaceParent(range.startContainer,"ol","ul");wwe.restoreSavedSelection()}else{wwe.unwrapBlockTag();sq.makeUnorderedList()}}}});module.exports=UL},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var OL=_commandManager2.default.command("wysiwyg",{name:"OL",keyMap:["CTRL+O","META+O"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var listManager=wwe.componentManager.getManager("list");var start=range.startContainer;var startOffset=range.startOffset;var end=range.endContainer;var endOffset=range.endOffset;sq.focus();sq.saveUndoState(range);var lines=listManager.getLinesOfSelection(start,end);for(var i=0;i<lines.length;i+=1){this._changeFormatToOrderedListIfNeed(wwe,lines[i])}range=sq.getSelection();range.setStart(start,startOffset);range.setEnd(end,endOffset);sq.setSelection(range);sq.saveUndoState(range)},_changeFormatToOrderedListIfNeed:function _changeFormatToOrderedListIfNeed(wwe,target){var sq=wwe.getEditor();var range=sq.getSelection();if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){range.setStart(target,0);range.collapse(true);sq.setSelection(range);if(sq.hasFormat("LI")){wwe.saveSelection(range);sq.replaceParent(range.startContainer,"ul","ol");wwe.restoreSavedSelection()}else{wwe.unwrapBlockTag();sq.makeOrderedList()}}}});module.exports=OL},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Table=_commandManager2.default.command("wysiwyg",{name:"Table",exec:function exec(wwe,col,row,data){var sq=wwe.getEditor();var tableIDClassName=wwe.componentManager.getManager("table").getTableIDClassName();var tableHTMLString=void 0;if(!sq.getSelection().collapsed||sq.hasFormat("TABLE")||sq.hasFormat("PRE")){sq.focus();return}tableHTMLString='<table class="'+tableIDClassName+'">';tableHTMLString+=makeHeader(col,data);tableHTMLString+=makeBody(col,row-1,data);tableHTMLString+="</table>";sq.insertHTML(tableHTMLString);sq.focus();if(!data){focusToFirstTh(sq,wwe.get$Body().find("."+tableIDClassName))}}});function focusToFirstTh(sq,$table){var range=sq.getSelection();range.selectNodeContents($table.find("th")[0]);range.collapse(true);sq.setSelection(range)}function makeHeader(col,data){var header="<thead><tr>";var index=0;while(col){header+="<th>";if(data){header+=data[index];index+=1}header+="</th>";col-=1}header+="</tr></thead>";return header}function makeBody(col,row,data){var body="<tbody>";var index=col;for(var irow=0;irow<row;irow+=1){body+="<tr>";for(var icol=0;icol<col;icol+=1){body+="<td>";if(data){body+=data[index];index+=1}body+="</td>"}body+="</tr>"}body+="</tbody>";return body}module.exports=Table},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AddRow=_commandManager2.default.command("wysiwyg",{name:"AddRow",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();var $tr=void 0,$newRow=void 0;sq.focus();if(sq.hasFormat("TD")){sq.saveUndoState(range);$tr=$(range.startContainer).closest("tr");$newRow=getNewRow($tr);$newRow.insertAfter($tr);focusToFirstTd(sq,$newRow)}else if(sq.hasFormat("TH")){sq.saveUndoState(range);$tr=$(range.startContainer).parents("thead").next("tbody").children("tr").eq(0);$newRow=getNewRow($tr);$newRow.insertBefore($tr);focusToFirstTd(sq,$newRow)}}});function getNewRow($tr){var cloned=$tr.clone();var htmlString=tui.util.browser.msie?"":"<br />";cloned.find("td").html(htmlString);return cloned}function focusToFirstTd(sq,$tr){var range=sq.getSelection();range.selectNodeContents($tr.find("td")[0]);range.collapse(true);sq.setSelection(range)}module.exports=AddRow},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AddCol=_commandManager2.default.command("wysiwyg",{name:"AddCol",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();var $cell=void 0;sq.focus();if(sq.hasFormat("TR")){sq.saveUndoState(range);$cell=getCellByRange(range);addColToCellAfter($cell);focusToNextCell(sq,$cell)}}});function getCellByRange(range){var cell=range.startContainer;if(_domUtils2.default.getNodeName(cell)==="TD"||_domUtils2.default.getNodeName(cell)==="TH"){cell=$(cell)}else{cell=$(cell).parentsUntil("tr")}return cell}function addColToCellAfter($cell){var index=$cell.index();var cellToAdd=void 0;$cell.parents("table").find("tr").each(function(n,tr){if(_domUtils2.default.getNodeName(tr.parentNode)==="TBODY"){cellToAdd=$("<td></td>")}else{cellToAdd=$("<th></th>")}if(!tui.util.browser.msie){cellToAdd.append($("<br />")[0])}$(cellToAdd).insertAfter($(tr).children().eq(index))})}function focusToNextCell(sq,$cell){var range=sq.getSelection();range.selectNodeContents($cell.next()[0]);range.collapse(true);sq.setSelection(range)}module.exports=AddCol},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RemoveRow=_commandManager2.default.command("wysiwyg",{name:"RemoveRow",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();var $table=$(range.startContainer).parents("table");var selectionMgr=wwe.componentManager.getManager("tableSelection");var tableMgr=wwe.componentManager.getManager("table");var $tr=getTrs(range,selectionMgr,$table);var tbodyRowLength=$table.find("tbody tr").length;sq.focus();if((sq.hasFormat("TD")||sq.hasFormat("TABLE"))&&tbodyRowLength>1){sq.saveUndoState(range);var $nextFocus=$tr.last().next()[0]?$tr.last().next():$tr.first().prev();if($nextFocus.length){focusToFirstTd(sq,range,$nextFocus,tableMgr)}$tr.remove()}selectionMgr.removeClassAttrbuteFromAllCellsIfNeed()}});function focusToFirstTd(sq,range,$tr,tableMgr){var nextFocusCell=$tr.find("td")[0];range.setStart(nextFocusCell,0);range.collapse(true);tableMgr.setLastCellNode(nextFocusCell);sq.setSelection(range)}function getSelectedRows(firstSelectedCell,rangeInformation,$table){var tbodyRowLength=$table.find("tbody tr").length;var isStartContainerInThead=$(firstSelectedCell).parents("thead").length;var startRowIndex=rangeInformation.from.row;var endRowIndex=rangeInformation.to.row;if(isStartContainerInThead){startRowIndex+=1}var isWholeTbodySelected=(startRowIndex===1||isStartContainerInThead)&&endRowIndex===tbodyRowLength;if(isWholeTbodySelected){endRowIndex-=1}return $table.find("tr").slice(startRowIndex,endRowIndex+1)}function getTrs(range,selectionMgr,$table){var selectedCells=selectionMgr.getSelectedCells();var rangeInformation=void 0,trs=void 0;if(selectedCells.length){rangeInformation=selectionMgr.getSelectionRangeFromTable(selectedCells.first()[0],selectedCells.last()[0]);trs=getSelectedRows(selectedCells.first()[0],rangeInformation,$table)}else{var cell=$(range.startContainer).closest("td,th")[0];rangeInformation=selectionMgr.getSelectionRangeFromTable(cell,cell);trs=getSelectedRows(cell,rangeInformation,$table)}return trs}module.exports=RemoveRow},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RemoveCol=_commandManager2.default.command("wysiwyg",{name:"RemoveCol",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();var tableMgr=wwe.componentManager.getManager("table");var isAbleToRemoveColumn=$(range.startContainer).closest("table").find("thead tr th").length>1;sq.focus();range.collapse(true);sq.setSelection(range);if(sq.hasFormat("TR",null,range)&&isAbleToRemoveColumn){sq.saveUndoState(range);var $cell=getCellByRange(range);var $nextFocus=$cell.next().length?$cell.next():$cell.prev();removeColByCell($cell);focusToCell(sq,$nextFocus,tableMgr)}}});function getCellByRange(range){var cell=range.startContainer;if(_domUtils2.default.getNodeName(cell)==="TD"||_domUtils2.default.getNodeName(cell)==="TH"){cell=$(cell)}else{cell=$(cell).parentsUntil("tr")}return cell}function removeColByCell($cell){var index=$cell.index();$cell.parents("table").find("tr").each(function(n,tr){$(tr).children().eq(index).remove()})}function focusToCell(sq,$cell,tableMgr){var nextFocusCell=$cell[0];if($cell.length){var range=sq.getSelection();range.selectNodeContents($cell[0]);range.collapse(true);sq.setSelection(range);tableMgr.setLastCellNode(nextFocusCell)}}module.exports=RemoveCol},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AlignCol=_commandManager2.default.command("wysiwyg",{name:"AlignCol",exec:function exec(wwe,alignDirection){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();var selectionMgr=wwe.componentManager.getManager("tableSelection");var rangeInformation=getRangeInformation(range,selectionMgr);sq.focus();if(sq.hasFormat("TR")){sq.saveUndoState(range);var $table=$(range.startContainer).parents("table");var selectionInformation=getSelectionInformation($table,rangeInformation);setAlignAttributeToTableCells($table,alignDirection,selectionInformation)}selectionMgr.removeClassAttrbuteFromAllCellsIfNeed()}});function setAlignAttributeToTableCells($table,alignDirection,selectionInformation){var isDivided=selectionInformation.isDivided||false;var start=selectionInformation.startColumnIndex;var end=selectionInformation.endColumnIndex;var columnLength=$table.find("tr").eq(0).find("td,th").length;$table.find("tr").each(function(n,tr){$(tr).children("td,th").each(function(index,cell){if(isDivided&&(start<=index&&index<=columnLength||index<=end)){$(cell).attr("align",alignDirection)}else if(start<=index&&index<=end){$(cell).attr("align",alignDirection)}})})}function getSelectionInformation($table,rangeInformation){var columnLength=$table.find("tr").eq(0).find("td,th").length;var from=rangeInformation.from;var to=rangeInformation.to;var startColumnIndex=void 0,endColumnIndex=void 0,isDivided=void 0;if(from.row===to.row){startColumnIndex=from.cell;endColumnIndex=to.cell}else if(from.row<to.row){if(from.cell<=to.cell){startColumnIndex=0;endColumnIndex=columnLength-1}else{startColumnIndex=from.cell;endColumnIndex=to.cell;isDivided=true}}return{startColumnIndex:startColumnIndex,endColumnIndex:endColumnIndex,isDivided:isDivided}}function getRangeInformation(range,selectionMgr){var selectedCells=selectionMgr.getSelectedCells();var rangeInformation=void 0,startCell=void 0;if(selectedCells.length){rangeInformation=selectionMgr.getSelectionRangeFromTable(selectedCells.first()[0],selectedCells.last()[0])}else{var startContainer=range.startContainer;startCell=_domUtils2.default.isTextNode(startContainer)?$(startContainer).parent("td,th")[0]:startContainer;rangeInformation=selectionMgr.getSelectionRangeFromTable(startCell,startCell)}return rangeInformation}module.exports=AlignCol},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RemoveTable=_commandManager2.default.command("wysiwyg",{name:"RemoveTable",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();if(sq.hasFormat("TABLE")){sq.saveUndoState(range);var $table=$(range.startContainer).closest("table");$table.remove()}sq.focus()}});module.exports=RemoveTable},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var IncreaseTask=_commandManager2.default.command("wysiwyg",{name:"IncreaseDepth",exec:function exec(wwe){var range=wwe.getEditor().getSelection();var $node=$(range.startContainer).closest("li");var prevClasses=void 0,nodeClasses=void 0,nextClasses=void 0;var $prev=$node.prev();if($prev.length&&$node.length){var $next=$node.find("li").eq(0);wwe.getEditor().saveUndoState();nodeClasses=$node.attr("class");prevClasses=$prev.attr("class");nextClasses=$next.attr("class");$node.removeAttr("class");$prev.removeAttr("class");if($next.length&&!$next.children("div").length){$next.removeAttr("class")}wwe.getEditor().increaseListLevel();$node.attr("class",nodeClasses);$prev.attr("class",prevClasses);$next.attr("class",nextClasses)}}});module.exports=IncreaseTask},function(module,exports,__webpack_require__){"use strict";var CommandManager=__webpack_require__(28);var DecreaseDepth=CommandManager.command("wysiwyg",{name:"DecreaseDepth",exec:function exec(wwe){var $node=getCurrent$Li(wwe);if($node.length){wwe.getEditor().saveUndoState();var nodeClasses=$node.attr("class");wwe.getEditor().decreaseListLevel();$node=getCurrent$Li(wwe);$node.attr("class",nodeClasses)}}});function getCurrent$Li(wwe){var range=wwe.getEditor().getSelection();return $(range.startContainer).closest("li")}module.exports=DecreaseDepth},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Task=_commandManager2.default.command("wysiwyg",{name:"Task",keyMap:["CTRL+T","META+T"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var taskManager=wwe.componentManager.getManager("task");var start=range.startContainer;var startOffset=range.startOffset;var end=range.endContainer;var endOffset=range.endOffset;sq.focus();sq.saveUndoState(range);var lines=taskManager.getLinesOfSelection(start,end);for(var i=0;i<lines.length;i+=1){this._changeFormatToTaskIfNeed(wwe,lines[i])}
range=sq.getSelection();range.setStart(start,startOffset);range.setEnd(end,endOffset);sq.setSelection(range);sq.saveUndoState(range)},_changeFormatToTaskIfNeed:function _changeFormatToTaskIfNeed(wwe,target){var sq=wwe.getEditor();var range=sq.getSelection();var taskManager=wwe.componentManager.getManager("task");if(!sq.hasFormat("TABLE")&&!sq.hasFormat("PRE")){range.setStart(target,0);range.collapse(true);sq.setSelection(range);if(!sq.hasFormat("li")){wwe.unwrapBlockTag();sq.makeUnorderedList()}if($(target).parents("li").first().hasClass("task-list-item")){taskManager.unformatTask(target)}else{taskManager.formatTask(target)}}}});module.exports=Task},function(module,exports,__webpack_require__){"use strict";var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _domUtils=__webpack_require__(11);var _domUtils2=_interopRequireDefault(_domUtils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Code=_commandManager2.default.command("wysiwyg",{name:"Code",keyMap:["SHIFT+CTRL+C","SHIFT+META+C"],exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection();var tableSelectionManager=wwe.componentManager.getManager("tableSelection");var _styleCode=tui.util.bind(styleCode,null,wwe.getEditor());sq.focus();if(sq.hasFormat("table")&&tableSelectionManager.getSelectedCells().length){tableSelectionManager.styleToSelectedCells(_styleCode)}else{_styleCode(sq)}if(sq.hasFormat("table")&&!_domUtils2.default.isTextNode(range.commonAncestorContainer)){range.collapse(true);sq.setSelection(range)}}});function removeUnnecessaryCodeInNextToRange(range){if(_domUtils2.default.getNodeName(range.startContainer.nextSibling)==="CODE"&&_domUtils2.default.getTextLength(range.startContainer.nextSibling)===0){$(range.startContainer.nextSibling).remove()}}function styleCode(editor,sq){if(!sq.hasFormat("PRE")&&sq.hasFormat("code")){sq.changeFormat(null,{tag:"code"});removeUnnecessaryCodeInNextToRange(editor.getSelection().cloneRange())}else if(!sq.hasFormat("a")&&!sq.hasFormat("PRE")){if(sq.hasFormat("b")){sq.removeBold()}else if(sq.hasFormat("i")){sq.removeItalic()}sq.changeFormat({tag:"code"});var range=sq.getSelection().cloneRange();range.setStart(range.endContainer,range.endOffset);range.collapse(true);sq.setSelection(range)}}module.exports=Code},function(module,exports,__webpack_require__){"use strict";var CommandManager=__webpack_require__(28);var CODEBLOCK_CLASS_PREFIX="te-content-codeblock-";var CODEBLOCK_ATTR_NAME="data-te-codeblock";var codeBlockID=0;var CodeBlock=CommandManager.command("wysiwyg",{name:"CodeBlock",keyMap:["SHIFT+CTRL+P","SHIFT+META+P"],exec:function exec(wwe,type){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();if(!sq.hasFormat("PRE")&&!sq.hasFormat("TABLE")){var attr=CODEBLOCK_ATTR_NAME+' class = "'+CODEBLOCK_CLASS_PREFIX+codeBlockID+'"';if(type){attr+=' data-language="'+type+'"'}var codeBlockBody=getCodeBlockBody(range,wwe);sq.insertHTML("<pre "+attr+">"+codeBlockBody+"</pre>");focusToFirstCode(wwe.get$Body().find("."+CODEBLOCK_CLASS_PREFIX+codeBlockID),wwe);codeBlockID+=1}sq.focus()}});function focusToFirstCode($pre,wwe){var range=wwe.getEditor().getSelection().cloneRange();range.setStartBefore($pre.find("div")[0].firstChild);range.collapse(true);wwe.getEditor().setSelection(range)}function getCodeBlockBody(range,wwe){var mgr=wwe.componentManager.getManager("codeblock");var contents=void 0,nodes=void 0;if(range.collapsed){nodes=[$("<div><br></div>")[0]]}else{contents=range.extractContents();nodes=tui.util.toArray(contents.childNodes)}var codeBlock=mgr.convertToCodeblock(nodes).innerHTML;return codeBlock}module.exports=CodeBlock},function(module,exports){"use strict";CodeMirror.overlayMode=function(base,overlay,combine){return{startState:function startState(){return{base:CodeMirror.startState(base),overlay:CodeMirror.startState(overlay),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function copyState(state){return{base:CodeMirror.copyState(base,state.base),overlay:CodeMirror.copyState(overlay,state.overlay),basePos:state.basePos,baseCur:null,overlayPos:state.overlayPos,overlayCur:null}},token:function token(stream,state){if(stream!=state.streamSeen||Math.min(state.basePos,state.overlayPos)<stream.start){state.streamSeen=stream;state.basePos=state.overlayPos=stream.start}if(stream.start==state.basePos){state.baseCur=base.token(stream,state.base);state.basePos=stream.pos}if(stream.start==state.overlayPos){stream.pos=stream.start;state.overlayCur=overlay.token(stream,state.overlay);state.overlayPos=stream.pos}stream.pos=Math.min(state.basePos,state.overlayPos);if(state.overlayCur==null)return state.baseCur;else if(state.baseCur!=null&&state.overlay.combineTokens||combine&&state.overlay.combineTokens==null)return state.baseCur+" "+state.overlayCur;else return state.overlayCur},indent:base.indent&&function(state,textAfter){return base.indent(state.base,textAfter)},electricChars:base.electricChars,innerMode:function innerMode(state){return{state:state.base,mode:base}},blankLine:function blankLine(state){if(base.blankLine)base.blankLine(state.base);if(overlay.blankLine)overlay.blankLine(state.overlay)}}}},function(module,exports){"use strict";CodeMirror.defineMode("markdown",function(cmCfg,modeCfg){var htmlFound=CodeMirror.modes.hasOwnProperty("xml");var htmlMode=CodeMirror.getMode(cmCfg,htmlFound?{name:"xml",htmlMode:true}:"text/plain");function getMode(name){if(CodeMirror.findModeByName){var found=CodeMirror.findModeByName(name);if(found)name=found.mime||found.mimes[0]}var mode=CodeMirror.getMode(cmCfg,name);return mode.name=="null"?null:mode}if(modeCfg.highlightFormatting===undefined)modeCfg.highlightFormatting=false;if(modeCfg.maxBlockquoteDepth===undefined)modeCfg.maxBlockquoteDepth=0;if(modeCfg.underscoresBreakWords===undefined)modeCfg.underscoresBreakWords=true;if(modeCfg.taskLists===undefined)modeCfg.taskLists=false;if(modeCfg.strikethrough===undefined)modeCfg.strikethrough=false;var codeDepth=0;var header="header",code="comment",quote="quote",list1="variable-2",list2="variable-3",list3="keyword",hr="hr",image="tag",formatting="formatting",linkinline="link",linkemail="link",linktext="link",linkhref="string",em="em",strong="strong",strikethrough="strikethrough";var hrRE=/^([*\-_])(?:\s*\1){2,}\s*$/,ulRE=/^[*\-+]\s+/,olRE=/^[0-9]+([.)])\s+/,taskListRE=/^\[(x| )\](?=\s)/,atxHeaderRE=modeCfg.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,setextHeaderRE=/^ *(?:\={1,}|-{1,})\s*$/,textRE=/^[^#!\[\]*_\\<>` "'(~]+/,fencedCodeRE=new RegExp("^("+(modeCfg.fencedCodeBlocks===true?"~~~+|```+":modeCfg.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)");function switchInline(stream,state,f){state.f=state.inline=f;return f(stream,state)}function switchBlock(stream,state,f){state.f=state.block=f;return f(stream,state)}function lineIsEmpty(line){return!line||!/\S/.test(line.string)}function blankLine(state){state.linkTitle=false;state.em=false;state.strong=false;state.strikethrough=false;state.quote=0;state.indentedCode=false;if(!htmlFound&&state.f==htmlBlock){state.f=inlineNormal;state.block=blockNormal}state.trailingSpace=0;state.trailingSpaceNewLine=false;state.prevLine=state.thisLine;state.thisLine=null;return null}function blockNormal(stream,state){var sol=stream.sol();var prevLineIsList=state.list!==false,prevLineIsIndentedCode=state.indentedCode;state.indentedCode=false;if(prevLineIsList){if(state.indentationDiff>=0){if(state.indentationDiff<4){state.indentation-=state.indentationDiff}state.list=null}if(state.indentation>0){state.list=null;state.listDepth=Math.floor(state.indentation/4)+1}else{state.list=false;state.listDepth=0}}var match=null;if(state.indentationDiff>=4){stream.skipToEnd();if(prevLineIsIndentedCode||lineIsEmpty(state.prevLine)){state.indentation-=4;state.indentedCode=true;return code}else{return null}}else if(stream.eatSpace()){return null}else if((match=stream.match(atxHeaderRE))&&match[1].length<=6){state.header=match[1].length;if(modeCfg.highlightFormatting)state.formatting="header";state.f=state.inline;return getType(state)}else if(!lineIsEmpty(state.prevLine)&&!state.quote&&!prevLineIsList&&!prevLineIsIndentedCode&&(match=stream.match(setextHeaderRE))){state.header=match[0].charAt(0)=="="?1:2;if(modeCfg.highlightFormatting)state.formatting="header";state.f=state.inline;return getType(state)}else if(stream.eat(">")){state.quote=sol?1:state.quote+1;if(modeCfg.highlightFormatting)state.formatting="quote";stream.eatSpace();return getType(state)}else if(stream.peek()==="["){return switchInline(stream,state,footnoteLink)}else if(stream.match(hrRE,true)){state.hr=true;return hr}else if((lineIsEmpty(state.prevLine)||prevLineIsList)&&(stream.match(ulRE,false)||stream.match(olRE,false))){var listType=null;if(stream.match(ulRE,true)){listType="ul"}else{stream.match(olRE,true);listType="ol"}state.indentation=stream.column()+stream.current().length;state.list=true;state.listDepth++;if(modeCfg.taskLists&&stream.match(taskListRE,false)){state.taskList=true;state.task=true}state.f=state.inline;if(modeCfg.highlightFormatting)state.formatting=["list","list-"+listType];return getType(state)}else if(modeCfg.fencedCodeBlocks&&(match=stream.match(fencedCodeRE,true))){state.fencedChars=match[1];state.localMode=getMode(match[2]);if(state.localMode)state.localState=state.localMode.startState();state.f=state.block=local;if(modeCfg.highlightFormatting)state.formatting="code-block";state.code=true;return getType(state)}return switchInline(stream,state,state.inline)}function htmlBlock(stream,state){var style=htmlMode.token(stream,state.htmlState);if(htmlFound&&state.htmlState.tagStart===null&&!state.htmlState.context&&state.htmlState.tokenize.isInText||state.md_inside&&stream.current().indexOf(">")>-1){state.f=inlineNormal;state.block=blockNormal;state.htmlState=null}return style}function local(stream,state){if(stream.sol()&&state.fencedChars&&stream.match(state.fencedChars,false)){state.localMode=state.localState=null;state.f=state.block=leavingLocal;return null}else if(state.localMode){return state.localMode.token(stream,state.localState)}else{stream.skipToEnd();return code}}function leavingLocal(stream,state){stream.match(state.fencedChars);state.block=blockNormal;state.f=inlineNormal;state.fencedChars=null;if(modeCfg.highlightFormatting)state.formatting="code-block";state.code=true;var returnType=getType(state);state.code=false;return returnType}function getType(state){var styles=[];if(state.formatting){styles.push(formatting);if(typeof state.formatting==="string")state.formatting=[state.formatting];for(var i=0;i<state.formatting.length;i++){styles.push(formatting+"-"+state.formatting[i]);if(state.formatting[i]==="header"){styles.push(formatting+"-"+state.formatting[i]+"-"+state.header)}if(state.formatting[i]==="quote"){if(!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote){styles.push(formatting+"-"+state.formatting[i]+"-"+state.quote)}else{styles.push("error")}}}}if(state.taskOpen){styles.push("meta");return styles.length?styles.join(" "):null}if(state.taskClosed){styles.push("property");return styles.length?styles.join(" "):null}if(state.linkHref){styles.push(linkhref,"url")}else{if(state.strong){styles.push(strong)}if(state.em){styles.push(em)}if(state.strikethrough){styles.push(strikethrough)}if(state.linkText){styles.push(linktext)}if(state.code){styles.push(code)}}if(state.header){styles.push(header);styles.push(header+"-"+state.header)}if(state.quote){styles.push(quote);if(!modeCfg.maxBlockquoteDepth||modeCfg.maxBlockquoteDepth>=state.quote){styles.push(quote+"-"+state.quote)}else{styles.push(quote+"-"+modeCfg.maxBlockquoteDepth)}}if(state.list!==false){var listMod=(state.listDepth-1)%3;if(!listMod){styles.push(list1)}else if(listMod===1){styles.push(list2)}else{styles.push(list3)}}if(state.trailingSpaceNewLine){styles.push("trailing-space-new-line")}else if(state.trailingSpace){styles.push("trailing-space-"+(state.trailingSpace%2?"a":"b"))}return styles.length?styles.join(" "):null}function handleText(stream,state){if(stream.match(textRE,true)){return getType(state)}return undefined}function inlineNormal(stream,state){var style=state.text(stream,state);if(typeof style!=="undefined")return style;if(state.list){state.list=null;return getType(state)}if(state.taskList){var taskOpen=stream.match(taskListRE,true)[1]!=="x";if(taskOpen)state.taskOpen=true;else state.taskClosed=true;if(modeCfg.highlightFormatting)state.formatting="task";state.taskList=false;return getType(state)}state.taskOpen=false;state.taskClosed=false;if(state.header&&stream.match(/^#+$/,true)){if(modeCfg.highlightFormatting)state.formatting="header";return getType(state)}var sol=stream.sol();var ch=stream.next();if(ch==="\\"){stream.next();if(modeCfg.highlightFormatting){var type=getType(state);return type?type+" formatting-escape":"formatting-escape"}}if(state.linkTitle){state.linkTitle=false;var matchCh=ch;if(ch==="("){matchCh=")"}matchCh=(matchCh+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var regex="^\\s*(?:[^"+matchCh+"\\\\]+|\\\\\\\\|\\\\.)"+matchCh;if(stream.match(new RegExp(regex),true)){return linkhref}}if(ch==="`"){var previousFormatting=state.formatting;if(modeCfg.highlightFormatting)state.formatting="code";var t=getType(state);var before=stream.pos;stream.eatWhile("`");var difference=1+stream.pos-before;if(!state.code){codeDepth=difference;state.code=true;return getType(state)}else{if(difference===codeDepth){state.code=false;return t}state.formatting=previousFormatting;return getType(state)}}else if(state.code){return getType(state)}if(ch==="!"&&stream.match(/\[[^\]]*\] ?(?:\(|\[)/,false)){stream.match(/\[[^\]]*\]/);return image}if(ch==="["&&stream.match(/.*\](\(.*\)| ?\[.*\])/,false)){state.linkText=true;if(modeCfg.highlightFormatting)state.formatting="link";return getType(state)}if(ch==="]"&&state.linkText&&stream.match(/\(.*\)| ?\[.*\]/,false)){if(modeCfg.highlightFormatting)state.formatting="link";var type=getType(state);state.linkText=false;state.inline=state.f=linkHref;return type}if(ch==="<"&&stream.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,false)){state.f=state.inline=linkInline;if(modeCfg.highlightFormatting)state.formatting="link";var type=getType(state);if(type){type+=" "}else{type=""}return type+linkinline}if(ch==="<"&&stream.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,false)){state.f=state.inline=linkInline;if(modeCfg.highlightFormatting)state.formatting="link";var type=getType(state);if(type){type+=" "}else{type=""}return type+linkemail}var ignoreUnderscore=false;if(!modeCfg.underscoresBreakWords){if(ch==="_"&&stream.peek()!=="_"&&stream.match(/(\w)/,false)){var prevPos=stream.pos-2;if(prevPos>=0){var prevCh=stream.string.charAt(prevPos);if(prevCh!=="_"&&prevCh.match(/(\w)/,false)){ignoreUnderscore=true}}}}if(ch==="*"||ch==="_"&&!ignoreUnderscore){if(sol&&stream.peek()===" "){}else if(state.strong===ch&&stream.eat(ch)){if(modeCfg.highlightFormatting)state.formatting="strong";var t=getType(state);state.strong=false;return t}else if(!state.strong&&stream.eat(ch)){state.strong=ch;if(modeCfg.highlightFormatting)state.formatting="strong";return getType(state)}else if(state.em===ch){if(modeCfg.highlightFormatting)state.formatting="em";var t=getType(state);state.em=false;return t}else if(!state.em){state.em=ch;if(modeCfg.highlightFormatting)state.formatting="em";return getType(state)}}else if(ch===" "){if(stream.eat("*")||stream.eat("_")){if(stream.peek()===" "){return getType(state)}else{stream.backUp(1)}}}if(modeCfg.strikethrough){if(ch==="~"&&stream.eatWhile(ch)){if(state.strikethrough){if(modeCfg.highlightFormatting)state.formatting="strikethrough";var t=getType(state);state.strikethrough=false;return t}else if(stream.match(/^[^\s]/,false)){state.strikethrough=true;if(modeCfg.highlightFormatting)state.formatting="strikethrough";return getType(state)}}else if(ch===" "){if(stream.match(/^~~/,true)){if(stream.peek()===" "){return getType(state)}else{stream.backUp(2)}}}}if(ch===" "){if(stream.match(/ +$/,false)){state.trailingSpace++}else if(state.trailingSpace){state.trailingSpaceNewLine=true}}return getType(state)}function linkInline(stream,state){var ch=stream.next();if(ch===">"){state.f=state.inline=inlineNormal;if(modeCfg.highlightFormatting)state.formatting="link";var type=getType(state);if(type){type+=" "}else{type=""}return type+linkinline}stream.match(/^[^>]+/,true);return linkinline}function linkHref(stream,state){if(stream.eatSpace()){return null}var ch=stream.next();if(ch==="("||ch==="["){state.f=state.inline=getLinkHrefInside(ch==="("?")":"]");if(modeCfg.highlightFormatting)state.formatting="link-string";state.linkHref=true;return getType(state)}return"error"}function getLinkHrefInside(endChar){return function(stream,state){var ch=stream.next();if(ch===endChar){state.f=state.inline=inlineNormal;if(modeCfg.highlightFormatting)state.formatting="link-string";var returnState=getType(state);state.linkHref=false;return returnState}if(stream.match(inlineRE(endChar),true)){stream.backUp(1)}state.linkHref=true;return getType(state)}}function footnoteLink(stream,state){if(stream.match(/^[^\]]*\]:/,false)){state.f=footnoteLinkInside;stream.next();if(modeCfg.highlightFormatting)state.formatting="link";state.linkText=true;return getType(state)}return switchInline(stream,state,inlineNormal)}function footnoteLinkInside(stream,state){if(stream.match(/^\]:/,true)){state.f=state.inline=footnoteUrl;if(modeCfg.highlightFormatting)state.formatting="link";var returnType=getType(state);state.linkText=false;return returnType}stream.match(/^[^\]]+/,true);return linktext}function footnoteUrl(stream,state){if(stream.eatSpace()){return null}stream.match(/^[^\s]+/,true);if(stream.peek()===undefined){state.linkTitle=true}else{stream.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,true)}state.f=state.inline=inlineNormal;return linkhref+" url"}var savedInlineRE=[];function inlineRE(endChar){if(!savedInlineRE[endChar]){endChar=(endChar+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");savedInlineRE[endChar]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+endChar+")")}return savedInlineRE[endChar]}var mode={startState:function startState(){return{f:blockNormal,prevLine:null,thisLine:null,block:blockNormal,htmlState:null,indentation:0,inline:inlineNormal,text:handleText,formatting:false,linkText:false,linkHref:false,linkTitle:false,em:false,strong:false,header:0,hr:false,task:false,taskList:false,list:false,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:false,strikethrough:false,fencedChars:null}},copyState:function copyState(s){return{f:s.f,prevLine:s.prevLine,thisLine:s.this,block:s.block,htmlState:s.htmlState&&CodeMirror.copyState(htmlMode,s.htmlState),indentation:s.indentation,localMode:s.localMode,localState:s.localMode?CodeMirror.copyState(s.localMode,s.localState):null,inline:s.inline,text:s.text,formatting:false,linkTitle:s.linkTitle,code:s.code,em:s.em,strong:s.strong,strikethrough:s.strikethrough,header:s.header,hr:s.hr,taskList:s.taskList,task:s.task,list:s.list,listDepth:s.listDepth,quote:s.quote,indentedCode:s.indentedCode,trailingSpace:s.trailingSpace,trailingSpaceNewLine:s.trailingSpaceNewLine,md_inside:s.md_inside,fencedChars:s.fencedChars}},token:function token(stream,state){state.formatting=false;if(stream!=state.thisLine){var forceBlankLine=state.header||state.hr;state.header=0;state.hr=false;if(stream.match(/^\s*$/,true)||forceBlankLine){blankLine(state);if(!forceBlankLine)return null;state.prevLine=null}state.prevLine=state.thisLine;state.thisLine=stream;state.taskList=false;state.task=false;state.trailingSpace=0;state.trailingSpaceNewLine=false;state.f=state.block;var indentation=stream.match(/^\s*/,true)[0].replace(/\t/g,"    ").length;var difference=Math.floor((indentation-state.indentation)/4)*4;if(difference>4)difference=4;var adjustedIndentation=state.indentation+difference;state.indentationDiff=adjustedIndentation-state.indentation;state.indentation=adjustedIndentation;if(indentation>0)return null}return state.f(stream,state)},innerMode:function innerMode(state){if(state.block==htmlBlock)return{state:state.htmlState,mode:htmlMode};if(state.localState)return{state:state.localState,mode:state.localMode};return{state:state,mode:mode}},blankLine:blankLine,getType:getType,closeBrackets:"()[]{}''\"\"``",fold:"markdown"};return mode},"xml");CodeMirror.defineMIME("text/x-markdown","markdown")},function(module,exports){"use strict";var urlRE=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?«»“”‘’]))/i;CodeMirror.defineMode("gfm",function(config,modeConfig){var codeDepth=0;function blankLine(state){state.code=false;return null}var gfmOverlay={startState:function startState(){return{code:false,codeBlock:false,ateSpace:false}},copyState:function copyState(s){return{code:s.code,codeBlock:s.codeBlock,ateSpace:s.ateSpace}},token:function token(stream,state){state.combineTokens=null;if(state.codeBlock){if(stream.match(/^```+/)){state.codeBlock=false;return null}stream.skipToEnd();return null}if(stream.sol()){state.code=false}if(stream.sol()&&stream.match(/^```+/)){stream.skipToEnd();state.codeBlock=true;return null}if(stream.peek()==="`"){stream.next();var before=stream.pos;stream.eatWhile("`");var difference=1+stream.pos-before;if(!state.code){codeDepth=difference;state.code=true}else{if(difference===codeDepth){state.code=false}}return null}else if(state.code){stream.next();return null}if(stream.eatSpace()){state.ateSpace=true;return null}if(stream.sol()||state.ateSpace){state.ateSpace=false}stream.next();return null},blankLine:blankLine};var markdownConfig={underscoresBreakWords:false,taskLists:true,fencedCodeBlocks:"```",strikethrough:true};for(var attr in modeConfig){markdownConfig[attr]=modeConfig[attr]}markdownConfig.name="markdown";return CodeMirror.overlayMode(CodeMirror.getMode(config,markdownConfig),gfmOverlay)},"markdown");CodeMirror.defineMIME("text/x-gfm","gfm")},function(module,exports){"use strict";var listRE=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)/,emptyListRE=/^(\s*)(>[> ]*|[*+-]\s(?:\[(?:x|\s)\]\s)?|(\d+)([.)]\s(?:\[(?:x|\s)\]\s)?))(\s*)$/,FIND_CODEBLOCK_START_RX=/^ *(`{3,}|~{3,})[ \.]*\S+ */,unorderedListRE=/[*+-]\s/;CodeMirror.commands.subListIndentTab=function(cm){if(cm.getOption("disableInput"))return CodeMirror.Pass;var ranges=cm.listSelections();for(var i=0;i<ranges.length;i++){var pos=ranges[i].head;var line=cm.getLine(pos.line);var cursorBeforeTextInline=line.substr(0,pos.ch);if(listRE.test(cursorBeforeTextInline)){cm.replaceRange(Array(cm.getOption("indentUnit")+1).join(" ")+line,{line:pos.line,ch:0},{line:pos.line,ch:line.length},"+input");cm.setCursor(pos.line,pos.ch+4)}else{if(cm.somethingSelected())cm.indentSelection("add");else cm.execCommand("insertSoftTab")}}};CodeMirror.commands.newlineAndIndentContinue=function(cm){if(cm.getOption("disableInput"))return CodeMirror.Pass;var ranges=cm.listSelections(),replacements=[];for(var i=0;i<ranges.length;i++){var pos=ranges[i].head;var eolState=cm.getStateAfter(pos.line);var inList=eolState.base.list!==false;var inQuote=eolState.base.quote!==0;var line=cm.getLine(pos.line);var isCodeBlockStart=FIND_CODEBLOCK_START_RX.test(line);var match=listRE.exec(line);var cursor=cm.getCursor();if(!ranges[i].empty()||!inList&&!inQuote&&!isCodeBlockStart||!match&&!isCodeBlockStart){cm.execCommand("newlineAndIndent");return}if(isCodeBlockStart){cursor=cm.getCursor();if(cursor.line!==pos.line||cursor.ch!==line.length){cm.execCommand("newlineAndIndent");return}}if(emptyListRE.test(line)&&cursor.ch>0){cm.replaceRange("",{line:pos.line,ch:0},{line:pos.line,ch:line.length});replacements[i]="\n"}else if(isCodeBlockStart){replacements[i]="\n\n```"}else{var indent=match[1],after=match[5],bullet;if(indent.length===pos.ch){bullet=""}else if(unorderedListRE.test(match[2])||match[2].indexOf(">")>=0){bullet=match[2]}else{bullet=parseInt(match[3],10)+1+match[4]}replacements[i]="\n"+indent+bullet+after}}cm.replaceSelections(replacements);if(isCodeBlockStart){cm.setCursor(pos.line+1,0)}}},function(module,exports){"use strict";CodeMirror.commands.replaceLineTextToUpper=function(cm){if(cm.getOption("disableInput")){return CodeMirror.Pass}var ranges=cm.listSelections();var lineAdjustment=-1;for(var i=0;i<ranges.length;i++){var range=ranges[i];var from=range.anchor;var to=range.head;if(isSameLineSelection(range)&&to.line>0){replaceSingleLine(cm,from,to,lineAdjustment)}else if(!isRangeCollapsed(range)){var topLine=from.line<to.line?from.line:to.line;if(topLine>0){var upper=from.line===topLine?from:to;var bottom=from.line===topLine?to:from;replaceMultiLine(cm,upper,bottom,lineAdjustment)}}}};CodeMirror.commands.replaceLineTextToLower=function(cm){if(cm.getOption("disableInput")){return CodeMirror.Pass}var ranges=cm.listSelections();var lineAdjustment=1;for(var i=0;i<ranges.length;i++){var range=ranges[i];var from=range.anchor;var to=range.head;var isLastLine=to.line===cm.lastLine();if(isSameLineSelection(range)&&!isLastLine){replaceSingleLine(cm,from,to,lineAdjustment)}else if(!isRangeCollapsed(range)){var topLine=from.line<to.line?from.line:to.line;var upper=from.line===topLine?from:to;var bottom=from.line===topLine?to:from;if(bottom.line<cm.lastLine()){replaceMultiLine(cm,upper,bottom,lineAdjustment)}}}};function isRangeCollapsed(range){return isSameLineSelection(range)&&range.anchor.ch===range.head.ch}function isSameLineSelection(range){return range.anchor.line===range.head.line}function replaceSingleLine(cm,from,to,lineAdjustment){var currentLine=cm.getLine(to.line);var replacement=cm.getLine(to.line+lineAdjustment);var range={anchor:from,head:to};cm.replaceRange(replacement,{line:to.line,ch:0},{line:to.line,ch:currentLine.length},"+input");cm.replaceRange(currentLine,{line:to.line+lineAdjustment,ch:0},{line:to.line+lineAdjustment,ch:replacement.length},"+input");if(isRangeCollapsed(range)){cm.setCursor({line:to.line+lineAdjustment,ch:to.ch})}else{cm.setSelection({line:from.line+lineAdjustment,ch:from.ch},{line:to.line+lineAdjustment,ch:to.ch})}}function replaceMultiLine(cm,upper,bottom,lineAdjustment){var rangeContent=cm.getRange({line:upper.line,ch:0},{line:bottom.line,ch:cm.getLine(bottom.line).length});var edgeLineOfConcern=lineAdjustment>0?bottom:upper;var replacement=cm.getLine(edgeLineOfConcern.line+lineAdjustment);var targetLine=void 0;if(lineAdjustment>0){targetLine=upper}else{targetLine=bottom}cm.replaceRange(replacement,{line:targetLine.line,ch:0},{line:targetLine.line,ch:cm.getLine(targetLine.line).length},"+input");cm.replaceRange(rangeContent,{line:upper.line+lineAdjustment,ch:0},{line:bottom.line+lineAdjustment,ch:cm.getLine(bottom.line+lineAdjustment).length},"+input");cm.setSelection({line:upper.line+lineAdjustment,ch:upper.ch},{line:bottom.line+lineAdjustment,ch:bottom.ch})}},function(module,exports,__webpack_require__){"use strict";var extManager=__webpack_require__(30);var FIND_TASK_RX=/^\s*\* \[[xX ]\] [^\n]*/gm;var FIND_CHECKED_TASK_RX=/^\s*\* \[[xX]\] [^\n]*/gm;extManager.defineExtension("taskCounter",function(editor){editor.getTaskCount=function(){var found=void 0,count=void 0;if(editor.isViewOnly()){count=editor.preview.$el.find(".task-list-item").length}else if(editor.isMarkdownMode()){found=editor.mdEditor.getValue().match(FIND_TASK_RX);count=found?found.length:0}else{count=editor.wwEditor.get$Body().find(".task-list-item").length}return count};editor.getCheckedTaskCount=function(){var found=void 0,count=void 0;if(editor.isViewOnly()){count=editor.preview.$el.find(".task-list-item.checked").length}else if(editor.isMarkdownMode()){found=editor.mdEditor.getValue().match(FIND_CHECKED_TASK_RX);count=found?found.length:0}else{count=editor.wwEditor.get$Body().find(".task-list-item.checked").length}return count}})},function(module,exports,__webpack_require__){"use strict";var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _scrollFollow=__webpack_require__(99);var _scrollFollow2=_interopRequireDefault(_scrollFollow);var _scrollFollow3=__webpack_require__(100);var _scrollFollow4=_interopRequireDefault(_scrollFollow3);var _button=__webpack_require__(43);var _button2=_interopRequireDefault(_button);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_extManager2.default.defineExtension("scrollFollow",function(editor){var className="tui-scrollfollow";var TOOL_TIP={active:_i18n2.default.get("Auto scroll enabled"),inActive:_i18n2.default.get("Auto scroll disabled")};if(editor.isViewOnly()){return}var cm=editor.getCodeMirror();var sectionManager=new _scrollFollow4.default(cm,editor.preview);var scrollSync=new _scrollFollow2.default(sectionManager,cm,editor.preview.$el);var isScrollable=false;var isActive=true;var button=void 0;if(editor.getUI().name==="default"){button=new _button2.default({className:className,command:"scrollFollowToggle",tooltip:TOOL_TIP.active,$el:$('<button class="active '+className+'" type="button"></button>')});editor.getUI().toolbar.addButton(button);changeButtonVisiblityStateIfNeed();editor.on("changeMode",changeButtonVisiblityStateIfNeed);editor.on("changePreviewStyle",changeButtonVisiblityStateIfNeed);editor.addCommand("markdown",{name:"scrollFollowToggle",exec:function exec(){isActive=!isActive;button._onOut();if(isActive){button.$el.addClass("active");button.tooltip=TOOL_TIP.active}else{button.$el.removeClass("active");button.tooltip=TOOL_TIP.inActive}button._onOver()}})}cm.on("change",function(){isScrollable=false;sectionManager.makeSectionList()});function changeButtonVisiblityStateIfNeed(){if(editor.mdPreviewStyle==="vertical"&&editor.currentMode==="markdown"){button.$el.show()}else{button.$el.hide()}}editor.on("previewRenderAfter",function(){sectionManager.sectionMatch();scrollSync.syncPreviewScrollTopToMarkdown();isScrollable=true});editor.eventManager.listen("scroll",function(event){if(!isActive){return}if(isScrollable&&editor.preview.isVisible()){if(event.source==="markdown"&&!scrollSync.isMarkdownScrollEventBlocked){scrollSync.syncPreviewScrollTopToMarkdown()}else if(event.source==="preview"&&!scrollSync.isPreviewScrollEventBlocked){scrollSync.syncMarkdownScrollTopToPreview()}}else{scrollSync.saveScrollInfo()}})})},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){
if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var PREVIEW_MARGIN_TOP=57;var SCROLL_TOP_PADDING=20;var SCROLL_BOCKING_RESET_DELAY=15;var ScrollSync=function(){function ScrollSync(sectionManager,cm,$previewContainerEl){_classCallCheck(this,ScrollSync);this.sectionManager=sectionManager;this.cm=cm;this.$previewContainerEl=$previewContainerEl;this.$contents=this.$previewContainerEl.find(".tui-editor-contents");this.releaseTimer=null;this._currentTimeoutId=null;this._savedScrollInfo=null}_createClass(ScrollSync,[{key:"_getEditorSectionHeight",value:function _getEditorSectionHeight(section){var height=this.cm.heightAtLine(section.end,"local");height-=this.cm.heightAtLine(section.start>0?section.start-1:0,"local");return height}},{key:"_getEditorLineHeightGapInSection",value:function _getEditorLineHeightGapInSection(section,line){var gap=this.cm.heightAtLine(line,"local");gap-=this.cm.heightAtLine(section.start>0?section.start-1:0,"local");return Math.max(gap,0)}},{key:"_getEditorSectionScrollRatio",value:function _getEditorSectionScrollRatio(section,line){var isOneLine=section.end===section.start;var ratio=void 0;if(isOneLine){ratio=0}else{ratio=this._getEditorLineHeightGapInSection(section,line)/this._getEditorSectionHeight(section)}return ratio}},{key:"_getScrollFactorsOfEditor",value:function _getScrollFactorsOfEditor(){var cm=this.cm;var scrollInfo=cm.getScrollInfo();var topLine=void 0,topSection=void 0,ratio=void 0,factors=void 0;scrollInfo=this._fallbackScrollInfoIfIncorrect(scrollInfo);var isEditorBottom=scrollInfo.height-scrollInfo.top<=scrollInfo.clientHeight;if(isEditorBottom){factors={isEditorBottom:isEditorBottom}}else{topLine=cm.coordsChar({left:scrollInfo.left,top:scrollInfo.top},"local").line;topSection=this.sectionManager.sectionByLine(topLine);ratio=this._getEditorSectionScrollRatio(topSection,topLine);factors={section:topSection,sectionRatio:ratio}}return factors}},{key:"_getScrollInfoForMarkdown",value:function _getScrollInfoForMarkdown(){var _this=this;var sectionList=this.sectionManager.getSectionList();var factors=void 0;tui.util.forEachArray(sectionList,function(section){var $div=section.$previewSectionEl;var $preview=$div.parent().parent();var isPreviewBottom=$preview[0].clientHeight-$preview.scrollTop()<=$preview[0].height;var needNext=true;if(isPreviewBottom){factors={isPreviewBottom:isPreviewBottom};needNext=false}else if(_this._isTopSection($preview,$div)){factors={section:section,sectionRatio:_this._getMarkdownEditorScrollRatio($preview,$div)};needNext=false}return needNext});return factors}},{key:"_getMarkdownEditorScrollRatio",value:function _getMarkdownEditorScrollRatio($preview,$div){return($preview.scrollTop()-$div[0].offsetTop)/$div.height()}},{key:"_getScrollTopForPreview",value:function _getScrollTopForPreview(){var scrollTop=void 0;var scrollFactors=this._getScrollFactorsOfEditor();var section=scrollFactors.section;var ratio=scrollFactors.sectionRatio;if(scrollFactors.isEditorBottom){scrollTop=this.$contents.height()}else if(section.$previewSectionEl){scrollTop=section.$previewSectionEl[0].offsetTop;scrollTop+=section.$previewSectionEl.height()*ratio-SCROLL_TOP_PADDING}scrollTop=scrollTop&&Math.max(scrollTop,0);return scrollTop}},{key:"_getScrollTopForMarkdown",value:function _getScrollTopForMarkdown(){var scrollTop=void 0;var scrollFactors=this._getScrollInfoForMarkdown();var ratio=scrollFactors.sectionRatio;if(scrollFactors.isPreviewBottom){scrollTop=this.cm.getScrollInfo().height}else if(scrollFactors.section){var section=scrollFactors.section;var coordsAtStart=this.cm.charCoords({line:section.start,char:0},"local");var coordsAtEnd=this.cm.charCoords({line:section.end,char:0},"local");scrollTop=coordsAtStart.top;scrollTop+=(coordsAtEnd.top-coordsAtStart.top)*ratio}scrollTop=scrollTop&&Math.max(scrollTop,0);return scrollTop}},{key:"syncPreviewScrollTopToMarkdown",value:function syncPreviewScrollTopToMarkdown(){var _this2=this;var $previewContainerEl=this.$previewContainerEl;var sourceScrollTop=$previewContainerEl.scrollTop();var targetScrollTop=this._getScrollTopForPreview();this.isPreviewScrollEventBlocked=true;this._animateRun(sourceScrollTop,targetScrollTop,function(deltaScrollTop){clearTimeout(_this2.releaseTimer);$previewContainerEl.scrollTop(deltaScrollTop);_this2.releaseTimer=setTimeout(function(){_this2.isPreviewScrollEventBlocked=false},SCROLL_BOCKING_RESET_DELAY)})}},{key:"syncMarkdownScrollTopToPreview",value:function syncMarkdownScrollTopToPreview(){var _this3=this;var codeMirror=this.cm;var codeMirrorScrollInfo=codeMirror.getScrollInfo();var sourceScrollTop=codeMirrorScrollInfo.top;var targetScrollTop=this._getScrollTopForMarkdown();this.isMarkdownScrollEventBlocked=true;this._animateRun(sourceScrollTop,targetScrollTop,function(deltaScrollTop){clearTimeout(_this3.releaseTimer);codeMirror.scrollTo(0,deltaScrollTop);_this3.releaseTimer=setTimeout(function(){_this3.isMarkdownScrollEventBlocked=false},SCROLL_BOCKING_RESET_DELAY)})}},{key:"_animateRun",value:function _animateRun(originValue,targetValue,stepCB){var valueDiff=targetValue-originValue,startTime=Date.now(),self=this;if(this._currentTimeoutId){clearTimeout(this._currentTimeoutId)}function step(){var stepTime=Date.now();var progress=(stepTime-startTime)/200;var deltaValue=void 0;if(progress<1){deltaValue=originValue+valueDiff*Math.cos((1-progress)*Math.PI/2);stepCB(Math.ceil(deltaValue));self._currentTimeoutId=setTimeout(step,1)}else{stepCB(targetValue);self._currentTimeoutId=null}}step()}},{key:"_fallbackScrollInfoIfIncorrect",value:function _fallbackScrollInfoIfIncorrect(scrollInfo){return scrollInfo.height<0&&this._savedScrollInfo?this._savedScrollInfo:scrollInfo}},{key:"saveScrollInfo",value:function saveScrollInfo(){this._savedScrollInfo=this.cm.getScrollInfo()}},{key:"_isTopSection",value:function _isTopSection($preview,$div){var previewScrollTop=$preview.scrollTop();var divOffsetTop=$div[0].offsetTop;var divHeight=$div.height();var isSectionBegin=previewScrollTop>=divOffsetTop-PREVIEW_MARGIN_TOP;var isSectionEnd=previewScrollTop>divOffsetTop+divHeight;return isSectionBegin&&!isSectionEnd}}]);return ScrollSync}();module.exports=ScrollSync},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var FIND_HEADER_RX=/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/;var FIND_LIST_RX=/^ *(\*|-|\d+\.|[*-] \[[ xX]])\s/;var FIND_QUOTE_RX=/^ {0,3}(> ?)+\s/;var FIND_IMAGE_RX=/^ {0,3}!\[([^\[\]]*)]\(([^)]*)\)/;var FIND_SETEXT_HEADER_RX=/^ *(?:={1,}|-{1,})\s*$/;var FIND_CODEBLOCK_END_RX=/^ *(`{3,}|~{3,})[ ]*$/;var FIND_CODEBLOCK_START_RX=/^ *(`{3,}|~{3,})[ .]*(\S+)? */;var FIND_SPACE=/\s/g;var SectionManager=function(){function SectionManager(cm,preview){_classCallCheck(this,SectionManager);this.cm=cm;this.preview=preview;this.$previewContent=preview.$el.find(".tui-editor-contents");this._sectionList=null;this._currentSection=null}_createClass(SectionManager,[{key:"_addNewSection",value:function _addNewSection(start,end){var newSection=this._makeSectionData(start,end);this._sectionList.push(newSection);this._currentSection=newSection}},{key:"getSectionList",value:function getSectionList(){return this._sectionList}},{key:"_makeSectionData",value:function _makeSectionData(start,end){return{start:start,end:end,$previewSectionEl:null}}},{key:"_updateCurrentSectionEnd",value:function _updateCurrentSectionEnd(end){this._currentSection.end=end}},{key:"_eachLineState",value:function _eachLineState(iteratee){var isSection=void 0,i=void 0,lineString=void 0,nextLineString=void 0,prevLineString=void 0,isTrimming=true,onTable=false,onCodeBlock=false,trimCapture="";var isRightAfterImageSection=false;var isEnsuredSection=false;var codeblockStartLineIndex=void 0;var lineLength=this.cm.getDoc().lineCount();for(i=0;i<lineLength;i+=1){isSection=false;lineString=this.cm.getLine(i);nextLineString=this.cm.getLine(i+1)||"";prevLineString=this.cm.getLine(i-1)||"";var isCodeBlockEnded=this._isCodeBlockEnd(prevLineString)&&codeblockStartLineIndex!==i-1;if(onTable&&(!lineString||!this._isTableCode(lineString))){onTable=false}else if(!onTable&&this._isTable(lineString,nextLineString)){onTable=true}if(onCodeBlock&&isCodeBlockEnded){onCodeBlock=false}if(!onCodeBlock&&this._isCodeBlockStart(lineString)){onCodeBlock=this._doFollowedLinesHaveCodeBlockEnd(i,lineLength);codeblockStartLineIndex=i}if(isEnsuredSection&&lineString.length!==0){if(this._isIndependentImage(onCodeBlock,onTable,lineString,prevLineString)){isRightAfterImageSection=true;isEnsuredSection=true}else{isRightAfterImageSection=false;isEnsuredSection=false}isSection=true}else if(this._isAtxHeader(lineString)){isRightAfterImageSection=false;isSection=true;isEnsuredSection=false}else if(!this._isCodeBlockEnd(lineString)&&!onTable&&this._isSeTextHeader(lineString,nextLineString)){isRightAfterImageSection=false;isSection=true;isEnsuredSection=false}else if(this._isIndependentImage(onCodeBlock,onTable,lineString,prevLineString)){isRightAfterImageSection=true;isSection=true;isEnsuredSection=false}else if(isRightAfterImageSection&&lineString.length===0){isRightAfterImageSection=false;isEnsuredSection=true}if(isTrimming){trimCapture+=lineString.trim();if(trimCapture){isTrimming=false}else{continue}}iteratee(isSection,i)}}},{key:"_isIndependentImage",value:function _isIndependentImage(onCodeBlock,onTable,lineString,prevLineString){return!onCodeBlock&&!onTable&&this._isImage(lineString)&&!this._isList(lineString)&&!this._isQuote(lineString)&&prevLineString.length===0}},{key:"_doFollowedLinesHaveCodeBlockEnd",value:function _doFollowedLinesHaveCodeBlockEnd(lineIndex,lineLength){var doLineHaveCodeBlockEnd=false;for(var i=lineIndex+1;i<lineLength;i+=1){if(this._isCodeBlockEnd(this.cm.getLine(i))){doLineHaveCodeBlockEnd=true;break}}return doLineHaveCodeBlockEnd}},{key:"_isCodeBlockStart",value:function _isCodeBlockStart(string){return FIND_CODEBLOCK_START_RX.test(string)}},{key:"_isCodeBlockEnd",value:function _isCodeBlockEnd(string){return FIND_CODEBLOCK_END_RX.test(string)}},{key:"_isTable",value:function _isTable(lineString,nextLineString){return this._isTableCode(lineString)&&this._isTableAligner(nextLineString)}},{key:"_isTableCode",value:function _isTableCode(string){return/(^\S?.*\|.*)/.test(string)}},{key:"_isTableAligner",value:function _isTableAligner(string){return/(\s*[-:]+\s*\|)+/.test(string)}},{key:"_isAtxHeader",value:function _isAtxHeader(string){return FIND_HEADER_RX.test(string)}},{key:"_isSeTextHeader",value:function _isSeTextHeader(lineString,nextLineString){return lineString.replace(FIND_SPACE,"")!==""&&nextLineString&&FIND_SETEXT_HEADER_RX.test(nextLineString)}},{key:"_isImage",value:function _isImage(lineString){return FIND_IMAGE_RX.test(lineString)}},{key:"_isList",value:function _isList(lineString){return FIND_LIST_RX.test(lineString)}},{key:"_isQuote",value:function _isQuote(lineString){return FIND_QUOTE_RX.test(lineString)}},{key:"makeSectionList",value:function makeSectionList(){var _this=this;this._sectionList=[];this._eachLineState(function(isSection,lineNumber){if(isSection||!_this._sectionList.length){_this._addNewSection(lineNumber,lineNumber)}else{_this._updateCurrentSectionEnd(lineNumber)}})}},{key:"sectionMatch",value:function sectionMatch(){if(this._sectionList){var sections=this._getPreviewSections();this._matchPreviewSectionsWithSectionlist(sections)}}},{key:"_matchPreviewSectionsWithSectionlist",value:function _matchPreviewSectionsWithSectionlist(sections){var _this2=this;sections.forEach(function(childs,index){if(_this2._sectionList[index]){var $sectionDiv=$("<div class='content-id-"+index+"'></div>");_this2._sectionList[index].$previewSectionEl=$(childs).wrapAll($sectionDiv).parent()}})}},{key:"_getPreviewSections",value:function _getPreviewSections(){var sections=[];var lastSection=0;var isRightAfterImageSection=false;sections[0]=[];this.$previewContent.contents().filter(findElementNodeFilter).each(function(index,el){var isParagraph=el.tagName==="P";var isHeading=el.tagName.match(/^(H1|H2|H3|H4|H5|H6)$/);var isImage=isParagraph&&el.childNodes[0].nodeName==="IMG";if((isHeading||isImage||isRightAfterImageSection)&&sections[lastSection].length){sections.push([]);lastSection+=1;isRightAfterImageSection=false}if(isImage){isRightAfterImageSection=true}sections[lastSection].push(el)});return sections}},{key:"sectionByLine",value:function sectionByLine(line){var sectionIndex=void 0;var sectionList=this._sectionList;var sectionLength=sectionList.length;for(sectionIndex=0;sectionIndex<sectionLength;sectionIndex+=1){if(line<=sectionList[sectionIndex].end){break}}if(sectionIndex===sectionLength){sectionIndex=sectionLength-1}return sectionList[sectionIndex]}}]);return SectionManager}();function findElementNodeFilter(){return this.nodeType===Node.ELEMENT_NODE}module.exports=SectionManager},function(module,exports,__webpack_require__){"use strict";var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var colorSyntaxRx=/\{color:(.+?)}(.*?)\{color}/g;var colorHtmlRx=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)/g;var colorHtmlCompleteRx=/<span (?:class="colour" )?style="color:(.+?)"(?: class="colour")?>(.*?)<\/span>/g;var decimalColorRx=/rgb\((\d+)[, ]+(\d+)[, ]+(\d+)\)/g;var RESET_COLOR="#181818";_extManager2.default.defineExtension("colorSyntax",function(editor){var useCustomSyntax=false;var preset=void 0;if(editor.options.colorSyntax){useCustomSyntax=!!editor.options.colorSyntax.useCustomSyntax;preset=editor.options.colorSyntax.preset}editor.eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(html){var replacement=void 0;if(!useCustomSyntax){replacement=html}else{replacement=html.replace(colorSyntaxRx,function(matched,p1,p2){return makeHTMLColorSyntax(p2,p1)})}return replacement});editor.eventManager.listen("convertorAfterHtmlToMarkdownConverted",function(markdown){var findRx=useCustomSyntax?colorHtmlCompleteRx:colorHtmlRx;return markdown.replace(findRx,function(founded,color,text){var replacement=void 0;if(color.match(decimalColorRx)){color=changeDecColorToHex(color)}if(!useCustomSyntax){replacement=founded.replace(/ ?class="colour" ?/g," ").replace(decimalColorRx,color)}else{replacement=makeCustomColorSyntax(text,color)}return replacement})});if(!editor.isViewOnly()&&editor.getUI().name==="default"){editor.addCommand("markdown",{name:"color",exec:function exec(mde,color){var cm=mde.getEditor();if(!color){return}if(!useCustomSyntax){cm.replaceSelection(makeHTMLColorSyntax(cm.getSelection(),color))}else{cm.replaceSelection(makeCustomColorSyntax(cm.getSelection(),color))}mde.focus()}});editor.addCommand("wysiwyg",{name:"color",exec:function exec(wwe,color){var sq=wwe.getEditor();if(!color){return}if(!sq.hasFormat("PRE")){if(color===RESET_COLOR){sq.changeFormat(null,{class:"colour",tag:"span"})}else{sq.setTextColour(color)}}sq.focus()}});initUI(editor,preset)}});function initUI(editor,preset){var className="tui-color";editor.eventManager.addEventType("colorButtonClicked");editor.getUI().toolbar.addButton({className:className,event:"colorButtonClicked",tooltip:_i18n2.default.get("Text color")},2);var $button=editor.getUI().toolbar.$el.find("button."+className);var $colorPickerContainer=$("<div />");var $buttonBar=$('<button type="button" class="te-apply-button">입력</button>');var cpOptions={container:$colorPickerContainer[0]};if(preset){cpOptions.preset=preset}var colorPicker=tui.component.colorpicker.create(cpOptions);var selectedColor=colorPicker.getColor();$colorPickerContainer.append($buttonBar);var popup=editor.getUI().createPopup({title:false,content:$colorPickerContainer,className:"tui-popup-color",$target:editor.getUI().$el,css:{width:"auto",position:"absolute"}});editor.eventManager.listen("focus",function(){popup.hide()});editor.eventManager.listen("colorButtonClicked",function(){editor.eventManager.emit("closeAllPopup");if(popup.isShow()){popup.hide()}else{popup.$el.css({top:$button.position().top+$button.height()+5,left:$button.position().left});popup.show();colorPicker.slider.toggle(true)}});editor.eventManager.listen("closeAllPopup",function(){popup.hide()});editor.eventManager.listen("removeEditor",function(){colorPicker.off("selectColor")});colorPicker.on("selectColor",function(e){selectedColor=e.color;if(e.origin==="palette"){editor.exec("color",selectedColor);popup.hide()}});popup.$el.find(".te-apply-button").on("click",function(){editor.exec("color",selectedColor)})}function makeCustomColorSyntax(text,color){return"{color:"+color+"}"+text+"{color}"}function makeHTMLColorSyntax(text,color){return'<span style="color:'+color+'">'+text+"</span>"}function changeDecColorToHex(color){return color.replace(decimalColorRx,function(colorValue,r,g,b){r=parseInt(r,10);g=parseInt(g,10);b=parseInt(b,10);var colorHexValue=get2DigitNumberString(r.toString(16))+get2DigitNumberString(g.toString(16))+get2DigitNumberString(b.toString(16));return"#"+colorHexValue})}function get2DigitNumberString(numberStr){return numberStr==="0"?"00":numberStr}},function(module,exports,__webpack_require__){"use strict";var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _markerList=__webpack_require__(103);var _markerList2=_interopRequireDefault(_markerList);var _markerManager=__webpack_require__(104);var _markerManager2=_interopRequireDefault(_markerManager);var _wysiwygMarkerHelper=__webpack_require__(106);var _wysiwygMarkerHelper2=_interopRequireDefault(_wysiwygMarkerHelper);var _viewOnlyMarkerHelper=__webpack_require__(107);var _viewOnlyMarkerHelper2=_interopRequireDefault(_viewOnlyMarkerHelper);var _markdownMarkerHelper=__webpack_require__(108);var _markdownMarkerHelper2=_interopRequireDefault(_markdownMarkerHelper);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var MARKER_UPDATE_DELAY=100;var FIND_CRLF_RX=/(\n)|(\r\n)|(\r)/g;_extManager2.default.defineExtension("mark",function(editor){var ml=new _markerList2.default;var mm=new _markerManager2.default(ml);var wmh=void 0,mmh=void 0,vmh=void 0;editor.eventManager.addEventType("markerUpdated");if(editor.isViewOnly()){vmh=new _viewOnlyMarkerHelper2.default(editor.preview)}else{wmh=new _wysiwygMarkerHelper2.default(editor.getSquire());mmh=new _markdownMarkerHelper2.default(editor.getCodeMirror())}function getHelper(){var helper=void 0;if(editor.isViewOnly()){helper=vmh}else if(editor.isWysiwygMode()){helper=wmh}else{helper=mmh}return helper}function updateMarkWhenResizing(){var helper=getHelper();ml.getAll().forEach(function(marker){helper.updateMarkerWithExtraInfo(marker)});editor.eventManager.emit("markerUpdated",ml.getAll())}$(window).on("resize",updateMarkWhenResizing);editor.on("removeEditor",function(){$(window).off("resize",updateMarkWhenResizing)});editor.on("setMarkdownAfter",function(){var helper=getHelper();mm.resetContent(helper.getTextContent())});editor.setValueWithMarkers=function(value,markerDataCollection){var helper=void 0;ml.resetMarkers();markerDataCollection.forEach(function(markerData){ml.addMarker(markerData.start,markerData.end,markerData.id)});editor.setValue(value);mm.resetContent(value.replace(FIND_CRLF_RX,""));if(editor.isViewOnly()||editor.isWysiwygMode()){helper=getHelper();mm.updateMarkersByContent(helper.getTextContent())}else{helper=mmh}ml.getAll().forEach(function(marker){helper.updateMarkerWithExtraInfo(marker)});editor.eventManager.emit("markerUpdated",ml.getAll());return ml.getAll()};editor.getMarker=function(id){return ml.getMarker(id)};editor.getMarkersAll=function(){return ml.getAll()};editor.removeMarker=function(id){return ml.removeMarker(id)};editor.exportMarkers=function(){var markersData=void 0;if(editor.isMarkdownMode()){markersData=ml.getMarkersData()}else if(editor.isViewOnly()||editor.isWysiwygMode()){mm.updateMarkersByContent(editor.getValue().replace(FIND_CRLF_RX,""));markersData=ml.getMarkersData();mm.updateMarkersByContent(getHelper().getTextContent())}return markersData};editor.selectMarker=function(id){var helper=getHelper();var marker=editor.getMarker(id);if(marker){helper.selectOffsetRange(marker.start,marker.end)}};editor.addMarker=function(start,end,id){var marker=void 0;var helper=getHelper();if(!id){id=start;marker=helper.getMarkerInfoOfCurrentSelection()}else{marker={start:start,end:end};marker=helper.updateMarkerWithExtraInfo(marker)}if(marker){marker.id=id;marker=ml.addMarker(marker);ml.sortBy("end");editor.eventManager.emit("markerUpdated",[marker])}return marker};editor.clearSelect=function(){getHelper().clearSelect()};if(!editor.isViewOnly()){editor.on("changeMode",function(){editor._updateMarkers()});editor.on("change",util.debounce(function(){editor._updateMarkers()},MARKER_UPDATE_DELAY));editor._updateMarkers=function(){var helper=getHelper();if(!ml.getAll().length){return}mm.updateMarkersByContent(helper.getTextContent());ml.getAll().forEach(function(marker){helper.updateMarkerWithExtraInfo(marker)});editor.eventManager.emit("markerUpdated",ml.getAll())}}})},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var Markerlist=function(){function Markerlist(){_classCallCheck(this,Markerlist);this._sortedMarkers=[];this._markersWithId={}}_createClass(Markerlist,[{key:"addMarker",value:function addMarker(start,end,id){var marker=void 0;if(!id){marker=start}else{marker={start:start,end:end,id:id}}if(!this._markersWithId[marker.id]){this._sortedMarkers.push(marker);this._markersWithId[marker.id]=marker}return marker}},{key:"getMarker",value:function getMarker(id){return this._markersWithId[id]}},{key:"removeMarker",value:function removeMarker(id){var removedMarker=this._markersWithId[id];delete this._markersWithId[id];var index=this._sortedMarkers.indexOf(removedMarker);this._sortedMarkers.splice(index,1);return removedMarker}},{key:"updateMarker",value:function updateMarker(id,obj){var marker=this.getMarker(id);return util.extend(marker,obj)}},{key:"forEachByRangeAffected",value:function forEachByRangeAffected(start,end,iteratee){var rangeMarkers=this._getMarkersByRangeAffected(start,end);rangeMarkers.forEach(iteratee)}},{key:"_getMarkersByRangeAffected",value:function _getMarkersByRangeAffected(start,end){var rangeMarkers=this._sortedMarkers.filter(function(marker){if(marker.end>end||marker.end>start){return true}return false});return rangeMarkers}},{key:"getAll",value:function getAll(){return this._sortedMarkers}},{key:"resetMarkers",value:function resetMarkers(){this._sortedMarkers=[];this._markersWithId={}}},{key:"sortBy",value:function sortBy(rangeKey){this._sortedMarkers.sort(function(a,b){return a[rangeKey]-b[rangeKey]})}},{key:"getMarkersData",value:function getMarkersData(){return this.getAll().map(function(marker){return{start:marker.start,end:marker.end,id:marker.id}})}}]);return Markerlist}();module.exports=Markerlist},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var DiffMatchPatch=__webpack_require__(105);var util=tui.util;var CHANGE_NOTHING=0,CHANGE_ADD=1,CHANGE_MINUS=-1;var MarkerManager=function(){function MarkerManager(markerList){_classCallCheck(this,MarkerManager);this._dmp=new DiffMatchPatch;this.markerList=markerList;this.oldTextContent=null}_createClass(MarkerManager,[{key:"resetContent",value:function resetContent(content){this.oldTextContent=util.isString(content)?content:null}},{key:"updateMarkersByContent",value:function updateMarkersByContent(newContent){if(util.isNull(this.oldTextContent)){this.resetContent(newContent);return[]}var markerDiffs=this._makeMarkerDiffs(newContent);this.oldTextContent=newContent;return this._getUpdateMarkersWithDiffs(markerDiffs)}},{key:"_makeMarkerDiffs",value:function _makeMarkerDiffs(newContent){var markerList=this.markerList,self=this,markerDiffs={};this._forEachChanges(newContent,function(changedStart,changedEnd,diffLen){markerList.forEachByRangeAffected(changedStart,changedEnd,function(marker){var markerDiff=markerDiffs[marker.id];var startDiff=self._calculateStartDiff(changedStart,changedEnd,diffLen,marker);var endDiff=self._calculateEndDiff(changedStart,changedEnd,diffLen,marker);if(markerDiff){markerDiff.start+=startDiff;markerDiff.end+=endDiff}else{markerDiffs[marker.id]={start:startDiff,end:endDiff}}})});return markerDiffs}},{key:"_forEachChanges",value:function _forEachChanges(newContent,iteratee){var changedStart=0;var changedEnd=0;var changes=this._dmp.diff_main(this.oldTextContent,newContent);changes.forEach(function(change){var type=change[0];var text=change[1];var diffLen=0;var changedLen=text.length;changedStart=changedEnd;if(type===CHANGE_NOTHING){changedStart+=changedLen;changedEnd+=changedLen;return}if(type===CHANGE_ADD){diffLen+=changedLen}else if(type===CHANGE_MINUS){diffLen-=changedLen;changedEnd+=changedLen}iteratee(changedStart,changedEnd,diffLen)})}},{key:"_calculateStartDiff",value:function _calculateStartDiff(start,end,diff,marker){var startDiff=void 0;if(start<=marker.start&&end<=marker.start){startDiff=diff}else if(start<=marker.start&&end>marker.start){startDiff=start-marker.start}else{startDiff=0}return startDiff}},{key:"_calculateEndDiff",value:function _calculateEndDiff(start,end,diff,marker){var endDiff=void 0;if(end<=marker.end){endDiff=diff}else if(start<=marker.end&&end>marker.start){endDiff=start-marker.end}else{endDiff=0}return endDiff}},{key:"_getUpdateMarkersWithDiffs",value:function _getUpdateMarkersWithDiffs(markerDiffs){var updatedMarkers=[],markerList=this.markerList;util.forEachOwnProperties(markerDiffs,function(markerDiff,id){var marker=markerList.getMarker(id);markerList.updateMarker(id,{start:marker.start+=markerDiff.start,end:marker.end+=markerDiff.end});updatedMarkers.push(marker)});return updatedMarkers}}]);return MarkerManager}();module.exports=MarkerManager},function(module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=.5;this.Match_Distance=1e3;this.Patch_DeleteThreshold=.5;this.Patch_Margin=4;this.Match_MaxBits=32}var DIFF_DELETE=-1;var DIFF_INSERT=1;var DIFF_EQUAL=0;diff_match_patch.Diff;diff_match_patch.prototype.diff_main=function(text1,text2,opt_checklines,opt_deadline){if(typeof opt_deadline=="undefined"){if(this.Diff_Timeout<=0){opt_deadline=Number.MAX_VALUE}else{opt_deadline=(new Date).getTime()+this.Diff_Timeout*1e3}}var deadline=opt_deadline;if(text1==null||text2==null){throw new Error("Null input. (diff_main)")}if(text1==text2){if(text1){return[[DIFF_EQUAL,text1]]}return[]}if(typeof opt_checklines=="undefined"){opt_checklines=true}var checklines=opt_checklines;var commonlength=this.diff_commonPrefix(text1,text2);var commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength);text2=text2.substring(commonlength);commonlength=this.diff_commonSuffix(text1,text2);var commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength);text2=text2.substring(0,text2.length-commonlength);var diffs=this.diff_compute_(text1,text2,checklines,deadline);if(commonprefix){diffs.unshift([DIFF_EQUAL,commonprefix])}if(commonsuffix){diffs.push([DIFF_EQUAL,commonsuffix])}this.diff_cleanupMerge(diffs);return diffs};diff_match_patch.prototype.diff_compute_=function(text1,text2,checklines,deadline){var diffs;if(!text1){return[[DIFF_INSERT,text2]]}if(!text2){return[[DIFF_DELETE,text1]]}var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;var i=longtext.indexOf(shorttext);if(i!=-1){diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]];if(text1.length>text2.length){diffs[0][0]=diffs[2][0]=DIFF_DELETE}return diffs}if(shorttext.length==1){return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]}var hm=this.diff_halfMatch_(text1,text2);if(hm){var text1_a=hm[0];var text1_b=hm[1];var text2_a=hm[2];var text2_b=hm[3];var mid_common=hm[4];var diffs_a=this.diff_main(text1_a,text2_a,checklines,deadline);var diffs_b=this.diff_main(text1_b,text2_b,checklines,deadline);return diffs_a.concat([[DIFF_EQUAL,mid_common]],diffs_b)}if(checklines&&text1.length>100&&text2.length>100){return this.diff_lineMode_(text1,text2,deadline)}return this.diff_bisect_(text1,text2,deadline)};diff_match_patch.prototype.diff_lineMode_=function(text1,text2,deadline){var a=this.diff_linesToChars_(text1,text2);text1=a.chars1;text2=a.chars2;var linearray=a.lineArray;var diffs=this.diff_main(text1,text2,false,deadline);this.diff_charsToLines_(diffs,linearray);this.diff_cleanupSemantic(diffs);diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];break;case DIFF_EQUAL:if(count_delete>=1&&count_insert>=1){diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert);pointer=pointer-count_delete-count_insert;var a=this.diff_main(text_delete,text_insert,false,deadline);for(var j=a.length-1;j>=0;j--){diffs.splice(pointer,0,a[j])}pointer=pointer+a.length}count_insert=0;count_delete=0;text_delete="";text_insert="";break}pointer++}diffs.pop();return diffs};diff_match_patch.prototype.diff_bisect_=function(text1,text2,deadline){var text1_length=text1.length;var text2_length=text2.length;var max_d=Math.ceil((text1_length+text2_length)/2);var v_offset=max_d;var v_length=2*max_d;var v1=new Array(v_length);var v2=new Array(v_length);for(var x=0;x<v_length;x++){v1[x]=-1;v2[x]=-1}v1[v_offset+1]=0;v2[v_offset+1]=0;var delta=text1_length-text2_length;var front=delta%2!=0;var k1start=0;var k1end=0;var k2start=0
;var k2end=0;for(var d=0;d<max_d;d++){if((new Date).getTime()>deadline){break}for(var k1=-d+k1start;k1<=d-k1end;k1+=2){var k1_offset=v_offset+k1;var x1;if(k1==-d||k1!=d&&v1[k1_offset-1]<v1[k1_offset+1]){x1=v1[k1_offset+1]}else{x1=v1[k1_offset-1]+1}var y1=x1-k1;while(x1<text1_length&&y1<text2_length&&text1.charAt(x1)==text2.charAt(y1)){x1++;y1++}v1[k1_offset]=x1;if(x1>text1_length){k1end+=2}else if(y1>text2_length){k1start+=2}else if(front){var k2_offset=v_offset+delta-k1;if(k2_offset>=0&&k2_offset<v_length&&v2[k2_offset]!=-1){var x2=text1_length-v2[k2_offset];if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}}for(var k2=-d+k2start;k2<=d-k2end;k2+=2){var k2_offset=v_offset+k2;var x2;if(k2==-d||k2!=d&&v2[k2_offset-1]<v2[k2_offset+1]){x2=v2[k2_offset+1]}else{x2=v2[k2_offset-1]+1}var y2=x2-k2;while(x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)==text2.charAt(text2_length-y2-1)){x2++;y2++}v2[k2_offset]=x2;if(x2>text1_length){k2end+=2}else if(y2>text2_length){k2start+=2}else if(!front){var k1_offset=v_offset+delta-k2;if(k1_offset>=0&&k1_offset<v_length&&v1[k1_offset]!=-1){var x1=v1[k1_offset];var y1=v_offset+x1-k1_offset;x2=text1_length-x2;if(x1>=x2){return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}}}return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]};diff_match_patch.prototype.diff_bisectSplit_=function(text1,text2,x,y,deadline){var text1a=text1.substring(0,x);var text2a=text2.substring(0,y);var text1b=text1.substring(x);var text2b=text2.substring(y);var diffs=this.diff_main(text1a,text2a,false,deadline);var diffsb=this.diff_main(text1b,text2b,false,deadline);return diffs.concat(diffsb)};diff_match_patch.prototype.diff_linesToChars_=function(text1,text2){var lineArray=[];var lineHash={};lineArray[0]="";function diff_linesToCharsMunge_(text){var chars="";var lineStart=0;var lineEnd=-1;var lineArrayLength=lineArray.length;while(lineEnd<text.length-1){lineEnd=text.indexOf("\n",lineStart);if(lineEnd==-1){lineEnd=text.length-1}var line=text.substring(lineStart,lineEnd+1);lineStart=lineEnd+1;if(lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):lineHash[line]!==undefined){chars+=String.fromCharCode(lineHash[line])}else{chars+=String.fromCharCode(lineArrayLength);lineHash[line]=lineArrayLength;lineArray[lineArrayLength++]=line}}return chars}var chars1=diff_linesToCharsMunge_(text1);var chars2=diff_linesToCharsMunge_(text2);return{chars1:chars1,chars2:chars2,lineArray:lineArray}};diff_match_patch.prototype.diff_charsToLines_=function(diffs,lineArray){for(var x=0;x<diffs.length;x++){var chars=diffs[x][1];var text=[];for(var y=0;y<chars.length;y++){text[y]=lineArray[chars.charCodeAt(y)]}diffs[x][1]=text.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(text1,text2){if(!text1||!text2||text1.charAt(0)!=text2.charAt(0)){return 0}var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerstart=0;while(pointermin<pointermid){if(text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)){pointermin=pointermid;pointerstart=pointermin}else{pointermax=pointermid}pointermid=Math.floor((pointermax-pointermin)/2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonSuffix=function(text1,text2){if(!text1||!text2||text1.charAt(text1.length-1)!=text2.charAt(text2.length-1)){return 0}var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerend=0;while(pointermin<pointermid){if(text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)){pointermin=pointermid;pointerend=pointermin}else{pointermax=pointermid}pointermid=Math.floor((pointermax-pointermin)/2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonOverlap_=function(text1,text2){var text1_length=text1.length;var text2_length=text2.length;if(text1_length==0||text2_length==0){return 0}if(text1_length>text2_length){text1=text1.substring(text1_length-text2_length)}else if(text1_length<text2_length){text2=text2.substring(0,text1_length)}var text_length=Math.min(text1_length,text2_length);if(text1==text2){return text_length}var best=0;var length=1;while(true){var pattern=text1.substring(text_length-length);var found=text2.indexOf(pattern);if(found==-1){return best}length+=found;if(found==0||text1.substring(text_length-length)==text2.substring(0,length)){best=length;length++}}};diff_match_patch.prototype.diff_halfMatch_=function(text1,text2){if(this.Diff_Timeout<=0){return null}var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||shorttext.length*2<longtext.length){return null}var dmp=this;function diff_halfMatchI_(longtext,shorttext,i){var seed=longtext.substring(i,i+Math.floor(longtext.length/4));var j=-1;var best_common="";var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b;while((j=shorttext.indexOf(seed,j+1))!=-1){var prefixLength=dmp.diff_commonPrefix(longtext.substring(i),shorttext.substring(j));var suffixLength=dmp.diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));if(best_common.length<suffixLength+prefixLength){best_common=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength);best_longtext_a=longtext.substring(0,i-suffixLength);best_longtext_b=longtext.substring(i+prefixLength);best_shorttext_a=shorttext.substring(0,j-suffixLength);best_shorttext_b=shorttext.substring(j+prefixLength)}}if(best_common.length*2>=longtext.length){return[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common]}else{return null}}var hm1=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/4));var hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));var hm;if(!hm1&&!hm2){return null}else if(!hm2){hm=hm1}else if(!hm1){hm=hm2}else{hm=hm1[4].length>hm2[4].length?hm1:hm2}var text1_a,text1_b,text2_a,text2_b;if(text1.length>text2.length){text1_a=hm[0];text1_b=hm[1];text2_a=hm[2];text2_b=hm[3]}else{text2_a=hm[0];text2_b=hm[1];text1_a=hm[2];text1_b=hm[3]}var mid_common=hm[4];return[text1_a,text1_b,text2_a,text2_b,mid_common]};diff_match_patch.prototype.diff_cleanupSemantic=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var length_insertions1=0;var length_deletions1=0;var length_insertions2=0;var length_deletions2=0;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){equalities[equalitiesLength++]=pointer;length_insertions1=length_insertions2;length_deletions1=length_deletions2;length_insertions2=0;length_deletions2=0;lastequality=diffs[pointer][1]}else{if(diffs[pointer][0]==DIFF_INSERT){length_insertions2+=diffs[pointer][1].length}else{length_deletions2+=diffs[pointer][1].length}if(lastequality&&lastequality.length<=Math.max(length_insertions1,length_deletions1)&&lastequality.length<=Math.max(length_insertions2,length_deletions2)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;length_insertions1=0;length_deletions1=0;length_insertions2=0;length_deletions2=0;lastequality=null;changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}this.diff_cleanupSemanticLossless(diffs);pointer=1;while(pointer<diffs.length){if(diffs[pointer-1][0]==DIFF_DELETE&&diffs[pointer][0]==DIFF_INSERT){var deletion=diffs[pointer-1][1];var insertion=diffs[pointer][1];var overlap_length1=this.diff_commonOverlap_(deletion,insertion);var overlap_length2=this.diff_commonOverlap_(insertion,deletion);if(overlap_length1>=overlap_length2){if(overlap_length1>=deletion.length/2||overlap_length1>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlap_length1)]);diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1);diffs[pointer+1][1]=insertion.substring(overlap_length1);pointer++}}else{if(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlap_length2)]);diffs[pointer-1][0]=DIFF_INSERT;diffs[pointer-1][1]=insertion.substring(0,insertion.length-overlap_length2);diffs[pointer+1][0]=DIFF_DELETE;diffs[pointer+1][1]=deletion.substring(overlap_length2);pointer++}}pointer++}pointer++}};diff_match_patch.prototype.diff_cleanupSemanticLossless=function(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two){return 6}var char1=one.charAt(one.length-1);var char2=two.charAt(0);var nonAlphaNumeric1=char1.match(diff_match_patch.nonAlphaNumericRegex_);var nonAlphaNumeric2=char2.match(diff_match_patch.nonAlphaNumericRegex_);var whitespace1=nonAlphaNumeric1&&char1.match(diff_match_patch.whitespaceRegex_);var whitespace2=nonAlphaNumeric2&&char2.match(diff_match_patch.whitespaceRegex_);var lineBreak1=whitespace1&&char1.match(diff_match_patch.linebreakRegex_);var lineBreak2=whitespace2&&char2.match(diff_match_patch.linebreakRegex_);var blankLine1=lineBreak1&&one.match(diff_match_patch.blanklineEndRegex_);var blankLine2=lineBreak2&&two.match(diff_match_patch.blanklineStartRegex_);if(blankLine1||blankLine2){return 5}else if(lineBreak1||lineBreak2){return 4}else if(nonAlphaNumeric1&&!whitespace1&&whitespace2){return 3}else if(whitespace1||whitespace2){return 2}else if(nonAlphaNumeric1||nonAlphaNumeric2){return 1}return 0}var pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){var equality1=diffs[pointer-1][1];var edit=diffs[pointer][1];var equality2=diffs[pointer+1][1];var commonOffset=this.diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset);edit=commonString+edit.substring(0,edit.length-commonOffset);equality2=commonString+equality2}var bestEquality1=equality1;var bestEdit=edit;var bestEquality2=equality2;var bestScore=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);while(edit.charAt(0)===equality2.charAt(0)){equality1+=edit.charAt(0);edit=edit.substring(1)+equality2.charAt(0);equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);if(score>=bestScore){bestScore=score;bestEquality1=equality1;bestEdit=edit;bestEquality2=equality2}}if(diffs[pointer-1][1]!=bestEquality1){if(bestEquality1){diffs[pointer-1][1]=bestEquality1}else{diffs.splice(pointer-1,1);pointer--}diffs[pointer][1]=bestEdit;if(bestEquality2){diffs[pointer+1][1]=bestEquality2}else{diffs.splice(pointer+1,1);pointer--}}}pointer++}};diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;diff_match_patch.whitespaceRegex_=/\s/;diff_match_patch.linebreakRegex_=/[\r\n]/;diff_match_patch.blanklineEndRegex_=/\n\r?\n$/;diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/;diff_match_patch.prototype.diff_cleanupEfficiency=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var pre_ins=false;var pre_del=false;var post_ins=false;var post_del=false;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){if(diffs[pointer][1].length<this.Diff_EditCost&&(post_ins||post_del)){equalities[equalitiesLength++]=pointer;pre_ins=post_ins;pre_del=post_del;lastequality=diffs[pointer][1]}else{equalitiesLength=0;lastequality=null}post_ins=post_del=false}else{if(diffs[pointer][0]==DIFF_DELETE){post_del=true}else{post_ins=true}if(lastequality&&(pre_ins&&pre_del&&post_ins&&post_del||lastequality.length<this.Diff_EditCost/2&&pre_ins+pre_del+post_ins+post_del==3)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;lastequality=null;if(pre_ins&&pre_del){post_ins=post_del=true;equalitiesLength=0}else{equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;post_ins=post_del=false}changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}};diff_match_patch.prototype.diff_cleanupMerge=function(diffs){diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";var commonlength;while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];pointer++;break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];pointer++;break;case DIFF_EQUAL:if(count_delete+count_insert>1){if(count_delete!==0&&count_insert!==0){commonlength=this.diff_commonPrefix(text_insert,text_delete);if(commonlength!==0){if(pointer-count_delete-count_insert>0&&diffs[pointer-count_delete-count_insert-1][0]==DIFF_EQUAL){diffs[pointer-count_delete-count_insert-1][1]+=text_insert.substring(0,commonlength)}else{diffs.splice(0,0,[DIFF_EQUAL,text_insert.substring(0,commonlength)]);pointer++}text_insert=text_insert.substring(commonlength);text_delete=text_delete.substring(commonlength)}commonlength=this.diff_commonSuffix(text_insert,text_delete);if(commonlength!==0){diffs[pointer][1]=text_insert.substring(text_insert.length-commonlength)+diffs[pointer][1];text_insert=text_insert.substring(0,text_insert.length-commonlength);text_delete=text_delete.substring(0,text_delete.length-commonlength)}}if(count_delete===0){diffs.splice(pointer-count_insert,count_delete+count_insert,[DIFF_INSERT,text_insert])}else if(count_insert===0){diffs.splice(pointer-count_delete,count_delete+count_insert,[DIFF_DELETE,text_delete])}else{diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert,[DIFF_DELETE,text_delete],[DIFF_INSERT,text_insert])}pointer=pointer-count_delete-count_insert+(count_delete?1:0)+(count_insert?1:0)+1}else if(pointer!==0&&diffs[pointer-1][0]==DIFF_EQUAL){diffs[pointer-1][1]+=diffs[pointer][1];diffs.splice(pointer,1)}else{pointer++}count_insert=0;count_delete=0;text_delete="";text_insert="";break}}if(diffs[diffs.length-1][1]===""){diffs.pop()}var changes=false;pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){if(diffs[pointer][1].substring(diffs[pointer][1].length-diffs[pointer-1][1].length)==diffs[pointer-1][1]){diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length);diffs[pointer+1][1]=diffs[pointer-1][1]+diffs[pointer+1][1];diffs.splice(pointer-1,1);changes=true}else if(diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]){diffs[pointer-1][1]+=diffs[pointer+1][1];diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1];diffs.splice(pointer+1,1);changes=true}}pointer++}if(changes){this.diff_cleanupMerge(diffs)}};diff_match_patch.prototype.diff_xIndex=function(diffs,loc){var chars1=0;var chars2=0;var last_chars1=0;var last_chars2=0;var x;for(x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){chars1+=diffs[x][1].length}if(diffs[x][0]!==DIFF_DELETE){chars2+=diffs[x][1].length}if(chars1>loc){break}last_chars1=chars1;last_chars2=chars2}if(diffs.length!=x&&diffs[x][0]===DIFF_DELETE){return last_chars2}return last_chars2+(loc-last_chars1)};diff_match_patch.prototype.diff_prettyHtml=function(diffs){var html=[];var pattern_amp=/&/g;var pattern_lt=/</g;var pattern_gt=/>/g;var pattern_para=/\n/g;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];var text=data.replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"&para;<br>");switch(op){case DIFF_INSERT:html[x]='<ins style="background:#e6ffe6;">'+text+"</ins>";break;case DIFF_DELETE:html[x]='<del style="background:#ffe6e6;">'+text+"</del>";break;case DIFF_EQUAL:html[x]="<span>"+text+"</span>";break}}return html.join("")};diff_match_patch.prototype.diff_text1=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT){text[x]=diffs[x][1]}}return text.join("")};diff_match_patch.prototype.diff_text2=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_DELETE){text[x]=diffs[x][1]}}return text.join("")};diff_match_patch.prototype.diff_levenshtein=function(diffs){var levenshtein=0;var insertions=0;var deletions=0;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];switch(op){case DIFF_INSERT:insertions+=data.length;break;case DIFF_DELETE:deletions+=data.length;break;case DIFF_EQUAL:levenshtein+=Math.max(insertions,deletions);insertions=0;deletions=0;break}}levenshtein+=Math.max(insertions,deletions);return levenshtein};diff_match_patch.prototype.diff_toDelta=function(diffs){var text=[];for(var x=0;x<diffs.length;x++){switch(diffs[x][0]){case DIFF_INSERT:text[x]="+"+encodeURI(diffs[x][1]);break;case DIFF_DELETE:text[x]="-"+diffs[x][1].length;break;case DIFF_EQUAL:text[x]="="+diffs[x][1].length;break}}return text.join("\t").replace(/%20/g," ")};diff_match_patch.prototype.diff_fromDelta=function(text1,delta){var diffs=[];var diffsLength=0;var pointer=0;var tokens=delta.split(/\t/g);for(var x=0;x<tokens.length;x++){var param=tokens[x].substring(1);switch(tokens[x].charAt(0)){case"+":try{diffs[diffsLength++]=[DIFF_INSERT,decodeURI(param)]}catch(ex){throw new Error("Illegal escape in diff_fromDelta: "+param)}break;case"-":case"=":var n=parseInt(param,10);if(isNaN(n)||n<0){throw new Error("Invalid number in diff_fromDelta: "+param)}var text=text1.substring(pointer,pointer+=n);if(tokens[x].charAt(0)=="="){diffs[diffsLength++]=[DIFF_EQUAL,text]}else{diffs[diffsLength++]=[DIFF_DELETE,text]}break;default:if(tokens[x]){throw new Error("Invalid diff operation in diff_fromDelta: "+tokens[x])}}}if(pointer!=text1.length){throw new Error("Delta length ("+pointer+") does not equal source text length ("+text1.length+").")}return diffs};diff_match_patch.prototype.match_main=function(text,pattern,loc){if(text==null||pattern==null||loc==null){throw new Error("Null input. (match_main)")}loc=Math.max(0,Math.min(loc,text.length));if(text==pattern){return 0}else if(!text.length){return-1}else if(text.substring(loc,loc+pattern.length)==pattern){return loc}else{return this.match_bitap_(text,pattern,loc)}};diff_match_patch.prototype.match_bitap_=function(text,pattern,loc){if(pattern.length>this.Match_MaxBits){throw new Error("Pattern too long for this browser.")}var s=this.match_alphabet_(pattern);var dmp=this;function match_bitapScore_(e,x){var accuracy=e/pattern.length;var proximity=Math.abs(loc-x);if(!dmp.Match_Distance){return proximity?1:accuracy}return accuracy+proximity/dmp.Match_Distance}var score_threshold=this.Match_Threshold;var best_loc=text.indexOf(pattern,loc);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold);best_loc=text.lastIndexOf(pattern,loc+pattern.length);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold)}}var matchmask=1<<pattern.length-1;best_loc=-1;var bin_min,bin_mid;var bin_max=pattern.length+text.length;var last_rd;for(var d=0;d<pattern.length;d++){bin_min=0;bin_mid=bin_max;while(bin_min<bin_mid){if(match_bitapScore_(d,loc+bin_mid)<=score_threshold){bin_min=bin_mid}else{bin_max=bin_mid}bin_mid=Math.floor((bin_max-bin_min)/2+bin_min)}bin_max=bin_mid;var start=Math.max(1,loc-bin_mid+1);var finish=Math.min(loc+bin_mid,text.length)+pattern.length;var rd=Array(finish+2);rd[finish+1]=(1<<d)-1;for(var j=finish;j>=start;j--){var charMatch=s[text.charAt(j-1)];if(d===0){rd[j]=(rd[j+1]<<1|1)&charMatch}else{rd[j]=(rd[j+1]<<1|1)&charMatch|((last_rd[j+1]|last_rd[j])<<1|1)|last_rd[j+1]}if(rd[j]&matchmask){var score=match_bitapScore_(d,j-1);if(score<=score_threshold){score_threshold=score;best_loc=j-1;if(best_loc>loc){start=Math.max(1,2*loc-best_loc)}else{break}}}}if(match_bitapScore_(d+1,loc)>score_threshold){break}last_rd=rd}return best_loc};diff_match_patch.prototype.match_alphabet_=function(pattern){var s={};for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]=0}for(var i=0;i<pattern.length;i++){s[pattern.charAt(i)]|=1<<pattern.length-i-1}return s};diff_match_patch.prototype.patch_addContext_=function(patch,text){if(text.length==0){return}var pattern=text.substring(patch.start2,patch.start2+patch.length1);var padding=0;while(text.indexOf(pattern)!=text.lastIndexOf(pattern)&&pattern.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin){padding+=this.Patch_Margin;pattern=text.substring(patch.start2-padding,patch.start2+patch.length1+padding)}padding+=this.Patch_Margin;var prefix=text.substring(patch.start2-padding,patch.start2);if(prefix){patch.diffs.unshift([DIFF_EQUAL,prefix])}var suffix=text.substring(patch.start2+patch.length1,patch.start2+patch.length1+padding);if(suffix){patch.diffs.push([DIFF_EQUAL,suffix])}patch.start1-=prefix.length;patch.start2-=prefix.length;patch.length1+=prefix.length+suffix.length;patch.length2+=prefix.length+suffix.length};diff_match_patch.prototype.patch_make=function(a,opt_b,opt_c){var text1,diffs;if(typeof a=="string"&&typeof opt_b=="string"&&typeof opt_c=="undefined"){text1=a;diffs=this.diff_main(text1,opt_b,true);if(diffs.length>2){this.diff_cleanupSemantic(diffs);this.diff_cleanupEfficiency(diffs)}}else if(a&&(typeof a==="undefined"?"undefined":_typeof(a))=="object"&&typeof opt_b=="undefined"&&typeof opt_c=="undefined"){diffs=a;text1=this.diff_text1(diffs)}else if(typeof a=="string"&&opt_b&&(typeof opt_b==="undefined"?"undefined":_typeof(opt_b))=="object"&&typeof opt_c=="undefined"){text1=a;diffs=opt_b}else if(typeof a=="string"&&typeof opt_b=="string"&&opt_c&&(typeof opt_c==="undefined"?"undefined":_typeof(opt_c))=="object"){text1=a;diffs=opt_c}else{throw new Error("Unknown call format to patch_make.")}if(diffs.length===0){return[]}var patches=[];var patch=new diff_match_patch.patch_obj;var patchDiffLength=0;var char_count1=0;var char_count2=0;var prepatch_text=text1;var postpatch_text=text1;for(var x=0;x<diffs.length;x++){var diff_type=diffs[x][0];var diff_text=diffs[x][1];if(!patchDiffLength&&diff_type!==DIFF_EQUAL){patch.start1=char_count1;patch.start2=char_count2}switch(diff_type){case DIFF_INSERT:patch.diffs[patchDiffLength++]=diffs[x];patch.length2+=diff_text.length;postpatch_text=postpatch_text.substring(0,char_count2)+diff_text+postpatch_text.substring(char_count2);break;case DIFF_DELETE:patch.length1+=diff_text.length;patch.diffs[patchDiffLength++]=diffs[x];postpatch_text=postpatch_text.substring(0,char_count2)+postpatch_text.substring(char_count2+diff_text.length);break;case DIFF_EQUAL:if(diff_text.length<=2*this.Patch_Margin&&patchDiffLength&&diffs.length!=x+1){patch.diffs[patchDiffLength++]=diffs[x];patch.length1+=diff_text.length;patch.length2+=diff_text.length}else if(diff_text.length>=2*this.Patch_Margin){if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch);patch=new diff_match_patch.patch_obj;patchDiffLength=0;prepatch_text=postpatch_text;char_count1=char_count2}}break}if(diff_type!==DIFF_INSERT){char_count1+=diff_text.length}if(diff_type!==DIFF_DELETE){char_count2+=diff_text.length}}if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch)}return patches};diff_match_patch.prototype.patch_deepCopy=function(patches){var patchesCopy=[];for(var x=0;x<patches.length;x++){var patch=patches[x];var patchCopy=new diff_match_patch.patch_obj;patchCopy.diffs=[];for(var y=0;y<patch.diffs.length;y++){patchCopy.diffs[y]=patch.diffs[y].slice()}patchCopy.start1=patch.start1;patchCopy.start2=patch.start2;patchCopy.length1=patch.length1;patchCopy.length2=patch.length2;patchesCopy[x]=patchCopy}return patchesCopy};diff_match_patch.prototype.patch_apply=function(patches,text){if(patches.length==0){return[text,[]]}patches=this.patch_deepCopy(patches);var nullPadding=this.patch_addPadding(patches);text=nullPadding+text+nullPadding;this.patch_splitMax(patches);var delta=0;var results=[];for(var x=0;x<patches.length;x++){var expected_loc=patches[x].start2+delta;var text1=this.diff_text1(patches[x].diffs);var start_loc;var end_loc=-1;if(text1.length>this.Match_MaxBits){start_loc=this.match_main(text,text1.substring(0,this.Match_MaxBits),expected_loc);if(start_loc!=-1){end_loc=this.match_main(text,text1.substring(text1.length-this.Match_MaxBits),expected_loc+text1.length-this.Match_MaxBits);if(end_loc==-1||start_loc>=end_loc){start_loc=-1}}}else{start_loc=this.match_main(text,text1,expected_loc)}if(start_loc==-1){results[x]=false;delta-=patches[x].length2-patches[x].length1}else{results[x]=true;delta=start_loc-expected_loc;var text2;if(end_loc==-1){text2=text.substring(start_loc,start_loc+text1.length)}else{text2=text.substring(start_loc,end_loc+this.Match_MaxBits)}if(text1==text2){text=text.substring(0,start_loc)+this.diff_text2(patches[x].diffs)+text.substring(start_loc+text1.length)}else{var diffs=this.diff_main(text1,text2,false);if(text1.length>this.Match_MaxBits&&this.diff_levenshtein(diffs)/text1.length>this.Patch_DeleteThreshold){results[x]=false}else{this.diff_cleanupSemanticLossless(diffs);var index1=0;var index2;for(var y=0;y<patches[x].diffs.length;y++){var mod=patches[x].diffs[y];if(mod[0]!==DIFF_EQUAL){index2=this.diff_xIndex(diffs,index1)}if(mod[0]===DIFF_INSERT){text=text.substring(0,start_loc+index2)+mod[1]+text.substring(start_loc+index2)}else if(mod[0]===DIFF_DELETE){text=text.substring(0,start_loc+index2)+text.substring(start_loc+this.diff_xIndex(diffs,index1+mod[1].length))}if(mod[0]!==DIFF_DELETE){index1+=mod[1].length}}}}}}text=text.substring(nullPadding.length,text.length-nullPadding.length);return[text,results]};diff_match_patch.prototype.patch_addPadding=function(patches){var paddingLength=this.Patch_Margin;var nullPadding="";for(var x=1;x<=paddingLength;x++){nullPadding+=String.fromCharCode(x)}for(var x=0;x<patches.length;x++){patches[x].start1+=paddingLength;patches[x].start2+=paddingLength}var patch=patches[0];var diffs=patch.diffs;if(diffs.length==0||diffs[0][0]!=DIFF_EQUAL){diffs.unshift([DIFF_EQUAL,nullPadding]);patch.start1-=paddingLength;patch.start2-=paddingLength;patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[0][1].length){var extraLength=paddingLength-diffs[0][1].length;diffs[0][1]=nullPadding.substring(diffs[0][1].length)+diffs[0][1];patch.start1-=extraLength;patch.start2-=extraLength;patch.length1+=extraLength;patch.length2+=extraLength}patch=patches[patches.length-1];diffs=patch.diffs;if(diffs.length==0||diffs[diffs.length-1][0]!=DIFF_EQUAL){diffs.push([DIFF_EQUAL,nullPadding]);patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[diffs.length-1][1].length){var extraLength=paddingLength-diffs[diffs.length-1][1].length;diffs[diffs.length-1][1]+=nullPadding.substring(0,extraLength);patch.length1+=extraLength;patch.length2+=extraLength}return nullPadding};diff_match_patch.prototype.patch_splitMax=function(patches){var patch_size=this.Match_MaxBits;for(var x=0;x<patches.length;x++){if(patches[x].length1<=patch_size){continue}var bigpatch=patches[x];patches.splice(x--,1);var start1=bigpatch.start1;var start2=bigpatch.start2;var precontext="";while(bigpatch.diffs.length!==0){var patch=new diff_match_patch.patch_obj;var empty=true;patch.start1=start1-precontext.length;patch.start2=start2-precontext.length;if(precontext!==""){patch.length1=patch.length2=precontext.length;patch.diffs.push([DIFF_EQUAL,precontext])}while(bigpatch.diffs.length!==0&&patch.length1<patch_size-this.Patch_Margin){var diff_type=bigpatch.diffs[0][0];var diff_text=bigpatch.diffs[0][1];if(diff_type===DIFF_INSERT){patch.length2+=diff_text.length;start2+=diff_text.length;patch.diffs.push(bigpatch.diffs.shift());empty=false}else if(diff_type===DIFF_DELETE&&patch.diffs.length==1&&patch.diffs[0][0]==DIFF_EQUAL&&diff_text.length>2*patch_size){patch.length1+=diff_text.length;start1+=diff_text.length;empty=false;patch.diffs.push([diff_type,diff_text]);bigpatch.diffs.shift()}else{diff_text=diff_text.substring(0,patch_size-patch.length1-this.Patch_Margin);patch.length1+=diff_text.length;start1+=diff_text.length;if(diff_type===DIFF_EQUAL){patch.length2+=diff_text.length;start2+=diff_text.length}else{empty=false}patch.diffs.push([diff_type,diff_text]);if(diff_text==bigpatch.diffs[0][1]){bigpatch.diffs.shift()}else{bigpatch.diffs[0][1]=bigpatch.diffs[0][1].substring(diff_text.length)}}}precontext=this.diff_text2(patch.diffs);precontext=precontext.substring(precontext.length-this.Patch_Margin);var postcontext=this.diff_text1(bigpatch.diffs).substring(0,this.Patch_Margin);if(postcontext!==""){patch.length1+=postcontext.length;patch.length2+=postcontext.length;if(patch.diffs.length!==0&&patch.diffs[patch.diffs.length-1][0]===DIFF_EQUAL){patch.diffs[patch.diffs.length-1][1]+=postcontext}else{patch.diffs.push([DIFF_EQUAL,postcontext])}}if(!empty){patches.splice(++x,0,patch)}}}};diff_match_patch.prototype.patch_toText=function(patches){var text=[];for(var x=0;x<patches.length;x++){text[x]=patches[x]}return text.join("")};diff_match_patch.prototype.patch_fromText=function(textline){var patches=[];if(!textline){return patches}var text=textline.split("\n");var textPointer=0;var patchHeader=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;while(textPointer<text.length){var m=text[textPointer].match(patchHeader);if(!m){throw new Error("Invalid patch string: "+text[textPointer])}var patch=new diff_match_patch.patch_obj;patches.push(patch);patch.start1=parseInt(m[1],10);if(m[2]===""){patch.start1--;patch.length1=1}else if(m[2]=="0"){patch.length1=0}else{patch.start1--;patch.length1=parseInt(m[2],10)}patch.start2=parseInt(m[3],10);if(m[4]===""){patch.start2--;patch.length2=1}else if(m[4]=="0"){patch.length2=0}else{patch.start2--;patch.length2=parseInt(m[4],10)}textPointer++;while(textPointer<text.length){var sign=text[textPointer].charAt(0);try{var line=decodeURI(text[textPointer].substring(1))}catch(ex){throw new Error("Illegal escape in patch_fromText: "+line)}if(sign=="-"){patch.diffs.push([DIFF_DELETE,line])}else if(sign=="+"){patch.diffs.push([DIFF_INSERT,line])}else if(sign==" "){patch.diffs.push([DIFF_EQUAL,line])}else if(sign=="@"){break}else if(sign===""){}else{throw new Error('Invalid patch mode "'+sign+'" in: '+line)}textPointer++}}return patches};diff_match_patch.patch_obj=function(){this.diffs=[];this.start1=null;this.start2=null;this.length1=0;this.length2=0};diff_match_patch.patch_obj.prototype.toString=function(){var coords1,coords2;if(this.length1===0){coords1=this.start1+",0"}else if(this.length1==1){coords1=this.start1+1}else{coords1=this.start1+1+","+this.length1}if(this.length2===0){coords2=this.start2+",0"}else if(this.length2==1){coords2=this.start2+1}else{coords2=this.start2+1+","+this.length2}var text=["@@ -"+coords1+" +"+coords2+" @@\n"];var op;for(var x=0;x<this.diffs.length;x++){switch(this.diffs[x][0]){case DIFF_INSERT:op="+";break;case DIFF_DELETE:op="-";break;case DIFF_EQUAL:op=" ";break}text[x+1]=op+encodeURI(this.diffs[x][1])+"\n"}return text.join("").replace(/%20/g," ")};module.exports=diff_match_patch},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var domUtils=__webpack_require__(11);var FIND_ZWB_RX=/\u200B/g;var WysiwygMarkerHelper=function(){function WysiwygMarkerHelper(sqe){_classCallCheck(this,WysiwygMarkerHelper);this.sqe=sqe}
_createClass(WysiwygMarkerHelper,[{key:"getTextContent",value:function getTextContent(){return this.sqe.get$Body()[0].textContent.replace(FIND_ZWB_RX,"")}},{key:"updateMarkerWithExtraInfo",value:function updateMarkerWithExtraInfo(marker){var foundNode=this._findOffsetNode([marker.start,marker.end]);var markerRange=this.sqe.getSelection().cloneRange();markerRange.setStart(foundNode[0].container,foundNode[0].offsetInContainer);markerRange.setEnd(foundNode[1].container,foundNode[1].offsetInContainer);var info=this._getExtraInfoOfRange(markerRange);marker.text=info.text;marker.top=info.top;marker.left=info.left;marker.height=info.height;return marker}},{key:"_getExtraInfoOfRange",value:function _getExtraInfoOfRange(range){var top=void 0,left=void 0,rect=void 0,height=void 0,node=void 0,parentNode=void 0,containerOffset=void 0;var endContainer=range.endContainer;var endOffset=range.endOffset;var text=range.cloneContents().textContent.replace(FIND_ZWB_RX,"");if(domUtils.getChildNodeByOffset(endContainer,endOffset)){range.setStart(endContainer,endOffset);range.collapse(true);rect=range.getBoundingClientRect()}if(rect&&!rect.top){this.sqe.modifyDocument(function(){node=document.createElement("SPAN");node.textContent="​";range.endContainer.parentNode.insertBefore(node,range.endContainer);rect=node.getBoundingClientRect();parentNode=node.parentNode;parentNode.removeChild(node)})}if(rect){containerOffset=this.sqe.get$Body().parent().offset();top=this.sqe.scrollTop()+rect.top-containerOffset.top+$("body").scrollTop();left=rect.left-containerOffset.left;height=rect.height}else{height=top=left=0}return{text:text,top:top,left:left,height:height}}},{key:"getMarkerInfoOfCurrentSelection",value:function getMarkerInfoOfCurrentSelection(){var beforeRange=void 0,start=void 0,end=void 0,info=void 0;var range=this.sqe.getSelection().cloneRange();if(this._extendRangeToTextNodeIfHasNone(range)){beforeRange=range.cloneRange();beforeRange.setStart(this.sqe.get$Body()[0],0);beforeRange.setEnd(range.startContainer,range.startOffset);info=this._getExtraInfoOfRange(range);start=beforeRange.cloneContents().textContent.length;end=start+info.text.length;return{start:start,end:end,text:info.text,top:info.top,left:info.left,height:info.height}}return null}},{key:"_extendRangeToTextNodeIfHasNone",value:function _extendRangeToTextNodeIfHasNone(range){var endNode=domUtils.getChildNodeByOffset(range.endContainer,range.endOffset);var textNode=void 0;if(!domUtils.isTextNode(range.endContainer)||!endNode.nodeValue.replace(FIND_ZWB_RX,"").length){if(domUtils.isTextNode(endNode)){range.setEnd(endNode,0)}else{textNode=domUtils.getPrevTextNode(endNode);if(textNode){range.setEnd(textNode,textNode.length)}else{return false}}}return true}},{key:"_findOffsetNode",value:function _findOffsetNode(offsetlist){return domUtils.findOffsetNode(this.sqe.get$Body()[0],offsetlist,function(text){return text.replace(FIND_ZWB_RX,"")})}},{key:"selectOffsetRange",value:function selectOffsetRange(start,end){var foundNode=this._findOffsetNode([start,end]),range=this.sqe.getSelection().cloneRange();range.setStart(foundNode[0].container,foundNode[0].offsetInContainer);range.setEnd(foundNode[1].container,foundNode[1].offsetInContainer);this.sqe.setSelection(range)}},{key:"clearSelect",value:function clearSelect(){var range=this.sqe.getSelection().cloneRange();range.collapse(true);this.sqe.setSelection(range)}}]);return WysiwygMarkerHelper}();module.exports=WysiwygMarkerHelper},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var domUtils=__webpack_require__(11);var FIND_CRLF_RX=/(\n)|(\r\n)|(\r)/g;var ViewOnlyMarkerHelper=function(){function ViewOnlyMarkerHelper(preview){_classCallCheck(this,ViewOnlyMarkerHelper);this.preview=preview}_createClass(ViewOnlyMarkerHelper,[{key:"getTextContent",value:function getTextContent(){return this.preview.$el[0].textContent.replace(FIND_CRLF_RX,"")}},{key:"updateMarkerWithExtraInfo",value:function updateMarkerWithExtraInfo(marker){var foundNode=this._findOffsetNode([marker.start,marker.end]);var markerRange=document.createRange();markerRange.setStart(foundNode[0].container,foundNode[0].offsetInContainer);markerRange.setEnd(foundNode[1].container,foundNode[1].offsetInContainer);var info=this._getExtraInfoOfRange(markerRange);marker.text=info.text;marker.top=info.top;marker.left=info.left;marker.height=info.height;return marker}},{key:"_getExtraInfoOfRange",value:function _getExtraInfoOfRange(range){var top=void 0,left=void 0,rect=void 0,containerOffset=void 0,height=void 0,node=void 0,parentNode=void 0;var text=range.cloneContents().textContent.replace(FIND_CRLF_RX,"");range.setStart(range.endContainer,range.endOffset);range.collapse(true);rect=range.getBoundingClientRect();if(rect&&!rect.top){node=document.createElement("SPAN");node.textContent="​";range.endContainer.parentNode.insertBefore(node,range.endContainer);rect=node.getBoundingClientRect();parentNode=node.parentNode;parentNode.removeChild(node)}if(rect){containerOffset=this.preview.$el.offset();top=rect.top+this.preview.$el.scrollTop()-containerOffset.top+$("body").scrollTop();left=rect.left-containerOffset.left;height=rect.height}else{height=top=left=0}return{text:text,top:top,left:left,height:height}}},{key:"getMarkerInfoOfCurrentSelection",value:function getMarkerInfoOfCurrentSelection(){var beforeRange=void 0,start=void 0,end=void 0,info=void 0;var range=getRange();var isRangeInContent=$.contains(this.preview.$el[0],range.commonAncestorContainer);if(isRangeInContent&&this._extendRangeToTextNodeIfHasNone(range)){beforeRange=range.cloneRange();beforeRange.setStart(this.preview.$el[0],0);beforeRange.setEnd(range.startContainer,range.startOffset);info=this._getExtraInfoOfRange(range);start=beforeRange.cloneContents().textContent.length;end=start+info.text.length;return{start:start,end:end,text:info.text,top:info.top,left:info.left,height:info.height}}return null}},{key:"_extendRangeToTextNodeIfHasNone",value:function _extendRangeToTextNodeIfHasNone(range){var endNode=domUtils.getChildNodeByOffset(range.endContainer,range.endOffset);var textNode=void 0;if(!domUtils.isTextNode(range.endContainer)){if(domUtils.isTextNode(endNode)){range.setEnd(endNode,0)}else{textNode=domUtils.getPrevTextNode(endNode);if(textNode){range.setEnd(textNode,textNode.length)}else{return false}}}return true}},{key:"_findOffsetNode",value:function _findOffsetNode(offsetlist){return domUtils.findOffsetNode(this.preview.$el[0],offsetlist,function(text){return text.replace(FIND_CRLF_RX,"")})}},{key:"selectOffsetRange",value:function selectOffsetRange(start,end){var foundNode=this._findOffsetNode([start,end]),range=document.createRange(),sel=window.getSelection();range.setStart(foundNode[0].container,foundNode[0].offsetInContainer);range.setEnd(foundNode[1].container,foundNode[1].offsetInContainer);sel.removeAllRanges();sel.addRange(range)}},{key:"clearSelect",value:function clearSelect(){window.getSelection().removeAllRanges()}}]);return ViewOnlyMarkerHelper}();function getRange(){var selection=window.getSelection();var range=void 0;if(selection&&selection.rangeCount){range=selection.getRangeAt(0).cloneRange()}else{range=document.createRange();range.selectNodeContents(this.preview.$el[0]);range.collapse(true)}return range}module.exports=ViewOnlyMarkerHelper},function(module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var util=tui.util;var FIND_CRLF_RX=/(\n)|(\r\n)|(\r)/g;var MarkdownMarkerHelper=function(){function MarkdownMarkerHelper(cm){_classCallCheck(this,MarkdownMarkerHelper);this.cm=cm}_createClass(MarkdownMarkerHelper,[{key:"getTextContent",value:function getTextContent(){return this.cm.getValue().replace(FIND_CRLF_RX,"")}},{key:"updateMarkerWithExtraInfo",value:function updateMarkerWithExtraInfo(marker){var foundCursor=this._findOffsetCursor([marker.start,marker.end]);var startLine=foundCursor[0].line;var startCh=foundCursor[0].ch;var endLine=foundCursor[1].line;var endCh=foundCursor[1].ch;var info=this._getExtraInfoOfRange(startLine,startCh,endLine,endCh);marker.text=info.text.replace(FIND_CRLF_RX," ");marker.top=info.top;marker.left=info.left;marker.height=info.height;return marker}},{key:"_getExtraInfoOfRange",value:function _getExtraInfoOfRange(startLine,startCh,endLine,endCh){var text=void 0,rect=void 0,top=void 0,left=void 0,height=void 0;var doc=this.cm.getDoc();if(!doc.getValue().length){top=left=height=0;text=""}else{text=doc.getRange({line:startLine,ch:startCh},{line:endLine,ch:endCh});rect=this.cm.charCoords({line:endLine,ch:endCh},"local");top=rect.top;left=rect.left;height=rect.bottom-rect.top}return{text:text,top:top,left:left,height:height}}},{key:"getMarkerInfoOfCurrentSelection",value:function getMarkerInfoOfCurrentSelection(){var doc=this.cm.getDoc();var selection=this._getSelection();var start=doc.getRange({line:0,ch:0},selection.anchor).replace(FIND_CRLF_RX,"").length;var end=start+doc.getSelection().replace(FIND_CRLF_RX,"").length;var foundCursor=this._findOffsetCursor([start,end]);var info=this._getExtraInfoOfRange(foundCursor[0].line,foundCursor[0].ch,foundCursor[1].line,foundCursor[1].ch);return{start:start,end:end,text:info.text.replace(FIND_CRLF_RX," "),top:info.top,left:info.left,height:info.height}}},{key:"_getSelection",value:function _getSelection(){var selection=this.cm.getDoc().listSelections()[0];var anchor=selection.anchor;var head=selection.head;var isReversedSelection=anchor.line>head.line||anchor.line===head.line&&anchor.ch>head.ch;if(isReversedSelection){var temp=head;head=anchor;anchor=temp}return{anchor:anchor,head:head}}},{key:"_findOffsetCursor",value:function _findOffsetCursor(offsetlist){var doc=this.cm.getDoc();var beforeLength=0;var result=[];var lineLength=doc.lineCount();var offsetIndex=0;var currentLength=0;var lineIndex=void 0;for(lineIndex=0;lineIndex<lineLength;lineIndex+=1){currentLength+=doc.getLine(lineIndex).length;while(currentLength>=offsetlist[offsetIndex]){result.push({line:lineIndex,ch:offsetlist[offsetIndex]-beforeLength});offsetIndex+=1;if(util.isUndefined(offsetlist[offsetIndex])){return result}}beforeLength=currentLength}while(!util.isUndefined(offsetlist[offsetIndex])){result.push({line:lineIndex,ch:currentLength-beforeLength});offsetIndex+=1}return result}},{key:"selectOffsetRange",value:function selectOffsetRange(start,end){var foundCursor=this._findOffsetCursor([start,end]);this.cm.setSelection({line:foundCursor[0].line,ch:foundCursor[0].ch},{line:foundCursor[1].line,ch:foundCursor[1].ch})}},{key:"clearSelect",value:function clearSelect(){var selection=this.cm.getDoc().listSelections()[0];if(selection){this.cm.setCursor(selection.to())}}}]);return MarkdownMarkerHelper}();module.exports=MarkdownMarkerHelper},function(module,exports,__webpack_require__){"use strict";var _extManager=__webpack_require__(30);var _extManager2=_interopRequireDefault(_extManager);var _mergedTableCreator=__webpack_require__(110);var _mergedTableCreator2=_interopRequireDefault(_mergedTableCreator);var _tableUnmergePreparer=__webpack_require__(113);var _tableUnmergePreparer2=_interopRequireDefault(_tableUnmergePreparer);var _toMarkRenderer=__webpack_require__(114);var _toMarkRenderer2=_interopRequireDefault(_toMarkRenderer);var _wwMergedTableManager=__webpack_require__(115);var _wwMergedTableManager2=_interopRequireDefault(_wwMergedTableManager);var _wwMergedTableSelectionManager=__webpack_require__(117);var _wwMergedTableSelectionManager2=_interopRequireDefault(_wwMergedTableSelectionManager);var _mergedTableAddRow=__webpack_require__(118);var _mergedTableAddRow2=_interopRequireDefault(_mergedTableAddRow);var _mergedTableAddCol=__webpack_require__(119);var _mergedTableAddCol2=_interopRequireDefault(_mergedTableAddCol);var _mergedTableRemoveRow=__webpack_require__(120);var _mergedTableRemoveRow2=_interopRequireDefault(_mergedTableRemoveRow);var _mergedTableRemoveCol=__webpack_require__(121);var _mergedTableRemoveCol2=_interopRequireDefault(_mergedTableRemoveCol);var _mergedTableAlignCol=__webpack_require__(122);var _mergedTableAlignCol2=_interopRequireDefault(_mergedTableAlignCol);var _mergeCell=__webpack_require__(123);var _mergeCell2=_interopRequireDefault(_mergeCell);var _unmergeCell=__webpack_require__(124);var _unmergeCell2=_interopRequireDefault(_unmergeCell);var _mergedTableUI=__webpack_require__(125);var _mergedTableUI2=_interopRequireDefault(_mergedTableUI);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(126);_extManager2.default.defineExtension("tableExtension",function(editor){var eventManager=editor.eventManager;editor.toMarkOptions=editor.toMarkOptions||{};editor.toMarkOptions.renderer=_toMarkRenderer2.default;_bindEvents(eventManager);if(editor.isViewOnly()){return}var wwComponentManager=editor.wwEditor.componentManager;var popupTableUtils=editor._ui.popupTableUtils;_addCommands(editor);_changeWysiwygManagers(wwComponentManager);if(editor._ui.popupTableUtils){_mergedTableUI2.default.updateContextMenu(popupTableUtils,eventManager,wwComponentManager.getManager("tableSelection"))}});function _addCommands(editor){editor.addCommand(_mergeCell2.default);editor.addCommand(_unmergeCell2.default)}function _changeWysiwygManagers(wwComponentManager){wwComponentManager.removeManager("table");wwComponentManager.removeManager("tableSelection");wwComponentManager.addManager(_wwMergedTableManager2.default);wwComponentManager.addManager(_wwMergedTableSelectionManager2.default)}function _changeHtml(html,onChangeTable){var $tempDiv=$("<div>"+html+"</div>");var $tables=$tempDiv.find("table");if($tables.length){$tables.get().forEach(function(tableElement){var changedTableElement=onChangeTable(tableElement);$(tableElement).replaceWith(changedTableElement)});html=$tempDiv.html()}return html}function _snatchWysiwygCommand(commandWrapper){var command=commandWrapper.command;if(!command.isWWType()){return}switch(command.getName()){case"AddRow":commandWrapper.command=_mergedTableAddRow2.default;break;case"AddCol":commandWrapper.command=_mergedTableAddCol2.default;break;case"RemoveRow":commandWrapper.command=_mergedTableRemoveRow2.default;break;case"RemoveCol":commandWrapper.command=_mergedTableRemoveCol2.default;break;case"AlignCol":commandWrapper.command=_mergedTableAlignCol2.default;break;default:}}function _bindEvents(eventManager){eventManager.listen("convertorAfterMarkdownToHtmlConverted",function(html){return _changeHtml(html,_mergedTableCreator2.default)});eventManager.listen("convertorBeforeHtmlToMarkdownConverted",function(html){return _changeHtml(html,_tableUnmergePreparer2.default)});eventManager.listen("addCommandBefore",_snatchWysiwygCommand)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();exports._extractPropertiesForMerge=_extractPropertiesForMerge;exports._parseTableCell=_parseTableCell;exports._createTableObjectFrom$Table=_createTableObjectFrom$Table;exports._divideTrs=_divideTrs;exports._mergeByColspan=_mergeByColspan;exports._getRemovalTdCountsByRowspan=_getRemovalTdCountsByRowspan;exports._mergeByRowspan=_mergeByRowspan;exports.default=createMergedTable;var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _extractPropertiesForMerge(value,type,oppossitType){var regex=new RegExp("^((?:"+oppossitType+"=[0-9]+:)?)"+type+"=([0-9]+):(.*)");var regexResult=regex.exec(value);var mergeCount=1;if(regexResult){mergeCount=parseInt(regexResult[2],10);value=regexResult[1]+regexResult[3]}return[mergeCount,value]}function _parseTableCell(cell){var nodeName=cell.nodeName;var align=cell.align||"";var content=cell.innerHTML.trim();var colspan=null;var rowspan=null;var _extractPropertiesFor=_extractPropertiesForMerge(content,"@cols","@rows");var _extractPropertiesFor2=_slicedToArray(_extractPropertiesFor,2);colspan=_extractPropertiesFor2[0];content=_extractPropertiesFor2[1];var _extractPropertiesFor3=_extractPropertiesForMerge(content,"@rows","@cols");var _extractPropertiesFor4=_slicedToArray(_extractPropertiesFor3,2);rowspan=_extractPropertiesFor4[0];content=_extractPropertiesFor4[1];return{nodeName:nodeName,colspan:colspan,rowspan:rowspan,content:content,align:align}}function _createTableObjectFrom$Table($table){return $table.find("tr").get().map(function(tr){return $(tr).find("td, th").get().map(_parseTableCell)})}function _findIndex(arr,onFind){var foundIndex=-1;tui.util.forEach(arr,function(item,index){var nextFind=true;if(onFind(item,index)){foundIndex=index;nextFind=false}return nextFind});return foundIndex}function _divideTrs(trs){var tbodyStartIndex=_findIndex(trs,function(tr){return tr[0].nodeName==="TD"});return[trs.slice(0,tbodyStartIndex),trs.slice(tbodyStartIndex)]}function _mergeByColspan(trs){trs.forEach(function(tr){var tdCount=tr.length;var removalCount=0;tr.forEach(function(td){removalCount+=td.colspan-1});tr.splice(tdCount-removalCount)})}function _getRemovalTdCountsByRowspan(trs){var trIndexes=trs.map(function(tr,index){return index});var removalCounts=trIndexes.map(function(){return 0});trs.forEach(function(tr,trIndex){var rowspanTds=tr.filter(function(td){return td.rowspan>1});var startTrIndexForRemoval=trIndex+1;rowspanTds.forEach(function(td){var removeCount=td.colspan;var endTrIndexForRemoval=startTrIndexForRemoval+(td.rowspan-1);trIndexes.slice(startTrIndexForRemoval,endTrIndexForRemoval).forEach(function(removeIndex){removalCounts[removeIndex]+=removeCount})})});return removalCounts}function _mergeByRowspan(trs){var removalCounts=_getRemovalTdCountsByRowspan(trs);trs.forEach(function(tr,trIndex){tr.splice(tr.length-removalCounts[trIndex])})}function createMergedTable(tableElement){var table=_createTableObjectFrom$Table($(tableElement));var _divideTrs2=_divideTrs(table),_divideTrs3=_slicedToArray(_divideTrs2,2),thead=_divideTrs3[0],tbody=_divideTrs3[1];_mergeByColspan(thead);_mergeByColspan(tbody);_mergeByRowspan(tbody);return $(_tableRenderer2.default.createTableHtml(table))[0]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _createCellHtml(cell){var attrs=cell.colspan>1?' colspan="'+cell.colspan+'"':"";attrs+=cell.rowspan>1?' rowspan="'+cell.rowspan+'"':"";attrs+=cell.align?' align="'+cell.align+'"':"";return"<"+cell.nodeName+attrs+">"+cell.content+"</"+cell.nodeName+">"}function _createTheadOrTbodyHtml(trs,wrapperNodeName){var html="";if(trs.length){html=trs.map(function(tr){var tdHtml=tr.map(_createCellHtml).join("");return"<tr>"+tdHtml+"</tr>"}).join("");html="<"+wrapperNodeName+">"+html+"</"+wrapperNodeName+">"}return html}function createTableHtml(renderData){var thead=[renderData[0]];var tbody=renderData.slice(1);var theadHtml=_createTheadOrTbodyHtml(thead,"THEAD");var tbodyHtml=_createTheadOrTbodyHtml(tbody,"TBODY");var className=renderData.className?' class="'+renderData.className+'"':"";return"<table"+className+">"+(theadHtml+tbodyHtml)+"</renderData>"}function replaceTable($table,tableData){var cellIndexData=_tableDataHandler2.default.createCellIndexData(tableData);var renderData=_tableDataHandler2.default.createRenderData(tableData,cellIndexData);var $newTable=$(createTableHtml(renderData));$table.replaceWith($newTable);return $newTable}function focusToCell(sq,range,targetCell){range.selectNodeContents(targetCell);range.collapse(true);sq.setSelection(range)}exports.default={createTableHtml:createTableHtml,replaceTable:replaceTable,focusToCell:focusToCell}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createTableData=createTableData;exports.createCellIndexData=createCellIndexData;function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var util=tui.util;function _parseCell(cell,rowIndex,colIndex){var $cell=$(cell);var colspan=$cell.attr("colspan");var rowspan=$cell.attr("rowspan");var nodeName=cell.nodeName;if(nodeName!=="TH"&&nodeName!=="TD"){return null}var cellData={nodeName:cell.nodeName,colspan:colspan?parseInt(colspan,10):1,rowspan:rowspan?parseInt(rowspan,10):1,content:$cell.html(),elementIndex:{rowIndex:rowIndex,colIndex:colIndex}};if(cell.nodeName==="TH"&&cell.align){cellData.align=cell.align}return cellData}function _addMergedCell(base,cellData,startRowIndex,startCellIndex){var colspan=cellData.colspan;var rowspan=cellData.rowspan;var colMerged=colspan>1;var rowMerged=rowspan>1;var nodeName=cellData.nodeName;if(!colMerged&&!rowMerged){return}var limitRowIndex=startRowIndex+rowspan;var limitCellIndex=startCellIndex+colspan;util.range(startRowIndex,limitRowIndex).forEach(function(rowIndex){base[rowIndex]=base[rowIndex]||[];util.range(startCellIndex,limitCellIndex).forEach(function(cellIndex){var mergedData={nodeName:nodeName};if(rowIndex===startRowIndex&&cellIndex===startCellIndex){return}if(colMerged){mergedData.colMergeWith=startCellIndex}if(rowMerged){mergedData.rowMergeWith=startRowIndex}base[rowIndex][cellIndex]=mergedData})})}function createTableData($table){var tableData=[];$table.find("tr").each(function(rowIndex,tr){var stackedColCount=0;tableData[rowIndex]=tableData[rowIndex]||[];$(tr).children().each(function(colIndex,cell){var cellData=_parseCell(cell,rowIndex,colIndex);if(!cellData){return}var dataColIndex=colIndex+stackedColCount;while(tableData[rowIndex][dataColIndex]){dataColIndex+=1;stackedColCount+=1}tableData[rowIndex][dataColIndex]=cellData;_addMergedCell(tableData,cellData,rowIndex,dataColIndex)})});if($table[0].className){tableData.className=$table[0].className}return tableData}function createCellIndexData(tableData){var mappingData=[];tableData.forEach(function(row,rowIndex){var mappingRow=[];row.forEach(function(cell,colIndex){if(util.isUndefined(cell.colMergeWith)&&util.isUndefined(cell.rowMergeWith)){mappingRow.push({rowIndex:rowIndex,colIndex:colIndex})}});mappingData.push(mappingRow)});return mappingData}function _getHeaderAligns(tableData){var headRowData=tableData[0];return headRowData.map(function(cellData){var align=void 0;if(util.isExisty(cellData.colMergeWith)){align=headRowData[cellData.colMergeWith].align}else{align=cellData.align}return align})}function createRenderData(tableData,cellIndexData){var headerAligns=_getHeaderAligns(tableData);var renderData=cellIndexData.map(function(row){return row.map(function(_ref){var rowIndex=_ref.rowIndex,colIndex=_ref.colIndex;return util.extend({align:headerAligns[colIndex]},tableData[rowIndex][colIndex])})});if(tableData.className){renderData.className=tableData.className}return renderData}var BASIC_CELL_CONTENT=tui.util.browser.msie?"":"<br>";function createBasicCell(rowIndex,colIndex,nodeName){return{nodeName:nodeName||"TD",colspan:1,rowspan:1,content:BASIC_CELL_CONTENT,elementIndex:{rowIndex:rowIndex,colIndex:colIndex}}}function findElementRowIndex($cell){var $tr=$cell.closest("tr");var rowIndex=$tr.prevAll().length;if($tr.parent()[0].nodeName==="TBODY"){rowIndex+=1}return rowIndex}function findElementColIndex($cell){return $cell.closest("td, th").prevAll().length}function findCellIndex(cellIndexData,$cell){var elementRowIndex=findElementRowIndex($cell);var elementColIndex=findElementColIndex($cell);return cellIndexData[elementRowIndex][elementColIndex]}function findRowMergedLastIndex(tableData,rowIndex,colIndex){var cellData=tableData[rowIndex][colIndex];var foundRowIndex=rowIndex;if(cellData.rowspan>1){foundRowIndex+=cellData.rowspan-1}return foundRowIndex}function findColMergedLastIndex(tableData,rowIndex,colIndex){var cellData=tableData[rowIndex][colIndex];var foundColIndex=colIndex;if(cellData.colspan>1){foundColIndex+=cellData.colspan-1}return foundColIndex}function findElementIndex(tableData,rowIndex,colIndex){var cellData=tableData[rowIndex][colIndex];rowIndex=util.isExisty(cellData.rowMergeWith)?cellData.rowMergeWith:rowIndex;colIndex=util.isExisty(cellData.colMergeWith)?cellData.colMergeWith:colIndex;return tableData[rowIndex][colIndex].elementIndex}function stuffCellsIntoIncompleteRow(tableData,limitIndex){tableData.forEach(function(rowData,rowIndex){var startIndex=rowData.length;var nodeName=rowData[0].nodeName;util.range(startIndex,limitIndex).forEach(function(colIndex){rowData.push(createBasicCell(rowIndex,colIndex,nodeName))})})}function addTbodyOrTheadIfNeed(tableData){var header=tableData[0];var cellCount=header.length;var added=true;if(!cellCount&&tableData[1]){util.range(0,tableData[1].length).forEach(function(colIndex){header.push(createBasicCell(0,colIndex,"TH"))})}else if(tableData[0][0].nodeName!=="TH"){var _ref2;var newHeader=util.range(0,cellCount).map(function(colIndex){return createBasicCell(0,colIndex,"TH")});(_ref2=[]).concat.apply(_ref2,_toConsumableArray(tableData)).forEach(function(cellData){if(cellData.elementIndex){cellData.elementIndex.rowIndex+=1}});tableData.unshift(newHeader)}else if(tableData.length===1){var newRow=util.range(0,cellCount).map(function(colIndex){return createBasicCell(1,colIndex,"TD")});tableData.push(newRow)}else{added=false}return added}exports.default={createTableData:createTableData,createCellIndexData:createCellIndexData,createRenderData:createRenderData,findElementRowIndex:findElementRowIndex,findElementColIndex:findElementColIndex,findCellIndex:findCellIndex,createBasicCell:createBasicCell,findRowMergedLastIndex:findRowMergedLastIndex,findColMergedLastIndex:findColMergedLastIndex,findElementIndex:findElementIndex,stuffCellsIntoIncompleteRow:stuffCellsIntoIncompleteRow,addTbodyOrTheadIfNeed:addTbodyOrTheadIfNeed}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._prependMergeSyntaxToContent=_prependMergeSyntaxToContent;exports.default=prepareTableUnmerge;function _prependMergeSyntaxToContent(cell){var $cell=$(cell);var colspan=$cell.attr("colspan")||"";var rowspan=$cell.attr("rowspan")||"";var content=$cell.html();if(colspan){content="@cols="+colspan+":"+content}if(rowspan){content="@rows="+rowspan+":"+content}if(content){$cell.html(content)}}function prepareTableUnmerge(tableElement){$(tableElement).find("td, th").get().forEach(_prependMergeSyntaxToContent);return tableElement}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._getAdditionalThCount=_getAdditionalThCount;exports._createTheadMarkdown=_createTheadMarkdown;var toMark=window.toMark;var RX_COLS=/@cols=[0-9]+:/g;function _createRepeatString(str,count){return tui.util.range(0,count).map(function(){return str}).join("")}function _makeTableHeadAlignText(thElement){var align=thElement.align;var textContent=(thElement.textContent||thElement.innerText).replace(RX_COLS,"");var textLength=textContent.length;var leftAlignValue="";var rightAlignValue="";if(align){if(align==="left"){leftAlignValue=":";textLength-=1}else if(align==="right"){rightAlignValue=":";textLength-=1}else if(align==="center"){rightAlignValue=":";leftAlignValue=":";textLength-=2}}textLength=Math.max(textLength,3);return leftAlignValue+_createRepeatString("-",textLength)+rightAlignValue}function _getAdditionalThCount(ths){var additionalThCount=0;ths.filter(function(th){return $(th).attr("colspan")}).forEach(function(th){additionalThCount+=parseInt($(th).attr("colspan"),10)-1});return additionalThCount}function _createTheadMarkdown(theadElement,theadContentMarkdown){var ths=$(theadElement).find("th").get();var align=ths.map(function(th){return" "+_makeTableHeadAlignText(th)+" |"}).join("");align+=_createRepeatString(" --- |",_getAdditionalThCount(ths));return theadContentMarkdown?theadContentMarkdown+"|"+align+"\n":""}exports.default=toMark.Renderer.factory(toMark.gfmRenderer,{THEAD:_createTheadMarkdown})},function(module,exports,__webpack_require__){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _wwTableManager=__webpack_require__(18);var _wwTableManager2=_interopRequireDefault(_wwTableManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var util=tui.util
;var PASTE_TABLE_BOOKMARK="tui-paste-table-bookmark";var PASTE_TABLE_CELL_BOOKMARK="tui-paste-table-cell-bookmark";var WwMergedTableManager=function(_WwTableManager){_inherits(WwMergedTableManager,_WwTableManager);function WwMergedTableManager(){_classCallCheck(this,WwMergedTableManager);return _possibleConstructorReturn(this,(WwMergedTableManager.__proto__||Object.getPrototypeOf(WwMergedTableManager)).apply(this,arguments))}_createClass(WwMergedTableManager,[{key:"_updateCopyDataMergeWith",value:function _updateCopyDataMergeWith(copyTableData,startRange){copyTableData.forEach(function(rowData){rowData.forEach(function(cellData){if(util.isExisty(cellData.rowMergeWith)){cellData.rowMergeWith-=startRange.rowIndex}if(util.isExisty(cellData.colMergeWith)){cellData.colMergeWith-=startRange.colIndex}})})}},{key:"_createCopyTableData",value:function _createCopyTableData(tableData,startRange,endRange){var copyTableData=tableData.slice(startRange.rowIndex,endRange.rowIndex+1);copyTableData=copyTableData.map(function(rowData){return rowData.slice(startRange.colIndex,endRange.colIndex+1)});this._updateCopyDataMergeWith(copyTableData,startRange);return copyTableData}},{key:"updateTableHtmlOfClipboardIfNeed",value:function updateTableHtmlOfClipboardIfNeed($clipboardContainer){var $selectedCells=this.wwe.componentManager.getManager("tableSelection").getSelectedCells();if($selectedCells.length){var tableData=_tableDataHandler2.default.createTableData($($selectedCells[0]).closest("TABLE"));var _tableRangeHandler$ge=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells),startRange=_tableRangeHandler$ge.start,endRange=_tableRangeHandler$ge.end;var copyTableData=this._createCopyTableData(tableData,startRange,endRange);var cellIndexData=_tableDataHandler2.default.createCellIndexData(copyTableData);var renderData=_tableDataHandler2.default.createRenderData(copyTableData,cellIndexData);$clipboardContainer.html(_tableRenderer2.default.createTableHtml(renderData))}}},{key:"prepareToTableCellStuffing",value:function prepareToTableCellStuffing(tableData){var maximumCellLength=tableData[0].length;var needTableCellStuffingAid=false;tableData.slice(1).forEach(function(rowData){var cellCount=rowData.length;if(maximumCellLength!==cellCount){needTableCellStuffingAid=true;if(maximumCellLength<cellCount){maximumCellLength=cellCount}}});return{maximumCellLength:maximumCellLength,needTableCellStuffingAid:needTableCellStuffingAid}}},{key:"tableCellAppendAidForTableElement",value:function tableCellAppendAidForTableElement(node){var $table=$(node);var tableData=_tableDataHandler2.default.createTableData($table);var added=_tableDataHandler2.default.addTbodyOrTheadIfNeed(tableData);var tableAidInformation=this.prepareToTableCellStuffing(tableData);var needTableCellStuffingAid=tableAidInformation.needTableCellStuffingAid;if(needTableCellStuffingAid){_tableDataHandler2.default.stuffCellsIntoIncompleteRow(tableData,tableAidInformation.maximumCellLength)}if(added||needTableCellStuffingAid){_tableRenderer2.default.replaceTable($table,tableData)}}},{key:"_findStartCell",value:function _findStartCell($selectedCells){var startCell=void 0;if($selectedCells.length===1){startCell=$selectedCells[0]}else{startCell=this.wwe.getEditor().getSelection().startContainer}return startCell}},{key:"_findStartCellIndex",value:function _findStartCellIndex(tableData,$startCell){var cellIndexData=_tableDataHandler2.default.createCellIndexData(tableData);return _tableDataHandler2.default.findCellIndex(cellIndexData,$startCell)}},{key:"_hasRowMergedHeader",value:function _hasRowMergedHeader(clipboardTableData,tableData,startCellIndex){var isHeader=tableData[startCellIndex.rowIndex][startCellIndex.colIndex].nodeName==="TH";var hasHeaderMerge=any(clipboardTableData[0],function(cellData){return cellData.rowspan&&cellData.rowspan>1});return isHeader&&hasHeaderMerge}},{key:"_isExactlyFit",value:function _isExactlyFit(clipboardTableData,targetRowCount,targetColCount){return targetRowCount%clipboardTableData.length===0&&targetColCount%clipboardTableData[0].length===0}},{key:"_updateClipboardTableData",value:function _updateClipboardTableData(clipboardTableData,targetRowCount,targetColCount){var clipboardRowCount=clipboardTableData.length;var clipboardColCount=clipboardTableData[0].length;var increaseRowCount=parseInt(targetRowCount/clipboardRowCount,10);var increaseColCount=parseInt(targetColCount/clipboardColCount,10);if(increaseRowCount>1){var originalData=JSON.parse(JSON.stringify(clipboardTableData));util.range(0,increaseRowCount-1).forEach(function(){var newRows=JSON.parse(JSON.stringify(originalData));clipboardTableData.push.apply(clipboardTableData,_toConsumableArray(newRows))})}if(increaseColCount>1){var _originalData=JSON.parse(JSON.stringify(clipboardTableData));util.range(0,increaseColCount-1).forEach(function(){var newData=JSON.parse(JSON.stringify(_originalData));clipboardTableData.forEach(function(rowData,rowIndex){rowData.push.apply(rowData,_toConsumableArray(newData[rowIndex]))})})}}},{key:"_updateTableDataByClipboardData",value:function _updateTableDataByClipboardData(clipboardTableData,tableData,startCellIndex){var startRowIndex=startCellIndex.rowIndex;var startColIndex=startCellIndex.colIndex;clipboardTableData.forEach(function(rowData,rowIndex){var updateRowIndex=startRowIndex+rowIndex;rowData.forEach(function(cellData,colIndex){var updateColIndex=startColIndex+colIndex;var prevCellData=tableData[updateRowIndex][updateColIndex];cellData.nodeName=prevCellData.nodeName;tableData[updateRowIndex][updateColIndex]=cellData})})}},{key:"_isPossibleToPaste",value:function _isPossibleToPaste(tableData,startCellIndex,endCellIndex){var startRowIndex=startCellIndex.rowIndex;var startColIndex=startCellIndex.colIndex;var endRowIndex=endCellIndex.rowIndex;var endColIndex=endCellIndex.colIndex;var filterdTableData=tableData.slice(startRowIndex,endRowIndex+1);var firstRow=filterdTableData[0].slice(startColIndex,endColIndex+1);var isPossible=!any(firstRow,function(cellData){return util.isExisty(cellData.rowMergeWith)});if(isPossible){var firstCells=util.pluck(filterdTableData,startColIndex);isPossible=!any(firstCells,function(cellData){return util.isExisty(cellData.colMergeWith)})}if(isPossible&&tableData.length>endRowIndex+1){var nextRow=tableData[endRowIndex+1].slice(startColIndex,endColIndex+1);isPossible=!any(nextRow,function(cellData){return util.isExisty(cellData.rowMergeWith)})}if(isPossible&&tableData[0].length>endColIndex+1){var nextCells=util.pluck(filterdTableData,endColIndex+1);isPossible=!any(nextCells,function(cellData){return util.isExisty(cellData.colMergeWith)})}return isPossible}},{key:"_spliceClipboardData",value:function _spliceClipboardData(clipboardTableData,targetRowCount,targetColCount){clipboardTableData.splice(targetRowCount);clipboardTableData.forEach(function(rowData){rowData.splice(targetColCount)})}},{key:"_bookmarkLastTd",value:function _bookmarkLastTd(_ref){var endRowIndex=_ref.rowIndex,endColIndex=_ref.colIndex;var sq=this.wwe.getEditor();var $bookmarkedTable=sq.get$Body().find("."+PASTE_TABLE_BOOKMARK);var tableData=_tableDataHandler2.default.createTableData($bookmarkedTable);var lastCellData=tableData[endRowIndex][endColIndex];endRowIndex=util.isExisty(lastCellData.rowMergeWith)?lastCellData.rowMergeWith:endRowIndex;endColIndex=util.isExisty(lastCellData.colMergeWith)?lastCellData.colMergeWith:endColIndex;var lastCellIndex=tableData[endRowIndex][endColIndex].elementIndex;var lastTd=$bookmarkedTable.find("tr").eq(lastCellIndex.rowIndex).children()[lastCellIndex.colIndex];$bookmarkedTable.removeClass(PASTE_TABLE_BOOKMARK);$(lastTd).addClass(PASTE_TABLE_CELL_BOOKMARK)}},{key:"_updateClipboardDataForPasteToSamllerSelectedArea",value:function _updateClipboardDataForPasteToSamllerSelectedArea(clipboardTableData,tableData,targetRowCount,targetColCount,startRange){var updated=true;var startCellIndex={rowIndex:0,colIndex:0};var endCellIndex={rowIndex:targetRowCount-1,colIndex:targetColCount-1};if(this._isPossibleToPaste(clipboardTableData,startCellIndex,endCellIndex)){this._spliceClipboardData(clipboardTableData,targetRowCount,targetColCount);this._updateTableDataByClipboardData(clipboardTableData,tableData,startRange)}else{updated=false}return updated}},{key:"_pasteToSelectedArea",value:function _pasteToSelectedArea($table,clipboardTableData,tableData,$selectedCells){var _tableRangeHandler$ge2=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells),startRange=_tableRangeHandler$ge2.start,endRange=_tableRangeHandler$ge2.end;var targetRowCount=endRange.rowIndex-startRange.rowIndex+1;var targetColCount=endRange.colIndex-startRange.colIndex+1;var clipboardRowCount=clipboardTableData.length;var clipboardColCount=clipboardTableData[0].length;var isSelectionLargerThanData=targetRowCount>=clipboardRowCount&&targetColCount>=clipboardColCount;var alertMessage=_i18n2.default.get("Cannot change part of merged cell");var updated=true;var endCellIndex=void 0;if(this._hasRowMergedHeader(clipboardTableData,tableData,startRange)){alertMessage=_i18n2.default.get("Cannot paste row merged cells into the table header");updated=false}else if(this._isExactlyFit(clipboardTableData,targetRowCount,targetColCount)){endCellIndex=endRange;this._updateClipboardTableData(clipboardTableData,targetRowCount,targetColCount);this._updateTableDataByClipboardData(clipboardTableData,tableData,startRange)}else if(isSelectionLargerThanData){endCellIndex={rowIndex:startRange.rowIndex+clipboardRowCount-1,colIndex:startRange.colIndex+clipboardColCount-1};if(this._isPossibleToPaste(tableData,startRange,endCellIndex)){this._updateTableDataByClipboardData(clipboardTableData,tableData,startRange)}else{updated=false}}else{endCellIndex={rowIndex:startRange.rowIndex+targetRowCount-1,colIndex:startRange.colIndex+targetColCount-1};updated=this._updateClipboardDataForPasteToSamllerSelectedArea(clipboardTableData,tableData,targetRowCount,targetColCount,startRange)}if(updated){tableData.className+=" "+PASTE_TABLE_BOOKMARK;_tableRenderer2.default.replaceTable($table,tableData);this._bookmarkLastTd(endCellIndex)}else{alert(alertMessage);this.wwe.getEditor().focus()}}},{key:"_findEndCellIndex",value:function _findEndCellIndex(clipboardTableData,_ref2){var startRowIndex=_ref2.rowIndex,startColIndex=_ref2.colIndex;return{rowIndex:startRowIndex+clipboardTableData.length-1,colIndex:startColIndex+clipboardTableData[0].length-1}}},{key:"_expandRow",value:function _expandRow(tableData,expandCount){var startRowIndex=tableData.length;var cellCount=tableData[0].length;var newRows=util.range(startRowIndex,startRowIndex+expandCount).map(function(rowIndex){return util.range(0,cellCount).map(function(colIndex){return _tableDataHandler2.default.createBasicCell(rowIndex,colIndex)})});tableData.push.apply(tableData,_toConsumableArray(newRows))}},{key:"_expandCoumn",value:function _expandCoumn(tableData,expandCount){var startCellIndex=tableData[0].length;var additionalCellRange=util.range(startCellIndex,startCellIndex+expandCount);tableData.forEach(function(rowData,rowIndex){var nodeName=rowData[0].nodeName;var newCells=additionalCellRange.map(function(colIndex){return _tableDataHandler2.default.createBasicCell(rowIndex,colIndex,nodeName)});rowData.push.apply(rowData,_toConsumableArray(newCells))})}},{key:"_expandTableDataIfNeed",value:function _expandTableDataIfNeed(tableData,startCellIndex,endCellIndex){var expandRowCount=endCellIndex.rowIndex-tableData.length+1;var expandCellCount=endCellIndex.colIndex-tableData[0].length+1;if(expandRowCount>0){this._expandRow(tableData,expandRowCount)}if(expandCellCount>0){this._expandCoumn(tableData,expandCellCount)}}},{key:"_pasteAllClipboardTableData",value:function _pasteAllClipboardTableData($table,clipboardTableData,tableData,startCellIndex){var endCellIndex=this._findEndCellIndex(clipboardTableData,startCellIndex);if(this._hasRowMergedHeader(clipboardTableData,tableData,startCellIndex)){alert(_i18n2.default.get("Cannot paste row merged cells into the table header"));this.wwe.getEditor().focus();return}this._expandTableDataIfNeed(tableData,startCellIndex,endCellIndex);if(this._isPossibleToPaste(tableData,startCellIndex,endCellIndex)){this._updateTableDataByClipboardData(clipboardTableData,tableData,startCellIndex);tableData.className+=" "+PASTE_TABLE_BOOKMARK;_tableRenderer2.default.replaceTable($table,tableData);this._bookmarkLastTd(endCellIndex)}else{alert(_i18n2.default.get("Cannot change part of merged cell"));this.wwe.getEditor().focus()}}},{key:"pasteClipboardData",value:function pasteClipboardData($clipboardTable){var clipboardTableData=_tableDataHandler2.default.createTableData($clipboardTable);var tableSelectionManager=this.wwe.componentManager.getManager("tableSelection");var $selectedCells=tableSelectionManager.getSelectedCells();var $startCell=$(this._findStartCell($selectedCells));var $table=$startCell.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var startCellIndex=this._findStartCellIndex(tableData,$startCell);if($selectedCells.length>1){this._pasteToSelectedArea($table,clipboardTableData,tableData,$selectedCells)}else{this._pasteAllClipboardTableData($table,clipboardTableData,tableData,startCellIndex)}}}]);return WwMergedTableManager}(_wwTableManager2.default);function any(arr,contition){var result=false;util.forEach(arr,function(item){result=contition(item);return!result});return result}module.exports=WwMergedTableManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;function _findUnmergedRange(tableData,$start,$end){var cellIndexData=_tableDataHandler2.default.createCellIndexData(tableData);var startCellIndex=_tableDataHandler2.default.findCellIndex(cellIndexData,$start);var endCellIndex=_tableDataHandler2.default.findCellIndex(cellIndexData,$end);var startRowIndex=void 0,endRowIndex=void 0,startColIndex=void 0,endColIndex=void 0;if(startCellIndex.rowIndex>endCellIndex.rowIndex){startRowIndex=endCellIndex.rowIndex;endRowIndex=startCellIndex.rowIndex}else{startRowIndex=startCellIndex.rowIndex;endRowIndex=endCellIndex.rowIndex}if(startCellIndex.colIndex>endCellIndex.colIndex){startColIndex=endCellIndex.colIndex;endColIndex=startCellIndex.colIndex}else{startColIndex=startCellIndex.colIndex;endColIndex=endCellIndex.colIndex}return{start:{rowIndex:startRowIndex,colIndex:startColIndex},end:{rowIndex:endRowIndex,colIndex:endColIndex}}}function _expandRowMergedRange(tableData,tableRange,rangeType){var rowIndex=tableRange[rangeType].rowIndex;var rowData=tableData[rowIndex];util.range(tableRange.start.colIndex,tableRange.end.colIndex+1).forEach(function(colIndex){var cellData=rowData[colIndex];var rowMergeWith=cellData.rowMergeWith;var lastRowMergedIndex=-1;if(util.isExisty(rowMergeWith)){if(rowMergeWith<tableRange.start.rowIndex){tableRange.start.rowIndex=rowMergeWith}lastRowMergedIndex=rowMergeWith+tableData[rowMergeWith][colIndex].rowspan-1}else if(cellData.rowspan>1){lastRowMergedIndex=rowIndex+cellData.rowspan-1}if(lastRowMergedIndex>tableRange.end.rowIndex){tableRange.end.rowIndex=lastRowMergedIndex}})}function _expandColMergedRange(tableData,tableRange,rowIndex,colIndex){var rowData=tableData[rowIndex];var cellData=rowData[colIndex];var colMergeWith=cellData.colMergeWith;var lastColMergedIndex=-1;if(util.isExisty(colMergeWith)){if(colMergeWith<tableRange.start.colIndex){tableRange.start.colIndex=colMergeWith}lastColMergedIndex=colMergeWith+rowData[colMergeWith].colspan-1}else if(cellData.colspan>1){lastColMergedIndex=colIndex+cellData.colspan-1}if(lastColMergedIndex>tableRange.end.colIndex){tableRange.end.colIndex=lastColMergedIndex}}function _expandMergedRange(tableData,tableRange){var rangeStr="";while(rangeStr!==JSON.stringify(tableRange)){rangeStr=JSON.stringify(tableRange);_expandRowMergedRange(tableData,tableRange,"start");_expandRowMergedRange(tableData,tableRange,"end");util.range(tableRange.start.rowIndex,tableRange.end.rowIndex+1).forEach(function(rowIndex){_expandColMergedRange(tableData,tableRange,rowIndex,tableRange.start.colIndex);_expandColMergedRange(tableData,tableRange,rowIndex,tableRange.end.colIndex)})}return tableRange}function findSelectionRange(tableData,$start,$end){var unmergedRange=_findUnmergedRange(tableData,$start,$end);return _expandMergedRange(tableData,unmergedRange)}function getTableSelectionRange(tableData,$selectedCells,$startContainer){var cellIndexData=_tableDataHandler2.default.createCellIndexData(tableData);var tableRange={};if($selectedCells.length){var startRange=_tableDataHandler2.default.findCellIndex(cellIndexData,$selectedCells.first());var endRange=util.extend({},startRange);$selectedCells.each(function(index,cell){var cellIndex=_tableDataHandler2.default.findCellIndex(cellIndexData,$(cell));var cellData=tableData[cellIndex.rowIndex][cellIndex.colIndex];var lastRowMergedIndex=cellIndex.rowIndex+cellData.rowspan-1;var lastColMergedIndex=cellIndex.colIndex+cellData.colspan-1;endRange.rowIndex=Math.max(endRange.rowIndex,lastRowMergedIndex);endRange.colIndex=Math.max(endRange.colIndex,lastColMergedIndex)});tableRange.start=startRange;tableRange.end=endRange}else{var cellIndex=_tableDataHandler2.default.findCellIndex(cellIndexData,$startContainer);tableRange.start=cellIndex;tableRange.end=util.extend({},cellIndex)}return tableRange}exports.default={findSelectionRange:findSelectionRange,getTableSelectionRange:getTableSelectionRange}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _wwTableSelectionManager=__webpack_require__(19);var _wwTableSelectionManager2=_interopRequireDefault(_wwTableSelectionManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TABLE_CELL_SELECTED_CLASS_NAME="te-cell-selected";var util=tui.util;var WwMergedTableSelectionManager=function(_WwTableSelectionMana){_inherits(WwMergedTableSelectionManager,_WwTableSelectionMana);function WwMergedTableSelectionManager(wwe){_classCallCheck(this,WwMergedTableSelectionManager);var _this=_possibleConstructorReturn(this,(WwMergedTableSelectionManager.__proto__||Object.getPrototypeOf(WwMergedTableSelectionManager)).call(this,wwe));_this._tableData=null;_this.mergedTableSelectionManager=true;return _this}_createClass(WwMergedTableSelectionManager,[{key:"_addClassToSelectedCells",value:function _addClassToSelectedCells($table,tableData,tableRange){var startRange=tableRange.start;var endRange=tableRange.end;var cellIndexRange=util.range(startRange.colIndex,endRange.colIndex+1);var $trs=$table.find("tr");util.range(startRange.rowIndex,endRange.rowIndex+1).forEach(function(rowIndex){var rowData=tableData[rowIndex];var $cells=$trs.eq(rowIndex).find("td, th");return cellIndexRange.forEach(function(colIndex){var cellData=rowData[colIndex];if(cellData.elementIndex){$cells.eq(rowData[colIndex].elementIndex.colIndex).addClass(TABLE_CELL_SELECTED_CLASS_NAME)}})})}},{key:"onDragStart",value:function onDragStart(selectionStart){var $table=$(selectionStart).closest("[contenteditable=true] table");this._tableData=_tableDataHandler2.default.createTableData($table)}},{key:"onDragEnd",value:function onDragEnd(){this._tableData=null}},{key:"highlightTableCellsBy",value:function highlightTableCellsBy(selectionStart,selectionEnd){var $start=$(selectionStart);var $end=$(selectionEnd);var $table=$start.closest("[contenteditable=true] table");var tableRange=_tableRangeHandler2.default.findSelectionRange(this._tableData,$start,$end);this.removeClassAttrbuteFromAllCellsIfNeed();this._addClassToSelectedCells($table,this._tableData,tableRange)}},{key:"styleToSelectedCells",value:function styleToSelectedCells(onStyle){var sq=this.wwe.getEditor();var range=sq.getSelection().cloneRange();var $table=$(range.startContainer).closest("[contenteditable=true] table");$table.find("tr").get().forEach(function(tr){var cells=$(tr).find("."+TABLE_CELL_SELECTED_CLASS_NAME);var firstSelectedCell=cells.first()[0];var lastSelectedCell=cells.last()[0];if(!cells.length){return}range.setStart(firstSelectedCell,0);range.setEnd(lastSelectedCell,lastSelectedCell.childNodes.length);sq.setSelection(range);onStyle(sq)})}},{key:"hasSelectedBothThAndTd",value:function hasSelectedBothThAndTd($selectedCells){$selectedCells=$selectedCells||this.getSelectedCells();return $selectedCells.first()[0].nodeName!==$selectedCells.last()[0].nodeName}}]);return WwMergedTableSelectionManager}(_wwTableSelectionManager2.default);exports.default=WwMergedTableSelectionManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._createNewRow=_createNewRow;exports._addRow=_addRow;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var util=tui.util;var AddRow=_commandManager2.default.command("wysiwyg",{name:"AddRow",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);_addRow(tableData,tableRange);var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusTd=_findFocusTd($newTable,tableRange.end.rowIndex,tableRange.start.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusTd)}});function _createRowMergedCell(rowMergeWith){return{nodeName:"TD",rowMergeWith:rowMergeWith}}function _createNewRow(tableData,rowIndex){var prevCell=null;return tableData[rowIndex].map(function(cellData,colIndex){var newCell=void 0;if(util.isExisty(cellData.rowMergeWith)){var rowMergeWith=cellData.rowMergeWith;var merger=tableData[rowMergeWith][colIndex];var lastMergedRowIndex=rowMergeWith+merger.rowspan-1;if(util.isExisty(merger.colMergeWith)&&prevCell){newCell=util.extend({},prevCell)}else if(lastMergedRowIndex>rowIndex){merger.rowspan+=1;newCell=util.extend({},cellData)}}else if(cellData.rowspan>1){cellData.rowspan+=1;newCell=_createRowMergedCell(rowIndex)}if(!newCell){newCell=_tableDataHandler2.default.createBasicCell(rowIndex+1,colIndex)}prevCell=newCell;return newCell})}function _addRow(tableData,tableRange){var startRowIndex=tableRange.start.rowIndex;var endRange=tableRange.end;var endRowIndex=_tableDataHandler2.default.findRowMergedLastIndex(tableData,endRange.rowIndex,endRange.colIndex);var newRows=util.range(startRowIndex,endRowIndex+1).map(function(){return _createNewRow(tableData,endRowIndex)});tableData.splice.apply(tableData,_toConsumableArray([endRowIndex+1,0].concat(newRows)))}function _findFocusTd($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);var newRowIndex=_tableDataHandler2.default.findRowMergedLastIndex(tableData,rowIndex,colIndex)+1;var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,newRowIndex,colIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td")[cellElementIndex.colIndex]}exports.default=AddRow},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._createNewColumns=_createNewColumns;exports._addColumns=_addColumns;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var util=tui.util;var AddCol=_commandManager2.default.command("wysiwyg",{name:"AddCol",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);_addColumns(tableData,tableRange);var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusCell=_findFocusCell($newTable,tableRange.start.rowIndex,tableRange.end.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusCell)}});function _createColMergedCell(colMergeWith,nodeName){return{nodeName:nodeName,colMergeWith:colMergeWith}}function _createNewCell(rowData,rowIndex,colIndex,prevCell){var cellData=rowData[colIndex];var newCell=void 0;if(util.isExisty(cellData.colMergeWith)){var colMergeWith=cellData.colMergeWith;var merger=rowData[colMergeWith];var lastMergedCellIndex=colMergeWith+merger.colspan-1;if(util.isExisty(merger.rowMergeWith)&&prevCell){newCell=util.extend({},prevCell)}else if(lastMergedCellIndex>colIndex){merger.colspan+=1;newCell=util.extend({},cellData)}}else if(cellData.colspan>1){cellData.colspan+=1;newCell=_createColMergedCell(colIndex,cellData.nodeName)}if(!newCell){newCell=_tableDataHandler2.default.createBasicCell(rowIndex,colIndex+1,cellData.nodeName)}return newCell}function _createNewColumns(tableData,startColIndex,endColIndex){var colIndexes=util.range(startColIndex,endColIndex+1);var newColumns=[];var prevCells=null;tableData.forEach(function(rowData,rowIndex){var newCells=colIndexes.map(function(colIndex,index){var prevCell=prevCells?prevCells[index-1]:null;return _createNewCell(rowData,rowIndex,endColIndex,prevCell)});prevCells=newCells;newColumns.push(newCells)});return newColumns}function _addColumns(tableData,tableRange){var endRange=tableRange.end;var endColIndex=_tableDataHandler2.default.findColMergedLastIndex(tableData,endRange.rowIndex,endRange.colIndex);var newColumns=_createNewColumns(tableData,tableRange.start.colIndex,endColIndex);var newColIndex=endColIndex+1;tableData.forEach(function(rowData,rowIndex){rowData.splice.apply(rowData,_toConsumableArray([newColIndex,0].concat(newColumns[rowIndex])))})}function _findFocusCell($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);var newColIndex=_tableDataHandler2.default.findColMergedLastIndex(tableData,rowIndex,colIndex)+1;var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,rowIndex,newColIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td, th")[cellElementIndex.colIndex]}exports.default=AddCol},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._removeRow=_removeRow;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var RemoveRow=_commandManager2.default.command("wysiwyg",{name:"RemoveRow",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var beforeRowLength=tableData.length;var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);_removeRow(tableData,tableRange);if(beforeRowLength===tableData.length){return}var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusTd=_findFocusTd($newTable,tableRange.end.rowIndex,tableRange.start.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusTd)}});function _updateRowspan(tableData,startRowIndex,endRowIndex){util.range(startRowIndex,endRowIndex+1).forEach(function(rowIndex){tableData[rowIndex].forEach(function(cell,cellIndex){if(util.isExisty(cell.rowMergeWith)){var merger=tableData[cell.rowMergeWith][cellIndex];if(merger.rowspan){merger.rowspan-=1}}else if(cell.rowspan>1){var lastMergedRowIndex=rowIndex+cell.rowspan-1;cell.rowspan-=endRowIndex-rowIndex+1;if(lastMergedRowIndex>endRowIndex){tableData[endRowIndex+1][cellIndex]=util.extend({},cell)}}})})}function _updateMergeStartIndex(tableData,startRowIndex,endRowIndex){tableData.slice(endRowIndex+1).forEach(function(row){row.forEach(function(cell){if(util.isExisty(cell.rowMergeWith)&&cell.rowMergeWith>=startRowIndex){cell.rowMergeWith=endRowIndex+1}})})}function _removeRow(tableData,tableRange){var startRowIndex=tableRange.start.rowIndex;var endRange=tableRange.end;var endRowIndex=_tableDataHandler2.default.findRowMergedLastIndex(tableData,endRange.rowIndex,endRange.colIndex)
;var removeCount=endRowIndex-startRowIndex+1;if(removeCount===tableData.length-1){return}_updateRowspan(tableData,startRowIndex,endRowIndex);_updateMergeStartIndex(tableData,startRowIndex,endRowIndex);tableData.splice(startRowIndex,removeCount)}function _findFocusTd($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);if(tableData.length-1<rowIndex){rowIndex-=1}var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,rowIndex,colIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td")[cellElementIndex.colIndex]}exports.default=RemoveRow},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._removeColumns=_removeColumns;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var RemoveCol=_commandManager2.default.command("wysiwyg",{name:"RemoveCol",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);var beforeCellLength=tableData[0].length;_removeColumns(tableData,tableRange);if(beforeCellLength===tableData[0].length){return}var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusCell=_findFocusCell($newTable,tableRange.start.rowIndex,tableRange.end.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusCell)}});function _updateColspan(tableData,startColIndex,endColIndex){tableData.forEach(function(rowData){util.range(startColIndex,endColIndex+1).forEach(function(colIndex){var cellData=rowData[colIndex];if(util.isExisty(cellData.colMergeWith)){var merger=rowData[cellData.colMergeWith];if(merger.colspan){merger.colspan-=1}}else if(cellData.colspan>1){var lastMergedCellIndex=colIndex+cellData.colspan-1;cellData.colspan-=endColIndex-colIndex+1;if(lastMergedCellIndex>endColIndex){rowData[endColIndex+1]=util.extend({},cellData)}}})})}function _updateMergeStartIndex(tableData,startColIndex,endColIndex){tableData.forEach(function(rowData){rowData.slice(endColIndex+1).forEach(function(cellData){if(util.isExisty(cellData.colMergeWith)&&cellData.colMergeWith>=startColIndex){cellData.colMergeWith=endColIndex+1}})})}function _removeColumns(tableData,tableRange){var startColIndex=tableRange.start.colIndex;var endRange=tableRange.end;var endColIndex=_tableDataHandler2.default.findColMergedLastIndex(tableData,endRange.rowIndex,endRange.colIndex);var removeCount=endColIndex-startColIndex+1;if(removeCount===tableData[0].length){return}_updateColspan(tableData,startColIndex,endColIndex);_updateMergeStartIndex(tableData,startColIndex,endColIndex);tableData.forEach(function(row){row.splice(startColIndex,removeCount)})}function _findFocusCell($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);if(tableData[0].length-1<colIndex){colIndex-=1}var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,rowIndex,colIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td, th")[cellElementIndex.colIndex]}exports.default=RemoveCol},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=tui.util;var AlignCol=_commandManager2.default.command("wysiwyg",{name:"AlignCol",exec:function exec(wwe,alignDirection){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);_align(tableData[0],tableRange.start.colIndex,tableRange.end.colIndex,alignDirection);var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusCell=_findFocusCell($newTable,$startContainer);_tableRenderer2.default.focusToCell(sq,range,focusCell)}});function _align(headRowData,startColIndex,endColIndex,alignDirection){util.range(startColIndex,endColIndex+1).forEach(function(colIndex){var headCellData=headRowData[colIndex];if(util.isExisty(headCellData.colMergeWith)){headRowData[headCellData.colMergeWith].align=alignDirection}else{headCellData.align=alignDirection}})}function _findFocusCell($newTable,$startContainer){var elementRowIndex=_tableDataHandler2.default.findElementRowIndex($startContainer);var elementColIndex=_tableDataHandler2.default.findElementColIndex($startContainer);return $newTable.find("tr").eq(elementRowIndex).find("td, th")[elementColIndex]}exports.default=AlignCol},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._mergeCells=_mergeCells;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var util=tui.util;var BASIC_CELL_CONTENT=util.browser.msie?"":"<br>";var MergeCell=_commandManager2.default.command("wysiwyg",{name:"MergeCells",exec:function exec(wwe){var sq=wwe.getEditor();sq.focus();if(!sq.hasFormat("TABLE")){return}var selectionManager=wwe.componentManager.getManager("tableSelection");var $selectedCells=selectionManager.getSelectedCells();if($selectedCells.length<2||selectionManager.hasSelectedBothThAndTd($selectedCells)){return}var range=sq.getSelection().cloneRange();var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);_mergeCells(tableData,tableRange);var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusCell=_findFocusCell($newTable,tableRange.start.rowIndex,tableRange.start.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusCell)}});function _pickContent(targetRows,startColIndex,endColIndex){var _ref;var limitColIndex=endColIndex+1;var cells=(_ref=[]).concat.apply(_ref,_toConsumableArray(targetRows.map(function(rowData){return rowData.slice(startColIndex,limitColIndex)})));var foundCellData=cells.filter(function(_ref2){var content=_ref2.content;return content&&content!==BASIC_CELL_CONTENT});return foundCellData.length?foundCellData[0].content:BASIC_CELL_CONTENT}function _initCellData(targetRows,startColIndex,endColIndex){var _ref3;var limitColIndex=endColIndex+1;var targetCells=targetRows.map(function(rowData){return rowData.slice(startColIndex,limitColIndex)});(_ref3=[]).concat.apply(_ref3,_toConsumableArray(targetCells)).slice(1).forEach(function(cellData){var nodeName=cellData.nodeName;util.forEach(cellData,function(value,name){return delete cellData[name]});cellData.nodeName=nodeName})}function _updateRowMergeWith(targetRows,startColIndex,endColIndex,rowMergeWith){var limitColIndex=endColIndex+1;targetRows.forEach(function(rowData){rowData.slice(startColIndex,limitColIndex).forEach(function(cellData){cellData.rowMergeWith=rowMergeWith})})}function _updateColMergeWith(targetRows,startColIndex,endColIndex,colMergeWith){var limitColIndex=endColIndex+1;targetRows.forEach(function(rowData){rowData.slice(startColIndex,limitColIndex).forEach(function(cellData){cellData.colMergeWith=colMergeWith})})}function _mergeCells(tableData,_ref4){var startRange=_ref4.start,endRange=_ref4.end;var startRowIndex=startRange.rowIndex;var startColIndex=startRange.colIndex;var endRowIndex=endRange.rowIndex;var endColIndex=endRange.colIndex;var merger=tableData[startRowIndex][startColIndex];var targetRows=tableData.slice(startRowIndex,endRowIndex+1);var rowspan=endRowIndex-startRowIndex+1;var colspan=endColIndex-startColIndex+1;merger.rowspan=rowspan;merger.colspan=colspan;merger.content=_pickContent(targetRows,startColIndex,endColIndex);_initCellData(targetRows,startColIndex,endColIndex);if(rowspan>1){_updateRowMergeWith(targetRows.slice(1),startColIndex,endColIndex,startRowIndex)}if(colspan>1){_updateColMergeWith(targetRows,startColIndex+1,endColIndex,startColIndex)}}function _findFocusCell($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,rowIndex,colIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td, th")[cellElementIndex.colIndex]}exports.default=MergeCell},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._hasMergedCell=_hasMergedCell;exports._unmergeCells=_unmergeCells;var _commandManager=__webpack_require__(28);var _commandManager2=_interopRequireDefault(_commandManager);var _tableDataHandler=__webpack_require__(112);var _tableDataHandler2=_interopRequireDefault(_tableDataHandler);var _tableRangeHandler=__webpack_require__(116);var _tableRangeHandler2=_interopRequireDefault(_tableRangeHandler);var _tableRenderer=__webpack_require__(111);var _tableRenderer2=_interopRequireDefault(_tableRenderer);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var util=tui.util;var UnmergeCell=_commandManager2.default.command("wysiwyg",{name:"UnmergeCells",exec:function exec(wwe){var sq=wwe.getEditor();var range=sq.getSelection().cloneRange();sq.focus();if(!sq.hasFormat("TABLE")){return}var $startContainer=$(range.startContainer);var $table=$startContainer.closest("table");var tableData=_tableDataHandler2.default.createTableData($table);var $selectedCells=wwe.componentManager.getManager("tableSelection").getSelectedCells();var tableRange=_tableRangeHandler2.default.getTableSelectionRange(tableData,$selectedCells,$startContainer);if(!_hasMergedCell(tableData,tableRange)){return}_unmergeCells(tableData,tableRange);var $newTable=_tableRenderer2.default.replaceTable($table,tableData);var focusCell=_findFocusCell($newTable,tableRange.start.rowIndex,tableRange.start.colIndex);_tableRenderer2.default.focusToCell(sq,range,focusCell)}});function _hasMergedCell(tableData,_ref){var _ref2;var startRange=_ref.start,endRange=_ref.end;var startColIndex=startRange.colIndex;var limitColIndex=endRange.colIndex+1;var targetRows=tableData.slice(startRange.rowIndex,endRange.rowIndex+1);var targetCells=targetRows.map(function(rowData){return rowData.slice(startColIndex,limitColIndex)});return!!(_ref2=[]).concat.apply(_ref2,_toConsumableArray(targetCells)).filter(function(cellData){return cellData.colspan>1||cellData.rowspan>1}).length}function _updateMergedCells(tableData,startRowIndex,startColIndex,rowspan,colspan){var limitRowIndex=startRowIndex+rowspan;var limitColIndex=startColIndex+colspan;var colRange=util.range(startColIndex,limitColIndex);util.range(startRowIndex,limitRowIndex).forEach(function(rowIndex){var rowData=tableData[rowIndex];var startIndex=rowIndex===startRowIndex?1:0;colRange.slice(startIndex).forEach(function(colIndex){rowData[colIndex]=_tableDataHandler2.default.createBasicCell(rowIndex,colIndex,rowData[colIndex].nodeName)})})}function _unmergeCells(tableData,_ref3){var startRange=_ref3.start,endRange=_ref3.end;var colRange=util.range(startRange.colIndex,endRange.colIndex+1);util.range(startRange.rowIndex,endRange.rowIndex+1).forEach(function(rowIndex){colRange.forEach(function(colIndex){var cellData=tableData[rowIndex][colIndex];var colspan=cellData.colspan,rowspan=cellData.rowspan;if(colspan>1||rowspan>1){cellData.colspan=1;cellData.rowspan=1;_updateMergedCells(tableData,rowIndex,colIndex,rowspan,colspan)}})})}function _findFocusCell($newTable,rowIndex,colIndex){var tableData=_tableDataHandler2.default.createTableData($newTable);var cellElementIndex=_tableDataHandler2.default.findElementIndex(tableData,rowIndex,colIndex);return $newTable.find("tr").eq(cellElementIndex.rowIndex).find("td, th")[cellElementIndex.colIndex]}exports.default=UnmergeCell},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _changeContent(popupTableUtils){var POPUP_CONTENT=['<button type="button" class="te-table-add-row">'+_i18n2.default.get("Add row")+"</button>",'<button type="button" class="te-table-add-col">'+_i18n2.default.get("Add col")+"</button>",'<button type="button" class="te-table-remove-row">'+_i18n2.default.get("Remove row")+"</button>",'<button type="button" class="te-table-remove-col">'+_i18n2.default.get("Remove col")+"</button>",'<button type="button" class="te-table-merge">'+_i18n2.default.get("Merge cells")+"</button>",'<button type="button" class="te-table-unmerge">'+_i18n2.default.get("Unmerge cells")+"</button>",'<button type="button" class="te-table-col-align-left">'+_i18n2.default.get("Align left")+"</button>",'<button type="button" class="te-table-col-align-center">'+_i18n2.default.get("Align center")+"</button>",'<button type="button" class="te-table-col-align-right">'+_i18n2.default.get("Align right")+"</button>",'<button type="button" class="te-table-remove">'+_i18n2.default.get("Remove table")+"</button>"].join("");var $popupContent=$(POPUP_CONTENT);popupTableUtils.$content=$popupContent;popupTableUtils.setContent($popupContent)}function _bindEvents(popupTableUtils,eventManager,selectionManager){var $popupContent=popupTableUtils.$content;var $mergeBtn=$($popupContent[4]);var $unmergeBtn=$($popupContent[5]);popupTableUtils.on("click .te-table-merge",function(){eventManager.emit("command","MergeCells")});popupTableUtils.on("click .te-table-unmerge",function(){eventManager.emit("command","UnmergeCells")});eventManager.listen("openPopupTableUtils",function(){var $selectedCells=selectionManager.getSelectedCells();var selectedCellCount=$selectedCells.length;if(selectedCellCount){if(selectedCellCount<2||selectionManager.hasSelectedBothThAndTd($selectedCells)){$mergeBtn.hide()}else{$mergeBtn.show()}if($selectedCells.is("[rowspan], [colspan]")){$unmergeBtn.show()}else{$unmergeBtn.hide()}}else{$mergeBtn.hide();$unmergeBtn.hide()}})}function updateContextMenu(popupTableUtils,eventManager,selectionManager){_changeContent(popupTableUtils);_bindEvents(popupTableUtils,eventManager,selectionManager)}exports.default={updateContextMenu:updateContextMenu}},function(module,exports,__webpack_require__){"use strict";var _i18n=__webpack_require__(15);var _i18n2=_interopRequireDefault(_i18n);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_i18n2.default.setLang(["ko","ko_KR"],{"Merge cells":"셀 병합","Unmerge cells":"셀 병합해제","Cannot change part of merged cell":"병합 된 셀의 일부를 변경할 수 없습니다.","Cannot paste row merged cells into the table header":"테이블 헤더에는 행 병합된 셀을 붙여넣을 수 없습니다."});_i18n2.default.setLang(["en","en_US"],{"Merge cells":"Merge cells","Unmerge cells":"Unmerge cells","Cannot change part of merged cell":"Cannot change part of merged cell.","Cannot paste row merged cells into the table header":"Cannot paste row merged cells into the table header."});_i18n2.default.setLang(["ja","ja_JP"],{"Merge cells":"セルの結合","Unmerge cells":"セルの結合を解除","Cannot change part of merged cell":"結合されたセルの一部を変更することはできません。","Cannot paste row merged cells into the table header":"行にマージされたセルをヘッダーに貼り付けることはできません。"});_i18n2.default.setLang(["nl","nl_NL"],{"Merge cells":"cellen samenvoegen","Unmerge cells":"Samenvoegen cellen ongedaan maken","Cannot change part of merged cell":"Kan geen deel uit van samengevoegde cel te veranderen.","Cannot paste row merged cells into the table header":"Kan niet plakken rij samengevoegde cellen in de koptekst. "});_i18n2.default.setLang(["zh","zh_CN"],{"Merge cells":"合并单元格","Unmerge cells":"取消合并单元格","Cannot change part of merged cell":"无法更改合并单元格的一部分。","Cannot paste row merged cells into the table header":"无法将行合并单元格粘贴到标题中。"})},function(module,exports){"use strict";tui.Editor.i18n.setLang(["en","en_US"],{Markdown:"Markdown",WYSIWYG:"WYSIWYG",Headings:"Headings",Paragraph:"Paragraph",Bold:"Bold",Italic:"Italic",Strike:"Strike",Code:"Code",Line:"Line",Blockquote:"Blockquote","Unordered list":"Unordered list","Ordered list":"Ordered list",Task:"Task","Insert link":"Insert link","Insert codeblock":"Insert codeblock","Insert table":"Insert table","Insert image":"Insert image",Heading:"Heading","Image URL":"Image URL","Select image file":"Select image file",Description:"Description",OK:"OK",Cancel:"Cancel",File:"File",URL:"URL","Link text":"Link text","Add row":"Add row","Add col":"Add col","Remove row":"Remove row","Remove col":"Remove col","Align left":"Align left","Align center":"Align center","Align right":"Align right","Remove table":"Remove table","Would you like to paste as table?":"Would you like to paste as table?","Text color":"Text color","Auto scroll enabled":"Auto scroll enabled","Auto scroll disabled":"Auto scroll disabled","Cannot paste values ​​other than a table in the cell selection state":"Cannot paste values ​​other than a table in the cell selection state."})},function(module,exports){"use strict";tui.Editor.i18n.setLang(["ko","ko_KR"],{Markdown:"마크다운",WYSIWYG:"위지윅",Headings:"제목크기",Paragraph:"본문",Bold:"굵게",Italic:"기울임꼴",Strike:"취소선",Code:"코드",Line:"문단나눔",Blockquote:"인용구","Unordered list":"글머리 기호","Ordered list":"번호 매기기",Task:"체크박스","Insert link":"링크 삽입","Insert codeblock":"코드블럭 삽입","Insert table":"표 삽입","Insert image":"이미지 삽입",Heading:"제목","Image URL":"이미지 주소","Select image file":"이미지 파일을 선택하세요.",Description:"설명",OK:"확인",Cancel:"취소",File:"파일",URL:"주소","Link text":"링크 텍스트","Add row":"행 추가","Add col":"열 추가","Remove row":"행 삭제","Remove col":"열 삭제","Align left":"왼쪽 정렬","Align center":"가운데 정렬","Align right":"오른쪽 정렬","Remove table":"표 삭제","Would you like to paste as table?":"표형태로 붙여 넣겠습니까?","Text color":"글자 색상","Auto scroll enabled":"자동 스크롤 켜짐","Auto scroll disabled":"자동 스크롤 꺼짐","Cannot paste values ​​other than a table in the cell selection state.":"셀 선택 상태에서는 테이블 이외의 값은 붙여넣을 수 없습니다."})},function(module,exports){"use strict";tui.Editor.i18n.setLang(["zh","zh_CN"],{Markdown:"Markdown",WYSIWYG:"所见即所得",Headings:"标题",Paragraph:"文本",Bold:"加粗",Italic:"斜体字",Strike:"删除线",Code:"内嵌代码",Line:"画水平线",Blockquote:"引用块","Unordered list":"无序列表","Ordered list":"有序列表",Task:"任务","Insert link":"插入链接","Insert codeblock":"插入代码块","Insert table":"插入表格","Insert image":"插入图片",Heading:"标题","Image URL":"图片网址","Select image file":"选择映像文件",Description:"说明",OK:"确认",Cancel:"取消",File:"文件",URL:"URL","Link text":"链接文本","Add row":"添加一行","Add col":"添加列","Remove row":"删除行","Remove col":"删除列","Align left":"左对齐","Align center":"居中对齐","Align right":"右对齐","Remove table":"删除表","Would you like to paste as table?":"你想粘贴表吗?","Text color":"文字色相","Auto scroll enabled":"自动滚动启用","Auto scroll disabled":"自动的滚动作非使用","Cannot paste values ​​other than a table in the cell selection state":"在单元格选择状态下无法粘贴表格以外的值。"})},function(module,exports){"use strict";tui.Editor.i18n.setLang(["ja","ja_JP"],{Markdown:"マークダウン",WYSIWYG:"WYSIWYG",Headings:"見出し",Paragraph:"本文",Bold:"太字",Italic:"イタリック",Strike:"ストライク",Code:"コード",Line:"ライン",Blockquote:"引用","Unordered list":"番号なしリスト","Ordered list":"順序付きリスト",Task:"タスク","Insert link":"リンク挿入","Insert codeblock":"コードブロック挿入","Insert table":"テーブル挿入","Insert image":"画像挿入",Heading:"見出し","Image URL":"イメージURL","Select image file":"画像ファイル選択",Description:"ディスクリプション ",OK:"はい",Cancel:"キャンセル",File:"ファイル",URL:"URL","Link text":"リンクテキスト","Add row":"行追加","Add col":"列追加","Remove row":"行削除","Remove col":"列削除","Align left":"左揃え","Align center":"中央揃え","Align right":"右揃え","Remove table":"テーブル削除","Would you like to paste as table?":"テーブルを貼り付けますか?","Text color":"文字色相","Auto scroll enabled":"自動スクロールが有効","Auto scroll disabled":"自動スクロールを無効に","Cannot paste values ​​other than a table in the cell selection state":"表以外の値をセル選択状態に貼り付けることはできません。"})},function(module,exports){"use strict";tui.Editor.i18n.setLang(["nl","nl_NL"],{Markdown:"Markdown",WYSIWYG:"WYSIWYG",Headings:"Koppen",Paragraph:"tekst",Bold:"Vet",Italic:"Cursief",Strike:"Doorhalen",Code:"Code",Line:"Regel",Blockquote:"Citaatblok","Unordered list":"Opsomming","Ordered list":"Genummerde opsomming",Task:"Taak","Insert link":"Link invoegen","Insert codeblock":"Codeblok toevoegen","Insert table":"Tabel invoegen","Insert image":"Afbeelding invoegen",Heading:"Kop","Image URL":"Afbeelding URL","Select image file":"Selecteer een afbeelding",Description:"Omschrijving",OK:"OK",Cancel:"Annuleren",File:"Bestand",URL:"URL","Link text":"Link tekst","Add row":"Rij toevoegen","Add col":"Kolom toevoegen","Remove row":"Rij verwijderen","Remove col":"Kolom verwijderen","Align left":"Links uitlijnen","Align center":"Centreren","Align right":"Rechts uitlijnen","Remove table":"Verwijder tabel","Would you like to paste as table?":"Wil je dit als tabel plakken?","Text color":"Tekstkleur","Auto scroll enabled":"Autoscroll ingeschakeld","Auto scroll disabled":"Autoscroll uitgeschakeld","Cannot paste values ​​other than a table in the cell selection state":"Kan geen waardes anders dan de tabel in de cell plakken"})}]);